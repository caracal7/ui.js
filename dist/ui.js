(()=>{var Oa="useandom-26T198340PX75pxJACKVERYMINDBUSHWOLF_GQZbfghjklqvwyzrict";var La=(e=21)=>{let t="",r=e;for(;r--;)t+=Oa[Math.random()*64|0];return t},rs=La;var Ve=class extends Error{constructor(t){super(t),this.name="i.js \u2764\uFE0F  brackets parse ERROR"}};function Na({open:e,close:t,pos:r,nodes:i},c,p){return{nodeType:"bracket",open:e,close:t,nodes:i,pos:Object.assign({},r,{end:c}),content:p.substring(r.start,c+1),innerContent:p.substring(r.start+1,c)}}function Pa(e){let t=new Map;return e.forEach(([r,i=r])=>t.set(r,i)),{quotes:t}}function Ia(e){let t={},r={};return e.forEach(([i,c])=>{r[i]=c,t[c]=i}),{opens:t,closes:r}}function zn(e){let{text:t,parent:r,start:i,end:c,opt:p}=e;if(i===c&&!p.includeEmpty)return;let f=p.pairs.reduce((x,P)=>x.concat(P.split("")),[]).map(x=>`${p.escape}${x}`),S=x=>f.reduce((P,R)=>P.split(R).join(R[1]),x),_=r.pos.depth+1;r.nodes.push({nodeType:"text",pos:{start:i,end:c,depth:_},content:S(t.substring(i,c))})}var Gn=e=>{let t=e.pop();if(t===void 0)throw new Ve("LogicError :)");return t};function ct(e,t){let i=Object.assign({pairs:["()","{}","[]"],nestMax:100,escape:"\\",skip:!1,includeEmpty:!1,quotes:['"',"'","`"]},t||{}),{pairs:c,nestMax:p,escape:f,skip:S}=i,{opens:_,closes:x}=Ia(c),{quotes:P}=Pa(i.quotes),R=[{nodeType:"root",nodes:[],pos:{start:0,end:0,depth:-1},content:e}],k=0,V=null,$=0;for(let ee=0;ee<e.length;ee++){let te=Gn(R),W=e[ee],y=ee>0&&e[ee-1]===f;if(S&&["{","}","(",")","[","]"].includes(W)&&te.nodeType==="root")R.push(te);else if(S&&["{","(","["].includes(te.open)&&(W==="<"||W===">"))R.push(te);else if(y)R.push(te);else if(V!==null)V===W&&(V=null),R.push(te);else if(P.has(W))V=P.get(W),$=ee,R.push(te);else if(x[W]!==void 0){if(R.length>=p)throw new Ve(`over nest max limit. options: { nestMax: '${i.nestMax}' }`);zn({text:e,parent:te,start:k,end:ee,opt:i}),R.push(te),R.push({nodeType:"bracket-open",pos:{start:ee,depth:te.pos.depth+1},open:W,close:x[W],nodes:[]}),k=ee+1}else if(_[W]!==void 0){if(te.nodeType==="root"||_[W]!==te.open)throw new Ve(`404 pair '${_[W]}' :${ee}`);let ye=Gn(R);zn({text:e,parent:te,start:k,end:ee,opt:i});let Le=Na(te,ee,e);ye.nodes.push(Le),R.push(ye),k=ee+1}else R.push(te)}if(V!==null)throw new Ve(`unclosed quote ${V} near "...${e.substring(k-20,k+30)}..."`);let he=Gn(R);if(he.nodeType!=="root")throw new Ve(`404 pair '${he.open}' :${he.pos.start}`);return zn({text:e,parent:he,start:k,end:e.length,opt:i}),he.nodes}function ss(e){return[...e].reduce((t,r)=>(t.quote?(r===t.quote&&(t.quote=void 0),t.a[t.a.length-1]+=r):r==="="?t.a[t.a.length-1].length?t.a.push("="):t.a[t.a.length-1]="=":r===" "?t.a[t.a.length-1]!=="="&&t.a[t.a.length-1].length&&t.a.push(""):(['"',"'","`"].includes(r)&&(t.quote=r),t.a[t.a.length-1]+=r),t),{a:[""]}).a}function lt(e,t="|",r=!1){let i=[...e].reduce((c,p)=>(c.quote?(p===c.quote&&(c.quote=void 0),c.a[c.a.length-1]+=p):p===t?c.a.push(""):(['"',"'","`"].includes(p)&&(c.quote=p),c.a[c.a.length-1]+=p),c),{a:[""]}).a;return r?i.filter(c=>c):i}function os(e,t="|"){var r=e.lastIndexOf(t);return[e.substr(0,r),e.substr(r+1)]}function is(e){if(['"',"'"].includes(e[0])&&e[0]===e[e.length-1]){for(var t=1;t<e.length-1;){if(e[t]===e[0]&&e[t-1]!=="\\")return!1;t++}return!0}return!1}function Ra(e){return e.filter(t=>t.opts&&t.opts.length).forEach(t=>{t.opts2={};let r=t.opts.find(_=>_.type==="loop");if(r){let _=r.key;t.opts2.key=new Function(`return ${_}`)();let x=r.value.split(" as ");if(!x[1])throw"Alias for the loop not defined";let P=x[1].split(",");t.opts2.loop_fn=x[0].trim(),t.opts2.loop_alias=P[0].trim(),P[1]&&(t.opts2.loop_key_alias=P[1].trim())}let i=t.opts.find(_=>_.type==="text");i&&(is(i.value)?t.opts2.text=i.value.substring(1,i.value.length-1):t.opts2.textFn=i.value);let c=t.opts.find(_=>_.type==="html");c&&(is(c.value)?t.opts2.html=c.value.substring(1,c.value.length-1):t.opts2.htmlFn=c.value),["if","style","attrs","enterStyles","updateStyles","exitStyles","enterAttrs","updateAttrs","exitAttrs"].forEach(_=>{let x=t.opts.find(P=>P.type===_);x&&(t.opts2[_]=x.value)}),t.opts.filter(_=>_.type==="eventCallback").forEach(_=>{t.opts2.events||(t.opts2.events={});let x=_.key.substr(1);if(t.opts2.events[x])throw`ui.js compile error: Duplicate event name "${x}"`;_.value[0]==="("&&console.warn(`"${_.key}(" is deprecated. Use "${_.key}{" inside "${t.content.length>40?t.content.substring(0,40)+"...":t.content}" declaration`),_.value=_.value[0]==="("?_.value.substring(1,_.value.length-1).trim():_.value.trim(),_.value[0]==="{"?_.value=_.value.substring(0,_.value.length-1)+";this.render()}":_.value="("+_.value+")==this.render()",t.opts2.events[x]=_.value}),t.opts.filter(_=>_.type==="eventBind"||_.type==="eventBindSelfNamed").forEach(_=>{t.opts2.events||(t.opts2.events={});let x=_.key.substr(1);if(t.opts2.events[x])throw`ui.js compile error: Duplicate event name "${x}"`;t.opts2.events[x]=new Function(`return (...args) => this.${_.value}(...args)`)()}),t.opts.filter(_=>_.type==="eventCallFunction").forEach(_=>{t.opts2.events||(t.opts2.events={});let x=_.key.substr(1);if(t.opts2.events[x])throw`ui.js compile error: Duplicate event name "${x}"`;t.opts2.events[x]=`${_.value}${_.args}`})}),e.filter(t=>t.opts&&t.opts.length).forEach(t=>{t.opts2||(t.opts2={}),t.opts2.attrs2||(t.opts2.attrs2={},t.opts2.attrsB={},t.opts2.attrsR={}),t.opts.filter(p=>p.type==="booleanAttribute").forEach(p=>{t.opts2.attrs2[p.key]&&console.warn(`ui.js compile warning: direct attibute "${p.key}" override attrs({...${p.key}...}) declaration in tag ""!`),t.opts2.attrs2[p.key]=p.key,t.opts2.attrsB[p.key]=!0}),t.opts.filter(p=>p.type==="stringAttribute").forEach(p=>{t.opts2.attrs2[p.key]&&console.warn(`ui.js compile warning: direct attibute "${p.key}" override attrs({...${p.key}...}) declaration in tag ""!`),t.opts2.attrs2[p.key]=p.value}),t.opts.filter(p=>p.type==="jsAttribute").forEach(p=>{if(p.key[0]==="%"){var f=p.key.substr(1);t.opts2.attrsR[f]=p.value}else var f=p.key;t.opts2.attrs2[f]&&console.warn(`ui.js compile warning: direct attibute "${f}" override attrs({...${f}...}) declaration in tag ""!`),t.opts2.attrs2[f]=p.value.endsWith("%")?p.value:p})}),e.forEach(t=>{t.opts2&&t.opts2.attrs2&&!Object.keys(t.opts2.attrs2).length&&(delete t.opts2.attrs2,delete t.opts2.attrsB),t.opts2&&t.opts2.events&&!Object.keys(t.opts2.events).length&&delete t.opts2.events}),e}function Be({AAA:e,item:t,tag:r,a:i},c="enter",p="enterStyles"){if(i===c&&e.length){let f=e.shift().content;if(f[0]==="("){if(t.opts.find(S=>S.type===c))throw`ui.js template parse error: duplicate ${c}() inside "<${r}>" declaration`;t.opts.push({type:p,value:f.slice(1,-1)})}else if(f[0]==="{"){if(c==="if")throw`ui.js template parse error: expected "if(..." but "if${f[0]}..." found inside "<${r}>"`;if(t.opts.find(S=>S.type===c))throw`ui.js template parse error: duplicate ${c}() inside "<${r}>" declaration`;t.opts.push({type:p,value:f.slice(1,-1)})}else throw`ui.js template parse error: expected "${c}{..." but "${c}${f[0]}..." found inside "<${r}>"`;return!0}return!1}function as(e){return e.filter(t=>t.nodeType==="bracket"&&t.innerContent[0]!=="/").forEach(t=>{t.opts=[];let r=ct(t.innerContent).map(c=>({nodeType:c.nodeType,content:c.content.trim()}));var i="";do{let c=r.shift();if(c.nodeType==="bracket")if(t.opts.length){let p=t.opts[t.opts.length-1];if(p.type==="jsAttribute")p.value+=c.content;else throw`ui.js template parse error: unxpected brackets "${c.content}" at the end of <${i}> attributes`}else throw`ui.js template parse error: unxpected brackets "${c.content}" at the end of <${i}> attributes`;else if(c.nodeType==="text"){let p=ss(c.content);i||(i=p.shift());do{let f=p.shift();if(p[0]&&p[0][0]==="="){let S=p.shift().substr(1);if(f[0]==="@"){if(['"',"'","`"].includes(S[0]))throw`ui.js template parse error: quotes around ${S} is prohibited`;if(r.length&&r[0].nodeType==="bracket"&&!p.length){let _=r.shift();t.opts.push({type:"eventCallFunction",key:f,value:S,args:_.content})}else t.opts.push({type:"eventBind",key:f,value:S.endsWith("/")?S.substring(0,S.length-1):S})}else if(S.startsWith('"')&&S.endsWith('"')||S.startsWith("`")&&S.endsWith("`")||S.startsWith("'")&&S.endsWith("'"))t.opts.push({type:"stringAttribute",key:f,value:S.slice(1,-1)});else if(S.length){let _=S.endsWith("/")?S.substring(0,S.length-1):S;_.startsWith('"')&&_.endsWith('"')||_.startsWith("`")&&_.endsWith("`")||_.startsWith("'")&&_.endsWith("'")?t.opts.push({type:"stringAttribute",key:f,value:_.slice(1,-1)}):t.opts.push({type:"jsAttribute",key:f,value:_})}else{if(!r.length)throw`ui.js template parse error: unxpected end of attribute "...${f}=" inside "<${i}>" declaration`;let _=r.shift().content;_[0]==="{"?t.opts.push({type:"eueAttribute",key:f,value:_}):_[0]==="["?t.opts.push({type:"transitionAttribute",key:f,value:_}):t.opts.push({type:"jsAttribute",key:f,value:_.substring(1,_.length-1)})}}else if(f==="loop"&&r.length){let S=r.shift().content;if(S[0]==="("){if(t.opts.find(P=>P.type==="loop"))throw`ui.js template parse error: duplicate loop${S} inside "<${i}>" declaration`;let[_,x]=os(S.slice(1,-1));if(x)t.opts.push({type:"loop",key:x,value:_});else throw`ui.js template parse error: non-keyed loop not supported yet. "loop${S}" inside "<${i}>"`}else throw`ui.js template parse error: expected "loop(..." but "loop${S[0]}..." found inside "<${i}>" `}else if(!Be({AAA:r,item:t,tag:i,a:f},"if","if")){if(!Be({AAA:r,item:t,tag:i,a:f},"style","style")){if(!Be({AAA:r,item:t,tag:i,a:f},"attrs","attrs")){if(!Be({AAA:r,item:t,tag:i,a:f},"enter","enterStyles")){if(!Be({AAA:r,item:t,tag:i,a:f},"update","updateStyles")){if(!Be({AAA:r,item:t,tag:i,a:f},"exit","exitStyles")){if(!Be({AAA:r,item:t,tag:i,a:f},"#enter","enterAttrs")){if(!Be({AAA:r,item:t,tag:i,a:f},"#update","updateAttrs")){if(!Be({AAA:r,item:t,tag:i,a:f},"#exit","exitAttrs")){if(f==="text"&&r.length){let S=r.shift().content;if(S[0]==="("){if(t.opts.find(_=>_.type==="text"))throw`ui.js template parse error: duplicate text{c} inside "<${i}>" declaration`;t.opts.push({type:"text",value:S.slice(1,-1)})}else throw`ui.js template parse error: expected "text(..." but "text{c[0]}..." found inside "<${i}>"`}else if(f==="html"&&r.length){let S=r.shift().content;if(S[0]==="("){if(t.opts.find(_=>_.type==="html"))throw`ui.js template parse error: duplicate html{c} inside "<${i}>" declaration`;t.opts.push({type:"html",value:S.slice(1,-1)})}else throw`ui.js template parse error: expected "html(..." but "html{c[0]}..." found inside "<${i}>"`}else if(f)if(f[0]==="@")if(!p.length&&r[0]&&r[0].nodeType==="bracket"){let S=r.shift();t.opts.push({type:"eventCallback",key:f,value:S.content})}else f.endsWith("/")?t.opts.push({type:"eventBindSelfNamed",key:f.trim().slice(0,-1),value:f.trim().slice(1,-1)}):t.opts.push({type:"eventBindSelfNamed",key:f.trim(),value:f.trim().slice(1)});else{if(f==="=")throw`ui.js template parse error: unxpected end of attribute "${f}" inside "<${i}>" declaration`;f!=="/"&&t.opts.push({type:"booleanAttribute",key:f.endsWith("/")?f.slice(0,-1):f})}}}}}}}}}}}while(p.length)}}while(r.length)}),Ra(e)}var Yn={"!DOCTYPE":!0,"!doctype":!0,area:!0,base:!0,br:!0,col:!0,command:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,menuitem:!0,param:!0,source:!0,track:!0,wbr:!0,circle:!0,ellipse:!0,line:!0,path:!0,polygon:!0,polyline:!0,rect:!0,stop:!0,use:!0};var Ht=class extends Error{constructor(t){super(t),this.name="ui.js \u2764\uFE0F  syntax ERROR"}};function qn(e,t=[]){if(!t.length)return e;if(e[0]=="@"){if(e.length===1)throw"empty alias tag <@>";let r=t.find(i=>i.alias===e);if(r)e=r.name;else throw`alias <${e}> not defined`}return e}function Wn(e,t){let r=t.find(i=>i.name===e);return r?r.alias:e}function Ba(e,t){let r=[{children:[]}];if(r.last=()=>r[r.length-1],e.forEach(i=>{if(i.nodeType==="text"){var c=r[r.length-1];if(c.text)throw"children and text() attribute at the same time";c.children.push({tag:"#text",content:i.content})}else{var p=i.content.match(new RegExp("^<(@?[a-z][-a-z0-9]*)(\\s.*)?\\/>$","s"));if(p){var c=r[r.length-1];if(c.text)throw"children and text() attribute at the same time";c.children.push(Object.assign({tag:qn(p[1],t)},i.opts2))}else{var f=i.content.match(new RegExp("^<(@?[a-z][-a-z0-9]*)(\\s.*)?>$","s"));if(f)if(Yn[f[1]]){let _=r[r.length-1];if(_.text)throw"children and text() attribute at the same time";_.children.push(Object.assign({tag:qn(f[1],t)},i.opts2))}else r.push(Object.assign({tag:qn(f[1],t),children:[]},i.opts2));else{var S=i.content.match(new RegExp("^<\\/(@?[a-z][-a-z0-9]*)(\\s.*)?>$","s"));if(S){if(Yn[S[1]])throw`can't close self-closing tag "</${S[1]}>"`;let _=r[r.length-2],x=r.pop();if(x.children.length===1&&x.children[0].tag==="#text"?(x.text=x.children[0].content,delete x.children):x.children.length||delete x.children,_){if(_.text)throw"children and text() attribute at the same time";let P=Wn(x.tag,t),R=Wn(S[1],t);if(P!==R)throw`the opening and closing tags are not the same <${P}>...</${R}>`;_.children.push(x)}else throw!x.children||x.children[0].tag!==S[1]?`missing the opening tag for </${S[1]}>`:`closed twice tag <${x.children[0].tag}>`}}}}}),r.length>1){let i=r.find(c=>c.tag);throw`Unclosed tag <${Wn(i.tag,t)}>`}return r[0].children}var cs=Ba;var ut={};ut.animate=function(e,t,r,i,c,p,f){if(typeof e!="number"||typeof t!="number"||typeof r!="number"||typeof i!="function")return;typeof c=="string"&&H[c]&&(c=H[c]),typeof c!="function"&&(c=H.linear),typeof p!="function"&&(p=function(){});var S=window.requestAnimationFrame||function(k){window.setTimeout(k,1e3/60)},_=!1,x=t-e;function P(k){if(!_){var V=(k||+new Date)-R;V>=0&&i(c(V,e,x,r)),V>=0&&V>=r?(i(t),p(f,t)):S(P)}}if(i(e),x){var R=window.performance&&window.performance.now?window.performance.now():+new Date;S(P)}return{update:function(k,V,$){R=window.performance&&window.performance.now?window.performance.now():+new Date,e=k,t=V,x=t-e,typeof $=="string"&&H[$]&&(c=H[$])},cancel:function(){_=!0},last:t}};ut.animateCSS=function(e,t,r,i,c,p,f,S){var _=function(x){e.style[t]=x+r};return ut.animate(i,c,p,_,f,S)};ut.cancel=function(e){e&&e.cancel()};var H=ut.easings={};H.linear=function(e,t,r,i){return r*e/i+t};H.easeInQuad=function(e,t,r,i){return r*(e/=i)*e+t};H.easeOutQuad=function(e,t,r,i){return-r*(e/=i)*(e-2)+t};H.easeInOutQuad=function(e,t,r,i){return(e/=i/2)<1?r/2*e*e+t:-r/2*(--e*(e-2)-1)+t};H.easeInCubic=function(e,t,r,i){return r*(e/=i)*e*e+t};H.easeOutCubic=function(e,t,r,i){return r*((e=e/i-1)*e*e+1)+t};H.easeInOutCubic=function(e,t,r,i){return(e/=i/2)<1?r/2*e*e*e+t:r/2*((e-=2)*e*e+2)+t};H.easeInQuart=function(e,t,r,i){return r*(e/=i)*e*e*e+t};H.easeOutQuart=function(e,t,r,i){return-r*((e=e/i-1)*e*e*e-1)+t};H.easeInOutQuart=function(e,t,r,i){return(e/=i/2)<1?r/2*e*e*e*e+t:-r/2*((e-=2)*e*e*e-2)+t};H.easeInQuint=function(e,t,r,i){return r*(e/=i)*e*e*e*e+t};H.easeOutQuint=function(e,t,r,i){return r*((e=e/i-1)*e*e*e*e+1)+t};H.easeInOutQuint=function(e,t,r,i){return(e/=i/2)<1?r/2*e*e*e*e*e+t:r/2*((e-=2)*e*e*e*e+2)+t};H.easeInSine=function(e,t,r,i){return-r*Math.cos(e/i*(Math.PI/2))+r+t};H.easeOutSine=function(e,t,r,i){return r*Math.sin(e/i*(Math.PI/2))+t};H.easeInOutSine=function(e,t,r,i){return-r/2*(Math.cos(Math.PI*e/i)-1)+t};H.easeInExpo=function(e,t,r,i){return e==0?t:r*Math.pow(2,10*(e/i-1))+t};H.easeOutExpo=function(e,t,r,i){return e==i?t+r:r*(-Math.pow(2,-10*e/i)+1)+t};H.easeInOutExpo=function(e,t,r,i){return e==0?t:e==i?t+r:(e/=i/2)<1?r/2*Math.pow(2,10*(e-1))+t:r/2*(-Math.pow(2,-10*--e)+2)+t};H.easeInCirc=function(e,t,r,i){return-r*(Math.sqrt(1-(e/=i)*e)-1)+t};H.easeOutCirc=function(e,t,r,i){return r*Math.sqrt(1-(e=e/i-1)*e)+t};H.easeInOutCirc=function(e,t,r,i){return(e/=i/2)<1?-r/2*(Math.sqrt(1-e*e)-1)+t:r/2*(Math.sqrt(1-(e-=2)*e)+1)+t};H.easeInElastic=function(e,t,r,i){var c=0,p=r;if(e==0)return t;if((e/=i)==1)return t+r;if(c||(c=i*.3),p<Math.abs(r)){p=r;var f=c/4}else var f=c/(2*Math.PI)*Math.asin(r/p);return-(p*Math.pow(2,10*(e-=1))*Math.sin((e*i-f)*(2*Math.PI)/c))+t};H.easeOutElastic=function(e,t,r,i){var c=0,p=r;if(e==0)return t;if((e/=i)==1)return t+r;if(c||(c=i*.3),p<Math.abs(r)){p=r;var f=c/4}else var f=c/(2*Math.PI)*Math.asin(r/p);return p*Math.pow(2,-10*e)*Math.sin((e*i-f)*(2*Math.PI)/c)+r+t};H.easeInOutElastic=function(e,t,r,i){var c=0,p=r;if(e==0)return t;if((e/=i/2)==2)return t+r;if(c||(c=i*(.3*1.5)),p<Math.abs(r)){p=r;var f=c/4}else var f=c/(2*Math.PI)*Math.asin(r/p);return e<1?-.5*(p*Math.pow(2,10*(e-=1))*Math.sin((e*i-f)*(2*Math.PI)/c))+t:p*Math.pow(2,-10*(e-=1))*Math.sin((e*i-f)*(2*Math.PI)/c)*.5+r+t};H.easeInBack=function(e,t,r,i,c){return c==null&&(c=1.70158),r*(e/=i)*e*((c+1)*e-c)+t};H.easeOutBack=function(e,t,r,i,c){return c==null&&(c=1.70158),r*((e=e/i-1)*e*((c+1)*e+c)+1)+t};H.easeInOutBack=function(e,t,r,i,c){return c==null&&(c=1.70158),(e/=i/2)<1?r/2*(e*e*(((c*=1.525)+1)*e-c))+t:r/2*((e-=2)*e*(((c*=1.525)+1)*e+c)+2)+t};H.easeInBounce=function(e,t,r,i){return r-H.easeOutBounce(i-e,0,r,i)+t};H.easeOutBounce=function(e,t,r,i){return(e/=i)<1/2.75?r*(7.5625*e*e)+t:e<2/2.75?r*(7.5625*(e-=1.5/2.75)*e+.75)+t:e<2.5/2.75?r*(7.5625*(e-=2.25/2.75)*e+.9375)+t:r*(7.5625*(e-=2.625/2.75)*e+.984375)+t};H.easeInOutBounce=function(e,t,r,i){return e<i/2?H.easeInBounce(e*2,0,r,i)*.5+t:H.easeOutBounce(e*2-i,0,r,i)*.5+r*.5+t};var Se=ut;var Ma={},Me=Ma;var Oe={duration:500};function Vn(e,t,r){var i=e[t];if(t<r)for(;t<r;t++)e[t]=e[t+1];else for(;t>r;t--)e[t]=e[t-1];e[r]=i}function pt(e,t){if(typeof Me[e.tag]=="function")var r=new Me[e.tag](t,e);else if(e.svg)var r=document.createElementNS("http://www.w3.org/2000/svg",e.tag);else var r=document.createElement(e.tag);return Object.assign(r,{_attrs:{},_styles:{},_attrsV:{},_styleV:{},_colors:{},_events:{}}),r}function ls(e,t,r){t._BASE_ELEMENT?r?e._childNodes.splice(e._childNodes.findIndex(i=>i===r)+1,0,t):e._childNodes.unshift(t):r?r.after(t):e.prepend(t)}function ft(e,t){t._BASE_ELEMENT?e._childNodes.unshift(t):e.prepend(t)}function mt(e,t,r){var R;var i=void 0,c="linear",p=void 0,f=void 0,S=void 0;if(typeof r=="object"){var _=r.duration||Oe.duration,x=r.to;r.ease&&(c=r.ease),r.fn&&(p=r.fn),r.done&&(f=r.done),r.from!==void 0&&(i=r.from),r.default!==void 0&&(S=r.default)}else var _=Oe.duration,x=r;if(i===void 0){var P=e.__rendererName?e.state[t]:e.getAttribute(t);i=P==null?S||0:Number(P)}Se.cancel(e._attrs[t]),p?(i=((R=e._attrs[t])==null?void 0:R.last)||0,e._attrs[t]=Se.animate(i,x,_,k=>{e.setAttribute(t,p(k))},c,f,e)):e._attrs[t]=Se.animate(i,x,_,k=>{e.setAttribute(t,k)},c,f,e)}function Fa(e,t,r){var i="linear",c=0;if(typeof r=="object"){var p=r.duration||Oe.duration,f=r.to;r.ease&&(i=r.ease),r.delay&&(c=r.delay)}else var p=Oe.duration,f=r;e._colors[t]=t+" "+p+"ms "+i+" "+c+"ms",clearTimeout(e._styles[t]),e._styles[t]=setTimeout(()=>{delete e._colors[t];var _=Object.values(e._colors).join(",");e._transition!=_&&(e._transition=_,e._transition?e.style.setProperty("transition",e._transition):e.style.removeProperty("transition"))},p+c);var S=Object.values(e._colors).join(",");e._transition!=S&&(e._transition=S,e._transition?e.style.setProperty("transition",e._transition):e.style.removeProperty("transition")),e.style.getPropertyValue(t)||e.style.setProperty(t,"#000000"),e.style.setProperty(t,getComputedStyle(e)[t]),setTimeout(()=>{e.style.setProperty(t,f)},0)}function Qt(e,t,r){if(["color","background","fill","stroke","background-color","border-color"].includes(t)){Fa(e,t,r);return}var i="linear",c=void 0,p=void 0,f=0,S="",_=void 0,x=void 0;if(typeof r=="object"){if(typeof r.duration=="function"&&(r.duration=r.duration()),r.duration===0&&r.to){Se.cancel(e._styles[t]),e.style.setProperty(t,r.to);return}var P=r.duration||Oe.duration,R=r.to;r.from!==void 0&&(p=r.from),r.default!==void 0&&(x=r.default),r.ease&&(i=r.ease),r.done&&(c=r.done),r.threshold!==void 0&&(f=r.threshold),r.fn&&(_=r.fn)}else var P=Oe.duration,R=r;var k=t.startsWith("--"),V=k?e.style.getPropertyValue(t):e.style[t];if(!V&&x&&(V=x),typeof R=="string"?["px","%","deg","vw","vh","em"].some($=>{if(R.endsWith($))return p!==void 0?p.endsWith($)&&(p=Number(p.substring(0,p.length-$.length))):p=Number(V.substring(0,V.length-$.length)),R=Number(R.substring(0,R.length-$.length)),S=$,!0})||(R=Number(R)):p===void 0&&(p=Number(V)),f&&Math.abs(p-R)<f){Se.cancel(e._styles[t]),e.style.setProperty(t,r.to);return}Se.cancel(e._styles[t]),_?e._styles[t]=Se.animate(p,R,P,$=>{e.style.setProperty(t,_($+S))},i,c,e):e._styles[t]=Se.animate(p,R,P,$=>{e.style.setProperty(t,$+S)},i,c,e)}function Et(e,t){return!!(e==="input"&&["checked","autofocus","readonly","required","disabled","multiple"].includes(t)||e==="option"&&["selected"].includes(t)||e==="button"&&["disabled","multiple"].includes(t)||e==="select"&&["disabled"].includes(t))}function us(e,t,r,i,c){return typeof c!="object"?(e.setAttribute(i,c),Oe.duration):(mt(e,i,c),c.duration?c.duration:Oe.duration)}function ps(e,t,r,i,c){return Qt(e,i,c),c.duration?c.duration:Oe.duration}function fs(e,t,r,i,c,p){var f=0,S=0;if(t.exitAttrs){var _=t.exitAttrs(r);typeof _=="object"&&(S=Object.entries(_).reduce((P,R)=>Math.max(us(e,t,r,R[0],R[1]),P),0))}if(t.exitStyles){var x=t.exitStyles(r);typeof x=="object"&&(f=Object.entries(x).reduce((P,R)=>Math.max(ps(e,t,r,R[0],R[1]),P),0))}if(e.isExit=!0,f>0||S>0){let P=setTimeout(()=>p.Done.then(()=>{xt(e),c.exit.delete(i)}),f>S?f:S);c.exit.set(i,{element:e,timeout:P});return}clearTimeout(c.exit[i]),xt(e)}function ms(e,t,r,i,c){var p=0,f=0;if(t.exitAttrs){var S=t.exitAttrs(r);typeof S=="object"&&(f=Object.entries(S).reduce((x,P)=>Math.max(us(e,t,r,P[0],P[1]),x),0))}if(t.exitStyles){var _=t.exitStyles(r);typeof _=="object"&&(p=Object.entries(_).reduce((x,P)=>Math.max(ps(e,t,r,P[0],P[1]),x),0))}if(e.isExit=!0,p>0||f>0){let x=setTimeout(()=>i.Done.then(()=>{i.__i__[c]=!1,xt(e)}),p>f?p:f);return i.__i__[c]={exit:x},!1}return clearTimeout(i.__i__[c]),i.__i__[c]=!1,xt(e),!0}async function xt(e){if(e.nodeName==="#text"){console.log("TEXT");return}if(e.__i__)for(let r of Object.values(e.__i__))clearTimeout(r.exit);for(let r of Object.values(e._attrs))r!=null&&r.cancel&&r.cancel();for(let r of Object.values(e._styles))r!=null&&r.cancel&&r.cancel();let t=e.__rendererName?e.document._childNodes:e.children;for(;t.length;){let r=t[t.length-1];await xt(r)}await e.remove()}function At(e,t,r,i,c,p,f){var S=c.keys,_=c.elements,x=c.exit,P=_.length,R=f.length,k=P>R?P:R,V=0,$=0,he=0;do{if($<R){var ee=e.key(f[$],$);if($>=P){P++,k=P>R?P:R;var te=x.get(ee);if(te){clearTimeout(te.timeout);var W=te.element;delete W.isExit,e.svg||(W.className=""),x.delete(ee)}else var W=pt(e,t);if(i[e.loop_alias]=f[$],e.loop_key_alias&&(i[e.loop_key_alias]=$),wt(W,e,i,de,te),$===0)if(x.size)for(let Ue of x){Ue[1].element.before(W);break}else r?r.after(W):ft(t,W);else _[$-1].after(W);_.splice($,0,W),W.key=ee,S[ee]=!0,$++;continue}else{var y=_[$].key;if(ee===y){i[e.loop_alias]=f[$],e.loop_key_alias&&(i[e.loop_key_alias]=$),e.Update_Tag(_[$],e,i,de),$++;continue}else if(S[ee]){var ye=void 0,Le=void 0;let Ue;for(var Qe=void 0,_e=$+1;_e<k;_e++)if(!ye&&_e<P&&_[_e].key===ee&&(ye=_e+1),!Le&&_e<R&&e.key(f[_e],_e)===y&&(Le=_e+1),ye&&Le){var Ne=_[$];if(ye>=Le)Ue=_[ye-1],t.insertBefore(Ue,Ne),i[e.loop_alias]=f[$],e.loop_key_alias&&(i[e.loop_key_alias]=$),e.Update_Tag(Ue,e,i,de),ye===Le?(_e-$>1&&(ye>=_.length?_[_e-1].after(Ne):t.insertBefore(Ne,_[ye])),_[$]=_[_e],_[_e]=Ne):(Vn(_,ye-1,$),V++),$++;else{Ue=!0;var Ke=Le-1+V;if(Ke>=_.length)_[_.length-2].after(Ne);else{if(!_[Ke])throw 9999999999;t.insertBefore(Ne,_[Ke])}Vn(_,$,(Ke>P?P:Ke)-1),i[e.loop_alias]=f[$],e.loop_key_alias&&(i[e.loop_key_alias]=$),e.Update_Tag(Ne,e,i,de)}break}if(Ue)continue}else{P++,k=P>R?P:R;var te=x.get(ee);if(te)clearTimeout(te.timeout),W=te.element,delete W.isExit,e.svg||(W.className=""),x.delete(ee);else var W=pt(e,t);i[e.loop_alias]=f[$],e.loop_key_alias&&(i[e.loop_key_alias]=$),wt(W,e,i,de,te),$===0?r?r.after(W):ft(t,W):_[$-1].after(W),_.splice($,0,W),W.key=ee,S[ee]=!0,$++;continue}}}delete S[_[$].key],e.loop_key_alias&&(i[e.loop_key_alias]=$+he,he++),fs(_[$],e,i,_[$].key,c,t),_.splice($,1),P--,k=P>R?P:R}while($<k);return c.length=_.length,x.size+c.length}function Ua(){return{ret_element:function(e,t,r,i){return e},children:function(e,t,r,i){i.UPDATE_Chidldren(e,t.children,r)},fn_text:function(e,t,r,i){var c=t.text(r);if(!e){console.log("NOT element.__lastText",e),console.trace();return}e.__lastText!==c&&(e.textContent=e.__lastText=c)},fn_html:function(e,t,r,i){var c=t.html(r);e.__lastHTML!==c&&(e.innerHTML=e.__lastHTML=c)},updateProps:function(e,t,r,i){t.updateProps(e,t,r,i)}}}function Kt(e){var t=[],r=Ua();return e.tag==="#text"?(t.push(r.ret_element),t):(e.children?t.push(r.children):e.html?typeof e.html=="function"&&t.push(r.fn_html):e.text&&typeof e.text=="function"&&t.push(r.fn_text),e.updateProps&&(t=[...t,...e.updateProps]),t.push(r.ret_element),t)}function Da(e,t,r,i,c,p){return t.Update_Tag(e.__rendererName?e._childNodes[c]:e.childNodes[c],t,r,de),c+1}function ja(e,t,r,i,c,p){let f=t.loop(r);if(!p||p.length===0){if(!p||p.exit.size===0)return f.length?i===0?(t.enter(t,e,void 0,r,i,f,de),c+e.__i__[i].length):(t.enter(t,e,c===0?void 0:e.__rendererName?e._childNodes[c-1]:e.childNodes[c-1],r,i,f,de),c+e.__i__[i].length):c;if(f.length){let S=At(t,e,i===0||c===0?void 0:e.__rendererName?e._childNodes[c]:e.childNodes[c],r,p,i,f);return c+S}else return c+p.exit.size}else if(f.length){let S=At(t,e,i===0||c===0?void 0:e.__rendererName?e._childNodes[c-1]:e.childNodes[c-1],r,p,i,f);return c+S}else{let S=At(t,e,i===0||c===0?void 0:e.__rendererName?e._childNodes[c]:e.childNodes[c],r,p,i,f);return c+S}}function ka(e,t,r,i,c,p){if(p===!1)if(t.if(r)){let _=pt(t,e);if(t.children)Fe(_,t.children,r);else if(t.text){var f=typeof t.text=="function"?t.text(r):t.text;_.__lastText!==f&&(_.textContent=_.__lastText=f)}else if(t.html){var S=typeof t.html=="function"?t.html(r):t.html;_.__lastHTML!==S&&(_.innerHTML=_.__lastHTML=S)}return t.enterProps&&t.enterProps(_,t,r,de),c===0?ft(e,_):e.__rendererName?e._childNodes[c-1].after(_):e.childNodes[c-1].after(_),e.__i__[i]={exit:!1},c+1}else return c;else{if(t.if(r))return p.exit?(clearTimeout(p.exit),t.enterProps&&t.enterProps(e.__rendererName?e._childNodes[c]:e.childNodes[c],t,r,de),e.__i__[i]={exit:!1},c+1):(t.Update_Tag(e.__rendererName?e._childNodes[c]:e.childNodes[c],t,r,de),c+1);if(p.exit)return c+1;{let _=e.__rendererName?e._childNodes:e.childNodes;return ms(_[c],t,r,e,i)?c:c+1}}}function za(e,t,r,i,c,p){if(p===!1||p.length===0)if(t.if(r)){let f=t.loop(r);return f.length?i===0?(t.enter(t,e,void 0,r,i,f,de),c+e.__i__[i].length):(t.enter(t,e,c===0?void 0:e.__rendererName?e._childNodes[c-1]:e.childNodes[c-1],r,i,f,de),c+e.__i__[i].length):c}else return c;else if(t.if(r)){let f=t.loop(r),S=At(t,e,i===0&&c===0?void 0:e.__rendererName||e.__rendererName?e._childNodes[c]:e.childNodes[c],r,p,i,f);return c+S}else{if(p.length===0)return c+p.exit.size;{let f=At(t,e,i===0&&c===0?void 0:e.__rendererName?e._childNodes[c]:e.childNodes[c],r,p,i,[]);return c+f}}}function Xt(e,t,r){if(!e.isExit){var i=void 0;e.Done=new Promise(p=>i=p);var c=0;t.every((p,f)=>{if(!e.__i__)return console.groupCollapsed("Not initialized element!!! "+p.tag),console.dir(e),console.log("component",t),console.log("tag",p),console.trace(),console.groupEnd(),!1;let S=e.__i__[f];return p.tag==="#text"?(c++,!0):(p.hasOwnProperty("if")?p.loop?c=za(e,p,r,f,c,S):c=ka(e,p,r,f,c,S):p.loop?c=ja(e,p,r,f,c,S):c=Da(e,p,r,f,c,S),!0)}),i()}}function hs(e,t,r,i){var p,f;if(e.tag==="input"&&r==="value")t._attrsV[r]!==i&&(t._attrsV[r]=i,t.value!=i&&(t.value=i));else if(r==="class"){if(typeof i=="object"&&i!==null)throw"Cannot do transition on class attribute";var c=i||void 0;t._attrsV[r]!==c&&(t._attrsV[r]=c,c?e.svg?t.setAttribute(r,c):t.className=c:t.removeAttribute(r))}else if(r==="style"){if(typeof i=="object"&&i!==null)throw"Cannot do transition on style attribute";var c=i||void 0;t._attrsV[r]!==c&&(t._attrsV[r]=c,c?t.setAttribute(r,c):t.removeAttribute(r))}else(typeof i=="object"||t._attrsV[r]!==i||Array.isArray(i))&&(Et(e.tag,r)?(t._attrsV[r]=i,e.tag==="input"&&e.attrs2.type==="radio"&&r==="checked"&&!e.attrsB[r]?e.attrs2.value?e.attrs2.value==i?(t.setAttribute(r,""),t[r]=r):(t.removeAttribute(r),t[r]=""):i?(t.setAttribute(r,""),t[r]=r):(t.removeAttribute(r),t[r]=""):i?t.setAttribute(r,"")||(t[r]=r):t.removeAttribute(r)||(t[r]="")):e.tag==="textarea"&&r==="value"?t.value=i:(!e.attrs3||!e.attrs3[r])&&typeof i=="object"?i!=null&&i.skip||t._attrsV[r]!==i.to&&(t._attrsV[r]=i.to,i!=null&&i.disabled?((p=t._attrs[r])!=null&&p.cancel&&t._attrs[r].cancel(),t.setAttribute(r,i.to)):mt(t,r,i)):t._attrsV[r]!==i&&(t._attrsV[r]=i,(f=t._attrs[r])!=null&&f.cancel&&t._attrs[r].cancel(),t.setAttribute(r,i)))}function Ga(){return{updateAttrs:function(e,t,r,i){Object.entries(t.updateAttrs(r)).forEach(([c,p])=>{i.updateAttribute(t,e,c,p)})},attrs3:function(e,t,r,i){Object.entries(t.attrs3).forEach(([c,p])=>{i.updateAttribute(t,e,c,typeof p=="function"?p(r):p)})},updateStyles:function(e,t,r,i){Object.entries(t.updateStyles(r)).forEach(([c,p])=>{var f;typeof p=="object"?e._styleV[c]!==p.to&&(p!=null&&p.skip||(e._styleV[c]=p.to,p!=null&&p.disabled?((f=e._styles[c])!=null&&f.cancel&&e._styles[c].cancel(),e.style.setProperty(c,p.to)):i.animateCSS(e,c,p))):e._styleV[c]!==p&&(e._styleV[c]=p,e.style.setProperty(c,p))})},style:function(e,t,r,i){Object.entries(t.style(r)).forEach(([c,p])=>{e._styleV[c]!==p&&(e._styleV[c]=p,e.style.setProperty(c,p))})},events:function(e,t,r,i){e.__datum={...r}}}}function Zt(e){let t=[],r=Ga();return e.updateAttrs&&t.push(r.updateAttrs),e.attrs3&&t.push(r.attrs3),e.style&&t.push(r.style),e.updateStyles&&t.push(r.updateStyles),e.events&&t.push(r.events),t}var ds=(...e)=>e.filter(t=>typeof t=="function").reduce((t,r)=>t===null?r:function(...c){t.apply(this,c),r.apply(this,c)},null);var Ya={createElement:pt,insertElement:ls,prependElement:ft,Enter_Children:Fe,UPDATE_Chidldren:Xt,Update_Tag:Kt,animateAttr:mt,animateCSS:Qt,enterProps:en,enterAttribute:ys,updateProps:Zt,updateAttribute:hs},de=Ya;function ys(e,t,r,i){var p;if(r==="class"){var c=i||void 0;t._attrsV[r]=c,c&&(e.svg?t.setAttribute(r,c):t.className=c)}else if(r==="style"){var c=i||void 0;t._attrsV[r]=c,c&&t.setAttribute(r,c)}else r==="id"?(t._attrsV[r]=i,t.id=i,t.setAttribute(r,i)):Et(e.tag,r)?e.tag==="input"&&e.attrs2.type==="radio"&&r==="checked"&&!e.attrsB[r]?e.attrs2.value?e.attrs2.value==i&&(t.setAttribute(r,""),t._attrsV[r]=i&&!0):i&&(t.setAttribute(r,""),t._attrsV[r]=i&&!0):(t._attrsV[r]=i&&!0,i&&t.setAttribute(r,"")):e.tag==="textarea"&&r==="value"?(t._attrsV[r]=i,t.innerHTML=i):((p=t._attrs[r])!=null&&p.cancel&&t._attrs[r].cancel(),t._attrsV[r]=i,t.setAttribute(r,i))}function qa(){return{enterAttrs:function(e,t,r,i){Object.entries(t.enterAttrs(r)).forEach(([c,p])=>{var f;if(Array.isArray(p))throw"not implemented";typeof p=="object"?(e._attrsV[c]=p,i.animateAttr(e,c,p)):((f=e._attrs[c])!=null&&f.cancel&&e._attrs[c].cancel(),i.enterAttribute(t,e,c,p))})},attrs:function(e,t,r,i){var c=t.attrs?t.attrs(r):{};t.attrs2&&Object.entries(t.attrs2).forEach(([p,f])=>{c[p]=typeof f=="function"?f(r):f}),Object.entries(c).forEach(([p,f])=>{i.enterAttribute(t,e,p,f)})},enterStyles:function(e,t,r,i){Object.entries(t.enterStyles(r)).forEach(([c,p])=>{var f;if(Array.isArray(p))throw"not implemented";typeof p=="object"?(e._styleV[c]=p.to,i.animateCSS(e,c,p)):(e._styleV[c]=p,(f=e._styles[c])!=null&&f.cancel&&e._styles[c].cancel(),e.style.setProperty(c,p))})},style:function(e,t,r,i){Object.entries(t.style(r)).forEach(([c,p])=>{e._styleV[c]=p,e.style.setProperty(c,p)})},events:function(e,t,r,i){e.__datum={...r},Object.entries(t.events).forEach(([c,p])=>{e._events[c]=f=>p(f,e.__datum,e),e.addEventListener(c,e._events[c])})}}}function en(e){let t=[],r=qa();return e.enterAttrs&&t.push(r.enterAttrs),(e.attrs||e.attrs2)&&t.push(r.attrs),e.style&&t.push(r.style),e.enterStyles&&t.push(r.enterStyles),e.events&&t.push(r.events),t}function _s(e){return(t,r,i,c,p,f,S)=>{var _={},x=new Map,P=[],R=i;return f.forEach((k,V)=>{var $=S.createElement(t,r);$.key=t.key(k,V),_[$.key]=!0,P.push($),c[t.loop_alias]=k,t.loop_key_alias&&(c[t.loop_key_alias]=V),t.enterProps&&t.enterProps($,t,c,S),t.children?S.Enter_Children($,t.children,c):(t.text&&(typeof t.text=="function"?$.textContent=$.__lastText=t.text(c):$.textContent=$.__lastText=t.text),t.html&&(typeof t.html=="function"?$.innerHTML=$.__lastHTML=t.html(c):$.innerHTML=$.__lastHTML=t.html)),V===0&&!R?S.prependElement(r,$):R.after($),R=$}),r.__i__[p]={length:f.length,exit:x,elements:P,keys:_},R}}function Wa(e,t,r,i){e.__i__={},t.forEach((c,p)=>{if(c.if&&!c.if(r)){e.__i__[p]=!1;return}if(c.loop){if(c.loop(r).length)throw 123;e.__i__[p]=!1;return}else{let f=e.__rendererName?e._childNodes:e.children;wt(f[p],c,r,i,!0);return}})}function wt(e,t,r,i,c){return t.enterProps&&t.enterProps(e,t,r,i),t.children?c?Wa(e,t.children,r,i):Fe(e,t.children,r):(t.text&&(typeof t.text=="function"?e.textContent=e.__lastText=t.text(r):e.textContent=e.__lastText=t.text),t.html&&(typeof t.html=="function"?e.innerHTML=e.__lastHTML=t.html(r):e.innerHTML=e.__lastHTML=t.html)),e}function bs(e,t,r,i,c){return e.element=document.createTextNode(e.content),r?r.after(e.element):t.prepend(e.element),t.__i__[c]={exit:!1},e.element}function gs(e){return(t,r,i,c,p,f,S)=>{var _=S.createElement(t,r);return t.enterProps&&t.enterProps(_,t,c,S),t.text&&(typeof t.text=="function"?_.textContent=_.__lastText=t.text(c):_.textContent=_.__lastText=t.text),t.html&&(typeof t.html=="function"?_.innerHTML=_.__lastHTML=t.html(c):_.innerHTML=_.__lastHTML=t.html),S.insertElement(r,_,i),r.__i__[p]={exit:!1},_}}function vs(e){return(t,r,i,c,p,f,S)=>{var _=S.createElement(t,r);return t.enterProps&&t.enterProps(_,t,c,S),S.insertElement(r,_,i),S.Enter_Children(_,t.children,c),r.__i__[p]={exit:!1},_}}function Fe(e,t,r){e.__i__={};var i;t.forEach((c,p)=>{if(c.if&&!c.if(r)){e.__i__[p]=!1;return}if(c.loop){let f=c.loop(r);if(f.length){i=c.enter(c,e,i,r,p,f,de);return}else{e.__i__[p]=!1;return}}else{i=c.enter(c,e,i,r,p,void 0,de);return}})}function Ss(e){if(e.tag==="#text"){e.enter=bs;return}e.enterProps=en(e),e.updateProps=Zt(e),e.Update_Tag=Kt(e),e.loop?e.enter=_s(e):e.enter=e.children?vs(e):gs(e)}var Va=Object.getPrototypeOf(async function(){}).constructor,tn=Va;var Ja=["svg","g","path","polygon","rect","circle","line","clipPath","cursor","defs","desc","ellipse","filter","font","glyph","image","text","textPath","animate","animateMotion","animateTransform"],nn=(e,t)=>new Function(`return ({ ${e.context.join(",")} }) => ${e[t]}`)(),Ha=(e,t)=>new Function(`return ({ ${e.context.join(",")} }) => ({${e[t]}})`)(),rn=(e,t,r)=>new Function(`return (event, { ${e.context.join(",")} }, element) => {setTimeout(()=>this.render(),0);${t} = event.target.${r}} `)(),Qa=(e,t)=>new Function(`return async (event, { ${e.context.join(",")} }, element) => ${t}`)(),Ka=(e,t)=>new Function(`return ({ ${e.context.join(",")} }) => ${t.value+(t.args||"")}`)();function Jn(e,t,r){return e.forEach((i,c)=>{Ja.includes(i.tag)&&(i.svg=!0),i.context=[...t],i.loop_alias&&(i.loop=nn(i,"loop_fn"),i.context.push(i.loop_alias),i.loop_key_alias&&i.context.push(i.loop_key_alias)),i.textFn&&(i.text=nn(i,"textFn"),delete i.textFn),i.htmlFn&&(i.html=nn(i,"htmlFn"),delete i.htmlFn),i.if&&(i.if=nn(i,"if")),["style","attrs","enterStyles","updateStyles","exitStyles","enterAttrs","updateAttrs","exitAttrs"].forEach(p=>{i[p]&&(i[p]=Ha(i,p))}),i.events&&Object.entries(i.events).forEach(([p,f])=>{typeof f=="string"&&(i.events[p]=Qa(i,f))}),i.attrsR&&Object.keys(i.attrsR).length&&Object.entries(i.attrsR).forEach(([p,f])=>{if(i.events||(i.events={}),i.events.input)throw"@input and reactive attr at the same time";i.tag==="input"?p==="value"?i.events.input=rn(i,f,"value"):p==="checked"&&(i.attrs2.type==="checkbox"?i.events.input=rn(i,f,"checked"):i.attrs2.type==="radio"&&(i.events.input=rn(i,f,"value"))):i.tag==="textarea"&&p==="value"&&(i.events.input=rn(i,f,"value"))}),i.attrs2&&(Object.keys(i.attrs2).length&&(i.attrs3={}),Object.entries(i.attrs2).forEach(([p,f])=>{typeof f=="object"&&f.type==="jsAttribute"&&(i.attrs3[p]=i.attrs2[p]=Ka(i,f))}),Object.keys(i.attrs3).length||delete i.attrs3),Ss(i),i.children&&Jn(i.children,i.context,r)}),e}function Xa(e){return e.filter(t=>{if(t.nodeType==="bracket"){let r=t.innerContent.split(" ").join("");if(["","/","@","@/","/@"].includes(r))throw`Empty tag <${r}>`}return!(t.nodeType==="text"&&!t.content.trim().length)})}function Za(e=""){return Xa(ct(e,{skip:!0,pairs:["<>","{}","()","[]"]}))}function Ts(e,t=[],r=!1){return Jn(cs(as(Za(e)),t),["state"],r)}var ec="static|template|state|class|style|walt";function tc(e){return e.split(/\r\n|\n|\r/)}function nc(e,t){let r=e.match(new RegExp(`^\\s*<!(${t})>\\s*$`,"i"));return r?r[1]:null}function rc(e,t){let r=e.match(new RegExp(`^\\s*<!${t}\\s+([^>]*)>\\s*$`,"i"));return r?r[1]:null}async function sc(e){let t=tc(e),r={};var i=void 0,c=0;for(let p=0;p<t.length;p++){let f=t[p];if(!f.trim().length)continue;let S=nc(f,ec);if(!(!S&&["css","import","tag","renderer"].some(_=>{let x=rc(f,_);if(x)return i=_,r[i]||(r[i]=[]),r[_].push(i==="tag"?{value:x,line:p}:x),!0}))){if(!i&&!S){i="template",c=p,r.template="",r.template+=`
`+f;continue}if(S){if(i=S,!r[S])r[S]="";else throw`duplicate <!${S}> block at line ${p}`;continue}else{if(["css","import","tag","renderer"].includes(i))if(!r.template)i="template",c=p,r.template="";else{if(f.trim().startsWith("//"))continue;throw`unexpected "${f.trim()}" at line ${p}. Template started at line ${c}`}r[i]+=`
`+f;continue}}}return r}function Je(e){return['"',"'","`"].includes(e[0])&&e[0]==e[e.length-1]?e.substring(1,e.length-1).trim():e.trim()}function oc(e){let t={},r=lt(e.value," ",!0).map(Je);if(r.length>2)throw`excess arguments <!tag ${e.value}> at line ${e.line}`;if(r.some(i=>!i))throw`empty argument <!tag ${e.value}> at line ${e.line}`;if(r.length===1){if(r[0][0]==="@")throw`alias is present but path is not <!tag ${e.value}> at line ${e.line}`;t.alias="@"+r[0].split("\\").pop().split("/").pop(),t.path=r[0]}else{if(r[0][0]!=="@")throw`missing alias identifier "@" <!tag ${e.value}> at line ${e.line}`;t.alias=r[0],t.path=r[1]}return t}function ic(e){if(lt(e," ",!0).length>1)throw`excess parameters <!import ${e}>`;return Je(e)}function ac(e){let t=lt(e," ",!0);if(t.length>2)throw`excess parameters <!renderer ${e}>`;if(t.length==2&&t[1]!=="html")throw`unknown second parameter <!renderer ${e}>`;return Je(e)}function sn(e){try{Function("var "+e)}catch(t){return!1}return!0}function cc(e){let t=lt(e," ",!0);if(t.length<3)throw`not enough parameters <!import ${e}>`;if(t.length===3){if(t[1].toLowerCase()!=="from")throw`wrong parameters <!import ${e}>`;if(t[0].startsWith("{")&&t[0].endsWith("}")){let i=t[0].substring(1,t[0].length-1);if(!i.length)throw`wrong parameters <!import ${e}>`;if(!i.split(",").map(p=>p.trim()).every(sn))throw`invalid variable name <!import ${e}>`;return{type:"object",import:t[0],path:Je(t[2])}}else{if(!sn(t[0]))throw`invalid variable name <!import ${e}>`;return{type:"var",import:t[0],path:Je(t[2])}}}else{try{var r=ct(e,{pairs:["{}"]})}catch(i){throw`invalid variable name <!import ${e}>`}if(r.length>2)throw`wrong parameters <!import ${e}>`;if(r.length===1){if(r[0].nodeType==="bracket")throw`wrong parameters <!import ${e}>`;if(t[0]==="*"&&t[1].toLowerCase()==="as"&&t[3].toLowerCase()==="from"&&t.length===5){if(!sn(t[2]))throw`invalid variable name <!import ${e}>`;return{type:"*",import:t[2],path:Je(t[4])}}else throw`wrong parameters <!import ${e}>`}else{let i=lt(r[1].content," ",!0);if(i.length!==2||i[0].toLowerCase()!=="from")throw`wrong parameters <!import ${e}>`;if(!r[0].innerContent.trim().length)throw`wrong parameters <!import ${e}>`;let c=r[0].innerContent.split(",").map(p=>p.trim());if(!c.every(sn))throw`invalid variable name <!import ${e}>`;return{type:"object",import:"{"+c.join(",")+"}",path:Je(i[1])}}}}async function Es(e){let t=await sc(e);return t.tag&&(t.tag=t.tag.map(oc)),t.css&&(t.css=t.css.map(ic)),t.import&&(t.import=t.import.map(cc)),t.renderer&&(t.renderer=t.renderer.map(ac)),t}function lc(e){return["Update_Tag","enterProps","updateProps"].forEach(t=>{Array.isArray(e[t])&&(e[t].length?e[t]=ds(...e[t]):delete e[t])}),e}function Hn(e){e.forEach((t,r)=>{e[r]=lc(t),t.children&&Hn(t.children)})}var Ct=class{constructor({stiffness:t=300,damping:r=70,mass:i=10,delta:c=.01,target:p,current:f,callback:S,done:_}={}){this.stiffness=t,this.damping=r,this.delta=c,this.mass=i,this.callback=S,this.done=_,this.target=p||0,this.current=f||0,this.running=!1,this.velocity=0,this.acceleration=0,this.step()}set(t,r=!1){this.target=t,r?this.current=t:this.running||this.step()}stop(){cancelAnimationFrame(this.rafId),this.done&&this.done(this.current)}start(){this.step()}step(){if(this.isAtTarget())this.current=this.target,this.running=!1,this.done&&this.done(this.current);else{let t=this.lastFrameTime?Math.min(Math.max((Date.now()-this.lastFrameTime)/1e3,.008333333333333333),.03333333333333333):.016666666666666666;this.running=!0,this.advance(t),this.lastFrameTime=Date.now(),this.rafId=requestAnimationFrame(()=>this.step())}this.callback&&this.callback(this.current)}advance(t){let r=-this.stiffness*(this.current-this.target),i=-this.damping*this.velocity;this.acceleration=(r+i)/this.mass,this.velocity+=this.acceleration*t,this.current+=this.velocity*t}isAtTarget(){return Math.abs(this.target-this.current)<this.delta&&Math.abs(this.velocity)<=this.delta}};var uc=function(e){"use strict";var t=i,r=Object.prototype.hasOwnProperty;function i(){for(var o={},n=0;n<arguments.length;n++){var s=arguments[n];for(var a in s)r.call(s,a)&&(o[a]=s[a])}return o}let c=o=>o;function p(o){function n(s){if(!Array.isArray(s))throw new Error("Transform must be used on an Array. Received "+JSON.stringify(s));let a=(()=>{let[d]=s;return d.Type in o&&typeof o[d.Type]=="function"?o[d.Type]:c})();if(a.length===2)return a(s,n);let[l,...u]=a(s),h=l.params.filter(Boolean).map(d=>n([d,...u]));return t(l,{params:h})}return n}function f(o){let n=s=>{if(s==null)return s;let a=(()=>"*"in o&&typeof o["*"]=="function"?o["*"]:s.Type in o&&typeof o[s.Type]=="function"?o[s.Type]:c)();if(a.length===2)return a(s,n);let l=a(s),u=l.params.map(n);return t(l,{params:u})};return n}var S={map:p,mapNode:f},_=S,x=_.map,P=_.mapNode,R=function(o){let n=s=>{if(s==null)return s;let{params:a}=s,l=(()=>"*"in o&&typeof o["*"]=="function"?o["*"]:s.Type in o&&typeof o[s.Type]=="function"?o[s.Type]:()=>s)();return l.length===2?(l(s,n),s):(l(s),a.forEach(n),s)};return n},k=R,V=function(o,n,s,a,l,u,h,d){if(n===void 0)throw new Error("invariant requires an error message argument");if(!o){var m;if(n===void 0)m=new Error("Minified exception occurred; use the non-minified dev environment for the full error message and additional helpful warnings.");else{var v=[s,a,l,u,h,d],b=0;m=new Error(n.replace(/%s/g,function(){return v[b++]})),m.name="Invariant Violation"}throw m.framesToPop=1,m}},$=V,he=typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function ee(o){return o&&o.__esModule?o.default:o}function te(o,n){return n={exports:{}},o(n,n.exports),n.exports}var W=te(function(o,n){(function(s,a){a(n)})(he,function(s){let a={whitespace:/[ \t]+/,comment:[{match:/\/\/.*?$/},{match:/\/\*[^]*?\*\//,lineBreaks:!0}],number:[{match:/0[xX][0-9a-fA-F]+/},{match:/0[oO][0-9]+/},{match:/0[bB][01]+/},{match:/(?:[0-9]+(?:\.[0-9]+)?e-?[0-9]+)/},{match:/[0-9]+\.[0-9]+|[0-9]+/}],char:[{match:/'(?:\\['\\bfnrtv0]|[^'\\\n])'/,value:We=>We.slice(1,-1)}],string:[{match:/"(?:\\["\\rn]|[^"\\\n])*?"/,value:We=>We.slice(1,-1)},{match:/'(?:\\['\\bfnrtv0]|[^'\\\n])*?'/,value:We=>We.slice(1,-1)},{match:/`(?:\\['\\bfnrtv0]|[^'\\])*?`/,value:We=>We.slice(1,-1)}],identifier:{match:/[A-Za-z_$][A-Za-z0-9_$]*/,keywords:{keyword:["break","if","else","import","as","from","export","return","switch","case","default","const","let","for","continue","do","while","throw","function","global","module","type","lambda"],type:["i32","i64","f32","f64","bool"]}},punctuator:["+","++","-","--",">>",">>>","<<","=","==","+=","-=","=>","<=",">=","!=","%","*","/","^","&","~","|","!","**",":","(",")",".","{","}",",","[","]",";",">","<","?","||","&&","{","}","..."],newline:{match:/(?:\r\n|\r|\n)/,lineBreaks:!0}},l="Program",u="Keyword",h="Export",d="Import",m="Statement",v="IfThenElse",b="Select",g="Else",w="UnaryExpression",N="BinaryExpression",B="TernaryExpression",U="NumberLiteral",z="StringLiteral",Z="CharacterLiteral",K="Punctuator",$e="Identifier",pe="ArraySubscript",O="Constant",D="Type",j="ArrayType",Y="DeclType",q="GenericType",J="UserType",X="FunctionType",ne="Declaration",re="StaticDeclaration",ie="StaticValueList",ge="ImmutableDeclaration",ve="FunctionDeclaration",me="ArrayDeclaration",at="IndirectFunctionCall",St="FunctionCall",qe="Loop",Tt="MemoryAssignment",ae="Assignment",Mr="AssignmentExpression",Fr="Param",$n="Typedef",On="Struct",Ln="UnionType",Nn="ReturnStatement",Pn="Sequence",In="ObjectLiteral",Rn="Pair",Ur="TypeCast",Bn="Break",Mn="Comment",Fn="Sizeof",Un="Spread",Dr="Closure",Dn="Noop",jr="ClosureType",jn="Block",kr="ObjectField",zr="FunctionIndex",Gr="FunctionIdentifier",Yr="FunctionPointer",qr="FunctionArguments",Wr="FunctionResult",Vr="FunctionLocals",Jr="NativeMethod",kn="Unreachable",Hr="Access",Qr="i32",Kr="f32",Xr="i64",Zr="f64",es="Memory",ts="Table",ns="bool";s.Program=l,s.Keyword=u,s.Export=h,s.Import=d,s.Statement=m,s.IfThenElse=v,s.Select=b,s.Else=g,s.UnaryExpression=w,s.BinaryExpression=N,s.TernaryExpression=B,s.NumberLiteral=U,s.StringLiteral=z,s.CharacterLiteral=Z,s.Punctuator=K,s.Identifier=$e,s.ArraySubscript=pe,s.Constant=O,s.Type=D,s.ArrayType=j,s.DeclType=Y,s.GenericType=q,s.UserType=J,s.FunctionType=X,s.Declaration=ne,s.StaticDeclaration=re,s.StaticValueList=ie,s.ImmutableDeclaration=ge,s.FunctionDeclaration=ve,s.ArrayDeclaration=me,s.IndirectFunctionCall=at,s.FunctionCall=St,s.Loop=qe,s.MemoryAssignment=Tt,s.Assignment=ae,s.AssignmentExpression=Mr,s.Param=Fr,s.Typedef=$n,s.Struct=On,s.UnionType=Ln,s.ReturnStatement=Nn,s.Sequence=Pn,s.ObjectLiteral=In,s.Pair=Rn,s.TypeCast=Ur,s.Break=Bn,s.Comment=Mn,s.Sizeof=Fn,s.Spread=Un,s.Closure=Dr,s.Noop=Dn,s.ClosureType=jr,s.Block=jn,s.ObjectField=kr,s.FunctionIndex=zr,s.FunctionIdentifier=Gr,s.FunctionPointer=Yr,s.FunctionArguments=qr,s.FunctionResult=Wr,s.FunctionLocals=Vr,s.NativeMethod=Jr,s.Unreachable=kn,s.Access=Hr,s.i32=Qr,s.f32=Kr,s.i64=Xr,s.f64=Zr,s.Memory=es,s.Table=ts,s.bool=ns,s.builtinTypes={i32:Qr,f32:Kr,i64:Xr,f64:Zr,Memory:es,Table:ts,bool:ns},s.statements={Program:l,Export:h,Import:d,IfThenElse:v,Else:g,Declaration:ne,ImmutableDeclaration:ge,FunctionDeclaration:ve,ArrayDeclaration:me,Loop:qe,MemoryAssignment:Tt,Assignment:ae,Typedef:$n,Struct:On,UnionType:Ln,ReturnStatement:Nn,Sequence:Pn,ObjectLiteral:In,Pair:Rn,Break:Bn,Comment:Mn,Sizeof:Fn,Spread:Un,Noop:Dn,Block:jn,Unreachable:kn},s.default={Program:l,Keyword:u,Export:h,Import:d,Statement:m,IfThenElse:v,Select:b,Else:g,UnaryExpression:w,BinaryExpression:N,TernaryExpression:B,NumberLiteral:U,StringLiteral:z,CharacterLiteral:Z,Punctuator:K,Identifier:$e,ArraySubscript:pe,Constant:O,Type:D,ArrayType:j,DeclType:Y,GenericType:q,UserType:J,FunctionType:X,Declaration:ne,ImmutableDeclaration:ge,FunctionDeclaration:ve,ArrayDeclaration:me,StaticDeclaration:re,StaticValueList:ie,IndirectFunctionCall:at,FunctionCall:St,Loop:qe,MemoryAssignment:Tt,Assignment:ae,AssignmentExpression:Mr,Param:Fr,Typedef:$n,Struct:On,UnionType:Ln,ReturnStatement:Nn,Sequence:Pn,ObjectLiteral:In,Pair:Rn,TypeCast:Ur,Break:Bn,Comment:Mn,Sizeof:Fn,Spread:Un,Closure:Dr,Access:Hr,Noop:Dn,ClosureType:jr,Block:jn,ObjectField:kr,FunctionIndex:zr,FunctionIdentifier:Gr,FunctionPointer:Yr,FunctionArguments:qr,FunctionResult:Wr,FunctionLocals:Vr,NativeMethod:Jr,Unreachable:kn},s.tokens=a,Object.defineProperty(s,"__esModule",{value:!0})})}),y=ee(W),ye=W.tokens,Le=W.semantics,Qe=W.builtinTypes,_e=W.statements,Ne=W.i32,Ke=W.f32,Ue=W.i64,Sc=W.f64,Ms=te(function(o){(function(n,s){o.exports?o.exports=s():n.moo=s()})(he,function(){var n=Object.prototype.hasOwnProperty,s=typeof Object.assign=="function"?Object.assign:function(O,D){if(O==null)throw new TypeError("Target cannot be null or undefined");O=Object(O);for(var j=1;j<arguments.length;j++){var Y=arguments[j];if(Y!=null)for(var q in Y)n.call(Y,q)&&(O[q]=Y[q])}return O},a=typeof new RegExp().sticky=="boolean";function l(O){return O&&O.constructor===RegExp}function u(O){return O&&typeof O=="object"&&O.constructor!==RegExp&&!Array.isArray(O)}function h(O){return O.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}function d(O){var D=new RegExp("|"+O);return D.exec("").length-1}function m(O){return"("+O+")"}function v(O){var D=O.map(function(j){return"(?:"+j+")"}).join("|");return"(?:"+D+")"}function b(O){if(typeof O=="string")return"(?:"+h(O)+")";if(l(O)){if(O.ignoreCase)throw new Error("RegExp /i flag not allowed");if(O.global)throw new Error("RegExp /g flag is implied");if(O.sticky)throw new Error("RegExp /y flag is implied");if(O.multiline)throw new Error("RegExp /m flag is implied");return O.source}else throw new Error("not a pattern: "+O)}function g(O){for(var D=Object.getOwnPropertyNames(O),j=[],Y=0;Y<D.length;Y++){var q=D[Y],J=O[q],X=Array.isArray(J)?J:[J],ne=[];X.forEach(function(re){u(re)?(ne.length&&j.push(N(q,ne)),j.push(N(q,re)),ne=[]):ne.push(re)}),ne.length&&j.push(N(q,ne))}return j}function w(O){for(var D=[],j=0;j<O.length;j++){var Y=O[j];if(!Y.name)throw new Error("Rule has no name: "+JSON.stringify(Y));D.push(N(Y.name,Y))}return D}function N(O,D){(typeof D!="object"||Array.isArray(D)||l(D))&&(D={match:D});var j=s({tokenType:O,lineBreaks:!!D.error,pop:!1,next:null,push:null,error:!1,value:null,getType:null},D),Y=j.match;return j.match=Array.isArray(Y)?Y:Y?[Y]:[],j.match.sort(function(q,J){return l(q)&&l(J)?0:l(J)?-1:l(q)?1:J.length-q.length}),j.keywords&&(j.getType=Z(j.keywords)),j}function B(O,D){O=Array.isArray(O)?w(O):g(O);for(var j=null,Y=[],q=[],J=0;J<O.length;J++){var X=O[J];if(X.error){if(j)throw new Error("Multiple error rules not allowed: (for token '"+X.tokenType+"')");j=X}if(X.match.length!==0){Y.push(X);var ne=v(X.match.map(b)),re=new RegExp(ne);if(re.test(""))throw new Error("RegExp matches empty string: "+re);var ie=d(ne);if(ie>0)throw new Error("RegExp has capture groups: "+re+`
Use (?: \u2026 ) instead`);if(!D&&(X.pop||X.push||X.next))throw new Error("State-switching options are not allowed in stateless lexers (for token '"+X.tokenType+"')");if(!X.lineBreaks&&re.test(`
`))throw new Error("Rule should declare lineBreaks: "+re);q.push(m(ne))}}var ge=a?"":"|(?:)",ve=a?"ym":"gm",me=new RegExp(v(q)+ge,ve);return{regexp:me,groups:Y,error:j}}function U(O){var D=B(O);return new K({start:D},"start")}function z(O,D){var j=Object.getOwnPropertyNames(O);D||(D=j[0]);for(var Y=Object.create(null),q=0;q<j.length;q++){var J=j[q];Y[J]=B(O[J],!0)}for(var q=0;q<j.length;q++)for(var X=Y[j[q]].groups,ne=0;ne<X.length;ne++){var re=X[ne],ie=re&&(re.push||re.next);if(ie&&!Y[ie])throw new Error("Missing state '"+ie+"' (in token '"+re.tokenType+"' of state '"+j[q]+"')");if(re&&re.pop&&+re.pop!=1)throw new Error("pop must be 1 (in token '"+re.tokenType+"' of state '"+j[q]+"')")}return new K(Y,D)}function Z(O){for(var D=Object.create(null),j=Object.create(null),Y=Object.getOwnPropertyNames(O),q=0;q<Y.length;q++){var J=Y[q],X=O[J],ne=Array.isArray(X)?X:[X];ne.forEach(function(me){if((j[me.length]=j[me.length]||[]).push(me),typeof me!="string")throw new Error("keyword must be string (in keyword '"+J+"')");D[me]=J})}function re(me){return JSON.stringify(me)}var ie="";ie+=`(function(value) {
`,ie+=`switch (value.length) {
`;for(var ge in j){var ve=j[ge];ie+="case "+ge+`:
`,ie+=`switch (value) {
`,ve.forEach(function(me){var at=D[me];ie+="case "+re(me)+": return "+re(at)+`
`}),ie+=`}
`}return ie+=`}
`,ie+="})",(0,eval)(ie)}var K=function(O,D){this.startState=D,this.states=O,this.buffer="",this.stack=[],this.reset()};K.prototype.reset=function(O,D){return this.buffer=O||"",this.index=0,this.line=D?D.line:1,this.col=D?D.col:1,this.setState(D?D.state:this.startState),this},K.prototype.save=function(){return{line:this.line,col:this.col,state:this.state}},K.prototype.setState=function(O){if(!(!O||this.state===O)){this.state=O;var D=this.states[O];this.groups=D.groups,this.error=D.error||{lineBreaks:!0,shouldThrow:!0},this.re=D.regexp}},K.prototype.popState=function(){this.setState(this.stack.pop())},K.prototype.pushState=function(O){this.stack.push(this.state),this.setState(O)},K.prototype._eat=a?function(O){return O.exec(this.buffer)}:function(O){var D=O.exec(this.buffer);return D[0].length===0?null:D},K.prototype._getGroup=function(O){if(O===null)return-1;for(var D=this.groups.length,j=0;j<D;j++)if(O[j+1]!==void 0)return j;throw new Error("oops")};function $e(){return this.value}if(K.prototype.next=function(){var O=this.re,D=this.buffer,j=O.lastIndex=this.index;if(j!==D.length){var Y=this._eat(O),q=this._getGroup(Y),J,X;q===-1?(J=this.error,X=D.slice(j)):(X=Y[0],J=this.groups[q]);var ne=0;if(J.lineBreaks){var re=/\n/g,ie=1;if(X===`
`)ne=1;else for(;re.exec(X);)ne++,ie=re.lastIndex}var ge={type:J.getType&&J.getType(X)||J.tokenType,value:J.value?J.value(X):X,text:X,toString:$e,offset:j,lineBreaks:ne,line:this.line,col:this.col},ve=X.length;if(this.index+=ve,this.line+=ne,ne!==0?this.col=ve-ie+1:this.col+=ve,J.shouldThrow)throw new Error(this.formatError(ge,"invalid syntax"));return J.pop?this.popState():J.push?this.pushState(J.push):J.next&&this.setState(J.next),ge}},typeof Symbol<"u"&&Symbol.iterator){var pe=function(O){this.lexer=O};pe.prototype.next=function(){var O=this.lexer.next();return{value:O,done:!O}},pe.prototype[Symbol.iterator]=function(){return this},K.prototype[Symbol.iterator]=function(){return new pe(this)}}return K.prototype.formatError=function(O,D){var j=O.value,Y=O.offset,q=O.lineBreaks?j.indexOf(`
`):j.length,J=Math.max(0,Y-O.col+1),X=this.buffer.substring(J,Y+q);return D+=" at line "+O.line+" col "+O.col+`:

`,D+="  "+X+`
`,D+="  "+Array(O.col).join(" ")+"^",D},K.prototype.clone=function(){return new K(this.states,this.state)},K.prototype.has=function(O){for(var D in this.states)for(var j=this.states[D].groups,Y=0;Y<j.length;Y++){var q=j[Y];if(q.tokenType===O||q.keywords&&n.call(q.keywords,O))return!0}return!1},{compile:U,states:z,error:Object.freeze({error:!0})}})}),ir=Array.prototype.slice,Fs=function(o){return ir.call(o)},Us=function(o){return ir.call(o,1)},ln=function(o,n,s){var a=s-n.length;switch(a){case 0:return function(){return we(o,Ae(n,arguments),s)};case 1:return function(l){return we(o,Ae(n,arguments),s)};case 2:return function(l,u){return we(o,Ae(n,arguments),s)};case 3:return function(l,u,h){return we(o,Ae(n,arguments),s)};case 4:return function(l,u,h,d){return we(o,Ae(n,arguments),s)};case 5:return function(l,u,h,d,m){return we(o,Ae(n,arguments),s)};case 6:return function(l,u,h,d,m,v){return we(o,Ae(n,arguments),s)};case 7:return function(l,u,h,d,m,v,b){return we(o,Ae(n,arguments),s)};case 8:return function(l,u,h,d,m,v,b,g){return we(o,Ae(n,arguments),s)};case 9:return function(l,u,h,d,m,v,b,g,w){return we(o,Ae(n,arguments),s)};case 10:return function(l,u,h,d,m,v,b,g,w,N){return we(o,Ae(n,arguments),s)};default:return Ds(o,n,a)}},Ae=function(o,n){return o.concat(Fs(n))},Ds=function(o,n,s){var a=js(s),l="false||function("+a+"){ return processInvocation(fn, concatArgs(args, arguments)); }";return(0,eval)(l)},js=function(o){for(var n=[],s=0;s<o;s+=1)n.push("a"+s.toString());return n.join(",")},ks=function(o,n){return o.length>n?o.slice(0,n):o},we=function(o,n,s){return n=ks(n,s),n.length===s?o.apply(null,n):ln(o,n,s)},De=function(o){return ln(o,[],o.length)};De.to=De(function(o,n){return ln(n,[],o)}),De.adaptTo=De(function(o,n){return De.to(o,function(s){var a=Us(arguments).concat(s);return n.apply(this,a)})}),De.adapt=function(o){return De.adaptTo(o.length,o)};var Lt=De;function M(o){return o[0]}function zs(){let o=this.lexer,n=this.Syntax,{extendNode:s,drop:a,nth:l,nuller:u,nonEmpty:h,add:d,flatten:m,compose:v}=this.helpers,{node:b,binary:g,constant:w,identifier:N,statement:B,unary:U,ternary:z,subscript:Z,access:K,fun:$e,declaration:pe,call:O,struct:D,result:j,string:Y,char:q,typedef:J,voidFun:X,type:ne,arrayType:re,assignment:ie,forLoop:ge,whileLoop:ve,typeGeneric:me,spread:at,builtinDecl:St,assignmentExpr:qe,addressOf:Tt}=this.nodes(o);return{Lexer:o,ParserRules:[{name:"_$ebnf$1",symbols:[]},{name:"_$ebnf$1",symbols:["_$ebnf$1","wschar"],postprocess:function(ae){return ae[0].concat([ae[1]])}},{name:"_",symbols:["_$ebnf$1"],postprocess:function(ae){return null}},{name:"__$ebnf$1",symbols:["wschar"]},{name:"__$ebnf$1",symbols:["__$ebnf$1","wschar"],postprocess:function(ae){return ae[0].concat([ae[1]])}},{name:"__",symbols:["__$ebnf$1"],postprocess:function(ae){return null}},{name:"wschar",symbols:[/[ \t\n\v\f]/],postprocess:M},{name:"Struct",symbols:["TYPE","__","Identifier","_","EQUALS","_","Union","SEPARATOR"],postprocess:D},{name:"Struct",symbols:["TYPE","__","Identifier","_","EQUALS","_","NativeType","SEPARATOR"],postprocess:D},{name:"Union",symbols:["StructDefinition"],postprocess:M},{name:"Union",symbols:["StructDefinition","_","OR","_","Union"],postprocess:b(n.UnionType)},{name:"StructDefinition",symbols:["ArrayType"],postprocess:M},{name:"StructDefinition",symbols:["Identifier"],postprocess:M},{name:"StructDefinition",symbols:["LCB","_","StructBody","_","RCB"],postprocess:v(b(n.ObjectLiteral),m)},{name:"StructBody",symbols:["StructNameAndType"],postprocess:M},{name:"StructBody",symbols:["StructNameAndType","_","COMMA","_","StructBody"],postprocess:m},{name:"StructNameAndType",symbols:["Identifier","_","COLON","_","Type"],postprocess:b(n.Pair)},{name:"StructNameAndType",symbols:["AddressOf","_","COLON","_","Type"],postprocess:b(n.Pair)},{name:"AddressOf",symbols:["AND","Identifier"],postprocess:Tt},{name:"TypeDef",symbols:["TYPE","__","Identifier","_","EQUALS","_","TypeDefinition","_","FATARROW","_","Type","_","SEPARATOR"],postprocess:v(J)},{name:"TypeDefinition",symbols:["LB","_","TypeList","_","RB"],postprocess:m},{name:"TypeDefinition",symbols:["LB","_","RB"],postprocess:m},{name:"TypeList",symbols:["Type"],postprocess:M},{name:"TypeList",symbols:["Type","_","COMMA","_","TypeList"],postprocess:m},{name:"_Type",symbols:["NativeType"],postprocess:M},{name:"_Type",symbols:["GenericType"],postprocess:M},{name:"_Type",symbols:["Identifier"],postprocess:M},{name:"ArrayType",symbols:["_Type","_","LSB","_","RSB"],postprocess:re},{name:"Type",symbols:["_Type"],postprocess:M},{name:"Type",symbols:["ArrayType"],postprocess:M},{name:"GenericType",symbols:["Identifier","LT","_","StaticObjectLiteral","_","GT"],postprocess:me},{name:"StaticObjectLiteral",symbols:["LCB","_","RCB"],postprocess:v(b(n.ObjectLiteral))},{name:"StaticObjectLiteral",symbols:["LCB","_","StaticPropertyList","_","RCB"],postprocess:v(b(n.ObjectLiteral),m)},{name:"StaticPropertyValue",symbols:["Number"],postprocess:M},{name:"StaticPropertyValue",symbols:["Boolean"],postprocess:M},{name:"StaticPropertyValue",symbols:["StringLiteral"],postprocess:M},{name:"StaticProperty",symbols:["Identifier","_","COLON","_","StaticPropertyValue"],postprocess:b(n.Pair)},{name:"StaticPropertyList",symbols:["StaticProperty"],postprocess:M},{name:"StaticPropertyList",symbols:["StaticProperty","_","COMMA","_","StaticPropertyList"],postprocess:m},{name:"ObjectLiteral",symbols:["LCB","_","RCB"],postprocess:b(n.ObjectLiteral)},{name:"ObjectLiteral",symbols:["LCB","_","PropertyList","_","RCB"],postprocess:v(b(n.ObjectLiteral),m)},{name:"PropertyList",symbols:["Property"],postprocess:M},{name:"PropertyList",symbols:["Property","_","COMMA","_","PropertyList"],postprocess:m},{name:"Property",symbols:["Identifier","_","COLON","_","Ternary"],postprocess:b(n.Pair)},{name:"Property",symbols:["SPREAD","Identifier"],postprocess:at},{name:"Property",symbols:["Identifier"],postprocess:M},{name:"Import",symbols:["IMPORT","_","ImportDefinition","__","FROM","__","StringLiteral","_","SEPARATOR"],postprocess:b(n.Import)},{name:"ImportDefinition",symbols:["LCB","_","ImportAndTypeList","_","RCB"],postprocess:v(b(n.ObjectLiteral),m)},{name:"ImportAndTypeList",symbols:["ImportName"],postprocess:M},{name:"ImportAndTypeList",symbols:["ImportAndType"],postprocess:M},{name:"ImportAndTypeList",symbols:["ImportName","_","COMMA","_","ImportAndTypeList"],postprocess:m},{name:"ImportAndTypeList",symbols:["ImportAndType","_","COMMA","_","ImportAndTypeList"],postprocess:m},{name:"ImportAndType",symbols:["ImportName","_","COLON","_","Type"],postprocess:b(n.Pair)},{name:"ImportAndType",symbols:["ImportName","_","AS","_","Identifier"],postprocess:b(n.BinaryExpression,{value:"as"})},{name:"ImportAndType",symbols:["ImportAndType","_","AS","_","Identifier"],postprocess:b(n.BinaryExpression,{value:"as"})},{name:"ImportName",symbols:["Identifier"],postprocess:M},{name:"If",symbols:["IF","_","LB","_","Expression","_","RB","_","BranchBody"],postprocess:b(n.IfThenElse)},{name:"If",symbols:["IF","_","LB","_","Expression","_","RB","_","BranchBody","_","Else"],postprocess:b(n.IfThenElse)},{name:"Else",symbols:["ELSE","_","BranchBody"],postprocess:b(n.Else)},{name:"BranchBody",symbols:["Statement"],postprocess:M},{name:"BranchBody",symbols:["Block"],postprocess:M},{name:"For",symbols:["FOR","_","LB","_","ForArg","_","SEPARATOR","_","Expression","_","SEPARATOR","_","ForArg","_","RB","_","BranchBody"],postprocess:ge},{name:"ForArg",symbols:["_Assignment"],postprocess:M},{name:"ForArg",symbols:["Ternary"],postprocess:M},{name:"While",symbols:["WHILE","_","LB","_","Expression","_","RB","_","BranchBody"],postprocess:ve},{name:"Break",symbols:["BREAK","_","SEPARATOR"],postprocess:b(n.Break)},{name:"Program",symbols:["_"],postprocess:v(b("Program",{value:"ROOT_NODE"}),m)},{name:"Program",symbols:["_","SourceElementList","_"],postprocess:v(b("Program",{value:"ROOT_NODE"}),m)},{name:"SourceElementList",symbols:["SourceElement"],postprocess:m},{name:"SourceElementList",symbols:["SourceElement","_","SourceElementList"],postprocess:v(a,m,m)},{name:"SourceElement",symbols:["Function"],postprocess:M},{name:"SourceElement",symbols:["GlobalDeclaration"],postprocess:M},{name:"SourceElement",symbols:["GlobalImmutableDeclaration"],postprocess:M},{name:"SourceElement",symbols:["StaticDeclaration"],postprocess:M},{name:"SourceElement",symbols:["Struct"],postprocess:M},{name:"SourceElement",symbols:["TypeDef"],postprocess:M},{name:"SourceElement",symbols:["Export"],postprocess:M},{name:"SourceElement",symbols:["Import"],postprocess:M},{name:"Statement",symbols:["ExpressionStatement"],postprocess:M},{name:"Statement",symbols:["Declaration"],postprocess:M},{name:"Statement",symbols:["ImmutableDeclaration"],postprocess:M},{name:"Statement",symbols:["Assignment"],postprocess:M},{name:"Statement",symbols:["If"],postprocess:M},{name:"Statement",symbols:["For"],postprocess:M},{name:"Statement",symbols:["While"],postprocess:M},{name:"Statement",symbols:["Break"],postprocess:M},{name:"Statement",symbols:["Unreachable"],postprocess:M},{name:"Statement",symbols:["ReturnStatement"],postprocess:M},{name:"Block",symbols:["LCB","_","RCB"],postprocess:b(n.Block)},{name:"Block",symbols:["LCB","_","StatementList","_","RCB"],postprocess:v(b(n.Block),m)},{name:"StatementList",symbols:["Statement"],postprocess:a},{name:"StatementList",symbols:["Statement","_","StatementList"],postprocess:m},{name:"Function",symbols:["FUNCTION","__","Identifier","_","FunctionParameters","_","Block"],postprocess:X},{name:"Function",symbols:["FUNCTION","__","Identifier","_","FunctionParameters","_","FunctionResult","_","Block"],postprocess:$e},{name:"FunctionParameters",symbols:["LB","_","RB"],postprocess:b(n.FunctionArguments)},{name:"FunctionParameters",symbols:["LB","_","ParameterList","_","RB"],postprocess:v(b(n.FunctionArguments),m,m)},{name:"ParameterList",symbols:["NameAndType"],postprocess:M},{name:"ParameterList",symbols:["NameAndType","_","COMMA","_","ParameterList"],postprocess:m},{name:"NameAndType",symbols:["Identifier","_","COLON","_","DeclType"],postprocess:b(n.Pair)},{name:"DeclType",symbols:["Type"],postprocess:v(s({Type:n.DeclType}),l(0))},{name:"FunctionResult",symbols:["COLON","_","Type"],postprocess:v(j,a)},{name:"GlobalDeclaration",symbols:["LET","_","NameAndType","_","SEPARATOR"],postprocess:pe(n.Declaration)},{name:"GlobalDeclaration",symbols:["LET","_","NameAndType","_","EQUALS","_","Atom","_","SEPARATOR"],postprocess:pe(n.Declaration)},{name:"GlobalImmutableDeclaration",symbols:["CONST","_","Identifier","_","COLON","_","GenericType","_","SEPARATOR"],postprocess:St},{name:"GlobalImmutableDeclaration",symbols:["CONST","_","NameAndType","_","EQUALS","_","ObjectLiteral","_","SEPARATOR"],postprocess:pe(n.ImmutableDeclaration)},{name:"GlobalImmutableDeclaration",symbols:["CONST","_","NameAndType","_","EQUALS","_","Atom","_","SEPARATOR"],postprocess:pe(n.ImmutableDeclaration)},{name:"Declaration",symbols:["LET","_","NameAndType","_","EQUALS","_","Expression","_","SEPARATOR"],postprocess:pe(n.Declaration)},{name:"Declaration",symbols:["LET","_","NameAndType","_","SEPARATOR"],postprocess:pe(n.Declaration)},{name:"ImmutableDeclaration",symbols:["CONST","_","NameAndType","_","EQUALS","_","Expression","_","SEPARATOR"],postprocess:pe(n.ImmutableDeclaration)},{name:"ImmutableDeclaration",symbols:["CONST","_","NameAndType","_","EQUALS","_","ObjectLiteral","_","SEPARATOR"],postprocess:pe(n.ImmutableDeclaration)},{name:"ImmutableDeclaration",symbols:["CONST","_","Identifier","_","COLON","_","GenericType","_","SEPARATOR"],postprocess:St},{name:"StaticNameAndType",symbols:["Identifier","_","COLON","_","ArrayType"],postprocess:b(n.Pair)},{name:"StaticDeclaration",symbols:["CONST","_","StaticNameAndType","_","EQUALS","_","LSB","_","RSB","_","SEPARATOR"],postprocess:pe(n.StaticDeclaration)},{name:"StaticDeclaration",symbols:["CONST","_","StaticNameAndType","_","EQUALS","_","LSB","_","StaticValueList","_","RSB","_","SEPARATOR"],postprocess:v(pe(n.StaticDeclaration),m)},{name:"StaticValueList",symbols:["Atom"],postprocess:M},{name:"StaticValueList",symbols:["Atom","_","COMMA","_","StaticValueList"],postprocess:m},{name:"Unreachable",symbols:["THROW","_","SEPARATOR"],postprocess:b(n.Unreachable)},{name:"Unreachable",symbols:["THROW","_","Expression","_","SEPARATOR"],postprocess:b(n.Unreachable)},{name:"Pair",symbols:["Identifier","_","COLON","_","Identifier"],postprocess:b(n.Pair)},{name:"Export",symbols:["EXPORT","__","ImmutableDeclaration"],postprocess:b(n.Export,{value:"export"})},{name:"Export",symbols:["EXPORT","__","Function"],postprocess:b(n.Export,{value:"export"})},{name:"Export",symbols:["EXPORT","__","TypeDef"],postprocess:b(n.Export,{value:"export"})},{name:"Export",symbols:["EXPORT","__","Struct"],postprocess:b(n.Export,{value:"export"})},{name:"ReturnStatement",symbols:["RETURN","__","Expression","_","SEPARATOR"],postprocess:b(n.ReturnStatement)},{name:"ReturnStatement$subexpression$1",symbols:[{literal:";"}],postprocess:u},{name:"ReturnStatement",symbols:["RETURN","ReturnStatement$subexpression$1"],postprocess:b(n.ReturnStatement)},{name:"Assignment",symbols:["_Assignment","_","SEPARATOR"],postprocess:M},{name:"_Assignment",symbols:["Subscript","_","EQUALS","_","Expression"],postprocess:ae=>ie(ae,"=")},{name:"_Assignment",symbols:["Subscript","_","PLSEQUALS","_","Expression"],postprocess:ae=>ie(ae,"+=")},{name:"_Assignment",symbols:["Subscript","_","MINEQUALS","_","Expression"],postprocess:ae=>ie(ae,"-=")},{name:"_Assignment",symbols:["Subscript","_","EQUALS","_","ObjectLiteral"],postprocess:ae=>ie(ae,"=")},{name:"ExpressionStatement",symbols:["Call","_","SEPARATOR"],postprocess:M},{name:"Expression",symbols:["AssignmentExpression"],postprocess:M},{name:"AssignmentExpression",symbols:["Identifier","_","EQUALS","_","Ternary"],postprocess:ae=>qe(ae,"=")},{name:"AssignmentExpression",symbols:["Identifier","_","PLSEQUALS","_","Ternary"],postprocess:ae=>qe(ae,"+=")},{name:"AssignmentExpression",symbols:["Identifier","_","MINEQUALS","_","Ternary"],postprocess:ae=>qe(ae,"-=")},{name:"AssignmentExpression",symbols:["Ternary"],postprocess:M},{name:"Ternary",symbols:["Ternary","_","QUESTION","_","TernaryPair"],postprocess:z},{name:"Ternary",symbols:["Binary"],postprocess:M},{name:"TernaryPair",symbols:["Expression","_","COLON","_","Expression"],postprocess:b(n.Pair)},{name:"Binary",symbols:["Logical"],postprocess:M},{name:"Logical",symbols:["Logical","_",{literal:"||"},"_","Bitwise"],postprocess:g},{name:"Logical",symbols:["Logical","_",{literal:"&&"},"_","Bitwise"],postprocess:g},{name:"Logical",symbols:["Bitwise"],postprocess:M},{name:"Bitwise",symbols:["Bitwise","_",{literal:"|"},"_","Sum"],postprocess:g},{name:"Bitwise",symbols:["Bitwise","_",{literal:"^"},"_","Sum"],postprocess:g},{name:"Bitwise",symbols:["Bitwise","_",{literal:"&"},"_","Sum"],postprocess:g},{name:"Bitwise",symbols:["Equality"],postprocess:M},{name:"Equality",symbols:["Equality","_",{literal:"=="},"_","Comparison"],postprocess:g},{name:"Equality",symbols:["Equality","_",{literal:"!="},"_","Comparison"],postprocess:g},{name:"Equality",symbols:["Comparison"],postprocess:M},{name:"Comparison",symbols:["Comparison","_",{literal:"<"},"_","Shift"],postprocess:g},{name:"Comparison",symbols:["Comparison","_",{literal:">"},"_","Shift"],postprocess:g},{name:"Comparison",symbols:["Comparison","_",{literal:"<="},"_","Shift"],postprocess:g},{name:"Comparison",symbols:["Comparison","_",{literal:">="},"_","Shift"],postprocess:g},{name:"Comparison",symbols:["Shift"],postprocess:M},{name:"Shift",symbols:["Shift","_",{literal:">>"},"_","Sum"],postprocess:g},{name:"Shift",symbols:["Shift","_",{literal:"<<"},"_","Sum"],postprocess:g},{name:"Shift",symbols:["Shift","_",{literal:">>>"},"_","Sum"],postprocess:g},{name:"Shift",symbols:["Sum"],postprocess:M},{name:"Sum",symbols:["Sum","_",{literal:"+"},"_","Product"],postprocess:g},{name:"Sum",symbols:["Sum","_",{literal:"-"},"_","Product"],postprocess:g},{name:"Sum",symbols:["Product"],postprocess:M},{name:"Product",symbols:["Product","_",{literal:"*"},"_","Typecast"],postprocess:g},{name:"Product",symbols:["Product","_",{literal:"/"},"_","Typecast"],postprocess:g},{name:"Product",symbols:["Product","_",{literal:"%"},"_","Typecast"],postprocess:g},{name:"Product",symbols:["Typecast"],postprocess:M},{name:"Typecast",symbols:["Expression","_","COLON","_","DeclType"],postprocess:b(n.Pair)},{name:"Typecast",symbols:["Expression","_","AS","_","DeclType"],postprocess:b(n.Pair)},{name:"Typecast",symbols:["Unary"],postprocess:M},{name:"Unary",symbols:[{literal:"!"},"Call"],postprocess:U},{name:"Unary",symbols:[{literal:"~"},"Call"],postprocess:U},{name:"Unary",symbols:[{literal:"-"},"Call"],postprocess:U},{name:"Unary",symbols:[{literal:"+"},"Call"],postprocess:U},{name:"Unary",symbols:[{literal:"++"},"Call"],postprocess:U},{name:"Unary",symbols:[{literal:"--"},"Call"],postprocess:U},{name:"Unary",symbols:["Call"],postprocess:M},{name:"Call",symbols:["Subscript","_","LB","_","ArgumentList","_","RB"],postprocess:v(O,m)},{name:"Call",symbols:["Subscript","_","LB","_","RB"],postprocess:O},{name:"Call",symbols:["Subscript"],postprocess:M},{name:"ArgumentList",symbols:["Expression"],postprocess:M},{name:"ArgumentList",symbols:["NativeType"],postprocess:M},{name:"ArgumentList",symbols:["Expression","_","COMMA","_","ArgumentList"],postprocess:m},{name:"Subscript",symbols:["Access","LSB","_","Expression","_","RSB","Subscript"],postprocess:Z},{name:"Subscript",symbols:["Access","LSB","_","Expression","_","RSB"],postprocess:Z},{name:"Subscript",symbols:["Access"],postprocess:M},{name:"Access",symbols:["Access","DOT","Identifier"],postprocess:v(K,a)},{name:"Access",symbols:["NativeType","DOT","Access"],postprocess:v(K,a)},{name:"Access",symbols:["Grouping"],postprocess:M},{name:"Grouping",symbols:["LB","_","Expression","_","RB"],postprocess:l(2)},{name:"Grouping",symbols:["Atom"],postprocess:M},{name:"Atom",symbols:["Identifier"],postprocess:M},{name:"Atom",symbols:["StringLiteral"],postprocess:M},{name:"Atom",symbols:["CharacterLiteral"],postprocess:M},{name:"Atom",symbols:["Number"],postprocess:M},{name:"NativeType",symbols:[o.has("type")?{type:"type"}:ne],postprocess:ne},{name:"Identifier",symbols:[o.has("identifier")?{type:"identifier"}:N],postprocess:N},{name:"Number",symbols:[o.has("number")?{type:"number"}:number],postprocess:w},{name:"StringLiteral",symbols:[o.has("string")?{type:"string"}:Y],postprocess:Y},{name:"CharacterLiteral",symbols:[o.has("char")?{type:"char"}:q],postprocess:q},{name:"word",symbols:[/[a-zA-Z_]/],postprocess:M},{name:"word",symbols:["word",/[a-zA-Z0-9_]/],postprocess:d},{name:"digit",symbols:[/[0-9]/],postprocess:M},{name:"digit",symbols:["digit",/[0-9]/],postprocess:d},{name:"SEPARATOR",symbols:["_",{literal:";"}],postprocess:u},{name:"QUESTION",symbols:[{literal:"?"}],postprocess:u},{name:"COMMA",symbols:[{literal:","}],postprocess:u},{name:"AND",symbols:[{literal:"&"}],postprocess:u},{name:"DOT",symbols:[{literal:"."}],postprocess:u},{name:"LB",symbols:[{literal:"("}],postprocess:u},{name:"RB",symbols:[{literal:")"}],postprocess:u},{name:"LSB",symbols:[{literal:"["}],postprocess:u},{name:"RSB",symbols:[{literal:"]"}],postprocess:u},{name:"LCB",symbols:[{literal:"{"}],postprocess:u},{name:"RCB",symbols:[{literal:"}"}],postprocess:u},{name:"OR",symbols:[{literal:"|"}],postprocess:u},{name:"COLON",symbols:[{literal:":"}],postprocess:u},{name:"EQUALS",symbols:[{literal:"="}],postprocess:u},{name:"PLSEQUALS",symbols:[{literal:"+="}],postprocess:u},{name:"MINEQUALS",symbols:[{literal:"-="}],postprocess:u},{name:"GT",symbols:[{literal:">"}],postprocess:u},{name:"LT",symbols:[{literal:"<"}],postprocess:u},{name:"FATARROW",symbols:[{literal:"=>"}],postprocess:u},{name:"SPREAD",symbols:[{literal:"..."}],postprocess:u},{name:"FUNCTION",symbols:[{literal:"function"}],postprocess:u},{name:"LET",symbols:[{literal:"let"}],postprocess:u},{name:"CONST",symbols:[{literal:"const"}],postprocess:u},{name:"EXPORT",symbols:[{literal:"export"}],postprocess:u},{name:"IMPORT",symbols:[{literal:"import"}],postprocess:u},{name:"AS",symbols:[{literal:"as"}],postprocess:u},{name:"FROM",symbols:[{literal:"from"}],postprocess:u},{name:"RETURN",symbols:[{literal:"return"}],postprocess:u},{name:"TYPE",symbols:[{literal:"type"}],postprocess:u},{name:"IF",symbols:[{literal:"if"}],postprocess:u},{name:"ELSE",symbols:[{literal:"else"}],postprocess:u},{name:"FOR",symbols:[{literal:"for"}],postprocess:u},{name:"WHILE",symbols:[{literal:"while"}],postprocess:u},{name:"SWITCH",symbols:[{literal:"switch"}],postprocess:u},{name:"DO",symbols:[{literal:"do"}],postprocess:u},{name:"THROW",symbols:[{literal:"throw"}],postprocess:u},{name:"BREAK",symbols:[{literal:"break"}],postprocess:u}],ParserStart:"Program"}}function ar(o){return o[0]}function cr(){let o=this.Syntax,{flatten:n}=this.helpers,{node:s}=this.nodes(this.lexer);return{Lexer:void 0,ParserRules:[{name:"TypeList",symbols:["DefaultArgument"],postprocess:ar},{name:"TypeList",symbols:["DefaultArgument","_","COMMA","_","TypeList"],postprocess:n},{name:"DefaultArgument",symbols:["Type","_","EQUALS","_","Atom"],postprocess:s(o.Assignment)},{name:"ParameterList",symbols:["DefaultFunctionArgument"],postprocess:ar},{name:"ParameterList",symbols:["DefaultFunctionArgument","_","COMMA","_","ParameterList"],postprocess:n},{name:"DefaultFunctionArgument",symbols:["NameAndType","_","EQUALS","_","Atom"],postprocess:s(o.Assignment)}],ParserStart:"TypeList"}}var lr=te(function(o){(function(n,s){o.exports?o.exports=s():n.nearley=s()})(he,function(){function n(d,m,v){return this.id=++n.highestId,this.name=d,this.symbols=m,this.postprocess=v,this}n.highestId=0,n.prototype.toString=function(d){function m(b){return b.literal?JSON.stringify(b.literal):b.type?"%"+b.type:b.toString()}var v=typeof d>"u"?this.symbols.map(m).join(" "):this.symbols.slice(0,d).map(m).join(" ")+" \u25CF "+this.symbols.slice(d).map(m).join(" ");return this.name+" \u2192 "+v};function s(d,m,v,b){this.rule=d,this.dot=m,this.reference=v,this.data=[],this.wantedBy=b,this.isComplete=this.dot===d.symbols.length}s.prototype.toString=function(){return"{"+this.rule.toString(this.dot)+"}, from: "+(this.reference||0)},s.prototype.nextState=function(d){var m=new s(this.rule,this.dot+1,this.reference,this.wantedBy);return m.left=this,m.right=d,m.isComplete&&(m.data=m.build()),m},s.prototype.build=function(){var d=[],m=this;do d.push(m.right.data),m=m.left;while(m.left);return d.reverse(),d},s.prototype.finish=function(){this.rule.postprocess&&(this.data=this.rule.postprocess(this.data,this.reference,h.fail))};function a(d,m){this.grammar=d,this.index=m,this.states=[],this.wants={},this.scannable=[],this.completed={}}a.prototype.process=function(d){for(var m=this.states,v=this.wants,b=this.completed,g=0;g<m.length;g++){var w=m[g];if(w.isComplete){if(w.finish(),w.data!==h.fail){for(var N=w.wantedBy,B=N.length;B--;){var U=N[B];this.complete(U,w)}if(w.reference===this.index){var z=w.rule.name;(this.completed[z]=this.completed[z]||[]).push(w)}}}else{var z=w.rule.symbols[w.dot];if(typeof z!="string"){this.scannable.push(w);continue}if(v[z]){if(v[z].push(w),b.hasOwnProperty(z))for(var Z=b[z],B=0;B<Z.length;B++){var K=Z[B];this.complete(w,K)}}else v[z]=[w],this.predict(z)}}},a.prototype.predict=function(d){for(var m=this.grammar.byName[d]||[],v=0;v<m.length;v++){var b=m[v],g=this.wants[d],w=new s(b,0,this.index,g);this.states.push(w)}},a.prototype.complete=function(d,m){var v=d.nextState(m);this.states.push(v)};function l(d,m){this.rules=d,this.start=m||this.rules[0].name;var v=this.byName={};this.rules.forEach(function(b){v.hasOwnProperty(b.name)||(v[b.name]=[]),v[b.name].push(b)})}l.fromCompiled=function(b,m){var v=b.Lexer;b.ParserStart&&(m=b.ParserStart,b=b.ParserRules);var b=b.map(function(w){return new n(w.name,w.symbols,w.postprocess)}),g=new l(b,m);return g.lexer=v,g};function u(){this.reset("")}u.prototype.reset=function(d,m){this.buffer=d,this.index=0,this.line=m?m.line:1,this.lastLineBreak=m?-m.col:0},u.prototype.next=function(){if(this.index<this.buffer.length){var d=this.buffer[this.index++];return d===`
`&&(this.line+=1,this.lastLineBreak=this.index),{value:d}}},u.prototype.save=function(){return{line:this.line,col:this.index-this.lastLineBreak}},u.prototype.formatError=function(d,m){var v=this.buffer;if(typeof v=="string"){var b=v.indexOf(`
`,this.index);b===-1&&(b=v.length);var g=v.substring(this.lastLineBreak,b),w=this.index-this.lastLineBreak;return m+=" at line "+this.line+" col "+w+`:

`,m+="  "+g+`
`,m+="  "+Array(w).join(" ")+"^",m}else return m+" at index "+(this.index-1)};function h(d,m,v){if(d instanceof l)var b=d,v=m;else var b=l.fromCompiled(d,m);this.grammar=b,this.options={keepHistory:!1,lexer:b.lexer||new u};for(var g in v||{})this.options[g]=v[g];this.lexer=this.options.lexer,this.lexerState=void 0;var w=new a(b,0);this.table=[w],w.wants[b.start]=[],w.predict(b.start),w.process(),this.current=0}return h.fail={},h.prototype.feed=function(d){var m=this.lexer;m.reset(d,this.lexerState);for(var v;v=m.next();){var b=this.table[this.current];this.options.keepHistory||delete this.table[this.current-1];var g=this.current+1,w=new a(this.grammar,g);this.table.push(w);for(var N=v.text!==void 0?v.text:v.value,B=m.constructor===u?v.value:v,U=b.scannable,z=U.length;z--;){var Z=U[z],K=Z.rule.symbols[Z.dot];if(K.test?K.test(B):K.type?K.type===v.type:K.literal===N){var $e=Z.nextState({data:B,token:v,isToken:!0,reference:g-1});w.states.push($e)}}if(w.process(),w.states.length===0){var pe=this.lexer.formatError(v,"invalid syntax")+`
`;pe+="Unexpected "+(v.type?v.type+" token: ":""),pe+=JSON.stringify(v.value!==void 0?v.value:v)+`
`;var O=new Error(pe);throw O.offset=this.current,O.token=v,O}this.options.keepHistory&&(b.lexerState=m.save()),this.current++}return b&&(this.lexerState=m.save()),this.results=this.finish(),this},h.prototype.save=function(){var d=this.table[this.current];return d.lexerState=this.lexerState,d},h.prototype.restore=function(d){var m=d.index;this.current=m,this.table[m]=d,this.table.splice(m+1),this.lexerState=d.lexerState,this.results=this.finish()},h.prototype.rewind=function(d){if(!this.options.keepHistory)throw new Error("set option `keepHistory` to enable rewinding");this.restore(this.table[d])},h.prototype.finish=function(){var d=[],m=this.grammar.start,v=this.table[this.table.length-1];return v.states.forEach(function(b){b.rule.name===m&&b.dot===b.rule.symbols.length&&b.reference===0&&b.data!==h.fail&&d.push(b)}),d.map(function(b){return b.data})},{Parser:h,Grammar:l,Rule:n}})}),Gs=lr.Parser,Ys=lr.Grammar,qs=(...o)=>o.reduce((n,s)=>(...a)=>n(s(...a))),I=Object.assign||function(o){for(var n=1;n<arguments.length;n++){var s=arguments[n];for(var a in s)Object.prototype.hasOwnProperty.call(s,a)&&(o[a]=s[a])}return o},Ws=function(o,n){var s={};for(var a in o)n.indexOf(a)>=0||Object.prototype.hasOwnProperty.call(o,a)&&(s[a]=o[a]);return s};let Q=Lt((o,n)=>{let{meta:s}=o,a=Ws(o,["meta"]);return I({},n,{meta:I({},n.meta,s)},a)}),Vs=o=>n=>n[o],Js=()=>null,Xe=o=>Array.isArray(o)?!!o.length:o!=null,Hs=o=>`${o[0]}${o[1]}`,Qs=o=>o.reduce((n,s)=>(Array.isArray(s),n.concat(s)),[]),be=o=>o.filter(Xe);var Ks={nth:Vs,nuller:Js,nonEmpty:Xe,add:Hs,flatten:Qs,compose:qs,drop:be,extendNode:Q};let Xs=o=>{let{col:n,line:s}=o;return o.lines.length?{col:n,line:s,sourceLine:o.lines[o.line-1]}:{col:n,line:s,sourceLine:""}};function Zs(o){let n=(l,u={})=>h=>{let d=h.filter(Xe),{value:m="",meta:v={}}=u,b=Xs(o),g=d[d.length-1]&&d[d.length-1].range?d[d.length-1].range[1]:I({},b,{col:b.col+m.length});return{value:m,type:null,Type:l,toString(){},meta:v,range:[b,g],params:d}},s=l=>{let[u,h,d]=l.filter(Xe),m=y.BinaryExpression;return(h.value==="||"||h.value==="&&")&&(m=y.Select),n(m,{value:h.value})([u,d])},a=l=>{let[u]=be(l);return Q({type:u!=null&&u.value!=="void"?u.value:null},n(y.FunctionResult)(l))};return{node:n,binary:s,constant:l=>{let u=l[0].value;return Q({value:`${u}`,type:u.toString().indexOf(".")!==-1?"f32":"i32"},n(y.Constant)([]))},identifier:l=>n("Identifier",{value:l.join("")})([]),unary:([l,u])=>{let h=[u];return l.value==="-"&&(h=[I({},u,{value:"0",Type:y.Constant,params:[],meta:{}}),u]),Q({value:l.value,params:h},n(y.UnaryExpression)([l,u]))},ternary:l=>Q({value:"?"},n(y.TernaryExpression)(l)),subscript:l=>{let[u,h]=l.filter(Xe);return Q({value:u.value,params:[u,h]},n(y.ArraySubscript)([u,h]))},access(l){return Q({value:l[0].value+"."+l[1].value},n(y.Access)(l))},fun:l=>{let[u,h,d,m]=l.filter(Xe);return I({},u,{Type:y.FunctionDeclaration,meta:[],params:[h,d,m]})},declaration:l=>u=>{let[h,...d]=be(u),[m,v]=h.params;return Q({value:m.value,type:v.value},n(l)(d))},call:l=>{let[u,...h]=be(l);return Q({value:u.value},n(y.FunctionCall)([u,...h]))},struct:l=>{let[u,...h]=be(l);return Q({value:u.value},n(y.Struct)(h))},result:a,string:l=>Q({value:l[0].value,type:"i32"},n(y.StringLiteral)([])),char(l){return Q({value:l[0].value,type:"i32"},n(y.CharacterLiteral)([]))},type(l){return Q({value:l[0].value,type:l[0].value,params:[]},n(y.Type)(l))},arrayType(l){let h=be(l)[0];return Q({value:h.value+"[]",type:h.type+"[]",params:[]},n(y.ArrayType)(l))},typeGeneric(l){let[u,h]=be(l);return Q({value:u.value,type:u.value,params:[h]},n(y.Type)(l))},typedef:l=>{let[u,h,d]=be(l);return Q({value:u.value,params:[n(y.FunctionArguments)(h),Q({type:d.value},n(y.FunctionResult)([d]))],type:d.type},n(y.Typedef)([u,h,a]))},voidFun:l=>{let u=be(l),[h,d,m]=u,v=Q({type:null},n(y.FunctionResult)([]));return Q({value:h.value,params:[d,v,m]},n(y.FunctionDeclaration)(u))},assignment(l,u){if(["-=","+="].includes(u)){let h=u[0],[d,m]=be(l),v=s([d,{value:h},m]);return n(y.Assignment,{value:"="})([d,v])}return n(y.Assignment,{value:u})(l)},assignmentExpr(l,u){if(["-=","+="].includes(u)){let h=u[0],[d,m]=be(l),v=s([d,{value:h},m]);return n(y.AssignmentExpression,{value:"="})([d,v])}return n(y.AssignmentExpression,{value:u})(l)},forLoop(l){let[u,h,d,...m]=be(l);return n(y.Loop)([u,h,...m,d])},whileLoop(l){let u=n(y.Noop)([]);return n(y.Loop)([u,...l])},spread(l){return n(y.Spread)(l)},builtinDecl(l){let[u,h]=be(l);return Q({value:u.value,type:h.value,params:[h]},n(y.ImmutableDeclaration)(l))},addressOf(l){let[u]=be(l);return Q({value:u.value,params:[]},n("AddressOf")(l))}}}function eo(){let o=Ms.compile(ye);return{current:null,lines:[],get line(){return o.line},get col(){return o.col},save(){return o.save()},reset(n,s){return this.lines=n.split(`
`),o.reset(n,s)},next(){let n=o.next();for(;n&&n.type==="comment";)n=o.next();return this.current=n,this.current},formatError(n){return o.formatError(n)},has(n){return o.has(n)}}}var un=Lt(function(o,n){let s=[zs,cr,...o],a={lexer:eo(),nodes:Zs,helpers:Ks,Syntax:y},l=s.slice(1).reduce((h,d)=>{let m=d.call(a);return I({},h,{ParserRules:h.ParserRules.concat(m.ParserRules)})},s[0].call(a)),u=new Gs(Ys.fromCompiled(l));return u.feed(n),$(u.results.length===1,`PANIC - Ambiguous Syntax! Number of productions (${u.results.length})`),u.results[0]});let to=o=>{let n,s=o.reduce((a,l)=>l(u=>a(u,n)),([a])=>a);return(a,l)=>(n=l,s(a,n))},no=o=>{let n=[],s=o.reduce((a,l)=>(Object.entries(l).forEach(([u,h])=>{if(u==="*"){n.push(h);return}a[u]==null&&(a[u]=[...n]),a[u].push(h)}),a),{});return Object.entries(s).reduce((a,[l,u])=>(a[l]=to(u),a),{})},ur=Symbol("scope namespace"),pr=Symbol("signature");function ro(o,n){return[...o,{[ur]:n,[pr]:{result:null,arguments:null}}]}function so(o){return o.slice(0,-1)}function fr(o){return o[o.length-1]}function oo(o,n,s){let a=fr(o);return a&&(a[n]=s),a}function io(o,n){let a=o.length-1;for(a;a>=0;a--){let l=o[a][n];if(l)return l}return null}function ao(o,n){let s=Object.keys(o).indexOf(n);return s>-1?s:Object.keys(o).length}var co={enter:ro,exit:so,add:oo,find:io,current:fr,index:ao,namespace:ur,signature:pr};let{enter:lo,exit:uo,add:po,find:fo,current:mo,namespace:ho,signature:yo,index:_o}=co;var je={enter:lo,exit:uo,add:po,find:fo,current:mo,namespace:ho,index:_o,signature:yo},mr=je.enter,bo=je.exit,Ge=je.current,Ze=je.find,go=je.add,hr=je.index,dr=je.namespace,et=je.signature;let Pe="function/index",Nt="LOCAL_INDEX",Ie="global/index",Pt="type/const",_t="TYPE_INDEX",vo="OBJECT_SIZE",pn="type/cast",fn="AST_METADATA",mn="FUNCTION_METADATA",ke=o=>{switch(o){case"i32":case"bool":return 0;case"i64":return 1;case"f32":return 2;case"f64":return 3;default:return-1}},hn=o=>{let n=o.params.reduce((a,{type:l})=>ke(a)<ke(l)?l:a,o.type),s=o.params.map(a=>a.type!=null&&ke(a.type)!==ke(n)?a.Type===y.Constant?Q({type:n},a):Q({type:n,value:a.value,Type:y.TypeCast,meta:{[pn]:{to:n,from:a.type}},params:[a]},a):a);return I({},o,{params:s,type:n})};function So(){return{semantics(){let o=n=>([s,a])=>{let l=Ge(a.scopes),u=hr(l,s.value);return l[s.value]=Q({params:s.params.map(Q({type:s.type})),meta:I({},s.meta,{[l[dr]]:u,[Pt]:s.Type===y.ImmutableDeclaration}),Type:y.Declaration},s),n([l[s.value],a])};return{[y.Export]:n=>([s,a])=>{let l=n([s,a]),[u]=l.params;return a.exports[u.value]=u,l},[y.Declaration]:o,[y.ImmutableDeclaration]:o,[y.Select]:n=>([s,a],l)=>hn(I({},s,{params:s.params.map(u=>l([u,a]))})),[y.BinaryExpression]:n=>([s,a],l)=>hn(I({},s,{params:s.params.map(u=>l([u,a]))})),[y.Pair]:n=>(s,a)=>{let[l,u]=s,h=l.params.map(g=>a([g,u])),[d,m]=h,{type:v}=d,{value:b}=m;return I({},l,{type:b,value:d.value,Type:y.TypeCast,meta:I({},l.meta,{[pn]:{to:b,from:v}}),params:[d]})},[y.Identifier]:n=>s=>{let[a,l]=s,u=Ze(l.scopes,a.value);return u?I({},a,{meta:I({},a.meta,u.meta),type:u.type}):a.value==="null"?I({},a,{value:"0",type:"i32",Type:y.Constant}):n(s)},[y.TernaryExpression]:n=>([s,a])=>n([hn(I({},s,{params:[...s.params[1].params,s.params[0]]})),a])}}}}function To(){return{semantics(){return{"*":o=>function([n,...s],a){return I({},n,{params:n.params.map(u=>a([u,...s]))})}}}}}function Eo(){return{semantics(){return{[y.Typedef]:o=>([n])=>n,[y.Program]:o=>n=>{let[s,a]=n,{types:l}=a,u=P({[y.Export]:(h,d)=>{let[m]=h.params;return m!=null&&[y.Typedef,y.Struct].includes(m.Type)?d(I({},m,{meta:I({},m.meta,{EXPORTED:!0})})):h},[y.Typedef]:(h,d)=>{let m=0,[v]=h.params,b=[];k({Assignment(w){let N=w.params[1];b.push(N)},Type(){m+=1}})(v);let g=I({},h,{meta:I({},h.meta,{FUNCTION_METADATA:{argumentsCount:m},DEFAULT_ARGUMENTS:b})});return l[h.value]=g,g}})(s);return o([u,a])}}}}}let xo={i64:63,f64:63,i32:31,f32:31},Ao={i64:"0xffffffffffff",f64:"0xffffffffffff",i32:"0xffffff",f32:"0xffffff"};function wo(){return{semantics({stmt:o}){return{[y.UnaryExpression]:n=>(s,a)=>{let[l,u]=s,[h,d]=l.params.map(m=>a([m,u]));switch(l.value){case"!":let m=xo[h.type];return a([o`(((${h} >> ${m}) | ((~${h} + 1) >> ${m})) + 1);`,u]);case"~":let v=Ao[a([h,u]).type];return a([o`(${h} ^ ${v});`,u]);case"-":if(d.Type===y.Constant)return I({},d,{meta:I({},d.meta,{SIGN:-1})});default:return a([I({},l,{type:d.type,params:[I({},h,{type:d.type}),d],Type:y.BinaryExpression}),u])}}}}}}function Co(){return{semantics(){return{[y.FunctionDeclaration]:o=>([n,s],a)=>{s.scopes=mr(s.scopes,Nt);let l=Ge(s.scopes),[u,h,d]=n.params,[m,v]=[u,h].map(g=>a([g,s])),b=I({},n,{type:l[et].result,meta:I({},n.meta,{[Pe]:Object.keys(s.functions).length,[mn]:{argumentsCount:l[et].arguments.length,locals:Ge(s.scopes)}})});return s.functions[n.value]=b,b.params=[m,v,a([d,s])],s.scopes=bo(s.scopes),b},[y.FunctionResult]:o=>([n,s])=>{let a=Ge(s.scopes);return a[et].result=n.type,n},[y.FunctionArguments]:o=>([n,s],a)=>{let l=Ge(s.scopes);return l[et].arguments=[],P({[y.Pair]:(h,d)=>{let[m,v]=h.params,b=a([v,s]);return l[et].arguments.push(h),a([I({},h,{value:m.value,type:b.value,params:[],Type:y.Declaration}),s]),I({},h,{params:[m,b]})}})(I({},n,{params:n.params.filter(Boolean)}))},[y.FunctionCall]:o=>([n,s])=>{let{functions:a}=s,l=Object.keys(a).indexOf(n.value);return o([I({},n,{type:a[n.value]!=null?a[n.value].type:null,meta:{[Pe]:l},params:n.params.slice(1)}),s])},[y.ReturnStatement]:o=>([n,s],a)=>{let l=Ge(s.scopes),[u]=n.params.map(m=>a([m,s])),{result:h}=l[et];if(u!=null&&u.Type===y.Constant&&ke(u.type)!==ke(h))return I({},n,{type:h,params:[I({},u,{type:h})]});let d=u?u.type:null;return I({},n,{params:[u],type:d})}}}}}function $o(){return{semantics:()=>({[y.Import]:o=>n=>{let[s,a]=n;return P({[y.BinaryExpression]:(l,u)=>{let[h,d]=l.params;if(h.Type!==y.Pair)return l;let[m,v]=h.params;return u(I({},h,{params:[I({},d,{meta:I({},m.meta,{AS:m.value})}),v]}))},[y.Pair]:(l,u)=>{let{types:h,functions:d}=a,[m,v]=l.params;if(h[v.value]!=null){let b=Object.keys(d).length,g=Object.keys(h).indexOf(v.value),w=I({},m,{id:m.value,type:h[v.value].type,meta:I({},m.meta,{[Pe]:b,[_t]:g,FUNCTION_METADATA:h[v.value].meta.FUNCTION_METADATA,DEFAULT_ARGUMENTS:h[v.value].meta.DEFAULT_ARGUMENTS})});return d[m.value]=w,I({},l,{params:[w,h[v.value]]})}if(["Table","Memory"].includes(v.value)){let b=v.value==="Memory"?"memories":"tables";a[b].push(m)}else{let b=Ge(a.scopes),g=hr(b,m.value);go(a.scopes,m.value,I({},m,{meta:{[b[dr]]:g,[Pt]:!0},type:v.type}))}return l}})(s)}})}}function Oo(){return{semantics(){let o=n=>([s,a])=>s.type==="bool"?n([I({},s,{type:"i32"}),a]):n([s,a]);return{[y.Identifier]:n=>(s,a)=>{let[l,u]=s;return l.value==="true"||l.value==="false"?a([I({},l,{Type:y.Constant,value:l.value==="true"?"1":"0",type:"i32"}),u]):n(s)},[y.FunctionResult]:n=>([s,a])=>s.type==="bool"?n([I({},s,{type:"i32"}),a]):n([s,a]),[y.Declaration]:o,[y.ImmutableDeclaration]:o}}}}function yr(o,n){let s=[null,n];return function(a){return s[0]=a,o(s)}}function Lo(o,n){let s={},a=0;for(a;a<o.length;a++)s[o[a]]=n[o[a]];return s}let No={i32:2,f32:2,i64:3,f64:3},Po="i32";function Io({stmt:o}){let n=u=>h=>{let[d,m]=h;if(!String(d.type).endsWith("[]"))return u(h);let v=Q({type:Po,meta:{TYPE_ARRAY:d.type.slice(0,-2)}},d);return u([v,m])};function s(u,h){let d=No[u.meta.TYPE_ARRAY]||2;return h.Type!==y.Constant||Number(h.value)?o`(${u} + (${h} << ${d}));`:o`(${u});`}function a(u){return!(u.type==null||u.index==null)}function l([u,h]){let d=u.meta.TYPE_ARRAY,m=s(u,h);return{type:d,index:m,TYPE_ARRAY:u.meta.TYPE_ARRAY}}return{[y.Declaration]:n,[y.ImmutableDeclaration]:n,[y.Identifier]:u=>h=>{let[d,m]=h,v=Ze(m.scopes,d.value);return v&&v.meta.TYPE_ARRAY?u([Q(Lo(["type","meta"],v),d),m]):u(h)},[y.Assignment]:u=>(h,d)=>{let[m,v]=h,[b,g]=m.params;if(b.Type!==y.ArraySubscript)return u(h);let w=yr(d,v),N=l(b.params.map(w)),{type:B,index:U}=N;return $(a(N),`PANIC - Cannot assign to subscript of ${b.value}`),w(o`${B}.store(${U}, ${g});`)},[y.ArraySubscript]:u=>(h,d)=>{let[m,v]=h,b=yr(d,v),g=l(m.params.map(b)),{type:w,index:N,TYPE_ARRAY:B}=g;return a(g)?Q({meta:{TYPE_ARRAY:B}},b(o`${w}.load(${N});`)):u(h)},[y.FunctionResult]:n}}function Ro(){return{semantics:Io}}let Bo=(o,n)=>{let s=o.memories[0];return s&&s.value===n.value};function Mo(){return{semantics({stmt:o}){return{[y.ImmutableDeclaration]:n=>s=>{let[a,l]=s,{scopes:u,memories:h}=l;return!u.length<2&&a.type==="Memory"&&!h.length?(h.push(I({},a,{meta:I({},a.meta,{[Ie]:-1})})),h[0]):n(s)},[y.FunctionCall]:n=>(s,a)=>{let[l,u]=s,[h,...d]=l.params,[m={},v={}]=h.params,g={dataSize:a([o`i32.load(0);`,u]),grow:I({},m,{value:"grow_memory",params:d.map(w=>a([w,u])),Type:y.NativeMethod}),size:I({},m,{value:"current_memory",params:[],Type:y.NativeMethod})}[v.value];return h.Type===y.Access&&Bo(u,m)&&g?g:n(s)}}}}}let _r=o=>{let n=[];for(;;){let s=o&127;o=o>>7;let a=s&64;if(o===0&&!a||o===-1&&a){n.push(s);break}else n.push(s|128)}return n},Fo=o=>{let n=[];for(;;){let s=o&127;if(o=o>>>7,o===0){n.push(s);break}n.push(s|128)}return n};let It=1,Rt=1<<1,Bt=1<<2,Mt=1<<3,Ft=1<<4,Ut=1<<5,br=1<<6,Dt=1<<7,jt=1<<8,kt=1<<9,zt=1<<10,Gt=1<<11,dn=1<<12,Te=4,Uo={[It]:Te,[Rt]:Te*2,[Bt]:Te,[Mt]:Te*2,[Gt]:Te,[zt]:Te>>1,[jt]:Te>>2,[Dt]:Te>>2,[kt]:Te>>1,[Ft]:Te,[Ut]:Te,[br]:Te},se=!0;var Re={i32:It,i64:Rt,f32:Bt,f64:Mt,anyfunc:Ft,func:Ut,block_type:br,i8:Dt,u8:jt,i16:kt,u16:zt,u32:Gt,u64:dn,set:(o,n,s,a)=>{switch(o){case It:return s.setInt32(n,a,se);case Rt:return s.setInt64(n,a,se);case Bt:return s.setFloat32(n,a,se);case Mt:return s.setFloat64(n,a,se);case Ft:return s.setUint32(n,a,se);case Ut:return s.setUint32(n,a,se);case Dt:return s.setInt8(n,a,se);case jt:return s.setUint8(n,a,se);case kt:return s.setInt16(n,a,se);case zt:return s.setUint16(n,a,se);case Gt:return s.setUint32(n,a,se);case dn:return s.setUint64(n,a,se);default:return s.setUint8(n,a,se)}},get:(o,n,s)=>{switch(o){case It:return s.getInt32(n,se);case Rt:return s.getInt64(n,se);case Bt:return s.getFloat32(n,se);case Mt:return s.getFloat64(n,se);case Ft:return s.getUint32(n,se);case Ut:return s.getUint32(n,se);case Dt:return s.getInt8(n,se);case jt:return s.getUint8(n,se);case kt:return s.getInt16(n,se);case zt:return s.getUint16(n,se);case Gt:return s.getUint32(n,se);case dn:return s.getUint64(n,se);default:return s.getUint8(n,se)}},sizeof:Uo},E=Re.i32,L=Re.i64,C=Re.f32,oe=Re.f64,ce=Re.u8,yn=Re.u32,gr=Re.set,_n=Re.sizeof;class le{constructor(){this.data=[],this.size=0}push(n,s,a){let l=0;switch(n){case"varuint7":case"varuint32":case"varint7":case"varint1":{s=Fo(s),l=s.length,$(l,`Cannot write a value of size ${l}`);break}case"varint32":{s=_r(s),l=s.length,$(l,`Cannot write a value of size ${l}`);break}case"varint64":{s=_r(s),l=s.length,$(l,`Cannot write a value of size ${l}`);break}default:l=_n[n],$(l,`Cannot write a value of size ${l}, type ${n}`)}return this.data.push({type:n,value:s,debug:a}),this.size+=l,this}buffer(n=new ArrayBuffer(this.size)){let s=new DataView(n),a=0;return this.data.forEach(({type:l,value:u})=>{Array.isArray(u)?u.forEach(h=>gr(ce,a++,s,h)):(gr(l,a,s,u),a+=_n[l])}),n}write(n){return n&&(this.data=this.data.concat(n.data),this.size+=n.size),this}}function*Do(o,n){let s=0,a=0,l=0,u=n;for(;;){let d=o.getUint8(u,!0);if(s|=(d&127)<<l,u+=1,!(d&128))break;l+=7}let h=0;for(;a<s;){for(h=0,l=0;;){let d=o.getUint8(u,!0);if(h|=(d&127)<<l,u+=1,!(d&128))break;l+=7}a+=1,yield h}}function vr(o){let n=new le,s=new le;s.push("varuint32",o.length,o);let a=0;for(a=0;a<o.length;a++)s.push("varuint32",o.codePointAt(a),o[a]);return n.write(s),n}let jo={["\\0"]:0,["\\a"]:7,["\\b"]:8,["\\t"]:9,["\\n"]:10,["\\v"]:11,["\\f"]:12,["\\r"]:13,["\\'"]:39},ko={i64:8,f64:8,i32:4,f32:4};function zo(o,n){let s=new le,a=Re[n];return o.forEach(l=>{s.push(a,l,String(l))}),s}function Go(){let o=0;return{semantics:({stmt:n})=>({[y.StaticDeclaration]:s=>([a,l],u)=>{let{userTypes:h,statics:d}=l,m=String(a.type).slice(0,-2),v=ko[m],b=a.params.reduce((w,N,B)=>{let U=u([N,l]);return w.OBJECT_SIZE+=v,w.TYPE_OBJECT[B]=B*v,w.OBJECT_KEY_TYPES[B]=m,w.VALUES.push(Number(U.value)),w},{OBJECT_SIZE:0,TYPE_OBJECT:{},OBJECT_KEY_TYPES:{},VALUES:[],STATIC:m}),g=`__auto_gen_${a.value}_${o}`;return o+=1,h[g]=I({},a,{value:g,Type:y.Type,meta:b,params:[]}),d[g]=zo(b.VALUES,m),u([I({},a,{meta:b,type:g,Type:y.ImmutableDeclaration,params:[I({},a.params[0],{value:g,Type:y.StaticValueList})]}),l])},[y.ArraySubscript]:s=>([a,l],u)=>{let[h,d]=a.params.map(v=>u([v,l]));if(!h.meta.STATIC)return s([a,l]);let m={i32:2,f32:2,i64:3,f64:3}[h.meta.STATIC];return u([n`${h.meta.STATIC}.load(${h} + (${d} << ${m}));`,l])},[y.CharacterLiteral]:s=>([a,l],u)=>{let h=jo[a.value]||a.value.codePointAt(0);return u([I({},a,{Type:"Constant",type:"i32",value:String(h)}),l])},[y.StringLiteral]:s=>a=>{let[l,u]=a,{statics:h}=u,{value:d}=l;return d in h||(h[d]=vr(d)),l}})}}function Yo(){return{semantics(){return{[y.ImmutableDeclaration]:o=>function(n){let[s,a]=n;return!a.locals&&s.type==="Table"?I({},s,{meta:I({},s.meta,{[Ie]:-1})}):o(n)},[y.Identifier]:o=>function(n){let[s,a]=n,{functions:l,table:u,scopes:h}=a;return Ze(h,s.value)||!l[s.value]?o(n):(u[s.value]==null&&(u[s.value]=l[s.value]),I({},s,{type:"i32",meta:{[Pe]:l[s.value].meta[Pe]},value:Object.keys(u).indexOf(s.value),Type:y.FunctionPointer}))},[y.FunctionResult]:o=>(n,s)=>{let[a,l]=n,{types:u}=l;return u[a.type]?o([Q({type:"i32",meta:{ALIAS:a.type},params:a.params.map(h=>s([h,l]))},a),l]):o(n)},[y.FunctionCall]:o=>function(n,s){let[a,l]=n,{scopes:u,types:h}=l,d=Ze(u,a.value);if(!d)return o(n);let m=h[d.type],v=Object.keys(h).indexOf(d.type),b=[...a.params.slice(1),I({},d,{Type:y.Identifier})].map(g=>s([g,l]));return I({},a,{meta:I({},a.meta,d.meta,{[_t]:v}),type:m!=null?m.type:a.type,params:b,Type:y.IndirectFunctionCall})}}}}}let Yt="i32",qo={i64:8,f64:8,i32:4,f32:4,["__DIRECT_ADDRESS__"]:4},Wo=o=>{let n={},s={},a=0;return k({[y.Pair]:l=>{let[u]=l.params,h=u.value,d=l.params[1].value;$(n[h]==null,`Duplicate key ${h} not allowed in object type`),s[h]=`${u.Type==="AddressOf"?"&":""}${d}`,n[h]=a,a+=qo[d]||4}})(o),[n,a,s]},Vo=o=>(n,s)=>{let a=o`throw;`,l={load:Q({range:s.range},o`i32.load(${a}, ${a});`),store:U=>Q({range:s.range},o`i32.store(${a}, ${U});`),offset:a,type:"void"};if(n.meta.STRUCT_TYPE==null)return l;let u=n.meta.STRUCT_TYPE,h=u.meta.TYPE_OBJECT,d=u.meta.OBJECT_KEY_TYPES,m=h[s.value];if(m==null)return l;let v=d[s.value],b=v[0]==="&",g=m?o`(${n} + ${m});`:o`(${n});`,w=null,N=null;v!=null&&typeof v=="object"&&(w=v,v=Yt),String(v).endsWith("[]")&&(N=v.slice(0,-2).replace("&",""),v="i32");let B=Q({range:n.range,meta:{STRUCT_TYPE:w,TYPE_ARRAY:N}});return{offset:g,type:v,store:U=>B(o`${v}.store(${g}, ${U});`),load:B(b?g:o`${v}.load(${g});`)}};function Jo(){return{semantics({stmt:o}){let n=Vo(o);function s(l,u){let[h,d]=l,[m,v]=h.params,[b,g]=m.params,w=n(u([b,d]),g);return u([w.store(v),d])}function a(l,u){let[h,d]=l,[m,v]=h.params,b=u([m,d]),g=[];k({[y.Identifier]:(N,B)=>{let U=n(b,N);g.push({field:U,value:N})},[y.Pair]:(N,B)=>{let[U,z]=N.params,Z=n(b,U);g.push({field:Z,value:z})},[y.Spread]:(N,B)=>{let U=u([N.params[0],d]);Object.keys(U.meta.TYPE_OBJECT).forEach(z=>{let Z=n(b,{value:z,type:null,range:U.range}),K=n(U,{value:z,type:null,range:U.range});g.push({field:Z,value:K.load})})}})(v);let w=g.filter(({field:N})=>N!=null).map(N=>u([N.field.store(N.value),d]));return I({},m,{Type:y.Block,params:w})}return{[y.Struct]:l=>([u,h],d)=>{let{userTypes:m,aliases:v}=h,[b]=u.params,g=I({},u,{meta:I({},u.meta,{TYPE_OBJECT:{},OBJECT_SIZE:0,OBJECT_KEY_TYPES:{}})}),w=()=>{v[u.value]=b.value},N=(U,z)=>{let[Z,K,$e]=Wo(U);g.meta.TYPE_OBJECT=I({},g.meta.TYPE_OBJECT,Z),g.meta.OBJECT_SIZE+=K,g.meta.OBJECT_KEY_TYPES=I({},g.meta.OBJECT_KEY_TYPES,$e)};return{[y.Type]:w,[y.Identifier]:w,[y.ObjectLiteral]:()=>{N(u),m[g.value]=g},[y.UnionType]:()=>{k({[y.ObjectLiteral]:N,[y.ArrayType]:U=>{g.meta.TYPE_ARRAY=U.type.slice(0,-2)},[y.Identifier]:U=>{let z=m[d([U,h]).value];g.meta.TYPE_OBJECT=I({},g.meta.TYPE_OBJECT,z.meta.TYPE_OBJECT),g.meta.OBJECT_SIZE=Math.max(g.meta.OBJECT_SIZE,z.meta.OBJECT_SIZE),g.meta.OBJECT_KEY_TYPES=I({},g.meta.OBJECT_KEY_TYPES,z.meta.OBJECT_KEY_TYPES)}})(b),m[g.value]=g}}[b.Type](),g.meta.OBJECT_KEY_TYPES=Object.entries(g.meta.OBJECT_KEY_TYPES).reduce((U,[z,Z])=>(U[z]=m[Z]||Z,U),{}),g},[y.DeclType]:l=>(u,h)=>{let[d,m]=u,{aliases:v}=m;return v[d.value]?h([Q({value:v[d.value],type:v[d.value]},d),m]):l(u)},[y.FunctionResult]:l=>(u,h)=>{let[d,m]=u,{userTypes:v,aliases:b}=m;return b[d.type]?h([Q({type:b[d.type]},d),m]):v[String(d.type)]?l([Q({type:Yt,meta:{STRUCT_TYPE:v[d.type]},params:d.params.map(g=>h([g,m]))},d),m]):l(u)},[y.Identifier]:l=>u=>{let[h,d]=u,{userTypes:m,scopes:v}=d,b=Ze(v,h.value);return b&&m[b.type]?I({},h,{meta:I({},h.meta,b.meta,m[b.type].meta,{STRUCT_TYPE:m[b.type]}),type:Yt}):l(u)},[y.Access]:function(l){return(u,h)=>{let[d,m]=u,[v,b]=d.params,g=n(h([v,m]),b);return h([g.load,m])}},[y.Assignment]:l=>(u,h)=>{let[d]=u,[m,v]=d.params;return m.Type===y.Access?s(u,h):v.Type===y.ObjectLiteral?a(u,h):l(u)},[y.ArraySubscript]:l=>(u,h)=>{let[d,m]=u,v=l(u);if(m.userTypes[v.meta.TYPE_ARRAY]==null)return v;let[b,g]=d.params.map(w=>h([w,m]));return h([Q({type:Yt,meta:{STRUCT_TYPE:m.userTypes[v.meta.TYPE_ARRAY]}},o`(${b} + (${g} * sizeof(${v.meta.TYPE_ARRAY})));`),m])}}}}}function Ho(){return{semantics(){return{[y.FunctionCall]:o=>(n,s)=>{let[a,l]=n,[u,...h]=a.params;if(u.Type===y.Access&&u.params[0]&&u.params[0].Type===y.Type){let[d,m]=u.params;return Q({value:`${d.value}.${m.value}`,type:d.value,params:h.map(v=>s([v,l])),Type:y.NativeMethod},a)}return o(n)},[y.Unreachable]:o=>([n])=>Q({value:"unreachable",params:[],Type:y.NativeMethod},n)}}}}function Qo(){return{grammar:cr,semantics(){return{[y.FunctionDeclaration]:o=>n=>{let[s,a]=n,[l]=s.params,u=[];return k({Assignment:h=>{let[,d]=h.params;u.push(d)}})(l),o([I({},s,{meta:I({},s.meta,{DEFAULT_ARGUMENTS:u})}),a])},[y.FunctionCall]:o=>n=>{let[s,a]=n,{functions:l}=a,[u,...h]=s.params,d=l[u.value];if(!d)return o(n);let m=d.meta.FUNCTION_METADATA.argumentsCount,v=h.length,b=m-v;return b>0?o([I({},s,{params:[...s.params,...d.meta.DEFAULT_ARGUMENTS.slice(b-1)]}),a]):o(n)}}}}}let Ko={i64:8,f64:8,i32:4,f32:4};function Xo(){return{semantics(){return{[y.FunctionCall]:o=>n=>{let[s,a]=n;if(s.value!=="sizeof")return o(n);let{scopes:l,userTypes:u,functions:h}=a,[,d]=s.params,m=Ze(l,d.value),{type:v=""}=m||{},b=u[d.value]||u[v],g=h[d.value];if(b!=null){let N=b.meta[vo];return $(N,"Object size information is missing"),I({},s,{value:N,params:[],type:"i32",Type:y.Constant})}let w=m||g;return I({},s,{value:Ko[String(w?w.type:d.value)],type:"i32",params:[],Type:y.Constant})}}}}}let Zo=()=>[To().semantics,So().semantics,$o().semantics,Eo().semantics,wo().semantics,Co().semantics,Oo().semantics,Ro().semantics,Mo().semantics,Go().semantics,Yo().semantics,Jo().semantics,Ho().semantics,Xo().semantics,Qo().semantics];function bn(o,n,s){let a=[...Zo(),...n],l=no(a.map(B=>B(s))),u={functions:{},types:{},userTypes:{},table:{},hoist:[],statics:{},path:[],scopes:mr([],Ie),memories:[],tables:[],aliases:{},exports:{}},h=x(l)([o,u]),{functions:d,scopes:m,types:v,userTypes:b,statics:g,hoist:w,exports:N}=u;return I({},h,{meta:I({},h.meta,{[fn]:{functions:d,globals:m[0],types:v,userTypes:b,statics:g,exports:N}}),params:[...h.params,...w]})}function Ce(o,n,s,a,l){let u=s.start.line,h=s.start.col,d=s.end.col,m=s.end.sourceLine,v=new Array(d-h+1).join("^").padStart(s.start.col-1," ");return`
`+m+`
`+v+` ${n}
`+o+`
  at ${l} (${a}:${u}:${h})`}let F={},ei=[],gn={},A=null,T=(o,n,s,a,l,u,h)=>{let d={result:o,first:n,second:s,size:a,code:l,name:u,text:h};return F[u]=d,ei[l]=d,gn[h]=d,d};T(A,A,A,0,0,"Unreachable","unreachable"),T(A,A,A,0,1,"Nop","nop"),T(A,A,A,0,2,"Block","block"),T(A,A,A,0,3,"Loop","loop"),T(A,A,A,0,4,"If","if"),T(A,A,A,0,5,"Else","else"),T(A,A,A,0,6,"Try","try"),T(A,A,A,0,7,"Catch","catch"),T(A,A,A,0,8,"Throw","throw"),T(A,A,A,0,9,"Rethrow","rethrow"),T(A,A,A,0,10,"CatchAll","catch_all"),T(A,A,A,0,11,"End","end"),T(A,A,A,0,12,"Br","br"),T(A,A,A,0,13,"BrIf","br_if"),T(A,A,A,0,14,"BrTable","br_table"),T(A,A,A,0,15,"Return","return"),T(A,A,A,0,16,"Call","call"),T(A,A,A,0,17,"CallIndirect","call_indirect"),T(A,A,A,0,26,"Drop","drop"),T(A,A,A,0,27,"Select","select"),T(A,A,A,0,32,"GetLocal","get_local"),T(A,A,A,0,33,"SetLocal","set_local"),T(A,A,A,0,34,"TeeLocal","tee_local"),T(A,A,A,0,35,"GetGlobal","get_global"),T(A,A,A,0,36,"SetGlobal","set_global"),T(E,E,A,4,40,"i32Load","i32.load"),T(L,E,A,8,41,"i64Load","i64.load"),T(C,E,A,4,42,"f32Load","f32.load"),T(oe,E,A,8,43,"f64Load","f64.load"),T(E,E,A,1,44,"i32Load8S","i32.load8_s"),T(E,E,A,1,45,"i32Load8U","i32.load8_u"),T(E,E,A,2,46,"i32Load16S","i32.load16_s"),T(E,E,A,2,47,"i32Load16U","i32.load16_u"),T(L,E,A,1,48,"i64Load8S","i64.load8_s"),T(L,E,A,1,49,"i64Load8U","i64.load8_u"),T(L,E,A,2,50,"i64Load16S","i64.load16_s"),T(L,E,A,2,51,"i64Load16U","i64.load16_u"),T(L,E,A,4,52,"i64Load32S","i64.load32_s"),T(L,E,A,4,53,"i64Load32U","i64.load32_u"),T(A,E,E,4,54,"i32Store","i32.store"),T(A,E,L,8,55,"i64Store","i64.store"),T(A,E,C,4,56,"f32Store","f32.store"),T(A,E,C,8,57,"f64Store","f64.store"),T(A,E,E,1,58,"i32Store8","i32.store8"),T(A,E,E,2,59,"i32Store16","i32.store16"),T(A,E,L,1,60,"i64Store8","i64.store8"),T(A,E,L,2,61,"i64Store16","i64.store16"),T(A,E,L,4,62,"i64Store32","i64.store32"),T(E,A,A,0,63,"CurrentMemory","current_memory"),T(E,E,A,0,64,"GrowMemory","grow_memory"),T(E,A,A,0,65,"i32Const","i32.const"),T(L,A,A,0,66,"i64Const","i64.const"),T(C,A,A,0,67,"f32Const","f32.const"),T(oe,A,A,0,68,"f64Const","f64.const"),T(E,E,A,0,69,"i32Eqz","i32.eqz"),T(E,E,E,0,70,"i32Eq","i32.eq"),T(E,E,E,0,71,"i32Ne","i32.ne"),T(E,E,E,0,72,"i32LtS","i32.lt_s"),T(E,E,E,0,73,"i32LtU","i32.lt_u"),T(E,E,E,0,74,"i32GtS","i32.gt_s"),T(E,E,E,0,75,"i32GtU","i32.gt_u"),T(E,E,E,0,76,"i32LeS","i32.le_s"),T(E,E,E,0,77,"i32LeU","i32.le_u"),T(E,E,E,0,78,"i32GeS","i32.ge_s"),T(E,E,E,0,79,"i32GeU","i32.ge_u"),T(E,L,A,0,80,"i64Eqz","i64.eqz"),T(E,L,L,0,81,"i64Eq","i64.eq"),T(E,L,L,0,82,"i64Ne","i64.ne"),T(E,L,L,0,83,"i64LtS","i64.lt_s"),T(E,L,L,0,84,"i64LtU","i64.lt_u"),T(E,L,L,0,85,"i64GtS","i64.gt_s"),T(E,L,L,0,86,"i64GtU","i64.gt_u"),T(E,L,L,0,87,"i64LeS","i64.le_s"),T(E,L,L,0,88,"i64LeU","i64.le_u"),T(E,L,L,0,89,"i64GeS","i64.ge_s"),T(E,L,L,0,90,"i64GeU","i64.ge_u"),T(E,C,C,0,91,"f32Eq","f32.eq"),T(E,C,C,0,92,"f32Ne","f32.ne"),T(E,C,C,0,93,"f32Lt","f32.lt"),T(E,C,C,0,94,"f32Gt","f32.gt"),T(E,C,C,0,95,"f32Le","f32.le"),T(E,C,C,0,96,"f32Ge","f32.ge"),T(E,C,C,0,97,"f64Eq","f64.eq"),T(E,C,C,0,98,"f64Ne","f64.ne"),T(E,C,C,0,99,"f64Lt","f64.lt"),T(E,C,C,0,100,"f64Gt","f64.gt"),T(E,C,C,0,101,"f64Le","f64.le"),T(E,C,C,0,102,"f64Ge","f64.ge"),T(E,E,A,0,103,"i32Clz","i32.clz"),T(E,E,A,0,104,"i32Ctz","i32.ctz"),T(E,E,A,0,105,"i32Popcnt","i32.popcnt"),T(E,E,E,0,106,"i32Add","i32.add"),T(E,E,E,0,107,"i32Sub","i32.sub"),T(E,E,E,0,108,"i32Mul","i32.mul"),T(E,E,E,0,109,"i32DivS","i32.div_s"),T(E,E,E,0,110,"i32DivU","i32.div_u"),T(E,E,E,0,111,"i32RemS","i32.rem_s"),T(E,E,E,0,112,"i32RemU","i32.rem_u"),T(E,E,E,0,113,"i32And","i32.and"),T(E,E,E,0,114,"i32Or","i32.or"),T(E,E,E,0,115,"i32Xor","i32.xor"),T(E,E,E,0,116,"i32Shl","i32.shl"),T(E,E,E,0,117,"i32ShrS","i32.shr_s"),T(E,E,E,0,118,"i32ShrU","i32.shr_u"),T(E,E,E,0,119,"i32Rotl","i32.rotl"),T(E,E,E,0,120,"i32Rotr","i32.rotr"),T(L,L,A,0,121,"i64Clz","i64.clz"),T(L,L,A,0,122,"i64Ctz","i64.ctz"),T(L,L,A,0,123,"i64Popcnt","i64.popcnt"),T(L,L,L,0,124,"i64Add","i64.add"),T(L,L,L,0,125,"i64Sub","i64.sub"),T(L,L,L,0,126,"i64Mul","i64.mul"),T(L,L,L,0,127,"i64DivS","i64.div_s"),T(L,L,L,0,128,"i64DivU","i64.div_u"),T(L,L,L,0,129,"i64RemS","i64.rem_s"),T(L,L,L,0,130,"i64RemU","i64.rem_u"),T(L,L,L,0,131,"i64And","i64.and"),T(L,L,L,0,132,"i64Or","i64.or"),T(L,L,L,0,133,"i64Xor","i64.xor"),T(L,L,L,0,134,"i64Shl","i64.shl"),T(L,L,L,0,135,"i64ShrS","i64.shr_s"),T(L,L,L,0,136,"i64ShrU","i64.shr_u"),T(L,L,L,0,137,"i64Rotl","i64.rotl"),T(L,L,L,0,138,"i64Rotr","i64.rotr"),T(C,C,C,0,139,"f32Abs","f32.abs"),T(C,C,C,0,140,"f32Neg","f32.neg"),T(C,C,C,0,141,"f32Ceil","f32.ceil"),T(C,C,C,0,142,"f32Floor","f32.floor"),T(C,C,C,0,143,"f32Trunc","f32.trunc"),T(C,C,C,0,144,"f32Nearest","f32.nearest"),T(C,C,C,0,145,"f32Sqrt","f32.sqrt"),T(C,C,C,0,146,"f32Add","f32.add"),T(C,C,C,0,147,"f32Sub","f32.sub"),T(C,C,C,0,148,"f32Mul","f32.mul"),T(C,C,C,0,149,"f32Div","f32.div"),T(C,C,C,0,150,"f32Min","f32.min"),T(C,C,C,0,151,"f32Max","f32.max"),T(C,C,C,0,152,"f32Copysign","f32.copysign"),T(C,C,C,0,153,"f32Abs","f64.abs"),T(C,C,C,0,154,"f32Neg","f64.neg"),T(C,C,C,0,155,"f32Ceil","f64.ceil"),T(C,C,C,0,156,"f32Floor","f64.floor"),T(C,C,C,0,157,"f32Trunc","f64.trunc"),T(C,C,C,0,158,"f32Nearest","f64.nearest"),T(C,C,C,0,159,"f32Sqrt","f64.sqrt"),T(oe,oe,oe,0,160,"f64Add","f64.add"),T(oe,oe,oe,0,161,"f64Sub","f64.sub"),T(oe,oe,oe,0,162,"f64Mul","f64.mul"),T(oe,oe,oe,0,163,"f64Div","f64.div"),T(oe,oe,oe,0,164,"f64Min","f64.min"),T(oe,oe,oe,0,165,"f64Max","f64.max"),T(oe,oe,oe,0,166,"f64Copysign","f64.copysign"),T(E,L,A,0,167,"i32Wrapi64","i32.wrap/i64"),T(E,C,A,0,168,"i32TruncSf32","i32.trunc_s/f32"),T(E,C,A,0,169,"i32TruncUf32","i32.trunc_u/f32"),T(E,C,A,0,170,"i32TruncSf64","i32.trunc_s/f64"),T(E,C,A,0,171,"i32TruncUf64","i32.trunc_u/f64"),T(L,E,A,0,172,"i64ExtendSi32","i64.extend_s/i32"),T(L,E,A,0,173,"i64ExtendUi32","i64.extend_u/i32"),T(L,C,A,0,174,"i64TruncSf32","i64.trunc_s/f32"),T(L,C,A,0,175,"i64TruncUf32","i64.trunc_u/f32"),T(L,C,A,0,176,"i64TruncSf64","i64.trunc_s/f64"),T(L,C,A,0,177,"i64TruncUf64","i64.trunc_u/f64"),T(C,E,A,0,178,"f32ConvertSi32","f32.convert_s/i32"),T(C,E,A,0,179,"f32ConvertUi32","f32.convert_u/i32"),T(C,L,A,0,180,"f32ConvertSi64","f32.convert_s/i64"),T(C,L,A,0,181,"f32ConvertUi64","f32.convert_u/i64"),T(C,C,A,0,182,"f32Demotef64","f32.demote/f64"),T(C,E,A,0,183,"f64ConvertSi32","f64.convert_s/i32"),T(C,E,A,0,184,"f64ConvertUi32","f64.convert_u/i32"),T(C,L,A,0,185,"f64ConvertSi64","f64.convert_s/i64"),T(C,L,A,0,186,"f64ConvertUi64","f64.convert_u/i64"),T(C,C,A,0,187,"f64Promotef32","f64.promote/f32"),T(E,C,A,0,188,"i32Reinterpretf32","i32.reinterpret/f32"),T(L,C,A,0,189,"i64Reinterpretf64","i64.reinterpret/f64"),T(C,E,A,0,190,"f32Reinterpreti32","f32.reinterpret/i32"),T(C,L,A,0,191,"f32Reinterpreti64","f64.reinterpret/i64");let Sr=(o,n)=>{let s=o[0];return["i32","bool"].includes(o)&&n==="i64"?F.i32Wrapi64:o==="i64"&&["i32","bool"].includes(n)?F.i64ExtendSi32:o==="f32"&&n==="f64"?F.f32Demotef64:o==="f64"&&n==="f32"?F.f64Promotef32:F[o+(s==="f"?"ConvertS":"TruncS")+n]},Tr=({type:o,value:n})=>({"+":F[String(o)+"Add"],"-":F[String(o)+"Sub"],"*":F[String(o)+"Mul"],"/":F[String(o)+"DivS"]||F[String(o)+"Div"],"%":F[String(o)+"RemS"]||F[String(o)+"RemU"],"==":F[String(o)+"Eq"],"!=":F[String(o)+"Ne"],">":F[String(o)+"Gt"]||F[String(o)+"GtS"],"<":F[String(o)+"Lt"]||F[String(o)+"LtS"],"<=":F[String(o)+"Le"]||F[String(o)+"LeS"],">=":F[String(o)+"Ge"]||F[String(o)+"GeS"],"?":F.If,":":F.Else,"&":F[String(o)+"And"],"|":F[String(o)+"Or"],"^":F[String(o)+"Xor"],">>":F[String(o)+"ShrS"],">>>":F[String(o)+"ShrU"],"<<":F[String(o)+"Shl"]})[n],tt=127,nt=126,rt=125,st=124,Er=112,xr=96,ti={i32:tt,i64:nt,f32:rt,f64:st},qt=o=>{switch(o){case nt:return"i64";case rt:return"f32";case st:return"f64";case xr:return"func";case Er:return"anyfunc";case tt:default:return"i32"}},vn=o=>{let n={};return k({[y.Pair]:({params:s})=>{let[{value:a},{value:l}]=s;n[a]=parseInt(l)}})(o),n},ni=o=>{let n=o.value||"??",s=o.type,a=Tr({value:n,type:s||"i32"});return s?a.text:a.text.replace("i32","??")},Ar=o=>{let n=[];return k({[y.Pair]:(s,a)=>{n.push(`${s.params[0].value} ${s.params[1].value}`)},[y.Type]:s=>{n.push(s.value)}})(o),n.length?" param("+n.join(" ")+")":""},wr=o=>o==null?"":" (result "+(o.type||"??")+")",Cr=o=>{let[n,s]=o.params;return"(type "+o.value+` (func${Ar(n)}${wr(s)}))`},ze=(o,n,{value:s,params:a})=>{a.filter(Boolean).length?(o(`(${s}`,2),a.forEach(n),o(")",0,-2)):o(`(${s})`,0,0)},ri=o=>({[y.Import]:(n,s)=>{let[a,l]=n.params;k({[y.Pair]:({params:u},h)=>{let{value:d}=u[0],m=u[1];if(m.value==="Memory"){let v=vn(m);o(`(import "${l.value}" "${d}" (memory ${v.initial}${v.max?v.max:""}))`)}else o(`(import "${l.value}" "${d}" ${Cr(m)})`)},[y.Identifier]:(u,h)=>{let{value:d}=u;o(`(import "${l.value}" "${d}" (type ??))`)}})(a)},[y.Export]:(n,s)=>{o("(export",2),n.params.forEach(s),o(")",0,-2)},[y.GenericType]:(n,s)=>{o(";; Pseudo type",0,0),o("(type-generic "+n.value+")",0,0)},[y.FunctionCall]:({value:n,params:s},a)=>{ze(o,a,{value:`call ${n}`,params:s})},[y.Block]:({params:n},s)=>{ze(o,s,{value:"block",params:n})},[y.NativeMethod]:(n,s)=>{ze(o,s,n)},[y.BinaryExpression]:(n,s)=>{let a=ni(n);ze(o,s,{value:a,params:n.params})},[y.ArraySubscript]:({params:n},s)=>{o(";; unparsed",0,0),ze(o,s,{value:"subscript",params:n})},[y.Typedef]:(n,s)=>{o(Cr(n))},[y.Struct]:(n,s)=>{o(";; Pseudo struct type",0,0),ze(o,s,{value:"type-struct "+n.value,params:n.params})},[y.Identifier]:n=>{let s=n.meta[Ie]!=null?"global":"local";o(`(get_${s} ${n.value})`)},[y.Constant]:n=>{o(`(${String(n.type)}.const ${n.value})`)},[y.FunctionPointer]:n=>{o(`(${String(n.type)}.table_pointer ${n.value})`)},[y.FunctionDeclaration]:(n,s)=>{let[a,l,...u]=n.params;o(`(func ${n.value}${Ar(a)}${wr(l)}`,2),u.forEach(s),o(")",0,-2)},[y.ReturnStatement]:({params:n},s)=>{ze(o,s,{value:"return",params:n})},[y.Declaration]:(n,s)=>{o("(local "+n.value+" "+String(n.type),2,0),n.params.forEach(s),o(")",0,-2)},[y.ImmutableDeclaration]:(n,s)=>{let a=n.meta[Ie]!=null?"global":"local";if(n.type==="Memory"){let l=vn(n);o(`(memory ${l.initial}${l.max?` ${l.max}`:""})`)}else o(`(${a} `+n.value+" "+String(n.type),2,0),n.params.forEach(s),o(")",0,-2)},[y.StringLiteral]:n=>{o(`; string "${n.value}"`,0,0),o("(i32.const ??)",0,0)},[y.Type]:n=>{o(n.value)},[y.TypeCast]:(n,s)=>{let a=n.params[0],l=Sr(String(n.type),a.type);o("("+l.text,2),n.params.forEach(s),o(")",0,-2)},[y.Access]:({params:n},s)=>{o(";; unparsed",0,0),ze(o,s,{value:"access",params:n})},[y.MemoryAssignment]:(n,s)=>{o("("+String(n.type)+".store",2,0),n.params.forEach(s),o(")",0,-2)},[y.Assignment]:(n,s)=>{let[a,...l]=n.params,u=a.meta[Ie]!=null?"global":"local";o(`(set_${u} ${a.value}`,2),[y.ArraySubscript,y.Access].includes(a.Type)&&s(a),l.forEach(s),o(")",0,-2)},[y.TernaryExpression]:(n,s)=>{let[a,l,u]=n.params;o("(select",2),s(a),s(l),s(u),o(")",0,-2)},[y.IfThenElse]:(n,s)=>{let[a,l,...u]=n.params;o("(if",2),s(a),o("(then",2),s(l),o(")",0,-2),u.length>0&&(o("(else",2),u.forEach(s),o(")",0,-2)),o(")",0,-2)},[y.ObjectLiteral]:(n,s)=>{}}),$r=o=>{if(o==null)return"";let n=0,s=[],a=[];return k(ri((h,d=0,m=0)=>{n+=m,a.push(h),s.push(n+h.length),n+=d}))(o),a.reduce((h,d,m)=>(h+=d.padStart(s[m]," ")+`
`,h),"")},Or=Lt((o,n)=>{let s=n.meta[Nt],a=n.meta[Ie],l=s!=null?s:a;$(l!=null,`Undefined index for scope Operation. Possibly missing metadata. op: ${JSON.stringify(o)} node: ${$r(n)}`);let u=s!=null?o+"Local":o+"Global",h=[Number(l)];return{kind:F[u],params:h,debug:`${n.value}<${n.meta.ALIAS||n.type}>`}}),si=o=>{switch(o){case Qe.f32:return rt;case Qe.f64:return st;case Qe.i64:return nt;case Qe.i32:default:return tt}},bt=o=>typeof o=="string"&&Qe[o]!=null,Lr=o=>({mutable:o.meta[Pt]?0:1,type:si(o.type)}),oi=Or("Set"),Nr=Or("Get"),Wt="global";function Sn(o,{filename:n}){let s=o.meta[fn];if(s==null)throw new Error("Missing AST metadata!");let{types:a,functions:l,userTypes:u}=s,h=[];k({[y.Import]:(m,v)=>{k({[y.BinaryExpression]:(b,g)=>{let[w,N]=b.range;h.push(Ce("Using an 'as' import without a type.","A type for original import "+b.params[0].value+" is not defined nor could it be inferred.",{start:w,end:N},n,Wt))},[y.Identifier]:(b,g)=>{let[w,N]=b.range;h.push(Ce("Infered type not supplied.","Looks like you'd like to infer a type, but it was never provided by a linker. Non-concrete types cannot be compiled.",{start:w,end:N},n,Wt))},[y.Pair]:(b,g)=>{let w=b.params[1];if(!bt(w.value)&&a[w.value]==null){let[N,B]=w.range;h.push(Ce(`Undefined Type ${w.value}`,`Invalid Import. ${w.value} type does not exist`,{start:N,end:B},n,Wt))}}})(m)},[y.Struct]:(m,v)=>{},[y.ImmutableDeclaration]:(m,v)=>{},[y.Declaration]:(m,v)=>{let[b,g]=m.range;!bt(m.type)&&!a[m.type]&&!u[m.type]&&h.push(Ce(`Unknown type used in a declaration, "${String(m.type)}"`,"Variables must be assigned with a known type.",{start:b,end:g},n,Wt))},[y.FunctionDeclaration]:(m,v)=>{let b=`${m.value}()`;k({[y.Declaration]:(g,w)=>{let[N,B]=g.range;!bt(g.type)&&!a[g.type]&&!u[g.type]&&h.push(Ce(`Unknown type used in a declartion, "${String(g.type)}"`,"Variables must be assigned with a known type.",{start:N,end:B},n,b))},[y.Assignment]:g=>{let[w]=g.params,[N,B]=g.range;w.meta[Pt]&&h.push(Ce(`Cannot reassign a const variable ${w.value}`,"const variables cannot be reassigned, use let instead.",{start:N,end:B},n,b))},[y.ArraySubscript]:g=>{let[w]=g.params,[N,B]=g.range;h.push(Ce("Invalid subscript target",`Expected array type for ${w.value}, received ${w.type}`,{start:N,end:B},n,b))},[y.NativeMethod]:(g,w)=>{let{value:N}=g,[B={},U]=g.params,[z,Z]=g.range;B.value==="unreachable"&&(N.includes("store")||N.includes("load"))&&h.push(Ce("Cannot generate property access",`Cannot assign "${U.value}". Key is "${B.value}"`,{start:z,end:Z},n,b))},[y.ReturnStatement]:(g,w)=>{if(g.params.map(w),m.type==null)return;let[N]=g.params,[B]=g.range,U=N!=null?N.range[1]:g.range[1],z=g.type;ke(z)!==ke(m.type)&&h.push(Ce("Missing return value","Inconsistent return value. Expected "+m.type+" received "+String(z),{start:B,end:U},n,b))},[y.FunctionCall]:(g,w)=>{if(l[g.value]==null){let[N,B]=g.range;h.push(Ce("Undefined function reference",`${g.value} is not defined.`,{start:N,end:B},n,b))}},[y.IndirectFunctionCall]:(g,w)=>{let N=g.params[g.params.length-1],B=a[N.type];if(!bt(N.type)&&B==null){let[U,z]=g.range;h.push(Ce("Cannot make an indirect call without a valid function type",`${N.value} has type ${String(N.type)} which is not defined. Indirect calls must have pre-defined types.`,{start:U,end:z},n,b))}}})(m)}})(o);let d=h.length;if(d>0){let m=h.reduce((v,b)=>v+`
${b}
`,`Cannot generate WebAssembly for ${n}. ${d} problems.
`);throw new Error(m)}}let ue=(o,n)=>(Array.isArray(n)?o=[...o,...n]:o.push(n),o),ii=(o,n)=>{let s=o.params.map(fe(n)).reduce(ue,[]),a=o.meta[Pe];return s.push({kind:F.Call,params:[a],debug:`${o.value}<${o.type?o.type:"void"}>`}),s},ai=(o,n)=>{let s=o.params.map(fe(n)).reduce(ue,[]),a=o.meta[Nt],l=o.meta[_t];return $(a!=null,"Undefined local index, not a valid function pointer"),$(l!=null,"Variable is not of a valid function pointer type"),[...s,{kind:F.CallIndirect,params:[l,0]}]},ci=(o,n)=>{let s=o.params.map(fe(n)).reduce(ue,[]);return s.push({kind:Tr(I({},o,{type:o.type})),params:[]}),s},li=(o,n)=>{let s=o.params.map(fe(n)).reduce(ue,[]);return s.push({kind:F.Select,params:[]}),s},ui=(o,n)=>{let s=fe(n),[a,l,...u]=o.params;return[...[a].map(s).reduce(ue,[]),{kind:F.If,params:[64]},...[l].map(s).reduce(ue,[]),...u.map(s).reduce(ue,[]),{kind:F.End,params:[]}]},pi=o=>[{kind:F.i32Const,params:[Number(o.value)]}],fi=o=>{let n=o.params.filter(Boolean).map(fe(null)).reduce(ue,[]);return n.push({kind:F.Return,params:[]}),n},mi=(o,n)=>[o].map(fe(n)).reduce(ue,[]),hi=(o,n)=>{let s=o.params[0];if(s){let a=o.meta[Nt],l=bt(o.type)?o.type:Ne;return[...mi(I({},s,{type:l}),n),{kind:F.SetLocal,params:[a],debug:`${o.value}<${String(o.type)}>`}]}return[]},di=o=>{let[n,s]=o.params,a=[s].map(fe(null)).reduce(ue,[]);return a.push(oi(n)),a},yi=o=>{let[n,s]=o.params,a=[s].map(fe(null)).reduce(ue,[]);return a.push({kind:F.TeeLocal,params:[Number(n.meta.LOCAL_INDEX)],debug:`${n.value}<${String(n.meta.ALIAS||n.type)}>`}),a},_i=(o,n)=>{let s=[],a=fe(n),[l,u,...h]=o.params;return s.push.apply(s,[l].map(a).reduce(ue,[])),s.push({kind:F.Block,params:[64]}),s.push({kind:F.Loop,params:[64]}),s.push.apply(s,[u].map(a).reduce(ue,[])),s.push({kind:F.i32Eqz,params:[]}),s.push({kind:F.BrIf,params:[1]}),s.push.apply(s,h.map(a).reduce(ue,[])),s.push({kind:F.Br,params:[0]}),s.push({kind:F.End,params:[]}),s.push({kind:F.End,params:[]}),s},bi=(o,n)=>{let s=o.meta[pn];$(s,`Cannot generate typecast for node: ${JSON.stringify(o)}`);let{to:a,from:l}=s;return[...o.params.map(fe(n)).reduce(ue,[]),{kind:Sr(a,l),params:[]}]},gi=()=>[{kind:F.Br,params:[2]}];function vi(){return[]}let Si=(o,n)=>o.params.map(fe(n)).reduce(ue,[]),Ti=(o,n)=>[{kind:F.Else,params:[]},...o.params.map(fe(n)).reduce(ue,[])],Ei=(o,n)=>{let[s,a]=o.params,l={kind:F.Select,params:[]},u=[s].map(fe(n)).reduce(ue,[]);return o.value==="&&"?[...[a].map(fe(n)).reduce(ue,[]),{kind:F.i32Const,params:[0]},...u,l]:[...u,...[a].map(fe(n)).reduce(ue,[]),...u,l]},Pr={load8_s:0,load8_u:0,store8:0,load16_s:1,load16_u:1,store16:1,store32:2,load32_s:2,load32_u:2,store:2,load:2},xi={grow_memory:0,current_memory:0},Ai=(o,n)=>{let s=o.params.map(fe(n)).reduce(ue,[]),a=o.value.split(".").pop();if(Pr[a]==null)s.push({kind:gn[o.value],params:[xi[o.value]]});else{let l=Pr[a];s.push({kind:gn[o.value],params:[l,0]})}return s},wi=o=>{let n=F[String(o.type)+"Const"],s=(o.meta.SIGN||1)*Number(o.value);return[{kind:n,params:[s]}]},Ci={[y.FunctionCall]:ii,[y.IndirectFunctionCall]:ai,[y.Constant]:wi,[y.BinaryExpression]:ci,[y.TernaryExpression]:li,[y.IfThenElse]:ui,[y.Else]:Ti,[y.Select]:Ei,[y.Block]:Si,[y.Identifier]:Nr,[y.FunctionIdentifier]:Nr,[y.FunctionPointer]:pi,[y.ReturnStatement]:fi,[y.Declaration]:hi,[y.Assignment]:di,[y.AssignmentExpression]:yi,[y.Loop]:_i,[y.Break]:gi,[y.TypeCast]:bi,[y.Noop]:vi,[y.NativeMethod]:Ai},fe=Lt((o,n)=>{let s=Ci[n.Type];return $(s,`Unsupported Syntax Token. ${n.Type} "${n.value}"`),s(n,o)}),$i=o=>({functionIndex:o}),Tn=0,Vt=1,Jt=2,gt=3,Oi={Memory:Jt,Table:Vt};function Li(o){let n=o.meta[Pe],s=o.meta[Ie];if(s!=null){let a=Oi[String(o.type)]||gt;return{index:[Jt,Vt].includes(a)?0:s,kind:a,field:o.value}}return{index:n,kind:Tn,field:o.value}}let Ni=o=>{let n={max:0,initial:0};return k({[y.Pair]:({params:s})=>{let[{value:a},{value:l}]=s;n[a]=parseInt(l)}})(o),n};function Pi(o){let n={max:0,initial:0,type:"element"};return k({[y.Pair]:({params:s})=>{let[{value:a},{value:l}]=s;switch(a){case"initial":n.initial=parseInt(l);break;case"element":n.type=l;break;case"max":n.max=parseInt(l);break}}})(o),n}let Ii=o=>{let n=Lr(o),[s]=o.params;if(s!=null){let{value:a}=s;switch(n.type){case rt:case st:n.init=parseFloat(a);break;case tt:case nt:default:n.init=parseInt(a)}}return n},Ri=o=>{switch(o){case"Memory":return Jt;case"Table":return Vt;case"i32":case"f32":case"i64":case"f64":return gt;default:return Tn}},Bi=o=>{let n=o.value;return o.meta.AS!=null?o.meta.AS:n};function Mi(o){let[n,s]=o.params,{value:a}=s,l=[];return k({[y.Pair]:(u,h)=>{let[d,m]=u.params,v=Bi(d),{value:b}=m,g=Ri(b),w=(()=>{let B=m.meta[_t];return B||null})(),N=b==="Memory"?vn(m):{};l.push(I({module:a,field:v,global:g===gt,kind:g,type:ti[b],typeIndex:w},N))}})(n),l}let ot=o=>{switch(o){case"f32":return rt;case"f64":return st;case"i64":return nt;case"i32":case"Function":default:return tt}},Ir=o=>{let[n]=o.params,s=o.type?ot(o.type):null,a=[];return k({[y.Pair]:l=>{let u=l.params[1];$(u,"Undefined type in a argument expression"),a.push(ot(u.value))}})(n),{params:a,result:s,id:o.value}};function Fi(o){let n=o.value;$(typeof n=="string",`Generator: A type must have a valid string identifier, node: ${JSON.stringify(o)}`);let[s,a]=o.params,l=[];return k({[y.DeclType]:(u,h)=>{l.push(ot(u.value))},[y.Type]:(u,h)=>{l.push(ot(u.value))},[y.Identifier]:(u,h)=>{l.push(ot(u.value))}})(s),{id:n,params:l,result:a.type&&a.type!=="void"?ot(a.type):null}}function Ui(o,n){let s=n,a={},l=Object.entries(o).reduce((h,[d,m])=>(h.push({offset:Number(s),data:m}),a[d]=s,s+=m.size,h),[]),u=new le;return u.push(yn,s,String(s)),{data:[{offset:0,data:u},...l],map:a}}let Di=4,ji=o=>{let[n,s,...a]=o.params,l=o.meta[mn];$(a,"Cannot generate code for function without body"),$(l,"Cannot generate code for function without metadata");let{locals:u,argumentsCount:h}=l,d={code:[],locals:Object.keys(u).slice(h).map(m=>Lr(u[m])),debug:`Function ${o.value}`};return d.code=a.map(fe(d)).reduce(ue,[]),d};function En(o,n){let s={Version:n.version,Types:[],Start:[],Element:[],Code:[],Exports:[],Imports:[],Globals:[],Functions:[],Memory:[],Table:[],Artifacts:[],Data:[],Name:{module:n.filename,functions:[],locals:[]}},{statics:a}=o.meta[fn];n.linker!=null&&(a=I({},n.linker.statics,a));let{map:l,data:u}=Ui(a,Di);Object.keys(a).length>0&&(s.Data=u);let h=g=>{let w=Ir(g);return s.Types.findIndex(N=>{let B=N.params.length===w.params.length&&N.params.reduce((z,Z,K)=>z&&Z===w.params[K],!0),U=N.result===w.result;return B&&U})},d=g=>s.Element.findIndex(w=>w.functionIndex===g),m={},v=P({[y.Typedef]:(g,w)=>{let N=s.Types.findIndex(({id:U})=>U===g.value),B=s.Types[N];return B==null&&(N=s.Types.length,s.Types.push(Fi(g))),B=I({},g,{meta:I({},g.meta,{[_t]:N})}),m[g.value]={typeIndex:N,typeNode:B},B}})(P({[y.Import]:(g,w)=>g,[y.StringLiteral]:(g,w)=>{let{value:N}=g;return l[N]==null?g:I({},g,{value:String(l[N]),Type:y.Constant})},[y.StaticValueList]:g=>{let{value:w}=g;return I({},g,{value:String(l[w]),Type:y.Constant})}})(o)),b={[y.Typedef]:(g,w)=>g,[y.Export]:g=>{let[w]=g.params;s.Exports.push(Li(w))},[y.ImmutableDeclaration]:g=>{switch(g.type){case"Memory":s.Memory.push(Ni(g));break;case"Table":s.Table.push(Pi(g));break}},[y.Declaration]:g=>{g.meta[Ie]!=null&&s.Globals.push(Ii(g))},[y.Import]:g=>{s.Imports.push(...Mi(g))},[y.FunctionDeclaration]:g=>{let w=(()=>{let U=h(g);return U===-1?(s.Types.push(Ir(g)),s.Types.length-1):U})(),N=P({FunctionPointer(U){let Z=U.meta[Pe],K=d(Z);return K<0&&(K=s.Element.length,s.Element.push($i(Z))),U}})(g),B=g.meta[Pe];if($(B!=null,"Function index must be set"),s.Functions[B]=w,s.Code[B]=ji(N),N.value==="start"&&s.Start.push(B),n.encodeNames){s.Name.functions.push({index:B,name:g.value});let U=g.meta[mn];U!=null&&Object.keys(U.locals).length&&(s.Name.locals[B]={index:B,locals:Object.entries(U.locals).map(([z,Z])=>({name:z,index:Number(Z.meta["local/index"])}))})}}};return k(b)(v),s.Code=s.Code.filter(Boolean),s}let Rr=1,ki=1836278016;function zi(o){return new le().push(yn,ki,"\\0asm").push(yn,o,`version ${o}`)}let xn="varuint7",G="varuint32",vt="varint7",it="varint1",An="varint32",Br="varint64";function Ye(o,n,s){o.push(G,n.length,s);for(let a=0;a<n.length;a++)o.push(ce,n.charCodeAt(a),n[a]);return o}let Gi=o=>{let n=new le().push(G,o.length,"entry count");return o.forEach(s=>{switch(Ye(n,s.module,"module"),Ye(n,s.field,"field"),s.kind){case gt:{n.push(ce,gt,"Global"),n.push(ce,s.type,qt(s.type)),n.push(ce,0,"immutable");break}case Tn:{n.push(ce,s.kind,"Function"),n.push(G,s.typeIndex,"type index");break}case Vt:{n.push(ce,s.kind,"Table"),n.push(ce,Er,"function table types"),n.push(it,0,"has max value"),n.push(G,0,"iniital table size");break}case Jt:{n.push(ce,s.kind,"Memory"),n.push(it,!!s.max,"has no max"),n.push(G,s.initial,"initial memory size(PAGES)"),s.max&&n.push(G,s.max,"max memory size(PAGES)");break}}}),n},Yi=o=>{let n=new le;return n.push(G,o.length,"count"),o.forEach(({field:s,kind:a,index:l})=>{Ye(n,s,"field"),n.push(ce,a,"Global"),n.push(G,l,"index")}),n},qi=(o,{type:n,init:s,mutable:a})=>{switch(o.push(ce,n,qt(n)),o.push(ce,a,"mutable"),n){case tt:o.push(ce,F.i32Const.code,F.i32Const.text),o.push(An,s,`value (${s})`);break;case rt:o.push(ce,F.f32Const.code,F.f32Const.text),o.push(C,s,`value (${s})`);break;case st:o.push(ce,F.f64Const.code,F.f64Const.text),o.push(oe,s,`value (${s})`);break;case nt:o.push(ce,F.i64Const.code,F.i64Const.text),o.push(Br,s,`value (${s})`)}o.push(ce,F.End.code,"end")},Wi=o=>{let n=new le;return n.push(G,o.length,"count"),o.forEach(s=>qi(n,s)),n},Vi=o=>{o=o.filter(s=>s!==null);let n=new le;return n.push(G,o.length,"count"),o.forEach(s=>n.push(G,s,"type index")),n};function Ji(o){let n=new le;return n.push(G,o[0],"start function"),n}let Hi=o=>({functionIndex:n},s)=>{o.push(G,0,"table index"),o.push(ce,F.i32Const.code,"offset"),o.push(G,s,s.toString()),o.push(ce,F.End.code,"end"),o.push(G,1,"number of elements"),o.push(G,n,"function index")},Qi=o=>{let n=new le;return n.push(G,o.length,"count"),o.forEach(Hi(n)),n},Ki=(o,{params:n,result:s},a)=>{o.push(vt,xr,`func type (${a})`),o.push(G,n.length,"parameter count"),n.forEach(l=>o.push(vt,l,"param")),s?(o.push(it,1,"result count"),o.push(vt,s,`result type ${qt(s)}`)):o.push(it,0,"result count")},Xi=o=>{let n=new le;return n.push(G,o.length,"count"),o.forEach((s,a)=>Ki(n,s,a)),n},Zi=(o,n)=>{o.push(G,1,"number of locals of following type"),o.push(vt,n.type,`${qt(n.type)}`)},ea=(o,{locals:n,code:s,debug:a})=>{let l=new le;s.forEach(({kind:h,params:d,debug:m})=>{$(typeof h<"u",`Fatal error! Generated undefined opcode. debug code: ${JSON.stringify(m)}`),l.push(ce,h.code,`${h.text}  ${m||""}`),d.filter(v=>typeof v<"u").forEach(v=>{let b=G,g="i32.literal";if(h.code>=40&&h.code<=64)b=G,g="memory_immediate";else switch(h.result){case oe:b=oe,g="f64.literal";break;case C:b=C,g="f32.literal";break;case E:b=An,g="i32.literal";break;case L:b=Br,g="i64.literal";break;default:b=G}l.push(b,v,`${g}`)})});let u=new le;n.forEach(h=>Zi(u,h)),o.push(G,l.size+u.size+2,a),o.push(G,n.length,"locals count"),o.write(u),o.write(l),o.push(ce,F.End.code,"end")},ta=o=>{let n=new le;return n.push(G,o.length,"function count"),o.forEach(s=>ea(n,s)),n},na=(o,n)=>{o.push(it,n.max?1:0,"has no max"),o.push(G,n.initial,"initial memory size(PAGES)"),n.max&&o.push(G,n.max,"max memory size(PAGES)")},ra=o=>{let n=new le;return n.push(G,o.length,"count"),o.forEach(s=>na(n,s)),n},sa={anyfunc:112},oa=(o,n)=>{o.push(vt,sa[n.type],n.type),o.push(it,n.max?1:0,"has max"),o.push(G,n.initial,"initial table size"),n.max&&o.push(G,n.max,"max table size")};function ia(o){let n=new le;return n.push(G,o.length,"count"),o.forEach(s=>oa(n,s)),n}let aa=(o,n)=>{o.push(G,0,"memory index");let{offset:s,data:a}=n;o.push(ce,F.i32Const.code,F.i32Const.text),o.push(An,s,`segment offset (${s})`),o.push(ce,F.End.code,"end"),o.push(G,a.size,"segment size"),o.write(a)};function ca(o){let n=new le;n.push(G,o.length,"entries");for(let s=0,a=o.length;s<a;s++){let l=o[s];aa(n,l)}return n}let la=o=>{let n=new le;return Ye(n,o,`name_len: ${o}`),n},ua=o=>{let n=new le;return n.push(G,o.length,`count: ${String(o.length)}`),o.forEach(({index:s,name:a})=>{n.push(G,s,`index: ${String(s)}`),Ye(n,a,`name_len: ${a}`)}),n},pa=o=>{let n=new le;return n.push(G,o.length,`count: ${String(o.length)}`),o.forEach(({index:s,locals:a})=>{n.push(G,s,`function index: ${String(s)}`),n.push(G,a.length,`number of params and locals ${a.length}`),a.forEach(({index:l,name:u})=>{n.push(G,l,`index: ${String(l)}`),Ye(n,u,`name_len: ${u}`)})}),n},fa=o=>{let n=new le;Ye(n,"name","name_len: name");let s=la(o.module);n.push(xn,0,"name_type: Module"),n.push(G,s.size,"name_payload_len"),n.write(s);let a=ua(o.functions);n.push(xn,1,"name_type: Function"),n.push(G,a.size,"name_payload_len"),n.write(a);let l=pa(o.locals);return n.push(xn,2,"name_type: Locals"),n.push(G,l.size,"name_payload_len"),n.write(l),n},ma=1,ha=2,da=3,ya=4,_a=5,ba=6,ga=7,va=8,Sa=9,Ta=10,Ea=11,xa=0,Ee=({type:o,label:n,emitter:s})=>a=>{let l=a[n];if(!l||Array.isArray(l)&&!l.length)return null;let u=new le().push(ce,o,n+" section"),h=s(l);return u.push(G,h.size,"size"),u.write(h),u};var xe={type:Ee({type:ma,label:"Types",emitter:Xi}),imports:Ee({type:ha,label:"Imports",emitter:Gi}),function:Ee({type:da,label:"Functions",emitter:Vi}),table:Ee({type:ya,label:"Table",emitter:ia}),memory:Ee({type:_a,label:"Memory",emitter:ra}),exports:Ee({type:ga,label:"Exports",emitter:Yi}),globals:Ee({type:ba,label:"Globals",emitter:Wi}),start:Ee({type:va,label:"Start",emitter:Ji}),element:Ee({type:Sa,label:"Element",emitter:Qi}),code:Ee({type:Ta,label:"Code",emitter:ta}),data:Ee({type:Ea,label:"Data",emitter:ca}),name:Ee({type:xa,label:"Name",emitter:fa})};function wn(o,n){let a=new le().write(zi(o.Version)).write(xe.type(o)).write(xe.imports(o)).write(xe.function(o)).write(xe.table(o)).write(xe.memory(o)).write(xe.globals(o)).write(xe.exports(o)).write(xe.start(o)).write(xe.element(o)).write(xe.code(o)).write(xe.data(o));return n.encodeNames?a.write(xe.name(o)):a}let Aa=(o,n=0,s)=>{let a=0;return o.data.slice(n,s).map(({type:l,value:u,debug:h})=>{let d=`${a.toString()} 0x${a.toString(16)}`.padStart(6," ").padEnd(o.data.length.toString().length+1),m;Array.isArray(u)?m=u.map(b=>b.toString(16)).join().padStart(16):m=u.toString(16).padStart(16);let v=`${d}: ${m} ; ${h}`;return a+=_n[l]||u.length,v}).join(`
`)+`
 ============ fin =============`},Cn=o=>{let n=s=>{try{return o(`function fragment() {
        ${s}
      }`).params[0].params[2].params[0]}catch(a){throw new Error(`PANIC - Invalid fragment input:

${s}

Parse Error: ${a.stack}`)}};return(s,...a)=>{let l=!1,u=s.reduce((d,m,v)=>{let b=a[v];return b!=null&&typeof b!="object"?d+=m+String(b):b!=null?(l=!0,d+=m+`$$rep_${v}`):d+=m},""),h=n(u);return l?P({Identifier(d){let{value:m}=d;return m.indexOf("$$rep_")?d:a[Number(m.replace("$$rep_",""))]}})(h):h}},wa="0.21.0",Ca=(o,n)=>{let{version:s=Rr,encodeNames:a=!1,lines:l=o.split(`
`),filename:u="unknown",extensions:h=[]}=n||{},d=un([]),m=Cn(d),v={version:s,encodeNames:a,lines:l,filename:u,extensions:h},b=d(o),g=bn(b,[],I({},v,{parser:d,stmt:m}));Sn(g,{lines:l,filename:u});let w=En(g,v);return wn(w,{version:s,encodeNames:a,filename:u,lines:l})},$a=(o,n)=>{let{filename:s="unknown.walt",extensions:a=[],linker:l,encodeNames:u=!1}=n||{},h={filename:s,lines:o.split(`
`),version:Rr,encodeNames:u},d=a.reduce((B,U)=>{let z=I({semantics:Z=>({}),grammar:()=>({ParserRules:[]})},U(h));return B.grammar.push(z.grammar),B.semantics.push(z.semantics),B},{grammar:[],semantics:[]}),m=un(d.grammar),v=Cn(m),b=m(o),g=bn(b,d.semantics,{parser:m,stmt:v});Sn(g,h);let w=En(g,I({},h,{linker:l})),N=wn(w,h);return{wasm:N,buffer(){return N.buffer()},ast:b,semanticAST:g}};return e.makeParser=un,e.makeFragment=Cn,e.semantics=bn,e.validate=Sn,e.generator=En,e.emitter=wn,e.prettyPrintNode=$r,e.debug=Aa,e.stringEncoder=vr,e.stringDecoder=Do,e.walkNode=k,e.mapNode=P,e.VERSION=wa,e.getIR=Ca,e.compile=$a,e}({}),Qn=uc;var pc=e=>Qn.compile(e).buffer(),fc=e=>e.trim().length?JSON.stringify([...new Uint8Array(Qn.compile(e).buffer())]):"[]",mc=e=>{let t={};return Object.getOwnPropertyNames(Object.getPrototypeOf(e)).filter(r=>!["constructor","nanoapp","initial_state","initial_component","css","__walt","__src","init"].includes(r)).map(r=>t[r]=e[r].bind(e)),t},hc=(e,t)=>{if(e.length){let r=new WebAssembly.Table({initial:10,element:"anyfunc"}),i=new WebAssembly.Instance(new WebAssembly.Module(new Uint8Array(e).buffer),{tag:mc(t),console,javascript:{table:r,setTimeout:(p,f)=>window.setTimeout(r.get(p),f),setInterval}}).exports,c={};return Object.keys(i).map(p=>c[p]=i[p]),c}return{}},xs={name:"Walt",uniqueBlock:"walt",compileWalt:fc,compile:pc,initWalt:hc};function dc(e){return e;function t(p,f,S){var _;return S<0?S+=1:S>1&&(S-=1),6*S<1?_=p+(f-p)*S*6:2*S<1?_=f:3*S<2?_=p+(f-p)*(2/3-S)*6:_=p,255*_}function r(p,f,S){var _,x,P,R,k,V,$=Math;return f/=100,S/=100,f?(S<=.5?x=S*(f+1):x=S+f-S*f,_=S*2-x,P=p/360,R=$.ceil(t(_,x,P+1/3)),k=$.ceil(t(_,x,P)),V=$.ceil(t(_,x,P-1/3))):R=k=V=S*255,{r:R,g:k,b:V}}function i(p,f,S){return"#"+((1<<24)+(1*p<<16)+(1*f<<8)+1*S).toString(16).slice(1)}var c}var As=dc;var ws={name:"min.css",processStyle:As};var yc={walt:xs,mincss:ws},He=yc;var ht=e=>class extends e{baseInit(){this.component=this.initial_component,Hn(this.component),this.animate=Se.animate,this.Spring=Ct,this.window_events={},this.checkStateObjectChanges={},this.state=this.initial_state,this.__walt&&(this.walt=He.walt.initWalt(this.__walt,this,this.state)),delete this.__proto__.baseInit}async connectedCallback(){if(this.renderer&&!this.__rendererHTML&&this.__rendererName!==this.parent.__rendererName)throw`ui.js diffferent renderers ${this.__rendererName} and ${this.parent.__rendererName}`;Fe(this.document,this.component,{state:this.state}),this.is_connected=!0,this.connected&&this.connected()}async disconnectedCallback(){this.disconnected&&await this.disconnected(),Object.keys(this.window_events).forEach(r=>this.window_events[r].forEach(i=>window.removeEventListener(r,i.cb)))}render(){this.is_connected&&Xt(this.document,this.component,{state:this.state})}attributeChangedCallback(r,i,c){if(typeof c=="object"){if(Array.isArray(this.state[r])&&Array.isArray(c)&&this.state[r].length==0&&c.length==0||this.checkStateObjectChanges[r]&&JSON.stringify(this.state[r])===JSON.stringify(c))return}else if(this.state[r]===c)return;this.state[r]=c,this.changed&&this.changed({[r]:c}),this.render()}hasEventHandler(r){return this._events?!!this._events[r]:!!this.getAttribute("on"+r)}get cookies(){return typeof document<"u"?Object.assign({},...document.cookie.split(";").filter(r=>r).map(r=>r.split("=")).map(([r,i])=>({[r.trim()]:(i+"").trim()}))):{}}get hash(){return typeof window<"u"?window.location.hash.substr(1).split("/"):[]}on(r,i,c){this.window_events[r]||(this.window_events[r]=[]);let p=this.window_events[r].find(S=>S.callback===i),f=(...S)=>i.call(this,...S);p||(this.window_events[r].push({callback:i,cb:f}),window.addEventListener(r,f,c))}off(r,i){if(!this.window_events[r])return;let c=this.window_events[r].findIndex(p=>p.callback===i);c!==-1&&(window.removeEventListener(r,this.window_events[r][c].cb),this.window_events[r].splice(c,1))}};var on=e=>class extends e{htmlInit(){if(this.animateCSS=(r,{element:i,unit:c,from:p,to:f,duration:S,easing:_,done:x})=>{i._styles[r]=Se.animateCSS(i||this,r,c===void 0?"":c,p||0,f,S||1e3,_,()=>{i._styleV[r]=f+c,x&&x()})},this.css.length){let r=document.createElement("style");r.textContent=this.css,this.ShadowDOM?this.document.append(r):setTimeout(()=>{this.document.append(r)},0)}delete this.__proto__.htmlInit}setAttribute(r,i){this.attributeChangedCallback(r,void 0,i),this.AddAttributes&&typeof i!="object"&&super.setAttribute(r,i)}$(r){return this.document.querySelector(r)}$$(r){return this.document.querySelectorAll(r)}emitNative(r,i){console.warn(`this.emitNative() is deprecated. Use this.emit(). "${this.__src}"`),this.emit(r,i)}emit(r,i){this.dispatchEvent(new CustomEvent(r,{cancelable:!1,bubbles:!1,detail:i}))}};var $t;if(typeof window<"u"){class e extends HTMLElement{constructor(){super(),this.AddAttributes=!1,this.ShadowDOM="open",this.MutationObserverOptions={childList:!0},this.baseInit(),this.init&&this.init(),this.document=["open","closed"].includes(this.ShadowDOM)?this.attachShadow({mode:this.ShadowDOM}):this,this.htmlInit(),this.slotChange&&(this._slot_observer=new MutationObserver(r=>this.slotChange(r)),this._slot_observer.observe(this,this.MutationObserverOptions))}get slotted(){let r=this.document.querySelector("slot");return r?r.assignedElements():[]}get element(){return this.ShadowDOM?this.document.host:this.document}}$t=class extends on(ht(e)){}}var Kn=class{constructor(){if(this.document=document.querySelector(this.container),!this.document)throw`i.js: target container "${this.container}" not found`;this.baseInit(),this.htmlInit(),this.init&&this.init(),this.connectedCallback()}get element(){return this.document}},an=class extends on(ht(Kn)){};var Xn=class{constructor(t,r){if(this._BASE_ELEMENT=!0,this.document={_childNodes:[],__rendererName:this.__rendererName},this._childNodes=[],this._eventListeners={},this.parent=t,this.baseInit(),this.renderer&&!this.__rendererHTML&&this.__rendererName!==this.parent.__rendererName)throw`ui.js diffferent renderers ${this.__rendererName} and ${this.parent.__rendererName}`;this.onReady=new Promise(async i=>{var c,p,f;(c=this.renderer)!=null&&c.onReady&&await this.renderer.onReady,(p=this.parent)!=null&&p.onReady&&await this.parent.onReady,(f=this.renderer)!=null&&f.onConnect&&await this.renderer.onConnect(this),this.document.renderer=this.renderer,this.document.parent=this.document,this.init&&await this.init(),Fe(this.document,this.component,{state:this.state}),i(),this.is_connected=!0,this.connected&&await this.connected()})}setAttribute(t,r){this.attributeChangedCallback(t,void 0,r)}emit(t,r){this._eventListeners[t]&&this._eventListeners[t].forEach(i=>i.cb(new CustomEvent(t,{cancelable:!1,bubbles:!1,detail:r})))}addEventListener(t,r,i){this._eventListeners[t]||(this._eventListeners[t]=[]);let c=this._eventListeners[t].find(f=>f.callback===r),p=(...f)=>r.call(this,...f);c||this._eventListeners[t].push({callback:r,cb:p})}removeEventListener(t,r){if(!this._eventListeners[t])return;let i=this._eventListeners[t].findIndex(c=>c.callback===r);i!==-1&&this._eventListeners[t].splice(i,1)}async remove(){for(await this.disconnectedCallback();this.document._childNodes.length;)await this.document._childNodes[this.document._childNodes.length-1].remove();this.renderer.onDisconnect&&await this.renderer.onDisconnect(this);let t=this.parent._childNodes.findIndex(r=>r==this);if(t!==-1)this.parent._childNodes.splice(t,1);else throw"Element not found"}after(t){this.renderer.insertAfter(this,t)}before(t){this.renderer.insertBefore(this,t)}},cn=class extends ht(Xn){};var Cs=(e,t=0)=>{for(var r=3735928559^t,i=1103547991^t,c=0,p;c<e.length;c++)p=e.charCodeAt(c),r=Math.imul(r^p,2654435761),i=Math.imul(i^p,1597334677);return r=Math.imul(r^r>>>16,2246822507)^Math.imul(i^i>>>13,3266489909),i=Math.imul(i^i>>>16,2246822507)^Math.imul(r^r>>>13,3266489909),4294967296*(2097151&i)+(r>>>0)};function Ot(e,t){return"ui-"+String(Cs(t||e.trim())).replaceAll("-","i")}var Zn={},_c=e=>e.split("-").map(t=>t.slice(0,1).toUpperCase()+t.slice(1)).join(""),bc=e=>((t,r)=>JSON.stringify(e,(i,c)=>typeof c=="function"?r.push(c)&&t:c).replace(new RegExp('"'+t+'"',"g"),i=>r.shift()))("____"+rs(50)+"____",[]),gc=(e,t)=>{if(Zn[e])return Zn[e];let r=URL.createObjectURL(new Blob([String.raw({raw:t})],{type:"text/javascript"}));return Zn[e]=r,r},er=(e,t,r,i)=>e.reduce((c,p)=>{let f=t?p.path[0]==="@"?p.path:"i.js:"+(p.path[0]==="/"?r:r+i)+"/"+p.path:gc(p.path,p.src);return p.type==="*"?c+"const "+p.import+" = {...(await import(`"+f+"`))};\n":p.type==="object"?c+"const "+p.import+" =  (await import(`"+f+"`));\n":c+"const "+p.import+" =  (await import(`"+f+"`)).default;\n"},"");function tr(e,t,{inFunc:r=!1,parent:i}){let c=Object.values(He).filter($=>$.processStyle).reduce(($,he)=>he.processStyle($),e.style||""),p=e.walt?He.walt.compileWalt(e.walt):"undefined",f=`{${(e.state||"").trim()}}`,S=t!=="customElement"?"":new Function(`return 'static get observedAttributes() { return '+JSON.stringify(Object.keys(${f}))+' }'`)(),_=_c(e.name),x=bc(Ts(e.template,e.tag||[])),P=e.container?`get container()         { return "${e.container}" }`:"";var R="";if(e.renderer){let $=e.renderer[0].split(" ");if(R='get __rendererName(){ return "'+$[0]+'" }',$.length==2){var k=!0;R+=`
get __rendererHTML(){ return true }`}else R+=`
get renderer(){ return this.parent?.renderer }`}let V=`

        ${e.static||""};
        class ${_} extends ${t} {
            ${S}
            get nanoapp()           { return ${JSON.stringify(e.nanoapp)} }
            get initial_state()     { return ${f} }
            get initial_component() { return ${x} }
            get css()               { return \`${c}\`; }
            get __walt()            { return ${p} }
            get __src()             { return "${e.src}" }
            ${R}
            ${P}
            ${e.class||""}
        };
    `;switch(t){case"customElement":let $=`
                ${e.import?er(e.import,e.nodePath,e.BASE_URL,e.path):""}
                if(!customElements.get('${e.name}')) {
                    ${V}
                    customElements.define('${e.name}', ${_});
                    window['UIjs'].tags['${e.name}'] = true;
                };`;return r?`;(async () => {${$}})();`:$;case"uiElement":let he=`
                ${e.import?er(e.import,e.nodePath,e.BASE_URL,e.path):""}
                ${V} return new ${_}("${"parentparentparent:"+i}");`;return r?`;(async () => {${he}})();`:he;case"baseElement":let ee=`
                ${e.import?er(e.import,e.nodePath,e.BASE_URL,e.path):""}
                ${V} ;window['UIjs'].tags['${e.name}'] = ${_};`;return r?`;(async () => {${ee}})();`:ee}}async function Ls(e,t,r){let i=Ot(e.innerText);await yt(e.innerText,{name:i,path:t,nanoapp:r}),e.replaceWith(document.createElement(i))}async function nr(e,t,r,i,c,p){await yt(e,{name:t,path:r,nanoapp:i,src:p})}function $s(e,t){return e.startsWith("/https://")&&(e=e.replace("/https://","https://")),typeof window<"u"&&window.nanoapp_base_path&&!e.startsWith(window.nanoapp_base_path)?window.nanoapp_base_path+"/app"+e:e}async function Ns(e,t){if(window.document.location.protocol=="file:"){console.error(`WARNING!!! ui.js cannot fetch external resources from a 'local' filesystem: "file://${e}"`);var r=await fetch($s(e,t),{mode:"no-cors"}).catch(i=>!1)}else var r=await fetch($s(e,t)).catch(c=>!1);return r}async function Os(e,t,r){if(t)return await t(e);let i=await Ns(e,r);if(i===!1)throw"i.js  \u2764\uFE0F error loading "+e;return(await i.text()).trim()}async function rr(e,t,r="",i){if(Me[e])return!0;let c=t.substr(-4)===".tag"?t:t+".tag",p=t[0]!=="/"?dt(r+c):c,f=await Ns(p,i);if(f===!1)throw"i.js  \u2764\uFE0F error loading "+c;let S=p.substring(0,p.lastIndexOf("/"))+"/";await nr(await f.text(),e,S,i,S,t)}async function Ps(e,t,r){await yt(e.innerText,{name:Ot(e.innerText),path:r,container:t})}function dt(e){return typeof window>"u"?e:new URL(e,document.baseURI).pathname}async function sr({source:e,path:t,keepName:r,nodeFetch:i,nodePath:c,BASE_URL:p}){let f=r?t.split("/").pop().split(".")[0]:Ot(t);return{name:f,compiled:await yt(e,{name:f,path:t.substring(0,t.lastIndexOf("/"))+"/",bundle:!0,nodeFetch:i,nodePath:c,BASE_URL:p})}}async function yt(e,t={}){let r=await Es(e);if(!t.name)throw"name is undefined !!!";r.name=t.name||"i-component",r.path=t.path,r.src=t.src,r.container=t.container||"",r.nodePath=t.nodePath?t.nodePath:void 0,r.BASE_URL=t.BASE_URL,r.nanoapp=t.nanoapp||[];let i=t.nodeFetch||void 0;var c="";if(r.style&&(r.style=r.style.trim(),r.style.length&&(c=r.style)),r.css)for(let p of r.css){let f=p[0]!=="/"?dt(r.path+p):p,S=await Os(f,i,r.nanoapp);S.length&&(c+=`
`+S)}if(r.style=c.replaceAll("`","`").trim(),r.tag)for(let p of r.tag){let f=p.path;f=f.substr(-4)===".tag"?f:f+".tag",i?f=dt(f[0]==="/"?f:r.path+f):f=dt(p.path[0]==="/"?f:r.path+f);let S=Ot(f);if(p.name=S,i)p.src=await i(f);else{let _=r.nanoapp&&r.nanoapp.children&&r.nanoapp.children.find(x=>"@"+x.alias===p.alias);_&&(f.startsWith("/!"+_.alias+".tag")&&f.split("/").length==2?f=window.nanoapp_base_path+f.replace("/!"+_.alias+".tag","/imports/"+_.child_release+"/index.tag"):f.startsWith("/!"+_.alias+"/")&&(f=window.nanoapp_base_path+f.replace("/!"+_.alias+"/","/imports/"+_.child_release+"/"))),await rr(S,f,r.path,_||r.nanoapp)}}if(r.import&&!i)for(let p of r.import){let f=p.path[0]!=="/"?dt(r.path+p.path):p.path;p.path=f;let S=await Os(f,i,r.nanoapp);p.src=S}if(Me[r.name]=!0,r.renderer&&r.renderer[0].split(" ").length==1){let p=tr(r,"baseElement",{inFunc:!1});return await new tn("baseElement",p)(cn)}else if(r.container){let p=tr(r,"uiElement",{inFunc:!1});return await new tn("uiElement",p)(an)}else{let p=tr(r,"customElement",{inFunc:!0});if(t.bundle){if(r.tag){let f="";for(let S of r.tag)if(Me[S.name])console.log(`              <${S.name}> skipped`);else{let _=S.path.substr(-4)===".tag"?S.path:S.path+".tag";_[0]!=="/"&&(_=r.path+_);let{name:x,compiled:P}=await sr({source:S.src,path:_,name:S.name,nodePath:dt(r.nodePath+r.path),BASE_URL:r.BASE_URL,nodeFetch:i});f+=P}return f+p}return p}await new tn("customElement",p)($t)}}function vc(e,t){e.innerText.trim().length&&console.warn(`ui.js warning: contents of "<script type=ui ${t.map(r=>r.name).join(" ")}> will be ignored"`)}function Is(e,t){e.innerText.trim().length||console.warn(`ui.js warning: empty "<script type=ui ${t.map(r=>r.name).join(" ")}>"`)}async function Rs(){let e=Array.from(document.querySelectorAll('script[type="ui"],script[type="i"]'));try{for(let t of e){let r=window.location.pathname,i=r.substring(0,r.lastIndexOf("/"))+"/",c=Array.prototype.slice.call(t.attributes).map(S=>({name:S.name,value:t.getAttribute(S.name).trim()})),p=c.find(S=>S.name==="target"&&S.value.length);if(p){c.length>2&&console.warn(`ui.js warning: all other attributes for "<script type=ui target="${p.value}"> will be ignored"`),await Ps(t,p.value,i),t.remove();continue}let f=c.filter(S=>S.name.includes("-"));if(f.length>1)throw`ui.js ERROR: more then one attribute with hyphens "<script ${f.map(S=>S.name).join(" ")}>"`;f.length===1?(f[0].value?(vc(t,c),await rr(f[0].name,f[0].value,i,typeof window<"u"&&window.nanoapp_dependencies)):(Is(t,c),await nr(t.innerText,f[0].name,i,typeof window<"u"&&window.nanoapp_dependencies)),t.remove()):(Is(t,c),await Ls(t,i))}}catch(t){throw new Ht(t)}}var or="0.7.6-dev";!or.endsWith("-dev")&&console.log(`ui.js \u2764\uFE0F ${or} alpha experiment. Make user interfaces great again!`);var Bs={VERSION:or,tags:Me,customElement:$t,createTag:yt,compile:sr,plugins:He},dp=Bs;typeof window<"u"&&(window.UIjs=Bs,document.addEventListener("DOMContentLoaded",Rs));})();
/**
 * WASM types
 *
 * https://github.com/WebAssembly/spec/tree/master/interpreter#s-expression-syntax
 *
 * Plus some extra C type mappings
 *
 * @author arthrubuldauskas@gmail.com
 * @license MIT
 */
/**
 * min.css
 *
 * min.css is a tiny, fast and efficient JavaScript library for minifying CSS
 * files that really makes your website faster
 *
 * Site: https://github.com/w3core/min.css/
 * Online: https://w3core.github.io/min.css/
 *
 * @version 1.3.1
 *
 * @license BSD License
 * @author Max Chuhryaev
 */
