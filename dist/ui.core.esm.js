var se="useandom-26T198340PX75pxJACKVERYMINDBUSHWOLF_GQZbfghjklqvwyzrict";var ne=(t=21)=>{let e="",r=t;for(;r--;)e+=se[Math.random()*64|0];return e},Tt=ne;var M=class extends Error{constructor(e){super(e),this.name="ui.js \u2764\uFE0F  brackets parse ERROR"}};function ie({open:t,close:e,pos:r,nodes:s},n,i){return{nodeType:"bracket",open:t,close:e,nodes:s,pos:Object.assign({},r,{end:n}),content:i.substring(r.start,n+1),innerContent:i.substring(r.start+1,n)}}function oe(t){let e=new Map;return t.forEach(([r,s=r])=>e.set(r,s)),{quotes:e}}function ae(t){let e={},r={};return t.forEach(([s,n])=>{r[s]=n,e[n]=s}),{opens:e,closes:r}}function lt(t){let{text:e,parent:r,start:s,end:n,opt:i}=t;if(s===n&&!i.includeEmpty)return;let o=i.pairs.reduce((f,p)=>f.concat(p.split("")),[]).map(f=>"".concat(i.escape).concat(f)),u=f=>o.reduce((p,c)=>p.split(c).join(c[1]),f),a=r.pos.depth+1;r.nodes.push({nodeType:"text",pos:{start:s,end:n,depth:a},content:u(e.substring(s,n))})}var ct=t=>{let e=t.pop();if(e===void 0)throw new M("LogicError :)");return e};function P(t,e){let s=Object.assign({pairs:["()","{}","[]"],nestMax:100,escape:"\\",skip:!1,includeEmpty:!1,quotes:['"',"'","`"]},e||{}),{pairs:n,nestMax:i,escape:o,skip:u}=s,{opens:a,closes:f}=ae(n),{quotes:p}=oe(s.quotes),c=[{nodeType:"root",nodes:[],pos:{start:0,end:0,depth:-1},content:t}],m=0,_=null,l=0;for(let w=0;w<t.length;w++){let b=ct(c),d=t[w],X=w>0&&t[w-1]===o;if(u&&["{","}","(",")","[","]"].includes(d)&&b.nodeType==="root")c.push(b);else if(u&&["{","(","["].includes(b.open)&&(d==="<"||d===">"))c.push(b);else if(X)c.push(b);else if(_!==null)_===d&&(_=null),c.push(b);else if(p.has(d))_=p.get(d),l=w,c.push(b);else if(f[d]!==void 0){if(c.length>=i)throw new M("over nest max limit. options: { nestMax: '".concat(s.nestMax,"' }"));lt({text:t,parent:b,start:m,end:w,opt:s}),c.push(b),c.push({nodeType:"bracket-open",pos:{start:w,depth:b.pos.depth+1},open:d,close:f[d],nodes:[]}),m=w+1}else if(a[d]!==void 0){if(b.nodeType==="root"||a[d]!==b.open)throw new M("404 pair '".concat(a[d],"' :").concat(w));let A=ct(c);lt({text:t,parent:b,start:m,end:w,opt:s});let N=ie(b,w,t);A.nodes.push(N),c.push(A),m=w+1}else c.push(b)}if(_!==null)throw new M("unclosed quote ".concat(_,' near "...').concat(t.substring(m-20,m+30),'..."'));let g=ct(c);if(g.nodeType!=="root")throw new M("404 pair '".concat(g.open,"' :").concat(g.pos.start));return lt({text:t,parent:g,start:m,end:t.length,opt:s}),g.nodes}function Nt(t){return[...t].reduce((e,r)=>(e.quote?(r===e.quote&&(e.quote=void 0),e.a[e.a.length-1]+=r):r==="="?e.a[e.a.length-1].length?e.a.push("="):e.a[e.a.length-1]="=":r===" "?e.a[e.a.length-1]!=="="&&e.a[e.a.length-1].length&&e.a.push(""):(['"',"'","`"].includes(r)&&(e.quote=r),e.a[e.a.length-1]+=r),e),{a:[""]}).a}function L(t,e="|",r=!1){let s=[...t].reduce((n,i)=>(n.quote?(i===n.quote&&(n.quote=void 0),n.a[n.a.length-1]+=i):i===e?n.a.push(""):(['"',"'","`"].includes(i)&&(n.quote=i),n.a[n.a.length-1]+=i),n),{a:[""]}).a;return r?s.filter(n=>n):s}function Ct(t,e="|"){var r=t.lastIndexOf(e);return[t.substr(0,r),t.substr(r+1)]}function St(t){if(['"',"'"].includes(t[0])&&t[0]===t[t.length-1]){for(var e=1;e<t.length-1;){if(t[e]===t[0]&&t[e-1]!=="\\")return!1;e++}return!0}return!1}function ue(t){return t.filter(e=>e.opts&&e.opts.length).forEach(e=>{e.opts2={};let r=e.opts.find(a=>a.type==="loop");if(r){let a=r.key;e.opts2.key=new Function("return ".concat(a))();let f=r.value.split(" as ");if(!f[1])throw"Alias for the loop not defined";let p=f[1].split(",");e.opts2.loop_fn=f[0].trim(),e.opts2.loop_alias=p[0].trim(),p[1]&&(e.opts2.loop_key_alias=p[1].trim())}let s=e.opts.find(a=>a.type==="text");s&&(St(s.value)?e.opts2.text=s.value.substring(1,s.value.length-1):e.opts2.textFn=s.value);let n=e.opts.find(a=>a.type==="html");n&&(St(n.value)?e.opts2.html=n.value.substring(1,n.value.length-1):e.opts2.htmlFn=n.value),["if","style","attrs","enterStyles","updateStyles","exitStyles","enterAttrs","updateAttrs","exitAttrs"].forEach(a=>{let f=e.opts.find(p=>p.type===a);f&&(e.opts2[a]=f.value)}),e.opts.filter(a=>a.type==="eventCallback").forEach(a=>{e.opts2.events||(e.opts2.events={});let f=a.key.substr(1);if(e.opts2.events[f])throw'ui.js compile error: Duplicate event name "'.concat(f,'"');a.value[0]==="("&&console.warn('"'.concat(a.key,'(" is deprecated. Use "').concat(a.key,'{" inside "').concat(e.content.length>40?e.content.substring(0,40)+"...":e.content,'" declaration')),a.value=a.value[0]==="("?a.value.substring(1,a.value.length-1).trim():a.value.trim(),a.value[0]==="{"?a.value=a.value.substring(0,a.value.length-1)+";this.render()}":a.value="("+a.value+")==this.render()",e.opts2.events[f]=a.value}),e.opts.filter(a=>a.type==="eventBind"||a.type==="eventBindSelfNamed").forEach(a=>{e.opts2.events||(e.opts2.events={});let f=a.key.substr(1);if(e.opts2.events[f])throw'ui.js compile error: Duplicate event name "'.concat(f,'"');e.opts2.events[f]=new Function("return (...args) => this.".concat(a.value,"(...args)"))()}),e.opts.filter(a=>a.type==="eventCallFunction").forEach(a=>{e.opts2.events||(e.opts2.events={});let f=a.key.substr(1);if(e.opts2.events[f])throw'ui.js compile error: Duplicate event name "'.concat(f,'"');e.opts2.events[f]="".concat(a.value).concat(a.args)})}),t.filter(e=>e.opts&&e.opts.length).forEach(e=>{e.opts2||(e.opts2={}),e.opts2.attrs2||(e.opts2.attrs2={},e.opts2.attrsB={},e.opts2.attrsR={}),e.opts.filter(i=>i.type==="booleanAttribute").forEach(i=>{e.opts2.attrs2[i.key]&&console.warn('ui.js compile warning: direct attibute "'.concat(i.key,'" override attrs({...').concat(i.key,'...}) declaration in tag ""!')),e.opts2.attrs2[i.key]=i.key,e.opts2.attrsB[i.key]=!0}),e.opts.filter(i=>i.type==="stringAttribute").forEach(i=>{e.opts2.attrs2[i.key]&&console.warn('ui.js compile warning: direct attibute "'.concat(i.key,'" override attrs({...').concat(i.key,'...}) declaration in tag ""!')),e.opts2.attrs2[i.key]=i.value}),e.opts.filter(i=>i.type==="jsAttribute").forEach(i=>{if(i.key[0]==="%"){var o=i.key.substr(1);e.opts2.attrsR[o]=i.value}else var o=i.key;e.opts2.attrs2[o]&&console.warn('ui.js compile warning: direct attibute "'.concat(o,'" override attrs({...').concat(o,'...}) declaration in tag ""!')),e.opts2.attrs2[o]=i.value.endsWith("%")?i.value:i})}),t.forEach(e=>{e.opts2&&e.opts2.attrs2&&!Object.keys(e.opts2.attrs2).length&&(delete e.opts2.attrs2,delete e.opts2.attrsB),e.opts2&&e.opts2.events&&!Object.keys(e.opts2.events).length&&delete e.opts2.events}),t}function x({AAA:t,item:e,tag:r,a:s},n="enter",i="enterStyles"){if(s===n&&t.length){let o=t.shift().content;if(o[0]==="("){if(e.opts.find(u=>u.type===n))throw"ui.js template parse error: duplicate ".concat(n,'() inside "<').concat(r,'>" declaration');e.opts.push({type:i,value:o.slice(1,-1)})}else if(o[0]==="{"){if(n==="if")throw'ui.js template parse error: expected "if(..." but "if'.concat(o[0],'..." found inside "<').concat(r,'>"');if(e.opts.find(u=>u.type===n))throw"ui.js template parse error: duplicate ".concat(n,'() inside "<').concat(r,'>" declaration');e.opts.push({type:i,value:o.slice(1,-1)})}else throw'ui.js template parse error: expected "'.concat(n,'{..." but "').concat(n).concat(o[0],'..." found inside "<').concat(r,'>"');return!0}return!1}function Mt(t){return t.filter(e=>e.nodeType==="bracket"&&e.innerContent[0]!=="/").forEach(e=>{e.opts=[];let r=P(e.innerContent).map(n=>({nodeType:n.nodeType,content:n.content.trim()}));var s="";do{let n=r.shift();if(n.nodeType==="bracket")if(e.opts.length){let i=e.opts[e.opts.length-1];if(i.type==="jsAttribute")i.value+=n.content;else throw'ui.js template parse error: unxpected brackets "'.concat(n.content,'" at the end of <').concat(s,"> attributes")}else throw'ui.js template parse error: unxpected brackets "'.concat(n.content,'" at the end of <').concat(s,"> attributes");else if(n.nodeType==="text"){let i=Nt(n.content);s||(s=i.shift());do{let o=i.shift();if(i[0]&&i[0][0]==="="){let u=i.shift().substr(1);if(o[0]==="@"){if(['"',"'","`"].includes(u[0]))throw"ui.js template parse error: quotes around ".concat(u," is prohibited");if(r.length&&r[0].nodeType==="bracket"&&!i.length){let a=r.shift();e.opts.push({type:"eventCallFunction",key:o,value:u,args:a.content})}else e.opts.push({type:"eventBind",key:o,value:u.endsWith("/")?u.substring(0,u.length-1):u})}else if(u.startsWith('"')&&u.endsWith('"')||u.startsWith("`")&&u.endsWith("`")||u.startsWith("'")&&u.endsWith("'"))e.opts.push({type:"stringAttribute",key:o,value:u.slice(1,-1)});else if(u.length){let a=u.endsWith("/")?u.substring(0,u.length-1):u;a.startsWith('"')&&a.endsWith('"')||a.startsWith("`")&&a.endsWith("`")||a.startsWith("'")&&a.endsWith("'")?e.opts.push({type:"stringAttribute",key:o,value:a.slice(1,-1)}):e.opts.push({type:"jsAttribute",key:o,value:a})}else{if(!r.length)throw'ui.js template parse error: unxpected end of attribute "...'.concat(o,'=" inside "<').concat(s,'>" declaration');let a=r.shift().content;a[0]==="{"?e.opts.push({type:"eueAttribute",key:o,value:a}):a[0]==="["?e.opts.push({type:"transitionAttribute",key:o,value:a}):e.opts.push({type:"jsAttribute",key:o,value:a.substring(1,a.length-1)})}}else if(o==="loop"&&r.length){let u=r.shift().content;if(u[0]==="("){if(e.opts.find(p=>p.type==="loop"))throw"ui.js template parse error: duplicate loop".concat(u,' inside "<').concat(s,'>" declaration');let[a,f]=Ct(u.slice(1,-1));if(f)e.opts.push({type:"loop",key:f,value:a});else throw'ui.js template parse error: non-keyed loop not supported yet. "loop'.concat(u,'" inside "<').concat(s,'>"')}else throw'ui.js template parse error: expected "loop(..." but "loop'.concat(u[0],'..." found inside "<').concat(s,'>" ')}else if(!x({AAA:r,item:e,tag:s,a:o},"if","if")){if(!x({AAA:r,item:e,tag:s,a:o},"style","style")){if(!x({AAA:r,item:e,tag:s,a:o},"attrs","attrs")){if(!x({AAA:r,item:e,tag:s,a:o},"enter","enterStyles")){if(!x({AAA:r,item:e,tag:s,a:o},"update","updateStyles")){if(!x({AAA:r,item:e,tag:s,a:o},"exit","exitStyles")){if(!x({AAA:r,item:e,tag:s,a:o},"#enter","enterAttrs")){if(!x({AAA:r,item:e,tag:s,a:o},"#update","updateAttrs")){if(!x({AAA:r,item:e,tag:s,a:o},"#exit","exitAttrs")){if(o==="text"&&r.length){let u=r.shift().content;if(u[0]==="("){if(e.opts.find(a=>a.type==="text"))throw'ui.js template parse error: duplicate text{c} inside "<'.concat(s,'>" declaration');e.opts.push({type:"text",value:u.slice(1,-1)})}else throw'ui.js template parse error: expected "text(..." but "text{c[0]}..." found inside "<'.concat(s,'>"')}else if(o==="html"&&r.length){let u=r.shift().content;if(u[0]==="("){if(e.opts.find(a=>a.type==="html"))throw'ui.js template parse error: duplicate html{c} inside "<'.concat(s,'>" declaration');e.opts.push({type:"html",value:u.slice(1,-1)})}else throw'ui.js template parse error: expected "html(..." but "html{c[0]}..." found inside "<'.concat(s,'>"')}else if(o)if(o[0]==="@")if(!i.length&&r[0]&&r[0].nodeType==="bracket"){let u=r.shift();e.opts.push({type:"eventCallback",key:o,value:u.content})}else o.endsWith("/")?e.opts.push({type:"eventBindSelfNamed",key:o.trim().slice(0,-1),value:o.trim().slice(1,-1)}):e.opts.push({type:"eventBindSelfNamed",key:o.trim(),value:o.trim().slice(1)});else{if(o==="=")throw'ui.js template parse error: unxpected end of attribute "'.concat(o,'" inside "<').concat(s,'>" declaration');o!=="/"&&e.opts.push({type:"booleanAttribute",key:o.endsWith("/")?o.slice(0,-1):o})}}}}}}}}}}}while(i.length)}}while(r.length)}),ue(t)}var pt={"!DOCTYPE":!0,"!doctype":!0,area:!0,base:!0,br:!0,col:!0,command:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,menuitem:!0,param:!0,source:!0,track:!0,wbr:!0,circle:!0,ellipse:!0,line:!0,path:!0,polygon:!0,polyline:!0,rect:!0,stop:!0,use:!0};function ht(t,e=[]){if(!e.length)return t;if(t[0]=="@"){if(t.length===1)throw"empty alias tag <@>";let r=e.find(s=>s.alias===t);if(r)t=r.name;else throw"alias <".concat(t,"> not defined")}return t}function dt(t,e){let r=e.find(s=>s.name===t);return r?r.alias:t}function fe(t,e){let r=[{children:[]}];if(r.last=()=>r[r.length-1],t.forEach(s=>{if(s.nodeType==="text"){var n=r[r.length-1];if(n.text)throw"children and text() attribute at the same time";n.children.push({tag:"#text",content:s.content})}else{var i=s.content.match(new RegExp("^<(@?[a-z][-a-z0-9]*)(\\s.*)?\\/>$","s"));if(i){var n=r[r.length-1];if(n.text)throw"children and text() attribute at the same time";n.children.push(Object.assign({tag:ht(i[1],e)},s.opts2))}else{var o=s.content.match(new RegExp("^<(@?[a-z][-a-z0-9]*)(\\s.*)?>$","s"));if(o)if(pt[o[1]]){let a=r[r.length-1];if(a.text)throw"children and text() attribute at the same time";a.children.push(Object.assign({tag:ht(o[1],e)},s.opts2))}else r.push(Object.assign({tag:ht(o[1],e),children:[]},s.opts2));else{var u=s.content.match(new RegExp("^<\\/(@?[a-z][-a-z0-9]*)(\\s.*)?>$","s"));if(u){if(pt[u[1]])throw"can't close self-closing tag \"</".concat(u[1],'>"');let a=r[r.length-2],f=r.pop();if(f.children.length===1&&f.children[0].tag==="#text"?(f.text=f.children[0].content,delete f.children):f.children.length||delete f.children,a){if(a.text)throw"children and text() attribute at the same time";let p=dt(f.tag,e),c=dt(u[1],e);if(p!==c)throw"the opening and closing tags are not the same <".concat(p,">...</").concat(c,">");a.children.push(f)}else throw!f.children||f.children[0].tag!==u[1]?"missing the opening tag for </".concat(u[1],">"):"closed twice tag <".concat(f.children[0].tag,">")}}}}}),r.length>1){let s=r.find(n=>n.tag);throw"Unclosed tag <".concat(dt(s.tag,e),">")}return r[0].children}var Ot=fe;var B={};B.animate=function(t,e,r,s,n,i,o){if(typeof t!="number"||typeof e!="number"||typeof r!="number"||typeof s!="function")return;typeof n=="string"&&h[n]&&(n=h[n]),typeof n!="function"&&(n=h.linear),typeof i!="function"&&(i=function(){});var u=window.requestAnimationFrame||function(m){window.setTimeout(m,1e3/60)},a=!1,f=e-t;function p(m){if(!a){var _=(m||+new Date)-c;_>=0&&s(n(_,t,f,r)),_>=0&&_>=r?(s(e),i(o,e)):u(p)}}if(s(t),f){var c=window.performance&&window.performance.now?window.performance.now():+new Date;u(p)}return{update:function(m,_,l){c=window.performance&&window.performance.now?window.performance.now():+new Date,t=m,e=_,f=e-t,typeof l=="string"&&h[l]&&(n=h[l])},cancel:function(){a=!0},last:e}};B.animateCSS=function(t,e,r,s,n,i,o,u){var a=function(f){t.style[e]=f+r};return B.animate(s,n,i,a,o,u)};B.cancel=function(t){t&&t.cancel()};var h=B.easings={};h.linear=function(t,e,r,s){return r*t/s+e};h.easeInQuad=function(t,e,r,s){return r*(t/=s)*t+e};h.easeOutQuad=function(t,e,r,s){return-r*(t/=s)*(t-2)+e};h.easeInOutQuad=function(t,e,r,s){return(t/=s/2)<1?r/2*t*t+e:-r/2*(--t*(t-2)-1)+e};h.easeInCubic=function(t,e,r,s){return r*(t/=s)*t*t+e};h.easeOutCubic=function(t,e,r,s){return r*((t=t/s-1)*t*t+1)+e};h.easeInOutCubic=function(t,e,r,s){return(t/=s/2)<1?r/2*t*t*t+e:r/2*((t-=2)*t*t+2)+e};h.easeInQuart=function(t,e,r,s){return r*(t/=s)*t*t*t+e};h.easeOutQuart=function(t,e,r,s){return-r*((t=t/s-1)*t*t*t-1)+e};h.easeInOutQuart=function(t,e,r,s){return(t/=s/2)<1?r/2*t*t*t*t+e:-r/2*((t-=2)*t*t*t-2)+e};h.easeInQuint=function(t,e,r,s){return r*(t/=s)*t*t*t*t+e};h.easeOutQuint=function(t,e,r,s){return r*((t=t/s-1)*t*t*t*t+1)+e};h.easeInOutQuint=function(t,e,r,s){return(t/=s/2)<1?r/2*t*t*t*t*t+e:r/2*((t-=2)*t*t*t*t+2)+e};h.easeInSine=function(t,e,r,s){return-r*Math.cos(t/s*(Math.PI/2))+r+e};h.easeOutSine=function(t,e,r,s){return r*Math.sin(t/s*(Math.PI/2))+e};h.easeInOutSine=function(t,e,r,s){return-r/2*(Math.cos(Math.PI*t/s)-1)+e};h.easeInExpo=function(t,e,r,s){return t==0?e:r*Math.pow(2,10*(t/s-1))+e};h.easeOutExpo=function(t,e,r,s){return t==s?e+r:r*(-Math.pow(2,-10*t/s)+1)+e};h.easeInOutExpo=function(t,e,r,s){return t==0?e:t==s?e+r:(t/=s/2)<1?r/2*Math.pow(2,10*(t-1))+e:r/2*(-Math.pow(2,-10*--t)+2)+e};h.easeInCirc=function(t,e,r,s){return-r*(Math.sqrt(1-(t/=s)*t)-1)+e};h.easeOutCirc=function(t,e,r,s){return r*Math.sqrt(1-(t=t/s-1)*t)+e};h.easeInOutCirc=function(t,e,r,s){return(t/=s/2)<1?-r/2*(Math.sqrt(1-t*t)-1)+e:r/2*(Math.sqrt(1-(t-=2)*t)+1)+e};h.easeInElastic=function(t,e,r,s){var n=0,i=r;if(t==0)return e;if((t/=s)==1)return e+r;if(n||(n=s*.3),i<Math.abs(r)){i=r;var o=n/4}else var o=n/(2*Math.PI)*Math.asin(r/i);return-(i*Math.pow(2,10*(t-=1))*Math.sin((t*s-o)*(2*Math.PI)/n))+e};h.easeOutElastic=function(t,e,r,s){var n=0,i=r;if(t==0)return e;if((t/=s)==1)return e+r;if(n||(n=s*.3),i<Math.abs(r)){i=r;var o=n/4}else var o=n/(2*Math.PI)*Math.asin(r/i);return i*Math.pow(2,-10*t)*Math.sin((t*s-o)*(2*Math.PI)/n)+r+e};h.easeInOutElastic=function(t,e,r,s){var n=0,i=r;if(t==0)return e;if((t/=s/2)==2)return e+r;if(n||(n=s*(.3*1.5)),i<Math.abs(r)){i=r;var o=n/4}else var o=n/(2*Math.PI)*Math.asin(r/i);return t<1?-.5*(i*Math.pow(2,10*(t-=1))*Math.sin((t*s-o)*(2*Math.PI)/n))+e:i*Math.pow(2,-10*(t-=1))*Math.sin((t*s-o)*(2*Math.PI)/n)*.5+r+e};h.easeInBack=function(t,e,r,s,n){return n==null&&(n=1.70158),r*(t/=s)*t*((n+1)*t-n)+e};h.easeOutBack=function(t,e,r,s,n){return n==null&&(n=1.70158),r*((t=t/s-1)*t*((n+1)*t+n)+1)+e};h.easeInOutBack=function(t,e,r,s,n){return n==null&&(n=1.70158),(t/=s/2)<1?r/2*(t*t*(((n*=1.525)+1)*t-n))+e:r/2*((t-=2)*t*(((n*=1.525)+1)*t+n)+2)+e};h.easeInBounce=function(t,e,r,s){return r-h.easeOutBounce(s-t,0,r,s)+e};h.easeOutBounce=function(t,e,r,s){return(t/=s)<1/2.75?r*(7.5625*t*t)+e:t<2/2.75?r*(7.5625*(t-=1.5/2.75)*t+.75)+e:t<2.5/2.75?r*(7.5625*(t-=2.25/2.75)*t+.9375)+e:r*(7.5625*(t-=2.625/2.75)*t+.984375)+e};h.easeInOutBounce=function(t,e,r,s){return t<s/2?h.easeInBounce(t*2,0,r,s)*.5+e:h.easeOutBounce(t*2-s,0,r,s)*.5+r*.5+e};var E=B;var le={},j=le;var $={duration:500};function _t(t,e,r){var s=t[e];if(e<r)for(;e<r;e++)t[e]=t[e+1];else for(;e>r;e--)t[e]=t[e-1];t[r]=s}function F(t,e){if(typeof j[t.tag]=="function")var r=new j[t.tag](e,t);else if(t.svg)var r=document.createElementNS("http://www.w3.org/2000/svg",t.tag);else var r=document.createElement(t.tag);return Object.assign(r,{_attrs:{},_styles:{},_attrsV:{},_styleV:{},_colors:{},_events:{}}),r}function Pt(t,e,r){e._BASE_ELEMENT?r?t._childNodes.splice(t._childNodes.findIndex(s=>s===r)+1,0,e):t._childNodes.unshift(e):r?r.after(e):t.prepend(e)}function U(t,e){e._BASE_ELEMENT?t._childNodes.unshift(e):t.prepend(e)}function V(t,e,r){var c;var s=void 0,n="linear",i=void 0,o=void 0,u=void 0;if(typeof r=="object"){var a=r.duration||$.duration,f=r.to;r.ease&&(n=r.ease),r.fn&&(i=r.fn),r.done&&(o=r.done),r.from!==void 0&&(s=r.from),r.default!==void 0&&(u=r.default)}else var a=$.duration,f=r;if(s===void 0){var p=t.__rendererName?t.state[e]:t.getAttribute(e);s=p==null?u||0:Number(p)}E.cancel(t._attrs[e]),i?(s=((c=t._attrs[e])==null?void 0:c.last)||0,t._attrs[e]=E.animate(s,f,a,m=>{t.setAttribute(e,i(m))},n,o,t)):t._attrs[e]=E.animate(s,f,a,m=>{t.setAttribute(e,m)},n,o,t)}function ce(t,e,r){var s="linear",n=0;if(typeof r=="object"){var i=r.duration||$.duration,o=r.to;r.ease&&(s=r.ease),r.delay&&(n=r.delay)}else var i=$.duration,o=r;t._colors[e]=e+" "+i+"ms "+s+" "+n+"ms",clearTimeout(t._styles[e]),t._styles[e]=setTimeout(()=>{delete t._colors[e];var a=Object.values(t._colors).join(",");t._transition!=a&&(t._transition=a,t._transition?t.style.setProperty("transition",t._transition):t.style.removeProperty("transition"))},i+n);var u=Object.values(t._colors).join(",");t._transition!=u&&(t._transition=u,t._transition?t.style.setProperty("transition",t._transition):t.style.removeProperty("transition")),t.style.getPropertyValue(e)||t.style.setProperty(e,"#000000"),t.style.setProperty(e,getComputedStyle(t)[e]),setTimeout(()=>{t.style.setProperty(e,o)},0)}function Y(t,e,r){if(["color","background","fill","stroke","background-color","border-color"].includes(e)){ce(t,e,r);return}var s="linear",n=void 0,i=void 0,o=0,u="",a=void 0,f=void 0;if(typeof r=="object"){if(typeof r.duration=="function"&&(r.duration=r.duration()),r.duration===0&&r.to){E.cancel(t._styles[e]),t.style.setProperty(e,r.to);return}var p=r.duration||$.duration,c=r.to;r.from!==void 0&&(i=r.from),r.default!==void 0&&(f=r.default),r.ease&&(s=r.ease),r.done&&(n=r.done),r.threshold!==void 0&&(o=r.threshold),r.fn&&(a=r.fn)}else var p=$.duration,c=r;var m=e.startsWith("--"),_=m?t.style.getPropertyValue(e):t.style[e];if(!_&&f&&(_=f),typeof c=="string"?["px","%","deg","vw","vh","em"].some(l=>{if(c.endsWith(l))return i!==void 0?i.endsWith(l)&&(i=Number(i.substring(0,i.length-l.length))):i=Number(_.substring(0,_.length-l.length)),c=Number(c.substring(0,c.length-l.length)),u=l,!0})||(c=Number(c)):i===void 0&&(i=Number(_)),o&&Math.abs(i-c)<o){E.cancel(t._styles[e]),t.style.setProperty(e,r.to);return}E.cancel(t._styles[e]),a?t._styles[e]=E.animate(i,c,p,l=>{t.style.setProperty(e,a(l+u))},s,n,t):t._styles[e]=E.animate(i,c,p,l=>{t.style.setProperty(e,l+u)},s,n,t)}function Lt(t,e,r,s,n){return typeof n!="object"?(t.setAttribute(s,n),$.duration):(V(t,s,n),n.duration?n.duration:$.duration)}function Bt(t,e,r,s,n){return Y(t,s,n),n.duration?n.duration:$.duration}function Ft(t,e,r,s,n,i){var o=0,u=0;if(e.exitAttrs){var a=e.exitAttrs(r);typeof a=="object"&&(u=Object.entries(a).reduce((p,c)=>Math.max(Lt(t,e,r,c[0],c[1]),p),0))}if(e.exitStyles){var f=e.exitStyles(r);typeof f=="object"&&(o=Object.entries(f).reduce((p,c)=>Math.max(Bt(t,e,r,c[0],c[1]),p),0))}if(t.isExit=!0,o>0||u>0){let p=setTimeout(()=>i.Done.then(()=>{H(t),n.exit.delete(s)}),o>u?o:u);n.exit.set(s,{element:t,timeout:p});return}clearTimeout(n.exit[s]),H(t)}function Ut(t,e,r,s,n){var i=0,o=0;if(e.exitAttrs){var u=e.exitAttrs(r);typeof u=="object"&&(o=Object.entries(u).reduce((f,p)=>Math.max(Lt(t,e,r,p[0],p[1]),f),0))}if(e.exitStyles){var a=e.exitStyles(r);typeof a=="object"&&(i=Object.entries(a).reduce((f,p)=>Math.max(Bt(t,e,r,p[0],p[1]),f),0))}if(t.isExit=!0,i>0||o>0){let f=setTimeout(()=>s.Done.then(()=>{s.__i__[n]=!1,H(t)}),i>o?i:o);return s.__i__[n]={exit:f},!1}return clearTimeout(s.__i__[n]),s.__i__[n]=!1,H(t),!0}async function H(t){if(t.nodeName==="#text"){console.log("TEXT");return}if(t.__i__)for(let r of Object.values(t.__i__))clearTimeout(r.exit);for(let r of Object.values(t._attrs))r!=null&&r.cancel&&r.cancel();for(let r of Object.values(t._styles))r!=null&&r.cancel&&r.cancel();let e=t.__rendererName?t.document._childNodes:t.children;for(;e.length;){let r=e[e.length-1];await H(r)}await t.remove()}function I(t,e,r,s,n,i,o){var u=n.keys,a=n.elements,f=n.exit,p=a.length,c=o.length,m=p>c?p:c,_=0,l=0,g=0;do{if(l<c){var w=t.key(o[l],l);if(l>=p){p++,m=p>c?p:c;var b=f.get(w);if(b){clearTimeout(b.timeout);var d=b.element;delete d.isExit,t.svg||(d.className=""),f.delete(w)}else var d=F(t,e);if(s[t.loop_alias]=o[l],t.loop_key_alias&&(s[t.loop_key_alias]=l),z(d,t,s,y,b),l===0)if(f.size)for(let S of f){S[1].element.before(d);break}else r?r.after(d):U(e,d);else a[l-1].after(d);a.splice(l,0,d),d.key=w,u[w]=!0,l++;continue}else{var X=a[l].key;if(w===X){s[t.loop_alias]=o[l],t.loop_key_alias&&(s[t.loop_key_alias]=l),t.Update_Tag(a[l],t,s,y),l++;continue}else if(u[w]){var A=void 0,N=void 0;let S;for(var qe=void 0,v=l+1;v<m;v++)if(!A&&v<p&&a[v].key===w&&(A=v+1),!N&&v<c&&t.key(o[v],v)===X&&(N=v+1),A&&N){var C=a[l];if(A>=N)S=a[A-1],e.insertBefore(S,C),s[t.loop_alias]=o[l],t.loop_key_alias&&(s[t.loop_key_alias]=l),t.Update_Tag(S,t,s,y),A===N?(v-l>1&&(A>=a.length?a[v-1].after(C):e.insertBefore(C,a[A])),a[l]=a[v],a[v]=C):(_t(a,A-1,l),_++),l++;else{S=!0;var q=N-1+_;if(q>=a.length)a[a.length-2].after(C);else{if(!a[q])throw 9999999999;e.insertBefore(C,a[q])}_t(a,l,(q>p?p:q)-1),s[t.loop_alias]=o[l],t.loop_key_alias&&(s[t.loop_key_alias]=l),t.Update_Tag(C,t,s,y)}break}if(S)continue}else{p++,m=p>c?p:c;var b=f.get(w);if(b)clearTimeout(b.timeout),d=b.element,delete d.isExit,t.svg||(d.className=""),f.delete(w);else var d=F(t,e);s[t.loop_alias]=o[l],t.loop_key_alias&&(s[t.loop_key_alias]=l),z(d,t,s,y,b),l===0?r?r.after(d):U(e,d):a[l-1].after(d),a.splice(l,0,d),d.key=w,u[w]=!0,l++;continue}}}delete u[a[l].key],t.loop_key_alias&&(s[t.loop_key_alias]=l+g,g++),Ft(a[l],t,s,a[l].key,n,e),a.splice(l,1),p--,m=p>c?p:c}while(l<m);return n.length=a.length,f.size+n.length}function pe(){return{ret_element:function(t,e,r,s){return t},children:function(t,e,r,s){s.UPDATE_Chidldren(t,e.children,r)},fn_text:function(t,e,r,s){var n=e.text(r);if(!t){console.log("NOT element.__lastText",t),console.trace();return}t.__lastText!==n&&(t.textContent=t.__lastText=n)},fn_html:function(t,e,r,s){var n=e.html(r);t.__lastHTML!==n&&(t.innerHTML=t.__lastHTML=n)},updateProps:function(t,e,r,s){e.updateProps(t,e,r,s)}}}function Z(t){var e=[],r=pe();return t.tag==="#text"?(e.push(r.ret_element),e):(t.children?e.push(r.children):t.html?typeof t.html=="function"&&e.push(r.fn_html):t.text&&typeof t.text=="function"&&e.push(r.fn_text),t.updateProps&&(e=[...e,...t.updateProps]),e.push(r.ret_element),e)}function he(t,e,r,s,n,i){return e.Update_Tag(t.__rendererName?t._childNodes[n]:t.childNodes[n],e,r,y),n+1}function de(t,e,r,s,n,i){let o=e.loop(r);if(!i||i.length===0){if(!i||i.exit.size===0)return o.length?s===0?(e.enter(e,t,void 0,r,s,o,y),n+t.__i__[s].length):(e.enter(e,t,n===0?void 0:t.__rendererName?t._childNodes[n-1]:t.childNodes[n-1],r,s,o,y),n+t.__i__[s].length):n;if(o.length){let u=I(e,t,s===0||n===0?void 0:t.__rendererName?t._childNodes[n]:t.childNodes[n],r,i,s,o);return n+u}else return n+i.exit.size}else if(o.length){let u=I(e,t,s===0||n===0?void 0:t.__rendererName?t._childNodes[n-1]:t.childNodes[n-1],r,i,s,o);return n+u}else{let u=I(e,t,s===0||n===0?void 0:t.__rendererName?t._childNodes[n]:t.childNodes[n],r,i,s,o);return n+u}}function _e(t,e,r,s,n,i){if(i===!1)if(e.if(r)){let a=F(e,t);if(e.children)T(a,e.children,r);else if(e.text){var o=typeof e.text=="function"?e.text(r):e.text;a.__lastText!==o&&(a.textContent=a.__lastText=o)}else if(e.html){var u=typeof e.html=="function"?e.html(r):e.html;a.__lastHTML!==u&&(a.innerHTML=a.__lastHTML=u)}return e.enterProps&&e.enterProps(a,e,r,y),n===0?U(t,a):t.__rendererName?t._childNodes[n-1].after(a):t.childNodes[n-1].after(a),t.__i__[s]={exit:!1},n+1}else return n;else{if(e.if(r))return i.exit?(clearTimeout(i.exit),e.enterProps&&e.enterProps(t.__rendererName?t._childNodes[n]:t.childNodes[n],e,r,y),t.__i__[s]={exit:!1},n+1):(e.Update_Tag(t.__rendererName?t._childNodes[n]:t.childNodes[n],e,r,y),n+1);if(i.exit)return n+1;{let a=t.__rendererName?t._childNodes:t.childNodes;return Ut(a[n],e,r,t,s)?n:n+1}}}function me(t,e,r,s,n,i){if(i===!1||i.length===0)if(e.if(r)){let o=e.loop(r);return o.length?s===0?(e.enter(e,t,void 0,r,s,o,y),n+t.__i__[s].length):(e.enter(e,t,n===0?void 0:t.__rendererName?t._childNodes[n-1]:t.childNodes[n-1],r,s,o,y),n+t.__i__[s].length):n}else return n;else if(e.if(r)){let o=e.loop(r),u=I(e,t,s===0&&n===0?void 0:t.__rendererName||t.__rendererName?t._childNodes[n]:t.childNodes[n],r,i,s,o);return n+u}else{if(i.length===0)return n+i.exit.size;{let o=I(e,t,s===0&&n===0?void 0:t.__rendererName?t._childNodes[n]:t.childNodes[n],r,i,s,[]);return n+o}}}function k(t,e,r){if(!t.isExit){var s=void 0;t.Done=new Promise(i=>s=i);var n=0;e.every((i,o)=>{if(!t.__i__)return console.groupCollapsed("Not initialized element!!! "+i.tag),console.dir(t),console.log("component",e),console.log("tag",i),console.trace(),console.groupEnd(),!1;let u=t.__i__[o];return i.tag==="#text"?(n++,!0):(i.hasOwnProperty("if")?i.loop?n=me(t,i,r,o,n,u):n=_e(t,i,r,o,n,u):i.loop?n=de(t,i,r,o,n,u):n=he(t,i,r,o,n,u),!0)}),s()}}function Q(t,e){return!!(t==="input"&&["checked","autofocus","readonly","required","disabled","multiple"].includes(e)||t==="option"&&["selected"].includes(e)||t==="button"&&["disabled","multiple"].includes(e)||t==="select"&&["disabled"].includes(e))}function Vt(t,e,r,s){var i,o;if(t.tag==="input"&&r==="value")e._attrsV[r]!==s&&(e._attrsV[r]=s,e.value!=s&&(e.value=s));else if(r==="class"){if(typeof s=="object"&&s!==null)throw"Cannot do transition on class attribute";var n=s||void 0;e._attrsV[r]!==n&&(e._attrsV[r]=n,n?t.svg?e.setAttribute(r,n):e.className=n:e.removeAttribute(r))}else if(r==="style"){if(typeof s=="object"&&s!==null)throw"Cannot do transition on style attribute";var n=s||void 0;e._attrsV[r]!==n&&(e._attrsV[r]=n,n?e.setAttribute(r,n):e.removeAttribute(r))}else(typeof s=="object"||e._attrsV[r]!==s||Array.isArray(s))&&(Q(t.tag,r)?(e._attrsV[r]=s,t.tag==="input"&&t.attrs2.type==="radio"&&r==="checked"&&!t.attrsB[r]?t.attrs2.value?t.attrs2.value==s?(e.setAttribute(r,""),e[r]=r):(e.removeAttribute(r),e[r]=""):s?(e.setAttribute(r,""),e[r]=r):(e.removeAttribute(r),e[r]=""):s?e.setAttribute(r,"")||(e[r]=r):e.removeAttribute(r)||(e[r]="")):t.tag==="textarea"&&r==="value"?e.value=s:(!t.attrs3||!t.attrs3[r])&&typeof s=="object"?s!=null&&s.skip||e._attrsV[r]!==s.to&&(e._attrsV[r]=s.to,s!=null&&s.disabled?((i=e._attrs[r])!=null&&i.cancel&&e._attrs[r].cancel(),e.setAttribute(r,s.to)):V(e,r,s)):e._attrsV[r]!==s&&(e._attrsV[r]=s,(o=e._attrs[r])!=null&&o.cancel&&e._attrs[r].cancel(),e.setAttribute(r,s)))}function we(){return{updateAttrs:function(t,e,r,s){Object.entries(e.updateAttrs(r)).forEach(([n,i])=>{s.updateAttribute(e,t,n,i)})},attrs3:function(t,e,r,s){Object.entries(e.attrs3).forEach(([n,i])=>{s.updateAttribute(e,t,n,typeof i=="function"?i(r):i)})},updateStyles:function(t,e,r,s){Object.entries(e.updateStyles(r)).forEach(([n,i])=>{var o;typeof i=="object"?t._styleV[n]!==i.to&&(i!=null&&i.skip||(t._styleV[n]=i.to,i!=null&&i.disabled?((o=t._styles[n])!=null&&o.cancel&&t._styles[n].cancel(),t.style.setProperty(n,i.to)):s.animateCSS(t,n,i))):t._styleV[n]!==i&&(t._styleV[n]=i,t.style.setProperty(n,i))})},style:function(t,e,r,s){Object.entries(e.style(r)).forEach(([n,i])=>{t._styleV[n]!==i&&(t._styleV[n]=i,t.style.setProperty(n,i))})},events:function(t,e,r,s){t.__datum={...r}}}}function tt(t){let e=[],r=we();return t.updateAttrs&&e.push(r.updateAttrs),t.attrs3&&e.push(r.attrs3),t.style&&e.push(r.style),t.updateStyles&&e.push(r.updateStyles),t.events&&e.push(r.events),e}function Rt(t,e,r,s){var i;if(r==="class"){var n=s||void 0;e._attrsV[r]=n,n&&(t.svg?e.setAttribute(r,n):e.className=n)}else if(r==="style"){var n=s||void 0;e._attrsV[r]=n,n&&e.setAttribute(r,n)}else r==="id"?(e._attrsV[r]=s,e.id=s,e.setAttribute(r,s)):Q(t.tag,r)?t.tag==="input"&&t.attrs2.type==="radio"&&r==="checked"&&!t.attrsB[r]?t.attrs2.value?t.attrs2.value==s&&(e.setAttribute(r,""),e._attrsV[r]=s&&!0):s&&(e.setAttribute(r,""),e._attrsV[r]=s&&!0):(e._attrsV[r]=s&&!0,s&&e.setAttribute(r,"")):t.tag==="textarea"&&r==="value"?(e._attrsV[r]=s,e.innerHTML=s):((i=e._attrs[r])!=null&&i.cancel&&e._attrs[r].cancel(),e._attrsV[r]=s,e.setAttribute(r,s))}function be(){return{enterAttrs:function(t,e,r,s){Object.entries(e.enterAttrs(r)).forEach(([n,i])=>{var o;if(Array.isArray(i))throw"not implemented";typeof i=="object"?(t._attrsV[n]=i,s.animateAttr(t,n,i)):((o=t._attrs[n])!=null&&o.cancel&&t._attrs[n].cancel(),s.enterAttribute(e,t,n,i))})},attrs:function(t,e,r,s){var n=e.attrs?e.attrs(r):{};e.attrs2&&Object.entries(e.attrs2).forEach(([i,o])=>{n[i]=typeof o=="function"?o(r):o}),Object.entries(n).forEach(([i,o])=>{s.enterAttribute(e,t,i,o)})},enterStyles:function(t,e,r,s){Object.entries(e.enterStyles(r)).forEach(([n,i])=>{var o;if(Array.isArray(i))throw"not implemented";typeof i=="object"?(t._styleV[n]=i.to,s.animateCSS(t,n,i)):(t._styleV[n]=i,(o=t._styles[n])!=null&&o.cancel&&t._styles[n].cancel(),t.style.setProperty(n,i))})},style:function(t,e,r,s){Object.entries(e.style(r)).forEach(([n,i])=>{t._styleV[n]=i,t.style.setProperty(n,i)})},events:function(t,e,r,s){t.__datum={...r},Object.entries(e.events).forEach(([n,i])=>{t._events[n]=o=>i(o,t.__datum,t),t.addEventListener(n,t._events[n])})}}}function et(t){let e=[],r=be();return t.enterAttrs&&e.push(r.enterAttrs),(t.attrs||t.attrs2)&&e.push(r.attrs),t.style&&e.push(r.style),t.enterStyles&&e.push(r.enterStyles),t.events&&e.push(r.events),e}var ye={createElement:F,insertElement:Pt,prependElement:U,Enter_Children:T,UPDATE_Chidldren:k,Update_Tag:Z,animateAttr:V,animateCSS:Y,enterProps:et,enterAttribute:Rt,updateProps:tt,updateAttribute:Vt},y=ye;function Dt(t){return(e,r,s,n,i,o,u)=>{var a={},f=new Map,p=[],c=s;return o.forEach((m,_)=>{var l=u.createElement(e,r);l.key=e.key(m,_),a[l.key]=!0,p.push(l),n[e.loop_alias]=m,e.loop_key_alias&&(n[e.loop_key_alias]=_),e.enterProps&&e.enterProps(l,e,n,u),e.children?u.Enter_Children(l,e.children,n):(e.text&&(typeof e.text=="function"?l.textContent=l.__lastText=e.text(n):l.textContent=l.__lastText=e.text),e.html&&(typeof e.html=="function"?l.innerHTML=l.__lastHTML=e.html(n):l.innerHTML=l.__lastHTML=e.html)),_===0&&!c?u.prependElement(r,l):c.after(l),c=l}),r.__i__[i]={length:o.length,exit:f,elements:p,keys:a},c}}function ve(t,e,r,s){t.__i__={},e.forEach((n,i)=>{if(n.if&&!n.if(r)){t.__i__[i]=!1;return}if(n.loop){if(n.loop(r).length)throw 123;t.__i__[i]=!1;return}else{let o=t.__rendererName?t._childNodes:t.children;z(o[i],n,r,s,!0);return}})}function z(t,e,r,s,n){return e.enterProps&&e.enterProps(t,e,r,s),e.children?n?ve(t,e.children,r,s):T(t,e.children,r):(e.text&&(typeof e.text=="function"?t.textContent=t.__lastText=e.text(r):t.textContent=t.__lastText=e.text),e.html&&(typeof e.html=="function"?t.innerHTML=t.__lastHTML=e.html(r):t.innerHTML=t.__lastHTML=e.html)),t}function Wt(t,e,r,s,n){return t.element=document.createTextNode(t.content),r?r.after(t.element):e.prepend(t.element),e.__i__[n]={exit:!1},t.element}function qt(t){return(e,r,s,n,i,o,u)=>{var a=u.createElement(e,r);return e.enterProps&&e.enterProps(a,e,n,u),e.text&&(typeof e.text=="function"?a.textContent=a.__lastText=e.text(n):a.textContent=a.__lastText=e.text),e.html&&(typeof e.html=="function"?a.innerHTML=a.__lastHTML=e.html(n):a.innerHTML=a.__lastHTML=e.html),u.insertElement(r,a,s),r.__i__[i]={exit:!1},a}}function Ht(t){return(e,r,s,n,i,o,u)=>{var a=u.createElement(e,r);return e.enterProps&&e.enterProps(a,e,n,u),u.insertElement(r,a,s),u.Enter_Children(a,e.children,n),r.__i__[i]={exit:!1},a}}function T(t,e,r){t.__i__={};var s;e.forEach((n,i)=>{if(n.if&&!n.if(r)){t.__i__[i]=!1;return}if(n.loop){let o=n.loop(r);if(o.length){s=n.enter(n,t,s,r,i,o,y);return}else{t.__i__[i]=!1;return}}else{s=n.enter(n,t,s,r,i,void 0,y);return}})}function It(t){if(t.tag==="#text"){t.enter=Wt;return}t.enterProps=et(t),t.updateProps=tt(t),t.Update_Tag=Z(t),t.loop?t.enter=Dt(t):t.enter=t.children?Ht(t):qt(t)}var Ee=["svg","g","path","polygon","rect","circle","line","clipPath","cursor","defs","desc","ellipse","filter","font","glyph","image","text","textPath","animate","animateMotion","animateTransform"],rt=(t,e)=>new Function("return ({ ".concat(t.context.join(",")," }) => ").concat(t[e]))(),Ae=(t,e)=>new Function("return ({ ".concat(t.context.join(",")," }) => ({").concat(t[e],"})"))(),st=(t,e,r)=>new Function("return (event, { ".concat(t.context.join(",")," }, element) => {setTimeout(()=>this.render(),0);").concat(e," = event.target.").concat(r,"} "))(),ge=(t,e)=>new Function("return async (event, { ".concat(t.context.join(",")," }, element) => ").concat(e))(),$e=(t,e)=>new Function("return ({ ".concat(t.context.join(",")," }) => ").concat(e.value+(e.args||"")))();function mt(t,e,r){return t.forEach((s,n)=>{Ee.includes(s.tag)&&(s.svg=!0),s.context=[...e],s.loop_alias&&(s.loop=rt(s,"loop_fn"),s.context.push(s.loop_alias),s.loop_key_alias&&s.context.push(s.loop_key_alias)),s.textFn&&(s.text=rt(s,"textFn"),delete s.textFn),s.htmlFn&&(s.html=rt(s,"htmlFn"),delete s.htmlFn),s.if&&(s.if=rt(s,"if")),["style","attrs","enterStyles","updateStyles","exitStyles","enterAttrs","updateAttrs","exitAttrs"].forEach(i=>{s[i]&&(s[i]=Ae(s,i))}),s.events&&Object.entries(s.events).forEach(([i,o])=>{typeof o=="string"&&(s.events[i]=ge(s,o))}),s.attrsR&&Object.keys(s.attrsR).length&&Object.entries(s.attrsR).forEach(([i,o])=>{if(s.events||(s.events={}),s.events.input)throw"@input and reactive attr at the same time";s.tag==="input"?i==="value"?s.events.input=st(s,o,"value"):i==="checked"&&(s.attrs2.type==="checkbox"?s.events.input=st(s,o,"checked"):s.attrs2.type==="radio"&&(s.events.input=st(s,o,"value"))):s.tag==="textarea"&&i==="value"&&(s.events.input=st(s,o,"value"))}),s.attrs2&&(Object.keys(s.attrs2).length&&(s.attrs3={}),Object.entries(s.attrs2).forEach(([i,o])=>{typeof o=="object"&&o.type==="jsAttribute"&&(s.attrs3[i]=s.attrs2[i]=$e(s,o))}),Object.keys(s.attrs3).length||delete s.attrs3),It(s),s.children&&mt(s.children,s.context,r)}),t}function xe(t){return t.filter(e=>{if(e.nodeType==="bracket"){let r=e.innerContent.split(" ").join("");if(["","/","@","@/","/@"].includes(r))throw"Empty tag <".concat(r,">")}return!(e.nodeType==="text"&&!e.content.trim().length)})}function je(t=""){return xe(P(t,{skip:!0,pairs:["<>","{}","()","[]"]}))}function zt(t,e=[],r=!1){return mt(Ot(Mt(je(t)),e),["state"],r)}var Te="static|template|state|class|style|walt";function Ne(t){return t.split(/\r\n|\n|\r/)}function Ce(t,e){let r=t.match(new RegExp("^\\s*<!(".concat(e,")>\\s*$"),"i"));return r?r[1]:null}function Se(t,e){let r=t.match(new RegExp("^\\s*<!".concat(e,"\\s+([^>]*)>\\s*$"),"i"));return r?r[1]:null}async function Me(t){let e=Ne(t),r={};var s=void 0,n=0;for(let i=0;i<e.length;i++){let o=e[i];if(!o.trim().length)continue;let u=Ce(o,Te);if(!(!u&&["css","import","tag","renderer"].some(a=>{let f=Se(o,a);if(f)return s=a,r[s]||(r[s]=[]),r[a].push(s==="tag"?{value:f,line:i}:f),!0}))){if(!s&&!u){s="template",n=i,r.template="",r.template+="\n"+o;continue}if(u){if(s=u,!r[u])r[u]="";else throw"duplicate <!".concat(u,"> block at line ").concat(i);continue}else{if(["css","import","tag","renderer"].includes(s))if(!r.template)s="template",n=i,r.template="";else{if(o.trim().startsWith("//"))continue;throw'unexpected "'.concat(o.trim(),'" at line ').concat(i,". Template started at line ").concat(n)}r[s]+="\n"+o;continue}}}return r}function O(t){return['"',"'","`"].includes(t[0])&&t[0]==t[t.length-1]?t.substring(1,t.length-1).trim():t.trim()}function Oe(t){let e={},r=L(t.value," ",!0).map(O);if(r.length>2)throw"excess arguments <!tag ".concat(t.value,"> at line ").concat(t.line);if(r.some(s=>!s))throw"empty argument <!tag ".concat(t.value,"> at line ").concat(t.line);if(r.length===1){if(r[0][0]==="@")throw"alias is present but path is not <!tag ".concat(t.value,"> at line ").concat(t.line);e.alias="@"+r[0].split("\\").pop().split("/").pop(),e.path=r[0]}else{if(r[0][0]!=="@")throw'missing alias identifier "@" <!tag '.concat(t.value,"> at line ").concat(t.line);e.alias=r[0],e.path=r[1]}return e}function Pe(t){if(L(t," ",!0).length>1)throw"excess parameters <!import ".concat(t,">");return O(t)}function Le(t){let e=L(t," ",!0);if(e.length>2)throw"excess parameters <!renderer ".concat(t,">");if(e.length==2&&e[1]!=="html")throw"unknown second parameter <!renderer ".concat(t,">");return O(t)}function nt(t){try{Function("var "+t)}catch(e){return!1}return!0}function Be(t){let e=L(t," ",!0);if(e.length<3)throw"not enough parameters <!import ".concat(t,">");if(e.length===3){if(e[1].toLowerCase()!=="from")throw"wrong parameters <!import ".concat(t,">");if(e[0].startsWith("{")&&e[0].endsWith("}")){let s=e[0].substring(1,e[0].length-1);if(!s.length)throw"wrong parameters <!import ".concat(t,">");if(!s.split(",").map(i=>i.trim()).every(nt))throw"invalid variable name <!import ".concat(t,">");return{type:"object",import:e[0],path:O(e[2])}}else{if(!nt(e[0]))throw"invalid variable name <!import ".concat(t,">");return{type:"var",import:e[0],path:O(e[2])}}}else{try{var r=P(t,{pairs:["{}"]})}catch(s){throw"invalid variable name <!import ".concat(t,">")}if(r.length>2)throw"wrong parameters <!import ".concat(t,">");if(r.length===1){if(r[0].nodeType==="bracket")throw"wrong parameters <!import ".concat(t,">");if(e[0]==="*"&&e[1].toLowerCase()==="as"&&e[3].toLowerCase()==="from"&&e.length===5){if(!nt(e[2]))throw"invalid variable name <!import ".concat(t,">");return{type:"*",import:e[2],path:O(e[4])}}else throw"wrong parameters <!import ".concat(t,">")}else{let s=L(r[1].content," ",!0);if(s.length!==2||s[0].toLowerCase()!=="from"||!r[0].innerContent.trim().length)throw"wrong parameters <!import ".concat(t,">");let n=r[0].innerContent.split(",").map(i=>i.trim());if(!n.every(nt))throw"invalid variable name <!import ".concat(t,">");return{type:"object",import:"{"+n.join(",")+"}",path:O(s[1])}}}}async function Qt(t){let e=await Me(t);return e.tag&&(e.tag=e.tag.map(Oe)),e.css&&(e.css=e.css.map(Pe)),e.import&&(e.import=e.import.map(Be)),e.renderer&&(e.renderer=e.renderer.map(Le)),e}var Jt=(...t)=>t.filter(e=>typeof e=="function").reduce((e,r)=>e===null?r:function(...n){e.apply(this,n),r.apply(this,n)},null);function Fe(t){return["Update_Tag","enterProps","updateProps"].forEach(e=>{Array.isArray(t[e])&&(t[e].length?t[e]=Jt(...t[e]):delete t[e])}),t}function wt(t){t.forEach((e,r)=>{t[r]=Fe(e),e.children&&wt(e.children)})}var J=class{constructor({stiffness:e=300,damping:r=70,mass:s=10,delta:n=.01,target:i,current:o,callback:u,done:a}={}){this.stiffness=e,this.damping=r,this.delta=n,this.mass=s,this.callback=u,this.done=a,this.target=i||0,this.current=o||0,this.running=!1,this.velocity=0,this.acceleration=0,this.step()}set(e,r=!1){this.target=e,r?this.current=e:this.running||this.step()}stop(){cancelAnimationFrame(this.rafId),this.done&&this.done(this.current)}start(){this.step()}step(){if(this.isAtTarget())this.current=this.target,this.running=!1,this.done&&this.done(this.current);else{let e=this.lastFrameTime?Math.min(Math.max((Date.now()-this.lastFrameTime)/1e3,.008333333333333333),.03333333333333333):.016666666666666666;this.running=!0,this.advance(e),this.lastFrameTime=Date.now(),this.rafId=requestAnimationFrame(()=>this.step())}this.callback&&this.callback(this.current)}advance(e){let r=-this.stiffness*(this.current-this.target),s=-this.damping*this.velocity;this.acceleration=(r+s)/this.mass,this.velocity+=this.acceleration*e,this.current+=this.velocity*e}isAtTarget(){return Math.abs(this.target-this.current)<this.delta&&Math.abs(this.velocity)<=this.delta}};var R=t=>class extends t{baseInit(){this.component=this.initial_component,wt(this.component),this.animate=E.animate,this.Spring=J,this.window_events={},this.checkStateObjectChanges={},this.state=this.initial_state,delete this.__proto__.baseInit}async connectedCallback(){if(this.renderer&&!this.__rendererHTML&&this.__rendererName!==this.parent.__rendererName)throw"ui.js diffferent renderers ".concat(this.__rendererName," and ").concat(this.parent.__rendererName);T(this.document,this.component,{state:this.state}),this.is_connected=!0,this.connected&&this.connected()}async disconnectedCallback(){this.disconnected&&await this.disconnected(),Object.keys(this.window_events).forEach(r=>this.window_events[r].forEach(s=>window.removeEventListener(r,s.cb)))}render(){this.is_connected&&k(this.document,this.component,{state:this.state})}attributeChangedCallback(r,s,n){if(typeof n=="object"){if(Array.isArray(this.state[r])&&Array.isArray(n)&&this.state[r].length==0&&n.length==0||this.checkStateObjectChanges[r]&&JSON.stringify(this.state[r])===JSON.stringify(n))return}else if(this.state[r]===n)return;this.state[r]=n,this.changed&&this.changed({[r]:n}),this.render()}hasEventHandler(r){return this._events?!!this._events[r]:!!this.getAttribute("on"+r)}get cookies(){return typeof document<"u"?Object.assign({},...document.cookie.split(";").filter(r=>r).map(r=>r.split("=")).map(([r,s])=>({[r.trim()]:(s+"").trim()}))):{}}get hash(){return typeof window<"u"?window.location.hash.substr(1).split("/"):[]}on(r,s,n){this.window_events[r]||(this.window_events[r]=[]);let i=this.window_events[r].find(u=>u.callback===s),o=(...u)=>s.call(this,...u);i||(this.window_events[r].push({callback:s,cb:o}),window.addEventListener(r,o,n))}off(r,s){if(!this.window_events[r])return;let n=this.window_events[r].findIndex(i=>i.callback===s);n!==-1&&(window.removeEventListener(r,this.window_events[r][n].cb),this.window_events[r].splice(n,1))}};var it=t=>class extends t{htmlInit(){if(this.animateCSS=(r,{element:s,unit:n,from:i,to:o,duration:u,easing:a,done:f})=>{s._styles[r]=E.animateCSS(s||this,r,n===void 0?"":n,i||0,o,u||1e3,a,()=>{s._styleV[r]=o+n,f&&f()})},this.css.length){let r=document.createElement("style");r.textContent=this.css,this.ShadowDOM?this.document.append(r):setTimeout(()=>{this.document.append(r)},0)}delete this.__proto__.htmlInit}setAttribute(r,s){this.attributeChangedCallback(r,void 0,s),this.AddAttributes&&typeof s!="object"&&super.setAttribute(r,s)}$(r){return this.document.querySelector(r)}$$(r){return this.document.querySelectorAll(r)}emitNative(r,s){console.warn('this.emitNative() is deprecated. Use this.emit(). "'.concat(this.__src,'"')),this.emit(r,s)}emit(r,s){this.dispatchEvent(new CustomEvent(r,{cancelable:!1,bubbles:!1,detail:s}))}};var G;if(typeof window<"u"){class t extends HTMLElement{constructor(){super(),this.AddAttributes=!1,this.ShadowDOM="open",this.MutationObserverOptions={childList:!0},this.baseInit(),this.init&&this.init(),this.document=["open","closed"].includes(this.ShadowDOM)?this.attachShadow({mode:this.ShadowDOM}):this,this.htmlInit(),this.slotChange&&(this._slot_observer=new MutationObserver(r=>this.slotChange(r)),this._slot_observer.observe(this,this.MutationObserverOptions))}get slotted(){let r=this.document.querySelector("slot");return r?r.assignedElements():[]}get element(){return this.ShadowDOM?this.document.host:this.document}}G=class extends it(R(t)){}}var bt=class{constructor(){if(this.document=document.querySelector(this.container),!this.document)throw'ui.js: target container "'.concat(this.container,'" not found');this.baseInit(),this.htmlInit(),this.init&&this.init(),this.connectedCallback()}get element(){return this.document}},ot=class extends it(R(bt)){};var yt=class{constructor(e,r){if(this._BASE_ELEMENT=!0,this.document={_childNodes:[],__rendererName:this.__rendererName},this._childNodes=[],this._eventListeners={},this.parent=e,this.baseInit(),this.renderer&&!this.__rendererHTML&&this.__rendererName!==this.parent.__rendererName)throw"ui.js diffferent renderers ".concat(this.__rendererName," and ").concat(this.parent.__rendererName);this.onReady=new Promise(async s=>{var n,i,o;(n=this.renderer)!=null&&n.onReady&&await this.renderer.onReady,(i=this.parent)!=null&&i.onReady&&await this.parent.onReady,(o=this.renderer)!=null&&o.onConnect&&await this.renderer.onConnect(this),this.document.renderer=this.renderer,this.document.parent=this.document,this.init&&await this.init(),T(this.document,this.component,{state:this.state}),s(),this.is_connected=!0,this.connected&&await this.connected()})}setAttribute(e,r){this.attributeChangedCallback(e,void 0,r)}emit(e,r){this._eventListeners[e]&&this._eventListeners[e].forEach(s=>s.cb(new CustomEvent(e,{cancelable:!1,bubbles:!1,detail:r})))}addEventListener(e,r,s){this._eventListeners[e]||(this._eventListeners[e]=[]);let n=this._eventListeners[e].find(o=>o.callback===r),i=(...o)=>r.call(this,...o);n||this._eventListeners[e].push({callback:r,cb:i})}removeEventListener(e,r){if(!this._eventListeners[e])return;let s=this._eventListeners[e].findIndex(n=>n.callback===r);s!==-1&&this._eventListeners[e].splice(s,1)}async remove(){for(await this.disconnectedCallback();this.document._childNodes.length;)await this.document._childNodes[this.document._childNodes.length-1].remove();this.renderer.onDisconnect&&await this.renderer.onDisconnect(this);let e=this.parent._childNodes.findIndex(r=>r==this);if(e!==-1)this.parent._childNodes.splice(e,1);else throw"Element not found"}after(e){this.renderer.insertAfter(this,e)}before(e){this.renderer.insertBefore(this,e)}},at=class extends R(yt){};var Gt=(t,e=0)=>{for(var r=3735928559^e,s=1103547991^e,n=0,i;n<t.length;n++)i=t.charCodeAt(n),r=Math.imul(r^i,2654435761),s=Math.imul(s^i,1597334677);return r=Math.imul(r^r>>>16,2246822507)^Math.imul(s^s>>>13,3266489909),s=Math.imul(s^s>>>16,2246822507)^Math.imul(r^r>>>13,3266489909),4294967296*(2097151&s)+(r>>>0)};function K(t,e){return"ui-"+String(Gt(e||t.trim())).replaceAll("-","i")}var Ue=Object.getPrototypeOf(async function(){}).constructor,ut=Ue;var vt={},Ve=t=>t.split("-").map(e=>e.slice(0,1).toUpperCase()+e.slice(1)).join(""),Re=t=>((e,r)=>JSON.stringify(t,(s,n)=>typeof n=="function"?r.push(n)&&e:n).replace(new RegExp('"'+e+'"',"g"),s=>r.shift()))("____"+Tt(50)+"____",[]),De=(t,e)=>{if(vt[t])return vt[t];let r=URL.createObjectURL(new Blob([String.raw({raw:e})],{type:"text/javascript"}));return vt[t]=r,r},Et=(t,e,r,s)=>t.reduce((n,i)=>{let o=e?i.path[0]==="@"?i.path:"ui.js-bundled-tags:"+(i.path[0]==="/"?r:r+s)+"/"+i.path:De(i.path,i.src);return i.type==="*"?n+"const "+i.import+" = {...(await import(`"+o+"`))};\n":i.type==="object"?n+"const "+i.import+" =  (await import(`"+o+"`));\n":n+"const "+i.import+" =  (await import(`"+o+"`)).default;\n"},"");function At(t,e,{inFunc:r=!1,parent:s}){let n=t.style,i="",o="{".concat((t.state||"").trim(),"}"),u=e!=="customElement"?"":new Function("return 'static get observedAttributes() { return '+JSON.stringify(Object.keys(".concat(o,"))+' }'"))(),a=Ve(t.name),f=Re(zt(t.template,t.tag||[])),p=t.container?'get container()         { return "'.concat(t.container,'" }'):"";var c="";if(t.renderer){let l=t.renderer[0].split(" ");if(c='get __rendererName(){ return "'+l[0]+'" }',l.length==2){var m=!0;c+="\nget __rendererHTML(){ return true }"}else c+="\nget renderer(){ return this.parent?.renderer }"}let _="\n\n        ".concat(t.static||"",";\n        class ").concat(a," extends ").concat(e," {\n            ").concat(u,"\n            get nanoapp()           { return ").concat(JSON.stringify(t.nanoapp)," }\n            get initial_state()     { return ").concat(o," }\n            get initial_component() { return ").concat(f," }\n            get css()               { return `").concat(n,"`; }\n            ").concat(i,'\n            get __src()             { return "').concat(t.src,'" }\n            ').concat(c,"\n            ").concat(p,"\n            ").concat(t.class||"","\n        };\n    ");switch(e){case"customElement":let l="\n                ".concat(t.import?Et(t.import,t.nodePath,t.BASE_URL,t.path):"","\n                if(!customElements.get('").concat(t.name,"')) {\n                    ").concat(_,"\n                    customElements.define('").concat(t.name,"', ").concat(a,");\n                    window['UIjs'].tags['").concat(t.name,"'] = true;\n                };");return r?";(async () => {".concat(l,"})();"):l;case"uiElement":let g="\n                ".concat(t.import?Et(t.import,t.nodePath,t.BASE_URL,t.path):"","\n                ").concat(_," return new ").concat(a,'("').concat("parentparentparent:"+s,'");');return r?";(async () => {".concat(g,"})();"):g;case"baseElement":let w="\n                ".concat(t.import?Et(t.import,t.nodePath,t.BASE_URL,t.path):"","\n                ").concat(_," ;window['UIjs'].tags['").concat(t.name,"'] = ").concat(a,";");return r?";(async () => {".concat(w,"})();"):w}}async function Yt(t,e,r){let s=K(t.innerText);await W(t.innerText,{name:s,path:e,nanoapp:r}),t.replaceWith(document.createElement(s))}async function gt(t,e,r,s,n,i){await W(t,{name:e,path:r,nanoapp:s,src:i})}function Kt(t,e){return t.startsWith("/https://")&&(t=t.replace("/https://","https://")),typeof window<"u"&&window.nanoapp_base_path&&!t.startsWith(window.nanoapp_base_path)?window.nanoapp_base_path+"/app"+t:t}async function Zt(t,e){if(window.document.location.protocol=="file:"){console.error("WARNING!!! ui.js cannot fetch external resources from a 'local' filesystem: \"file://".concat(t,'"'));var r=await fetch(Kt(t,e),{mode:"no-cors"}).catch(s=>!1)}else var r=await fetch(Kt(t,e)).catch(n=>!1);return r}async function Xt(t,e,r){if(e)return await e(t);let s=await Zt(t,r);if(s===!1)throw"ui.js  \u2764\uFE0F error loading "+t;return(await s.text()).trim()}async function $t(t,e,r="",s){if(j[t])return!0;let n=e.substr(-4)===".tag"?e:e+".tag",i=e[0]!=="/"?D(r+n):n,o=await Zt(i,s);if(o===!1)throw"ui.js  \u2764\uFE0F error loading "+n;let u=i.substring(0,i.lastIndexOf("/"))+"/";await gt(await o.text(),t,u,s,u,e)}async function kt(t,e,r){await W(t.innerText,{name:K(t.innerText),path:r,container:e})}function D(t){return typeof window>"u"?t:new URL(t,document.baseURI).pathname}async function xt({source:t,path:e,keepName:r,nodeFetch:s,nodePath:n,BASE_URL:i}){let o=r?e.split("/").pop().split(".")[0]:K(e);return{name:o,compiled:await W(t,{name:o,path:e.substring(0,e.lastIndexOf("/"))+"/",bundle:!0,nodeFetch:s,nodePath:n,BASE_URL:i})}}async function W(t,e={}){let r=await Qt(t);if(!e.name)throw"name is undefined !!!";r.name=e.name||"i-component",r.path=e.path,r.src=e.src,r.container=e.container||"",r.nodePath=e.nodePath?e.nodePath:void 0,r.BASE_URL=e.BASE_URL,r.nanoapp=e.nanoapp||[];let s=e.nodeFetch||void 0;var n="";if(r.style&&(r.style=r.style.trim(),r.style.length&&(n=r.style)),r.css)for(let i of r.css){let o=i[0]!=="/"?D(r.path+i):i,u=await Xt(o,s,r.nanoapp);u.length&&(n+="\n"+u)}if(r.style=n.replaceAll("`","`").trim(),r.tag)for(let i of r.tag){let o=i.path;o=o.substr(-4)===".tag"?o:o+".tag",s?o=D(o[0]==="/"?o:r.path+o):o=D(i.path[0]==="/"?o:r.path+o);let u=K(o);if(i.name=u,s)i.src=await s(o);else{let a=r.nanoapp&&r.nanoapp.children&&r.nanoapp.children.find(f=>"@"+f.alias===i.alias);a&&(o.startsWith("/!"+a.alias+".tag")&&o.split("/").length==2?o=window.nanoapp_base_path+o.replace("/!"+a.alias+".tag","/imports/"+a.child_release+"/index.tag"):o.startsWith("/!"+a.alias+"/")&&(o=window.nanoapp_base_path+o.replace("/!"+a.alias+"/","/imports/"+a.child_release+"/"))),await $t(u,o,r.path,a||r.nanoapp)}}if(r.import&&!s)for(let i of r.import){let o=i.path[0]!=="/"?D(r.path+i.path):i.path;i.path=o;let u=await Xt(o,s,r.nanoapp);i.src=u}if(j[r.name]=!0,r.renderer&&r.renderer[0].split(" ").length==1){let i=At(r,"baseElement",{inFunc:!1});return await new ut("baseElement",i)(at)}else if(r.container){let i=At(r,"uiElement",{inFunc:!1});return await new ut("uiElement",i)(ot)}else{let i=At(r,"customElement",{inFunc:!0});if(e.bundle){if(r.tag){let o="";for(let u of r.tag)if(!j[u.name]){let a=u.path.substr(-4)===".tag"?u.path:u.path+".tag";a[0]!=="/"&&(a=r.path+a);let{name:f,compiled:p}=await xt({source:u.src,path:a,name:u.name,nodePath:D(r.nodePath+r.path),BASE_URL:r.BASE_URL,nodeFetch:s});o+=p}return o+i}return i}await new ut("customElement",i)(G)}}var ft=class extends Error{constructor(e){super(e),this.name="ui.js \u2764\uFE0F  syntax ERROR"}};function We(t,e){t.innerText.trim().length&&console.warn('ui.js warning: contents of "<script type=ui '.concat(e.map(r=>r.name).join(" "),'> will be ignored"'))}function te(t,e){t.innerText.trim().length||console.warn('ui.js warning: empty "<script type=ui '.concat(e.map(r=>r.name).join(" "),'>"'))}async function ee(){let t=Array.from(document.querySelectorAll('script[type="ui"],script[type="i"]'));try{for(let e of t){let r=window.location.pathname,s=r.substring(0,r.lastIndexOf("/"))+"/",n=Array.prototype.slice.call(e.attributes).map(u=>({name:u.name,value:e.getAttribute(u.name).trim()})),i=n.find(u=>u.name==="target"&&u.value.length);if(i){n.length>2&&console.warn('ui.js warning: all other attributes for "<script type=ui target="'.concat(i.value,'"> will be ignored"')),await kt(e,i.value,s),e.remove();continue}let o=n.filter(u=>u.name.includes("-"));if(o.length>1)throw'ui.js ERROR: more then one attribute with hyphens "<script '.concat(o.map(u=>u.name).join(" "),'>"');o.length===1?(o[0].value?(We(e,n),await $t(o[0].name,o[0].value,s,typeof window<"u"&&window.nanoapp_dependencies)):(te(e,n),await gt(e.innerText,o[0].name,s,typeof window<"u"&&window.nanoapp_dependencies)),e.remove()):(te(e,n),await Yt(e,s))}}catch(e){throw new ft(e)}}var jt="0.7.8-dev";!jt.endsWith("-dev")&&console.log("ui.js \u2764\uFE0F ".concat(jt," alpha experiment. Make user interfaces great again!"));var re={VERSION:jt,tags:j,customElement:G,createTag:W,compile:xt},Us=re;typeof window<"u"&&(window.UIjs=re,document.addEventListener("DOMContentLoaded",ee));export{jt as VERSION,xt as compile,W as createTag,G as customElement,Us as default,j as tags};
