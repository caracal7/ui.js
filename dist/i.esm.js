var bi="useandom-26T198340PX75pxJACKVERYMINDBUSHWOLF_GQZbfghjklqvwyzrict";var _i=(r=21)=>{let t="",o=r;for(;o--;)t+=bi[Math.random()*64|0];return t},Yr=_i;var Ge=class extends Error{constructor(t){super(t),this.name="i.js \u2764\uFE0F  brackets parse ERROR"}};function gi({open:r,close:t,pos:o,nodes:a},u,m){return{nodeType:"bracket",open:r,close:t,nodes:a,pos:Object.assign({},o,{end:u}),content:m.substring(o.start,u+1),innerContent:m.substring(o.start+1,u)}}function vi(r){let t=new Map;return r.forEach(([o,a=o])=>t.set(o,a)),{quotes:t}}function Si(r){let t={},o={};return r.forEach(([a,u])=>{o[a]=u,t[u]=a}),{opens:t,closes:o}}function In(r){let{text:t,parent:o,start:a,end:u,opt:m}=r;if(a===u&&!m.includeEmpty)return;let h=m.pairs.reduce((A,N)=>A.concat(N.split("")),[]).map(A=>`${m.escape}${A}`),_=A=>h.reduce((N,F)=>N.split(F).join(F[1]),A),E=o.pos.depth+1;o.nodes.push({nodeType:"text",pos:{start:a,end:u,depth:E},content:_(t.substring(a,u))})}var Nn=r=>{let t=r.pop();if(t===void 0)throw new Ge("LogicError :)");return t};function tt(r,t){let a=Object.assign({pairs:["()","{}","[]"],nestMax:100,escape:"\\",skip:!1,includeEmpty:!1,quotes:['"',"'","`"]},t||{}),{pairs:u,nestMax:m,escape:h,skip:_}=a,{opens:E,closes:A}=Si(u),{quotes:N}=vi(a.quotes),F=[{nodeType:"root",nodes:[],pos:{start:0,end:0,depth:-1},content:r}],U=0,te=null,I=0;for(let ne=0;ne<r.length;ne++){let re=Nn(F),J=r[ne],d=ne>0&&r[ne-1]===h;if(_&&["{","}","(",")","[","]"].includes(J)&&re.nodeType==="root")F.push(re);else if(_&&["{","(","["].includes(re.open)&&(J==="<"||J===">"))F.push(re);else if(d)F.push(re);else if(te!==null)te===J&&(te=null),F.push(re);else if(N.has(J))te=N.get(J),I=ne,F.push(re);else if(A[J]!==void 0){if(F.length>=m)throw new Ge(`over nest max limit. options: { nestMax: '${a.nestMax}' }`);In({text:r,parent:re,start:U,end:ne,opt:a}),F.push(re),F.push({nodeType:"bracket-open",pos:{start:ne,depth:re.pos.depth+1},open:J,close:A[J],nodes:[]}),U=ne+1}else if(E[J]!==void 0){if(re.nodeType==="root"||E[J]!==re.open)throw new Ge(`404 pair '${E[J]}' :${ne}`);let be=Nn(F);In({text:r,parent:re,start:U,end:ne,opt:a});let Oe=gi(re,ne,r);be.nodes.push(Oe),F.push(be),U=ne+1}else F.push(re)}if(te!==null)throw new Ge(`unclosed quote ${te} near "...${r.substring(U-20,U+30)}..."`);let ve=Nn(F);if(ve.nodeType!=="root")throw new Ge(`404 pair '${ve.open}' :${ve.pos.start}`);return In({text:r,parent:ve,start:U,end:r.length,opt:a}),ve.nodes}function qr(r){return[...r].reduce((t,o)=>(t.quote?(o===t.quote&&(t.quote=void 0),t.a[t.a.length-1]+=o):o==="="?t.a[t.a.length-1].length?t.a.push("="):t.a[t.a.length-1]="=":o===" "?t.a[t.a.length-1]!=="="&&t.a[t.a.length-1].length&&t.a.push(""):(['"',"'","`"].includes(o)&&(t.quote=o),t.a[t.a.length-1]+=o),t),{a:[""]}).a}function bt(r,t="|",o=!1){let a=[...r].reduce((u,m)=>(u.quote?(m===u.quote&&(u.quote=void 0),u.a[u.a.length-1]+=m):m===t?u.a.push(""):(['"',"'","`"].includes(m)&&(u.quote=m),u.a[u.a.length-1]+=m),u),{a:[""]}).a;return o?a.filter(u=>u):a}function Vr(r,t="|"){var o=r.lastIndexOf(t);return[r.substr(0,o),r.substr(o+1)]}function Ti(r){if(['"',"'","`"].includes(r[0])&&r[0]===r[r.length-1]){for(var t=1;t<r.length-1;){if(r[t]===r[0]&&r[t-1]!=="\\")return!1;t++}return!0}return!1}function Ei(r){return r.filter(t=>t.opts&&t.opts.length).forEach(t=>{t.opts2={};let o=t.opts.find(_=>_.type==="loop");if(o){let _=o.key;t.opts2.key=new Function(`return ${_}`)();let E=o.value.split(" as ");if(!E[1])throw"\u041D\u0435 \u0443\u043A\u0430\u0437\u0430\u043D \u0430\u043B\u0438\u0430\u0441 \u0434\u043B\u044F loop";let A=E[1].split(",");t.opts2.loop_fn=E[0].trim(),t.opts2.loop_alias=A[0].trim(),A[1]&&(t.opts2.loop_key_alias=A[1].trim())}let a=t.opts.find(_=>_.type==="text");a&&(Ti(a.value)?t.opts2.text=a.value.substring(1,a.value.length-1):t.opts2.textFn=a.value),["if","style","attrs","enterStyles","updateStyles","exitStyles","enterAttrs","updateAttrs","exitAttrs"].forEach(_=>{let E=t.opts.find(A=>A.type===_);E&&(t.opts2[_]=E.value)}),t.opts.filter(_=>_.type==="eventCallback").forEach(_=>{t.opts2.events||(t.opts2.events={});let E=_.key.substr(1);if(t.opts2.events[E])throw`i.js compile error: Duplicate event name "${E}"`;_.value=_.value.substring(1,_.value.length-1).trim(),_.value[0]==="{"?_.value=_.value.substring(0,_.value.length-1)+";this.render()}":_.value="("+_.value+")==this.render()",t.opts2.events[E]=_.value}),t.opts.filter(_=>_.type==="eventBind"||_.type==="eventBindSelfNamed").forEach(_=>{t.opts2.events||(t.opts2.events={});let E=_.key.substr(1);if(t.opts2.events[E])throw`i.js compile error: Duplicate event name "${E}"`;t.opts2.events[E]=new Function(`return (...args) => this.${_.value}(...args)`)()}),t.opts.filter(_=>_.type==="eventCallFunction").forEach(_=>{t.opts2.events||(t.opts2.events={});let E=_.key.substr(1);if(t.opts2.events[E])throw`i.js compile error: Duplicate event name "${E}"`;t.opts2.events[E]=`${_.value}${_.args}`})}),r.filter(t=>t.opts&&t.opts.length).forEach(t=>{t.opts2||(t.opts2={}),t.opts2.attrs2||(t.opts2.attrs2={},t.opts2.attrsB={},t.opts2.attrsR={}),t.opts.filter(m=>m.type==="booleanAttribute").forEach(m=>{t.opts2.attrs2[m.key]&&console.warn(`i.js compile warning: direct attibute "${m.key}" override attrs({...${m.key}...}) declaration in tag ""!`),t.opts2.attrs2[m.key]=m.key,t.opts2.attrsB[m.key]=!0}),t.opts.filter(m=>m.type==="stringAttribute").forEach(m=>{t.opts2.attrs2[m.key]&&console.warn(`i.js compile warning: direct attibute "${m.key}" override attrs({...${m.key}...}) declaration in tag ""!`),t.opts2.attrs2[m.key]=m.value}),t.opts.filter(m=>m.type==="jsAttribute").forEach(m=>{if(m.key[0]==="%"){var h=m.key.substr(1);t.opts2.attrsR[h]=m.value}else var h=m.key;t.opts2.attrs2[h]&&console.warn(`i.js compile warning: direct attibute "${h}" override attrs({...${h}...}) declaration in tag ""!`),t.opts2.attrs2[h]=m.value.endsWith("%")?m.value:m})}),r.forEach(t=>{t.opts2&&t.opts2.attrs2&&!Object.keys(t.opts2.attrs2).length&&(delete t.opts2.attrs2,delete t.opts2.attrsB),t.opts2&&t.opts2.events&&!Object.keys(t.opts2.events).length&&delete t.opts2.events}),r}function Ie({AAA:r,item:t,tag:o,a},u="enter",m="enterStyles"){if(a===u&&r.length){let h=r.shift().content;if(h[0]==="("){if(t.opts.find(_=>_.type===u))throw`i.js template parse error: duplicate ${u}() inside "<${o}>" declaration`;t.opts.push({type:m,value:h.slice(1,-1)})}else throw`i.js template parse error: expected "${u}(..." but "${u}${h[0]}..." found inside "<${o}>"`;return!0}return!1}function Jr(r){return r.filter(t=>t.nodeType==="bracket"&&t.innerContent[0]!=="/").forEach(t=>{t.opts=[];let o=tt(t.innerContent).map(u=>({nodeType:u.nodeType,content:u.content.trim()}));var a="";do{let u=o.shift();if(u.nodeType==="bracket")throw`i.js template parse error: unxpected brackets "${u.content}" at the end of <${a}> attributes`;if(u.nodeType==="text"){let m=qr(u.content);a||(a=m.shift());do{let h=m.shift();if(m[0]&&m[0][0]==="="){let _=m.shift().substr(1);if(h[0]==="@"){if(['"',"'","`"].includes(_[0]))throw`i.js template parse error: quotes around ${_} is prohibited`;if(o.length&&o[0].nodeType==="bracket"){let E=o.shift();t.opts.push({type:"eventCallFunction",key:h,value:_,args:E.content})}else t.opts.push({type:"eventBind",key:h,value:_.endsWith("/")?_.substring(0,_.length-1):_})}else if(_.startsWith('"')&&_.endsWith('"')||_.startsWith("`")&&_.endsWith("`")||_.startsWith("'")&&_.endsWith("'"))t.opts.push({type:"stringAttribute",key:h,value:_.slice(1,-1)});else if(_.length)t.opts.push({type:"jsAttribute",key:h,value:_.endsWith("/")?_.substring(0,_.length-1):_});else{if(!o.length)throw`i.js template parse error: unxpected end of attribute "...${h}=" inside "<${a}>" declaration`;let E=o.shift().content;E[0]==="{"?t.opts.push({type:"eueAttribute",key:h,value:E}):E[0]==="["?t.opts.push({type:"transitionAttribute",key:h,value:E}):t.opts.push({type:"jsAttribute",key:h,value:E.substring(1,E.length-1)})}}else if(h==="loop"&&o.length){let _=o.shift().content;if(_[0]==="("){if(t.opts.find(N=>N.type==="loop"))throw`i.js template parse error: duplicate loop${_} inside "<${a}>" declaration`;let[E,A]=Vr(_.slice(1,-1));if(A)t.opts.push({type:"loop",key:A,value:E});else throw`i.js template parse error: non-keyed loop not supported yet. "loop${_}" inside "<${a}>"`}else throw`i.js template parse error: expected "loop(..." but "loop${_[0]}..." found inside "<${a}>" `}else if(!Ie({AAA:o,item:t,tag:a,a:h},"if","if")){if(!Ie({AAA:o,item:t,tag:a,a:h},"style","style")){if(!Ie({AAA:o,item:t,tag:a,a:h},"attrs","attrs")){if(!Ie({AAA:o,item:t,tag:a,a:h},"enter","enterStyles")){if(!Ie({AAA:o,item:t,tag:a,a:h},"update","updateStyles")){if(!Ie({AAA:o,item:t,tag:a,a:h},"exit","exitStyles")){if(!Ie({AAA:o,item:t,tag:a,a:h},"#enter","enterAttrs")){if(!Ie({AAA:o,item:t,tag:a,a:h},"#update","updateAttrs")){if(!Ie({AAA:o,item:t,tag:a,a:h},"#exit","exitAttrs")){if(h==="text"&&o.length){let _=o.shift().content;if(_[0]==="("){if(t.opts.find(E=>E.type==="text"))throw`i.js template parse error: duplicate text{c} inside "<${a}>" declaration`;t.opts.push({type:"text",value:_.slice(1,-1)})}else throw`i.js template parse error: expected "text(..." but "text{c[0]}..." found inside "<${a}>"`}else if(h)if(h[0]==="@")if(!m.length&&o[0]&&o[0].nodeType==="bracket"){let _=o.shift();t.opts.push({type:"eventCallback",key:h,value:_.content})}else t.opts.push({type:"eventBindSelfNamed",key:h,value:h.slice(1)});else{if(h==="=")throw`i.js template parse error: unxpected end of attribute "${h}" inside "<${a}>" declaration`;h!=="/"&&t.opts.push({type:"booleanAttribute",key:h})}}}}}}}}}}}while(m.length)}}while(o.length)}),Ei(r)}var Rn={"!DOCTYPE":!0,"!doctype":!0,area:!0,base:!0,br:!0,col:!0,command:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,menuitem:!0,param:!0,source:!0,track:!0,wbr:!0,circle:!0,ellipse:!0,line:!0,path:!0,polygon:!0,polyline:!0,rect:!0,stop:!0,use:!0};var qt=class extends Error{constructor(t){super(t),this.name="i.js \u2764\uFE0F  syntax ERROR"}};function Bn(r,t=[]){if(!t.length)return r;if(r[0]=="@"){if(r.length===1)throw"empty alias tag <@>";let o=t.find(a=>a.alias===r);if(o)r=o.name;else throw`alias <${r}> not defined`}return r}function kn(r,t){let o=t.find(a=>a.name===r);return o?o.alias:r}function xi(r,t){let o=[{children:[]}];if(o.last=()=>o[o.length-1],r.forEach(a=>{if(a.nodeType==="text"){var u=o[o.length-1];if(u.text)throw"children and text() attribute at the same time";u.children.push({tag:"#text",content:a.content})}else{var m=a.content.match(new RegExp("^<(@?[a-z][-a-z0-9]*)(\\s.*)?\\/>$","s"));if(m){var u=o[o.length-1];if(u.text)throw"children and text() attribute at the same time";u.children.push(Object.assign({tag:Bn(m[1],t)},a.opts2))}else{var h=a.content.match(new RegExp("^<(@?[a-z][-a-z0-9]*)(\\s.*)?>$","s"));if(h)if(Rn[h[1]]){let E=o[o.length-1];if(E.text)throw"children and text() attribute at the same time";E.children.push(Object.assign({tag:Bn(h[1],t)},a.opts2))}else o.push(Object.assign({tag:Bn(h[1],t),children:[]},a.opts2));else{var _=a.content.match(new RegExp("^<\\/(@?[a-z][-a-z0-9]*)(\\s.*)?>$","s"));if(_){if(Rn[_[1]])throw`can't close self-closing tag "</${_[1]}>"`;let E=o[o.length-2],A=o.pop();if(A.children.length===1&&A.children[0].tag==="#text"?(A.text=A.children[0].content,delete A.children):A.children.length||delete A.children,E){if(E.text)throw"children and text() attribute at the same time";let N=kn(A.tag,t),F=kn(_[1],t);if(N!==F)throw`the opening and closing tags are not the same <${N}>...</${F}>`;E.children.push(A)}else throw!A.children||A.children[0].tag!==_[1]?`missing the opening tag for </${_[1]}>`:`closed twice tag <${A.children[0].tag}>`}}}}}),o.length>1){let a=o.find(u=>u.tag);throw`Unclosed tag <${kn(a.tag,t)}>`}return o[0].children}var Wr=xi;var nt={};nt.animate=function(r,t,o,a,u,m){if(typeof r!="number"||typeof t!="number"||typeof o!="number"||typeof a!="function")return;typeof u=="string"&&K[u]&&(u=K[u]),typeof u!="function"&&(u=K.linear),typeof m!="function"&&(m=function(){});var h=window.requestAnimationFrame||function(F){window.setTimeout(F,1e3/60)},_=!1,E=t-r;function A(F){if(!_){var U=(F||+new Date)-N;U>=0&&a(u(U,r,E,o)),U>=0&&U>=o?(a(t),m()):h(A)}}a(r);var N=window.performance&&window.performance.now?window.performance.now():+new Date;return h(A),{cancel:function(){_=!0}}};nt.animateCSS=function(r,t,o,a,u,m,h,_){var E=function(A){r.style[t]=A+o};return nt.animate(a,u,m,E,h,_)};nt.cancel=function(r){r&&r.cancel()};var K=nt.easings={};K.linear=function(r,t,o,a){return o*r/a+t};K.easeInQuad=function(r,t,o,a){return o*(r/=a)*r+t};K.easeOutQuad=function(r,t,o,a){return-o*(r/=a)*(r-2)+t};K.easeInOutQuad=function(r,t,o,a){return(r/=a/2)<1?o/2*r*r+t:-o/2*(--r*(r-2)-1)+t};K.easeInCubic=function(r,t,o,a){return o*(r/=a)*r*r+t};K.easeOutCubic=function(r,t,o,a){return o*((r=r/a-1)*r*r+1)+t};K.easeInOutCubic=function(r,t,o,a){return(r/=a/2)<1?o/2*r*r*r+t:o/2*((r-=2)*r*r+2)+t};K.easeInQuart=function(r,t,o,a){return o*(r/=a)*r*r*r+t};K.easeOutQuart=function(r,t,o,a){return-o*((r=r/a-1)*r*r*r-1)+t};K.easeInOutQuart=function(r,t,o,a){return(r/=a/2)<1?o/2*r*r*r*r+t:-o/2*((r-=2)*r*r*r-2)+t};K.easeInQuint=function(r,t,o,a){return o*(r/=a)*r*r*r*r+t};K.easeOutQuint=function(r,t,o,a){return o*((r=r/a-1)*r*r*r*r+1)+t};K.easeInOutQuint=function(r,t,o,a){return(r/=a/2)<1?o/2*r*r*r*r*r+t:o/2*((r-=2)*r*r*r*r+2)+t};K.easeInSine=function(r,t,o,a){return-o*Math.cos(r/a*(Math.PI/2))+o+t};K.easeOutSine=function(r,t,o,a){return o*Math.sin(r/a*(Math.PI/2))+t};K.easeInOutSine=function(r,t,o,a){return-o/2*(Math.cos(Math.PI*r/a)-1)+t};K.easeInExpo=function(r,t,o,a){return r==0?t:o*Math.pow(2,10*(r/a-1))+t};K.easeOutExpo=function(r,t,o,a){return r==a?t+o:o*(-Math.pow(2,-10*r/a)+1)+t};K.easeInOutExpo=function(r,t,o,a){return r==0?t:r==a?t+o:(r/=a/2)<1?o/2*Math.pow(2,10*(r-1))+t:o/2*(-Math.pow(2,-10*--r)+2)+t};K.easeInCirc=function(r,t,o,a){return-o*(Math.sqrt(1-(r/=a)*r)-1)+t};K.easeOutCirc=function(r,t,o,a){return o*Math.sqrt(1-(r=r/a-1)*r)+t};K.easeInOutCirc=function(r,t,o,a){return(r/=a/2)<1?-o/2*(Math.sqrt(1-r*r)-1)+t:o/2*(Math.sqrt(1-(r-=2)*r)+1)+t};K.easeInElastic=function(r,t,o,a){var u=0,m=o;if(r==0)return t;if((r/=a)==1)return t+o;if(u||(u=a*.3),m<Math.abs(o)){m=o;var h=u/4}else var h=u/(2*Math.PI)*Math.asin(o/m);return-(m*Math.pow(2,10*(r-=1))*Math.sin((r*a-h)*(2*Math.PI)/u))+t};K.easeOutElastic=function(r,t,o,a){var u=0,m=o;if(r==0)return t;if((r/=a)==1)return t+o;if(u||(u=a*.3),m<Math.abs(o)){m=o;var h=u/4}else var h=u/(2*Math.PI)*Math.asin(o/m);return m*Math.pow(2,-10*r)*Math.sin((r*a-h)*(2*Math.PI)/u)+o+t};K.easeInOutElastic=function(r,t,o,a){var u=0,m=o;if(r==0)return t;if((r/=a/2)==2)return t+o;if(u||(u=a*(.3*1.5)),m<Math.abs(o)){m=o;var h=u/4}else var h=u/(2*Math.PI)*Math.asin(o/m);return r<1?-.5*(m*Math.pow(2,10*(r-=1))*Math.sin((r*a-h)*(2*Math.PI)/u))+t:m*Math.pow(2,-10*(r-=1))*Math.sin((r*a-h)*(2*Math.PI)/u)*.5+o+t};K.easeInBack=function(r,t,o,a,u){return u==null&&(u=1.70158),o*(r/=a)*r*((u+1)*r-u)+t};K.easeOutBack=function(r,t,o,a,u){return u==null&&(u=1.70158),o*((r=r/a-1)*r*((u+1)*r+u)+1)+t};K.easeInOutBack=function(r,t,o,a,u){return u==null&&(u=1.70158),(r/=a/2)<1?o/2*(r*r*(((u*=1.525)+1)*r-u))+t:o/2*((r-=2)*r*(((u*=1.525)+1)*r+u)+2)+t};K.easeInBounce=function(r,t,o,a){return o-K.easeOutBounce(a-r,0,o,a)+t};K.easeOutBounce=function(r,t,o,a){return(r/=a)<1/2.75?o*(7.5625*r*r)+t:r<2/2.75?o*(7.5625*(r-=1.5/2.75)*r+.75)+t:r<2.5/2.75?o*(7.5625*(r-=2.25/2.75)*r+.9375)+t:o*(7.5625*(r-=2.625/2.75)*r+.984375)+t};K.easeInOutBounce=function(r,t,o,a){return r<a/2?K.easeInBounce(r*2,0,o,a)*.5+t:K.easeOutBounce(r*2-a,0,o,a)*.5+o*.5+t};var _t=nt;var Ne={duration:500};function Fn(r,t,o){var a=r[t];if(t<o)for(;t<o;t++)r[t]=r[t+1];else for(;t>o;t--)r[t]=r[t-1];r[o]=a}function rt(r){if(r.svg)var t=document.createElementNS("http://www.w3.org/2000/svg",r.tag);else var t=document.createElement(r.tag);return Object.assign(t,{_attrs:{},_styles:{},_attrsV:{},_styleV:{},_colors:{}}),t}var Qr=r=>`
    var element = document.createElement("${r}");
    Object.assign(element, {_attrs:{},_styles:{},_attrsV:{},_styleV:{}, _colors:{}});
`,Hr=r=>`
    var element = document.createElementNS("http://www.w3.org/2000/svg", "${r}");
    Object.assign(element, {_attrs:{},_styles:{},_attrsV:{},_styleV:{}, _colors:{}});
`;function st(r,t,o){var a="linear";if(typeof o=="object"){var u=o.duration||Ne.duration,m=o.to;o.ease&&(a=o.ease)}else var u=Ne.duration,m=o;var h=r.getAttribute(t)?Number(r.getAttribute(t)):0;_t.cancel(r._attrs[t]),r._attrs[t]=_t.animate(h,m,u,_=>{r.setAttribute(t,_)},a)}function Ai(r,t,o){var a="linear",u=0;if(typeof o=="object"){var m=o.duration||Ne.duration,h=o.to;o.ease&&(a=o.ease),o.delay&&(u=o.delay)}else var m=Ne.duration,h=o;r._colors[t]={key:t,duration:m,ease:a,delay:u},setTimeout(()=>{delete r._colors[t];var E=Object.values(r._colors).map(A=>A.key+" "+A.duration+"ms "+A.ease+" "+A.delay+"ms").join(",");r.style.setProperty("transition",E||"none")},m+u);var _=Object.values(r._colors).map(E=>E.key+" "+E.duration+"ms "+E.ease+" "+E.delay+"ms").join(",");r.style.setProperty("transition",_||"none"),r.style.getPropertyValue(t)||r.style.setProperty(t,"#000000"),setTimeout(()=>{r.style.setProperty(t,h)},0)}function Vt(r,t,o){if(["color","background","fill","stroke","background-color","border-color"].includes(t)){Ai(r,t,o);return}var a="linear",u=0;if(typeof o=="object"){var m=o.duration||Ne.duration,h=o.to;o.from&&(u=o.from),o.ease&&(a=o.ease)}else var m=Ne.duration,h=o;var _=r.style[t],E="";typeof h=="string"&&(h.endsWith("px")?(u=Number(_.substring(0,_.length-2)),h=Number(h.substring(0,h.length-2)),E="px"):h.endsWith("%")&&(u=Number(_.substring(0,_.length-1)),h=Number(h.substring(0,h.length-1)),E="%")),_t.cancel(r._styles[t]),r._styles[t]=_t.animate(u,h,m,A=>{r.style.setProperty(t,A+E)},a)}function gt(r,t){return!!(r==="input"&&["checked","autofocus","readonly","required","disabled","multiple"].includes(t)||r==="option"&&["selected"].includes(t)||r==="button"&&["disabled","multiple"].includes(t))}function Kr(r,t,o,a,u){var m=u;return st(r,a,m),typeof m=="object"&&m.duration?m.duration:Ne.duration;return 0}function Xr(r,t,o,a,u){var m=u;return Vt(r,a,m),typeof m=="object"&&m.duration?m.duration:Ne.duration;return 0}function Zr(r,t,o,a,u,m){var h=0,_=0;if(t.exitAttrs){var E=t.exitAttrs(o);typeof E=="object"&&(_=Object.entries(E).reduce((N,F)=>Math.max(Kr(r,t,o,F[0],F[1]),N),0))}if(t.exitStyles){var A=t.exitStyles(o);typeof A=="object"&&(h=Object.entries(A).reduce((N,F)=>Math.max(Xr(r,t,o,F[0],F[1]),N),0))}if(h>0||_>0){let N=setTimeout(()=>m.Done.then(()=>{r.remove(),u.exit.delete(a)}),h>_?h:_);u.exit.set(a,{element:r,timeout:N});return}r.remove()}function es(r,t,o,a,u){var m=0,h=0;if(t.exitAttrs){var _=t.exitAttrs(o);typeof _=="object"&&(h=Object.entries(_).reduce((A,N)=>Math.max(Kr(r,t,o,N[0],N[1]),A),0))}if(t.exitStyles){var E=t.exitStyles(o);typeof E=="object"&&(m=Object.entries(E).reduce((A,N)=>Math.max(Xr(r,t,o,N[0],N[1]),A),0))}if(m>0||h>0){let A=setTimeout(()=>a.Done.then(()=>{r.remove(),a.__i__[u]=!1}),m>h?m:h);return a.__i__[u]={exit:A},!1}return a.__i__[u]=!1,r.remove(),!0}function vt(r,t,o,a,u,m,h){var _=u.keys,E=u.elements,A=u.exit,N=E.length,F=h.length,U=N>F?N:F,te=0,I=0,ve=0;do{if(I<F){var ne=r.key(h[I]);if(I>=N){N++,U=N>F?N:F;var re=A.get(ne);if(re){clearTimeout(re.timeout);var J=re.element;A.delete(ne)}else var J=rt(r);if(a[r.loop_alias]=h[I],r.loop_key_alias&&(a[r.loop_key_alias]=I),Mn(J,r,a,he),I===0)if(A.size)for(let Me of A){Me[1].element.before(J);break}else o?o.after(J):t.prepend(J);else E[I-1].after(J);E.splice(I,0,J),J.key=ne,_[ne]=!0,I++;continue}else{var d=E[I].key;if(ne===d){a[r.loop_alias]=h[I],r.loop_key_alias&&(a[r.loop_key_alias]=I),r.Update_Tag(E[I],r,a,he),I++;continue}else if(_[ne]){var be=void 0,Oe=void 0;let Me;for(var ye=I+1;ye<U;ye++)if(!be&&ye<N&&E[ye].key===ne&&(be=ye+1),!Oe&&ye<F&&r.key(h[ye])===d&&(Oe=ye+1),be&&Oe){var lt=E[I];if(be>=Oe)Me=E[be-1],t.insertBefore(Me,lt),a[r.loop_alias]=h[I],r.loop_key_alias&&(a[r.loop_key_alias]=I),r.Update_Tag(Me,r,a,he),be===Oe?(ye-I>1&&t.insertBefore(lt,E[be]),E[I]=E[ye],E[ye]=lt):(Fn(E,be-1,I),te++),I++;else{var ut=Oe-1+te;t.insertBefore(lt,E[ut]||null),Fn(E,I,(ut>N?N:ut)-1),te--,a[r.loop_alias]=h[I],r.loop_key_alias&&(a[r.loop_key_alias]=I),r.Update_Tag(E[I],r,a,he)}break}if(Me)continue}else{N++,U=N>F?N:F;var re=A.get(ne);if(re)clearTimeout(re.timeout),J=re.element,A.delete(ne);else var J=rt(r);a[r.loop_alias]=h[I],r.loop_key_alias&&(a[r.loop_key_alias]=I),Mn(J,r,a,he),I===0?o?o.after(J):t.prepend(J):E[I-1].after(J),E.splice(I,0,J),J.key=ne,_[ne]=!0,I++;continue}}}delete _[E[I].key],r.loop_key_alias&&(a[r.loop_key_alias]=I+ve,ve++),Zr(E[I],r,a,E[I].key,u,t),E.splice(I,1),N--,U=N>F?N:F}while(I<U);return u.length=E.length,A.size+u.length}function wi(){return{ret_element:function(r,t,o,a){return r},children:function(r,t,o,a){a.UPDATE_Chidldren(r,t.children,o)},fn_text:function(r,t,o,a){var u=t.text(o);r.__lastText!==u&&(r.textContent=r.__lastText=u)},updateProps:function(r,t,o,a){t.updateProps(r,t,o,a)}}}function Jt(r){var t=[],o=wi();return r.tag==="#text"?(t.push(o.ret_element),t):(r.children?t.push(o.children):typeof r.text=="function"&&t.push(o.fn_text),r.updateProps&&(t=[...t,...r.updateProps]),t.push(o.ret_element),t)}function $i(r,t,o,a,u,m){return t.Update_Tag(r.childNodes[u],t,o,he),u+1}function Oi(r,t,o,a,u,m){let h=t.loop(o);if(!m||m.length===0){if(!m||m.exit.size===0)return h.length?a===0?(t.enter(t,r,void 0,o,a,h,he),u+r.__i__[a].length):(t.enter(t,r,u===0?void 0:r.childNodes[u-1],o,a,h,he),u+r.__i__[a].length):u;if(h.length){let _=vt(t,r,a===0||u===0?void 0:r.childNodes[u],o,m,a,h);return u+_}else return u+m.exit.size}else if(h.length){let _=vt(t,r,a===0||u===0?void 0:r.childNodes[u-1],o,m,a,h);return u+_}else{let _=vt(t,r,a===0||u===0?void 0:r.childNodes[u],o,m,a,h);return u+_}}function Ci(r,t,o,a,u,m){if(m===!1)if(t.if(o)){let _=rt(t);if(t.children)Ye(_,t.children,o);else{var h=typeof t.text=="function"?t.text(o):t.text;_.__lastText!==h&&(_.textContent=_.__lastText=h)}return t.enterProps&&t.enterProps(_,t,o,he),u===0?r.prepend(_):r.childNodes[u-1].after(_),r.__i__[a]={exit:!1},u+1}else return u;else return t.if(o)?m.exit?(clearTimeout(m.exit),t.enterProps&&t.enterProps(r.childNodes[u],t,o,he),r.__i__[a]={exit:!1},u+1):(typeof t.text!="string"&&t.Update_Tag(r.childNodes[u],t,o,he),u+1):m.exit?u+1:es(r.childNodes[u],t,o,r,a)?u:u+1}function Li(r,t,o,a,u,m){if(m===!1||m.length===0)if(t.if(o)){let h=t.loop(o);return h.length?a===0?(t.enter(t,r,void 0,o,a,h,he),u+r.__i__[a].length):(t.enter(t,r,u===0?void 0:r.childNodes[u-1],o,a,h,he),u+r.__i__[a].length):u}else return u;else if(t.if(o)){let h=t.loop(o),_=vt(t,r,a===0&&u===0?void 0:r.childNodes[u],o,m,a,h);return u+_}else{if(m.length===0)return u+m.exit.size;{let h=vt(t,r,a===0&&u===0?void 0:r.childNodes[u],o,m,a,[]);return u+h}}}function St(r,t,o){var a=void 0;r.Done=new Promise(m=>a=m);var u=0;t.forEach((m,h)=>{let _=r.__i__[h];if(m.tag==="#text"){u++;return}m.hasOwnProperty("if")?m.loop?u=Li(r,m,o,h,u,_):u=Ci(r,m,o,h,u,_):m.loop?u=Oi(r,m,o,h,u,_):u=$i(r,m,o,h,u,_)}),a()}function ts(r,t,o,a){if(r.tag==="input"&&o==="value")t._attrsV[o]!==a&&(t._attrsV[o]=a,t.value!=a&&(t.value=a));else if(o==="class"){if(typeof a=="object")throw"Cannot do transition on  class attribute";var u=a||void 0;t._attrsV[o]!==u&&(t._attrsV[o]=u,u?r.svg?t.setAttribute(o,u):t.className=u:t.removeAttribute(o))}else if(r.attrs3[o])(t._attrsV[o]!==a||Array.isArray(a))&&t.setAttribute(o,a);else if(t._attrsV[o]!==a)if(t._attrsV[o]=a,gt(r.tag,o)){if(typeof a=="object")throw"Cannot do transition on boolean attribute";r.tag==="input"&&r.attrs2.type==="radio"&&o==="checked"&&!r.attrsB[o]?t.value===a?(t.setAttribute(o,""),t[o]=o):(t.removeAttribute(o),t[o]=""):a?t.setAttribute(o,"")||(t[o]=o):t.removeAttribute(o)||(t[o]="")}else r.tag==="textarea"&&o==="value"?t.value=a:typeof a=="object"?st(t,o,a):t.setAttribute(o,a)}function Pi(){return{updateAttrs:function(r,t,o,a){Object.entries(t.updateAttrs(o)).forEach(([u,m])=>{a.updateAttribute(t,r,u,m)})},attrs3:function(r,t,o,a){Object.entries(t.attrs3).forEach(([u,m])=>{a.updateAttribute(t,r,u,typeof m=="function"?m(o):m)})},updateStyles:function(r,t,o,a){Object.entries(t.updateStyles(o)).forEach(([u,m])=>{typeof m=="object"?a.animateCSS(r,u,m):r.style.setProperty(u,m)})}}}function Wt(r){let t=[],o=Pi();return r.updateAttrs&&t.push(o.updateAttrs),r.attrs3&&t.push(o.attrs3),r.updateStyles&&t.push(o.updateStyles),t}var ns=(...r)=>r.filter(t=>typeof t=="function").reduce((t,o)=>t===null?o:function(...u){t.apply(this,u),o.apply(this,u)},null);var Ii={createElementHTML:Qr,createElementSVG:Hr,createElement:rt,Enter_Children:Ye,UPDATE_Chidldren:St,Update_Tag:Jt,animateAttr:st,animateCSS:Vt,enterProps:Qt,enterAttribute:rs,updateProps:Wt,updateAttribute:ts},he=Ii;function rs(r,t,o,a){if(o==="class"){var u=a||void 0;t._attrsV[o]=u,u&&(t._attrsV[o]=u,r.svg?t.setAttribute(o,u):t.className=u)}else gt(r.tag,o)?r.tag==="input"&&r.attrs2.type==="radio"&&o==="checked"&&!r.attrsB[o]?t.value===a&&(t.setAttribute(o,""),t._attrsV[o]=a):(t._attrsV[o]=a&&!0,a&&t.setAttribute(o,"")):r.tag==="textarea"&&o==="value"?(t._attrsV[o]=a,t.innerHTML=a):(t._attrsV[o]=a,t.setAttribute(o,a))}function Ni(){return{enterAttrs:function(r,t,o,a){Object.entries(t.enterAttrs(o)).forEach(([u,m])=>{if(Array.isArray(m))throw"not implemented";typeof m=="object"?a.animateAttr(r,u,m):a.enterAttribute(t,r,u,m)})},attrs:function(r,t,o,a){var u=t.attrs?t.attrs(o):{};t.attrs2&&Object.entries(t.attrs2).forEach(([m,h])=>{u[m]=typeof h=="function"?h(o):h}),Object.entries(u).forEach(([m,h])=>{a.enterAttribute(t,r,m,h)})},enterStyles:function(r,t,o,a){Object.entries(t.enterStyles(o)).forEach(([u,m])=>{if(Array.isArray(m))throw"not implemented";typeof m=="object"?a.animateCSS(r,u,m):r.style.setProperty(u,m)})},style:function(r,t,o,a){Object.entries(t.style(o)).forEach(([u,m])=>{r.style.setProperty(u,m)})},events:function(r,t,o,a){r.__datum={...o},Object.entries(t.events).map(([u,m])=>{r["on"+u]=h=>m(r.__datum,h)})}}}function Qt(r){let t=[],o=Ni();return r.enterAttrs&&t.push(o.enterAttrs),(r.attrs||r.attrs2)&&t.push(o.attrs),r.enterStyles&&t.push(o.enterStyles),r.style&&t.push(o.style),r.events&&t.push(o.events),t}function ss(r){return(t,o,a,u,m,h,_)=>{var E={},A=new Map,N=[],F=a;return h.forEach((U,te)=>{if(t.svg){var I=document.createElementNS("http://www.w3.org/2000/svg",t.tag);Object.assign(I,{_attrs:{},_styles:{},_attrsV:{},_styleV:{},_colors:{}})}else{var I=document.createElement(t.tag);Object.assign(I,{_attrs:{},_styles:{},_attrsV:{},_styleV:{},_colors:{}})}I.key=t.key(U),E[I.key]=!0,N.push(I),u[t.loop_alias]=U,t.loop_key_alias&&(u[t.loop_key_alias]=te),t.enterProps&&t.enterProps(I,t,u,_),t.children?_.Enter_Children(I,t.children,u):t.text&&(typeof t.text=="function"?I.textContent=I.__lastText=t.text(u):I.textContent=I.__lastText=t.text),te===0&&!F?o.prepend(I):F.after(I),F=I}),o.__i__[m]={length:h.length,exit:A,elements:N,keys:E},F}}function Mn(r,t,o,a){t.enterProps&&t.enterProps(r,t,o,a),t.children?Ye(r,t.children,o):typeof t.text=="function"?r.textContent=r.__lastText=t.text(o):r.textContent=r.__lastText=t.text}function os(r,t,o,a,u){return r.element=document.createTextNode(r.content),o?o.after(r.element):t.prepend(r.element),t.__i__[u]={exit:!1},r.element}function as(r){return(t,o,a,u,m,h,_)=>{if(t.svg){var E=document.createElementNS("http://www.w3.org/2000/svg",t.tag);Object.assign(E,{_attrs:{},_styles:{},_attrsV:{},_styleV:{},_colors:{}})}else{var E=document.createElement(t.tag);Object.assign(E,{_attrs:{},_styles:{},_attrsV:{},_styleV:{},_colors:{}})}return t.enterProps&&t.enterProps(E,t,u,_),t.text&&(typeof t.text=="function"?E.textContent=E.__lastText=t.text(u):E.textContent=E.__lastText=t.text),a?a.after(E):o.prepend(E),o.__i__[m]={exit:!1},E}}function is(r){return(t,o,a,u,m,h,_)=>{if(t.svg){var E=document.createElementNS("http://www.w3.org/2000/svg",t.tag);Object.assign(E,{_attrs:{},_styles:{},_attrsV:{},_styleV:{},_colors:{}})}else{var E=document.createElement(t.tag);Object.assign(E,{_attrs:{},_styles:{},_attrsV:{},_styleV:{},_colors:{}})}return t.enterProps&&t.enterProps(E,t,u,_),a?a.after(E):o.prepend(E),_.Enter_Children(E,t.children,u),o.__i__[m]={exit:!1},E}}function Ye(r,t,o){r.__i__={};var a;t.forEach((u,m)=>{if(u.if&&!u.if(o)){r.__i__[m]=!1;return}if(u.loop){let h=u.loop(o);if(h.length){a=u.enter(u,r,a,o,m,h,he);return}else{r.__i__[m]=!1;return}}else{a=u.enter(u,r,a,o,m,void 0,he);return}})}function cs(r){if(r.tag==="#text"){r.enter=os;return}r.enterProps=Qt(r),r.updateProps=Wt(r),r.Update_Tag=Jt(r),r.loop?r.enter=ss(r):r.enter=r.children?is(r):as(r)}var Ri=Object.getPrototypeOf(async function(){}).constructor,jn=Ri;var Bi=["svg","g","path","polygon","rect","circle","line","clipPath","cursor","defs","desc","ellipse","filter","font","glyph","image","text","textPath","animate","animateMotion","animateTransform"];function Dn(r,t,o){return r.forEach((a,u)=>{Bi.includes(a.tag)&&(a.svg=!0),a.context=[...t],a.loop_alias&&(a.loop=new Function(`return ({ ${a.context.join(",")} }) => ${a.loop_fn}`)(),a.context.push(a.loop_alias),a.loop_key_alias&&a.context.push(a.loop_key_alias)),a.textFn&&(a.text=new Function(`return ({ ${a.context.join(",")} }) => ${a.textFn}`)(),delete a.textFn),a.if&&(a.if=new Function(`return ({ ${a.context.join(",")} }) => ${a.if}`)()),a.events&&Object.entries(a.events).forEach(([m,h])=>{typeof h=="string"&&(a.events[m]=new Function(`return async ({ ${a.context.join(",")} }, event) => ${h}`)())}),a.attrsR&&Object.keys(a.attrsR).length&&Object.entries(a.attrsR).forEach(([m,h])=>{if(a.events||(a.events={}),a.events.input)throw"@input and reactive attr at the same time";a.tag==="input"?m==="value"?a.events.input=new Function(`return ({ ${a.context.join(",")} }, event) => {setTimeout(()=>this.render(),0);${h} = event.target.value} `)():m==="checked"&&(a.attrs2.type==="checkbox"?a.events.input=new Function(`return ({ ${a.context.join(",")} }, event) => {setTimeout(()=>this.render(),0);${h} = event.target.checked} `)():a.attrs2.type==="radio"&&(a.events.input=new Function(`return ({ ${a.context.join(",")} }, event) => {setTimeout(()=>this.render(),0);${h} = event.target.value} `)())):a.tag==="textarea"&&m==="value"&&(a.events.input=new Function(`return ({ ${a.context.join(",")} }, event) => {setTimeout(()=>this.render(),0);${h} = event.target.value} `)())}),["style","attrs","enterStyles","updateStyles","exitStyles","enterAttrs","updateAttrs","exitAttrs"].forEach(m=>{a[m]&&(a[m]=new Function(`return ({ ${a.context.join(",")} }) => ({${a[m]}})`)())}),a.attrs2&&(Object.keys(a.attrs2).length&&(a.attrs3={}),Object.entries(a.attrs2).forEach(([m,h])=>{typeof h=="object"&&h.type==="jsAttribute"&&(a.attrs3[m]=a.attrs2[m]=new Function(`return ({ ${a.context.join(",")} }) => ${h.value+(h.args||"")}`)())}),Object.keys(a.attrs3).length||delete a.attrs3),cs(a),a.children&&Dn(a.children,a.context,o)}),r}function ki(r){return r.filter(t=>{if(t.nodeType==="bracket"){let o=t.innerContent.split(" ").join("");if(["","/","@","@/","/@"].includes(o))throw`Empty tag <${o}>`}return!(t.nodeType==="text"&&!t.content.trim().length)})}function Fi(r=""){return ki(tt(r,{skip:!0,pairs:["<>","{}","()","[]"]}))}function ls(r,t=[],o=!1){return Dn(Wr(Jr(Fi(r)),t),["state"],o)}var Mi="static|template|state|class|style";function ji(r){return r.split(/\r\n|\n|\r/)}function Di(r,t){let o=r.match(new RegExp(`^\\s*<!(${t})>\\s*$`,"i"));return o?o[1]:null}function Ui(r,t){let o=r.match(new RegExp(`^\\s*<!${t}\\s+([^>]*)>\\s*$`,"i"));return o?o[1]:null}async function zi(r){let t=ji(r),o={};var a=void 0,u=0;for(let m=0;m<t.length;m++){let h=t[m];if(!h.trim().length)continue;let _=Di(h,Mi+"|walt");if(!(!_&&["css","import","tag"].some(E=>{let A=Ui(h,E);if(A)return a=E,o[a]||(o[a]=[]),o[E].push(a==="tag"?{value:A,line:m}:A),!0}))){if(!a&&!_){a="template",u=m,o.template="",o.template+=`
`+h;continue}if(_){if(a=_,!o[_])o[_]="";else throw`duplicate <!${_}> block at line ${m}`;continue}else{if(["css","import","tag"].includes(a))if(!o.template)a="template",u=m,o.template="";else{if(h.trim().startsWith("//"))continue;throw`unexpected "${h.trim()}" at line ${m}. Template started at line ${u}`}o[a]+=`
`+h;continue}}}return o}function ot(r){return['"',"'","`"].includes(r[0])&&r[0]==r[r.length-1]?r.substring(1,r.length-1).trim():r.trim()}function Gi(r){let t={},o=bt(r.value," ",!0).map(ot);if(o.length>2)throw`excess arguments <!tag ${r.value}> at line ${r.line}`;if(o.some(a=>!a))throw`empty argument <!tag ${r.value}> at line ${r.line}`;if(o.length===1){if(o[0][0]==="@")throw`alias is present but path is not <!tag ${r.value}> at line ${r.line}`;t.alias="@"+o[0].split("\\").pop().split("/").pop(),t.path=o[0]}else{if(o[0][0]!=="@")throw`missing alias identifier "@" <!tag ${r.value}> at line ${r.line}`;t.alias=o[0],t.path=o[1]}return t}function Yi(r){if(bt(r," ",!0).length>1)throw`excess parameters <!import ${r}>`;return ot(r)}function Ht(r){try{Function("var "+r)}catch(t){return!1}return!0}function qi(r){let t=bt(r," ",!0);if(t.length<3)throw`not enough parameters <!import ${r}>`;if(t.length===3){if(t[1].toLowerCase()!=="from")throw`wrong parameters <!import ${r}>`;if(t[0].startsWith("{")&&t[0].endsWith("}")){let a=t[0].substring(1,t[0].length-1);if(!a.length)throw`wrong parameters <!import ${r}>`;if(!a.split(",").map(m=>m.trim()).every(Ht))throw`invalid variable name <!import ${r}>`;return{type:"object",import:t[0],path:ot(t[2])}}else{if(!Ht(t[0]))throw`invalid variable name <!import ${r}>`;return{type:"var",import:t[0],path:ot(t[2])}}}else{try{var o=tt(r,{pairs:["{}"]})}catch(a){throw`invalid variable name <!import ${r}>`}if(o.length>2)throw`wrong parameters <!import ${r}>`;if(o.length===1){if(o[0].nodeType==="bracket")throw`wrong parameters <!import ${r}>`;if(t[0]==="*"&&t[1].toLowerCase()==="as"&&t[3].toLowerCase()==="from"&&t.length===5){if(!Ht(t[2]))throw`invalid variable name <!import ${r}>`;return{type:"*",import:t[2],path:ot(t[4])}}else throw`wrong parameters <!import ${r}>`}else{let a=bt(o[1].content," ",!0);if(a.length!==2||a[0].toLowerCase()!=="from")throw`wrong parameters <!import ${r}>`;if(!o[0].innerContent.trim().length)throw`wrong parameters <!import ${r}>`;let u=o[0].innerContent.split(",").map(m=>m.trim());if(!u.every(Ht))throw`invalid variable name <!import ${r}>`;return{type:"object",import:"{"+u.join(",")+"}",path:ot(a[1])}}}}async function us(r){let t=await zi(r);return t.tag&&(t.tag=t.tag.map(Gi)),t.css&&(t.css=t.css.map(Yi)),t.import&&(t.import=t.import.map(qi)),t}function Vi(r){return["Update_Tag","enterProps","updateProps"].forEach(t=>{Array.isArray(r[t])&&(r[t].length?r[t]=ns(...r[t]):delete r[t])}),r}function Un(r){r.forEach((t,o)=>{r[o]=Vi(t),t.children&&Un(t.children)})}var at=class{connectedCallback(){Ye(this.document,this.component,{state:this.state}),this.__proto__.setAttribute=Ji,delete this.__proto__.initialize,this.connected&&setTimeout(()=>{this.connected()},0)}disconnectedCallback(){this.disconnected&&this.disconnected()}render(){St(this.document,this.component,{state:this.state})}setAttribute(t,o){this.state[t]=o}initialize(){if(this.component=this.initial_component,Un(this.component),this.window_events={},this.css.length){let t=document.createElement("style");t.textContent=this.css,this.document.append(t)}}emitNative(t,o){this.dispatchEvent(new CustomEvent(t,{cancelable:!1,bubbles:!1,detail:o}))}on(t,o,a){this.window_events[t]||(this.window_events[t]=[]);let u=this.window_events[t].find(h=>h.callback===o),m=(...h)=>o.call(this,...h);u||(this.window_events[t].push({callback:o,cb:m}),window.addEventListener(t,m,a))}off(t,o){if(!this.window_events[t])return;let a=this.window_events[t].findIndex(u=>u.callback===o);a!==-1&&(window.removeEventListener(t,this.window_events[t][a].cb),this.window_events[t].splice(a,1))}};function Ji(r,t){this.state[r]=t,this.changed&&this.changed({[r]:t}),setTimeout(()=>{St(this.document,this.component,{state:this.state})},0)}var Kt=(r,t)=>Object.getOwnPropertyNames(t.prototype).filter(o=>o!=="constructor").forEach(o=>r.prototype[o]=t.prototype[o]);var Wi=function(r){"use strict";var t=a,o=Object.prototype.hasOwnProperty;function a(){for(var s={},e=0;e<arguments.length;e++){var n=arguments[e];for(var i in n)o.call(n,i)&&(s[i]=n[i])}return s}let u=s=>s;function m(s){function e(n){if(!Array.isArray(n))throw new Error("Transform must be used on an Array. Received "+JSON.stringify(n));let i=(()=>{let[y]=n;return y.Type in s&&typeof s[y.Type]=="function"?s[y.Type]:u})();if(i.length===2)return i(n,e);let[c,...l]=i(n),f=c.params.filter(Boolean).map(y=>e([y,...l]));return t(c,{params:f})}return e}function h(s){let e=n=>{if(n==null)return n;let i=(()=>"*"in s&&typeof s["*"]=="function"?s["*"]:n.Type in s&&typeof s[n.Type]=="function"?s[n.Type]:u)();if(i.length===2)return i(n,e);let c=i(n),l=c.params.map(e);return t(c,{params:l})};return e}var _={map:m,mapNode:h},E=_,A=E.map,N=E.mapNode,F=function(s){let e=n=>{if(n==null)return n;let{params:i}=n,c=(()=>"*"in s&&typeof s["*"]=="function"?s["*"]:n.Type in s&&typeof s[n.Type]=="function"?s[n.Type]:()=>n)();return c.length===2?(c(n,e),n):(c(n),i.forEach(e),n)};return e},U=F,te=function(s,e,n,i,c,l,f,y){if(e===void 0)throw new Error("invariant requires an error message argument");if(!s){var p;if(e===void 0)p=new Error("Minified exception occurred; use the non-minified dev environment for the full error message and additional helpful warnings.");else{var v=[n,i,c,l,f,y],b=0;p=new Error(e.replace(/%s/g,function(){return v[b++]})),p.name="Invariant Violation"}throw p.framesToPop=1,p}},I=te,ve=typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function ne(s){return s&&s.__esModule?s.default:s}function re(s,e){return e={exports:{}},s(e,e.exports),e.exports}var J=re(function(s,e){(function(n,i){i(e)})(ve,function(n){let i={whitespace:/[ \t]+/,comment:[{match:/\/\/.*?$/},{match:/\/\*[^]*?\*\//,lineBreaks:!0}],number:[{match:/0[xX][0-9a-fA-F]+/},{match:/0[oO][0-9]+/},{match:/0[bB][01]+/},{match:/(?:[0-9]+(?:\.[0-9]+)?e-?[0-9]+)/},{match:/[0-9]+\.[0-9]+|[0-9]+/}],char:[{match:/'(?:\\['\\bfnrtv0]|[^'\\\n])'/,value:ze=>ze.slice(1,-1)}],string:[{match:/"(?:\\["\\rn]|[^"\\\n])*?"/,value:ze=>ze.slice(1,-1)},{match:/'(?:\\['\\bfnrtv0]|[^'\\\n])*?'/,value:ze=>ze.slice(1,-1)},{match:/`(?:\\['\\bfnrtv0]|[^'\\])*?`/,value:ze=>ze.slice(1,-1)}],identifier:{match:/[A-Za-z_$][A-Za-z0-9_$]*/,keywords:{keyword:["break","if","else","import","as","from","export","return","switch","case","default","const","let","for","continue","do","while","throw","function","global","module","type","lambda"],type:["i32","i64","f32","f64","bool"]}},punctuator:["+","++","-","--",">>",">>>","<<","=","==","+=","-=","=>","<=",">=","!=","%","*","/","^","&","~","|","!","**",":","(",")",".","{","}",",","[","]",";",">","<","?","||","&&","{","}","..."],newline:{match:/(?:\r\n|\r|\n)/,lineBreaks:!0}},c="Program",l="Keyword",f="Export",y="Import",p="Statement",v="IfThenElse",b="Select",g="Else",w="UnaryExpression",L="BinaryExpression",R="TernaryExpression",M="NumberLiteral",z="StringLiteral",X="CharacterLiteral",Q="Punctuator",$e="Identifier",pe="ArraySubscript",O="Constant",j="Type",D="ArrayType",Y="DeclType",q="GenericType",V="UserType",H="FunctionType",Z="Declaration",ee="StaticDeclaration",ae="StaticValueList",_e="ImmutableDeclaration",ge="FunctionDeclaration",me="ArrayDeclaration",et="IndirectFunctionCall",ht="FunctionCall",Ue="Loop",dt="MemoryAssignment",ie="Assignment",Er="AssignmentExpression",xr="Param",_n="Typedef",gn="Struct",vn="UnionType",Sn="ReturnStatement",Tn="Sequence",En="ObjectLiteral",xn="Pair",Ar="TypeCast",An="Break",wn="Comment",$n="Sizeof",On="Spread",wr="Closure",Cn="Noop",$r="ClosureType",Ln="Block",Or="ObjectField",Cr="FunctionIndex",Lr="FunctionIdentifier",Pr="FunctionPointer",Ir="FunctionArguments",Nr="FunctionResult",Rr="FunctionLocals",Br="NativeMethod",Pn="Unreachable",kr="Access",Fr="i32",Mr="f32",jr="i64",Dr="f64",Ur="Memory",zr="Table",Gr="bool";n.Program=c,n.Keyword=l,n.Export=f,n.Import=y,n.Statement=p,n.IfThenElse=v,n.Select=b,n.Else=g,n.UnaryExpression=w,n.BinaryExpression=L,n.TernaryExpression=R,n.NumberLiteral=M,n.StringLiteral=z,n.CharacterLiteral=X,n.Punctuator=Q,n.Identifier=$e,n.ArraySubscript=pe,n.Constant=O,n.Type=j,n.ArrayType=D,n.DeclType=Y,n.GenericType=q,n.UserType=V,n.FunctionType=H,n.Declaration=Z,n.StaticDeclaration=ee,n.StaticValueList=ae,n.ImmutableDeclaration=_e,n.FunctionDeclaration=ge,n.ArrayDeclaration=me,n.IndirectFunctionCall=et,n.FunctionCall=ht,n.Loop=Ue,n.MemoryAssignment=dt,n.Assignment=ie,n.AssignmentExpression=Er,n.Param=xr,n.Typedef=_n,n.Struct=gn,n.UnionType=vn,n.ReturnStatement=Sn,n.Sequence=Tn,n.ObjectLiteral=En,n.Pair=xn,n.TypeCast=Ar,n.Break=An,n.Comment=wn,n.Sizeof=$n,n.Spread=On,n.Closure=wr,n.Noop=Cn,n.ClosureType=$r,n.Block=Ln,n.ObjectField=Or,n.FunctionIndex=Cr,n.FunctionIdentifier=Lr,n.FunctionPointer=Pr,n.FunctionArguments=Ir,n.FunctionResult=Nr,n.FunctionLocals=Rr,n.NativeMethod=Br,n.Unreachable=Pn,n.Access=kr,n.i32=Fr,n.f32=Mr,n.i64=jr,n.f64=Dr,n.Memory=Ur,n.Table=zr,n.bool=Gr,n.builtinTypes={i32:Fr,f32:Mr,i64:jr,f64:Dr,Memory:Ur,Table:zr,bool:Gr},n.statements={Program:c,Export:f,Import:y,IfThenElse:v,Else:g,Declaration:Z,ImmutableDeclaration:_e,FunctionDeclaration:ge,ArrayDeclaration:me,Loop:Ue,MemoryAssignment:dt,Assignment:ie,Typedef:_n,Struct:gn,UnionType:vn,ReturnStatement:Sn,Sequence:Tn,ObjectLiteral:En,Pair:xn,Break:An,Comment:wn,Sizeof:$n,Spread:On,Noop:Cn,Block:Ln,Unreachable:Pn},n.default={Program:c,Keyword:l,Export:f,Import:y,Statement:p,IfThenElse:v,Select:b,Else:g,UnaryExpression:w,BinaryExpression:L,TernaryExpression:R,NumberLiteral:M,StringLiteral:z,CharacterLiteral:X,Punctuator:Q,Identifier:$e,ArraySubscript:pe,Constant:O,Type:j,ArrayType:D,DeclType:Y,GenericType:q,UserType:V,FunctionType:H,Declaration:Z,ImmutableDeclaration:_e,FunctionDeclaration:ge,ArrayDeclaration:me,StaticDeclaration:ee,StaticValueList:ae,IndirectFunctionCall:et,FunctionCall:ht,Loop:Ue,MemoryAssignment:dt,Assignment:ie,AssignmentExpression:Er,Param:xr,Typedef:_n,Struct:gn,UnionType:vn,ReturnStatement:Sn,Sequence:Tn,ObjectLiteral:En,Pair:xn,TypeCast:Ar,Break:An,Comment:wn,Sizeof:$n,Spread:On,Closure:wr,Access:kr,Noop:Cn,ClosureType:$r,Block:Ln,ObjectField:Or,FunctionIndex:Cr,FunctionIdentifier:Lr,FunctionPointer:Pr,FunctionArguments:Ir,FunctionResult:Nr,FunctionLocals:Rr,NativeMethod:Br,Unreachable:Pn},n.tokens=i,Object.defineProperty(n,"__esModule",{value:!0})})}),d=ne(J),be=J.tokens,Oe=J.semantics,ye=J.builtinTypes,lt=J.statements,ut=J.i32,Me=J.f32,ac=J.i64,ic=J.f64,xs=re(function(s){(function(e,n){s.exports?s.exports=n():e.moo=n()})(ve,function(){var e=Object.prototype.hasOwnProperty,n=typeof Object.assign=="function"?Object.assign:function(O,j){if(O==null)throw new TypeError("Target cannot be null or undefined");O=Object(O);for(var D=1;D<arguments.length;D++){var Y=arguments[D];if(Y!=null)for(var q in Y)e.call(Y,q)&&(O[q]=Y[q])}return O},i=typeof new RegExp().sticky=="boolean";function c(O){return O&&O.constructor===RegExp}function l(O){return O&&typeof O=="object"&&O.constructor!==RegExp&&!Array.isArray(O)}function f(O){return O.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}function y(O){var j=new RegExp("|"+O);return j.exec("").length-1}function p(O){return"("+O+")"}function v(O){var j=O.map(function(D){return"(?:"+D+")"}).join("|");return"(?:"+j+")"}function b(O){if(typeof O=="string")return"(?:"+f(O)+")";if(c(O)){if(O.ignoreCase)throw new Error("RegExp /i flag not allowed");if(O.global)throw new Error("RegExp /g flag is implied");if(O.sticky)throw new Error("RegExp /y flag is implied");if(O.multiline)throw new Error("RegExp /m flag is implied");return O.source}else throw new Error("not a pattern: "+O)}function g(O){for(var j=Object.getOwnPropertyNames(O),D=[],Y=0;Y<j.length;Y++){var q=j[Y],V=O[q],H=Array.isArray(V)?V:[V],Z=[];H.forEach(function(ee){l(ee)?(Z.length&&D.push(L(q,Z)),D.push(L(q,ee)),Z=[]):Z.push(ee)}),Z.length&&D.push(L(q,Z))}return D}function w(O){for(var j=[],D=0;D<O.length;D++){var Y=O[D];if(!Y.name)throw new Error("Rule has no name: "+JSON.stringify(Y));j.push(L(Y.name,Y))}return j}function L(O,j){(typeof j!="object"||Array.isArray(j)||c(j))&&(j={match:j});var D=n({tokenType:O,lineBreaks:!!j.error,pop:!1,next:null,push:null,error:!1,value:null,getType:null},j),Y=D.match;return D.match=Array.isArray(Y)?Y:Y?[Y]:[],D.match.sort(function(q,V){return c(q)&&c(V)?0:c(V)?-1:c(q)?1:V.length-q.length}),D.keywords&&(D.getType=X(D.keywords)),D}function R(O,j){O=Array.isArray(O)?w(O):g(O);for(var D=null,Y=[],q=[],V=0;V<O.length;V++){var H=O[V];if(H.error){if(D)throw new Error("Multiple error rules not allowed: (for token '"+H.tokenType+"')");D=H}if(H.match.length!==0){Y.push(H);var Z=v(H.match.map(b)),ee=new RegExp(Z);if(ee.test(""))throw new Error("RegExp matches empty string: "+ee);var ae=y(Z);if(ae>0)throw new Error("RegExp has capture groups: "+ee+`
Use (?: \u2026 ) instead`);if(!j&&(H.pop||H.push||H.next))throw new Error("State-switching options are not allowed in stateless lexers (for token '"+H.tokenType+"')");if(!H.lineBreaks&&ee.test(`
`))throw new Error("Rule should declare lineBreaks: "+ee);q.push(p(Z))}}var _e=i?"":"|(?:)",ge=i?"ym":"gm",me=new RegExp(v(q)+_e,ge);return{regexp:me,groups:Y,error:D}}function M(O){var j=R(O);return new Q({start:j},"start")}function z(O,j){var D=Object.getOwnPropertyNames(O);j||(j=D[0]);for(var Y=Object.create(null),q=0;q<D.length;q++){var V=D[q];Y[V]=R(O[V],!0)}for(var q=0;q<D.length;q++)for(var H=Y[D[q]].groups,Z=0;Z<H.length;Z++){var ee=H[Z],ae=ee&&(ee.push||ee.next);if(ae&&!Y[ae])throw new Error("Missing state '"+ae+"' (in token '"+ee.tokenType+"' of state '"+D[q]+"')");if(ee&&ee.pop&&+ee.pop!=1)throw new Error("pop must be 1 (in token '"+ee.tokenType+"' of state '"+D[q]+"')")}return new Q(Y,j)}function X(O){for(var j=Object.create(null),D=Object.create(null),Y=Object.getOwnPropertyNames(O),q=0;q<Y.length;q++){var V=Y[q],H=O[V],Z=Array.isArray(H)?H:[H];Z.forEach(function(me){if((D[me.length]=D[me.length]||[]).push(me),typeof me!="string")throw new Error("keyword must be string (in keyword '"+V+"')");j[me]=V})}function ee(me){return JSON.stringify(me)}var ae="";ae+=`(function(value) {
`,ae+=`switch (value.length) {
`;for(var _e in D){var ge=D[_e];ae+="case "+_e+`:
`,ae+=`switch (value) {
`,ge.forEach(function(me){var et=j[me];ae+="case "+ee(me)+": return "+ee(et)+`
`}),ae+=`}
`}return ae+=`}
`,ae+="})",(0,eval)(ae)}var Q=function(O,j){this.startState=j,this.states=O,this.buffer="",this.stack=[],this.reset()};Q.prototype.reset=function(O,j){return this.buffer=O||"",this.index=0,this.line=j?j.line:1,this.col=j?j.col:1,this.setState(j?j.state:this.startState),this},Q.prototype.save=function(){return{line:this.line,col:this.col,state:this.state}},Q.prototype.setState=function(O){if(!(!O||this.state===O)){this.state=O;var j=this.states[O];this.groups=j.groups,this.error=j.error||{lineBreaks:!0,shouldThrow:!0},this.re=j.regexp}},Q.prototype.popState=function(){this.setState(this.stack.pop())},Q.prototype.pushState=function(O){this.stack.push(this.state),this.setState(O)},Q.prototype._eat=i?function(O){return O.exec(this.buffer)}:function(O){var j=O.exec(this.buffer);return j[0].length===0?null:j},Q.prototype._getGroup=function(O){if(O===null)return-1;for(var j=this.groups.length,D=0;D<j;D++)if(O[D+1]!==void 0)return D;throw new Error("oops")};function $e(){return this.value}if(Q.prototype.next=function(){var O=this.re,j=this.buffer,D=O.lastIndex=this.index;if(D!==j.length){var Y=this._eat(O),q=this._getGroup(Y),V,H;q===-1?(V=this.error,H=j.slice(D)):(H=Y[0],V=this.groups[q]);var Z=0;if(V.lineBreaks){var ee=/\n/g,ae=1;if(H===`
`)Z=1;else for(;ee.exec(H);)Z++,ae=ee.lastIndex}var _e={type:V.getType&&V.getType(H)||V.tokenType,value:V.value?V.value(H):H,text:H,toString:$e,offset:D,lineBreaks:Z,line:this.line,col:this.col},ge=H.length;if(this.index+=ge,this.line+=Z,Z!==0?this.col=ge-ae+1:this.col+=ge,V.shouldThrow)throw new Error(this.formatError(_e,"invalid syntax"));return V.pop?this.popState():V.push?this.pushState(V.push):V.next&&this.setState(V.next),_e}},typeof Symbol<"u"&&Symbol.iterator){var pe=function(O){this.lexer=O};pe.prototype.next=function(){var O=this.lexer.next();return{value:O,done:!O}},pe.prototype[Symbol.iterator]=function(){return this},Q.prototype[Symbol.iterator]=function(){return new pe(this)}}return Q.prototype.formatError=function(O,j){var D=O.value,Y=O.offset,q=O.lineBreaks?D.indexOf(`
`):D.length,V=Math.max(0,Y-O.col+1),H=this.buffer.substring(V,Y+q);return j+=" at line "+O.line+" col "+O.col+`:

`,j+="  "+H+`
`,j+="  "+Array(O.col).join(" ")+"^",j},Q.prototype.clone=function(){return new Q(this.states,this.state)},Q.prototype.has=function(O){for(var j in this.states)for(var D=this.states[j].groups,Y=0;Y<D.length;Y++){var q=D[Y];if(q.tokenType===O||q.keywords&&e.call(q.keywords,O))return!0}return!1},{compile:M,states:z,error:Object.freeze({error:!0})}})}),Jn=Array.prototype.slice,As=function(s){return Jn.call(s)},ws=function(s){return Jn.call(s,1)},Xt=function(s,e,n){var i=n-e.length;switch(i){case 0:return function(){return Ae(s,xe(e,arguments),n)};case 1:return function(c){return Ae(s,xe(e,arguments),n)};case 2:return function(c,l){return Ae(s,xe(e,arguments),n)};case 3:return function(c,l,f){return Ae(s,xe(e,arguments),n)};case 4:return function(c,l,f,y){return Ae(s,xe(e,arguments),n)};case 5:return function(c,l,f,y,p){return Ae(s,xe(e,arguments),n)};case 6:return function(c,l,f,y,p,v){return Ae(s,xe(e,arguments),n)};case 7:return function(c,l,f,y,p,v,b){return Ae(s,xe(e,arguments),n)};case 8:return function(c,l,f,y,p,v,b,g){return Ae(s,xe(e,arguments),n)};case 9:return function(c,l,f,y,p,v,b,g,w){return Ae(s,xe(e,arguments),n)};case 10:return function(c,l,f,y,p,v,b,g,w,L){return Ae(s,xe(e,arguments),n)};default:return $s(s,e,i)}},xe=function(s,e){return s.concat(As(e))},$s=function(s,e,n){var i=Os(n),c="false||function("+i+"){ return processInvocation(fn, concatArgs(args, arguments)); }";return(0,eval)(c)},Os=function(s){for(var e=[],n=0;n<s;n+=1)e.push("a"+n.toString());return e.join(",")},Cs=function(s,e){return s.length>e?s.slice(0,e):s},Ae=function(s,e,n){return e=Cs(e,n),e.length===n?s.apply(null,e):Xt(s,e,n)},Re=function(s){return Xt(s,[],s.length)};Re.to=Re(function(s,e){return Xt(e,[],s)}),Re.adaptTo=Re(function(s,e){return Re.to(s,function(n){var i=ws(arguments).concat(n);return e.apply(this,i)})}),Re.adapt=function(s){return Re.adaptTo(s.length,s)};var wt=Re;function B(s){return s[0]}function Ls(){let s=this.lexer,e=this.Syntax,{extendNode:n,drop:i,nth:c,nuller:l,nonEmpty:f,add:y,flatten:p,compose:v}=this.helpers,{node:b,binary:g,constant:w,identifier:L,statement:R,unary:M,ternary:z,subscript:X,access:Q,fun:$e,declaration:pe,call:O,struct:j,result:D,string:Y,char:q,typedef:V,voidFun:H,type:Z,arrayType:ee,assignment:ae,forLoop:_e,whileLoop:ge,typeGeneric:me,spread:et,builtinDecl:ht,assignmentExpr:Ue,addressOf:dt}=this.nodes(s);return{Lexer:s,ParserRules:[{name:"_$ebnf$1",symbols:[]},{name:"_$ebnf$1",symbols:["_$ebnf$1","wschar"],postprocess:function(ie){return ie[0].concat([ie[1]])}},{name:"_",symbols:["_$ebnf$1"],postprocess:function(ie){return null}},{name:"__$ebnf$1",symbols:["wschar"]},{name:"__$ebnf$1",symbols:["__$ebnf$1","wschar"],postprocess:function(ie){return ie[0].concat([ie[1]])}},{name:"__",symbols:["__$ebnf$1"],postprocess:function(ie){return null}},{name:"wschar",symbols:[/[ \t\n\v\f]/],postprocess:B},{name:"Struct",symbols:["TYPE","__","Identifier","_","EQUALS","_","Union","SEPARATOR"],postprocess:j},{name:"Struct",symbols:["TYPE","__","Identifier","_","EQUALS","_","NativeType","SEPARATOR"],postprocess:j},{name:"Union",symbols:["StructDefinition"],postprocess:B},{name:"Union",symbols:["StructDefinition","_","OR","_","Union"],postprocess:b(e.UnionType)},{name:"StructDefinition",symbols:["ArrayType"],postprocess:B},{name:"StructDefinition",symbols:["Identifier"],postprocess:B},{name:"StructDefinition",symbols:["LCB","_","StructBody","_","RCB"],postprocess:v(b(e.ObjectLiteral),p)},{name:"StructBody",symbols:["StructNameAndType"],postprocess:B},{name:"StructBody",symbols:["StructNameAndType","_","COMMA","_","StructBody"],postprocess:p},{name:"StructNameAndType",symbols:["Identifier","_","COLON","_","Type"],postprocess:b(e.Pair)},{name:"StructNameAndType",symbols:["AddressOf","_","COLON","_","Type"],postprocess:b(e.Pair)},{name:"AddressOf",symbols:["AND","Identifier"],postprocess:dt},{name:"TypeDef",symbols:["TYPE","__","Identifier","_","EQUALS","_","TypeDefinition","_","FATARROW","_","Type","_","SEPARATOR"],postprocess:v(V)},{name:"TypeDefinition",symbols:["LB","_","TypeList","_","RB"],postprocess:p},{name:"TypeDefinition",symbols:["LB","_","RB"],postprocess:p},{name:"TypeList",symbols:["Type"],postprocess:B},{name:"TypeList",symbols:["Type","_","COMMA","_","TypeList"],postprocess:p},{name:"_Type",symbols:["NativeType"],postprocess:B},{name:"_Type",symbols:["GenericType"],postprocess:B},{name:"_Type",symbols:["Identifier"],postprocess:B},{name:"ArrayType",symbols:["_Type","_","LSB","_","RSB"],postprocess:ee},{name:"Type",symbols:["_Type"],postprocess:B},{name:"Type",symbols:["ArrayType"],postprocess:B},{name:"GenericType",symbols:["Identifier","LT","_","StaticObjectLiteral","_","GT"],postprocess:me},{name:"StaticObjectLiteral",symbols:["LCB","_","RCB"],postprocess:v(b(e.ObjectLiteral))},{name:"StaticObjectLiteral",symbols:["LCB","_","StaticPropertyList","_","RCB"],postprocess:v(b(e.ObjectLiteral),p)},{name:"StaticPropertyValue",symbols:["Number"],postprocess:B},{name:"StaticPropertyValue",symbols:["Boolean"],postprocess:B},{name:"StaticPropertyValue",symbols:["StringLiteral"],postprocess:B},{name:"StaticProperty",symbols:["Identifier","_","COLON","_","StaticPropertyValue"],postprocess:b(e.Pair)},{name:"StaticPropertyList",symbols:["StaticProperty"],postprocess:B},{name:"StaticPropertyList",symbols:["StaticProperty","_","COMMA","_","StaticPropertyList"],postprocess:p},{name:"ObjectLiteral",symbols:["LCB","_","RCB"],postprocess:b(e.ObjectLiteral)},{name:"ObjectLiteral",symbols:["LCB","_","PropertyList","_","RCB"],postprocess:v(b(e.ObjectLiteral),p)},{name:"PropertyList",symbols:["Property"],postprocess:B},{name:"PropertyList",symbols:["Property","_","COMMA","_","PropertyList"],postprocess:p},{name:"Property",symbols:["Identifier","_","COLON","_","Ternary"],postprocess:b(e.Pair)},{name:"Property",symbols:["SPREAD","Identifier"],postprocess:et},{name:"Property",symbols:["Identifier"],postprocess:B},{name:"Import",symbols:["IMPORT","_","ImportDefinition","__","FROM","__","StringLiteral","_","SEPARATOR"],postprocess:b(e.Import)},{name:"ImportDefinition",symbols:["LCB","_","ImportAndTypeList","_","RCB"],postprocess:v(b(e.ObjectLiteral),p)},{name:"ImportAndTypeList",symbols:["ImportName"],postprocess:B},{name:"ImportAndTypeList",symbols:["ImportAndType"],postprocess:B},{name:"ImportAndTypeList",symbols:["ImportName","_","COMMA","_","ImportAndTypeList"],postprocess:p},{name:"ImportAndTypeList",symbols:["ImportAndType","_","COMMA","_","ImportAndTypeList"],postprocess:p},{name:"ImportAndType",symbols:["ImportName","_","COLON","_","Type"],postprocess:b(e.Pair)},{name:"ImportAndType",symbols:["ImportName","_","AS","_","Identifier"],postprocess:b(e.BinaryExpression,{value:"as"})},{name:"ImportAndType",symbols:["ImportAndType","_","AS","_","Identifier"],postprocess:b(e.BinaryExpression,{value:"as"})},{name:"ImportName",symbols:["Identifier"],postprocess:B},{name:"If",symbols:["IF","_","LB","_","Expression","_","RB","_","BranchBody"],postprocess:b(e.IfThenElse)},{name:"If",symbols:["IF","_","LB","_","Expression","_","RB","_","BranchBody","_","Else"],postprocess:b(e.IfThenElse)},{name:"Else",symbols:["ELSE","_","BranchBody"],postprocess:b(e.Else)},{name:"BranchBody",symbols:["Statement"],postprocess:B},{name:"BranchBody",symbols:["Block"],postprocess:B},{name:"For",symbols:["FOR","_","LB","_","ForArg","_","SEPARATOR","_","Expression","_","SEPARATOR","_","ForArg","_","RB","_","BranchBody"],postprocess:_e},{name:"ForArg",symbols:["_Assignment"],postprocess:B},{name:"ForArg",symbols:["Ternary"],postprocess:B},{name:"While",symbols:["WHILE","_","LB","_","Expression","_","RB","_","BranchBody"],postprocess:ge},{name:"Break",symbols:["BREAK","_","SEPARATOR"],postprocess:b(e.Break)},{name:"Program",symbols:["_"],postprocess:v(b("Program",{value:"ROOT_NODE"}),p)},{name:"Program",symbols:["_","SourceElementList","_"],postprocess:v(b("Program",{value:"ROOT_NODE"}),p)},{name:"SourceElementList",symbols:["SourceElement"],postprocess:p},{name:"SourceElementList",symbols:["SourceElement","_","SourceElementList"],postprocess:v(i,p,p)},{name:"SourceElement",symbols:["Function"],postprocess:B},{name:"SourceElement",symbols:["GlobalDeclaration"],postprocess:B},{name:"SourceElement",symbols:["GlobalImmutableDeclaration"],postprocess:B},{name:"SourceElement",symbols:["StaticDeclaration"],postprocess:B},{name:"SourceElement",symbols:["Struct"],postprocess:B},{name:"SourceElement",symbols:["TypeDef"],postprocess:B},{name:"SourceElement",symbols:["Export"],postprocess:B},{name:"SourceElement",symbols:["Import"],postprocess:B},{name:"Statement",symbols:["ExpressionStatement"],postprocess:B},{name:"Statement",symbols:["Declaration"],postprocess:B},{name:"Statement",symbols:["ImmutableDeclaration"],postprocess:B},{name:"Statement",symbols:["Assignment"],postprocess:B},{name:"Statement",symbols:["If"],postprocess:B},{name:"Statement",symbols:["For"],postprocess:B},{name:"Statement",symbols:["While"],postprocess:B},{name:"Statement",symbols:["Break"],postprocess:B},{name:"Statement",symbols:["Unreachable"],postprocess:B},{name:"Statement",symbols:["ReturnStatement"],postprocess:B},{name:"Block",symbols:["LCB","_","RCB"],postprocess:b(e.Block)},{name:"Block",symbols:["LCB","_","StatementList","_","RCB"],postprocess:v(b(e.Block),p)},{name:"StatementList",symbols:["Statement"],postprocess:i},{name:"StatementList",symbols:["Statement","_","StatementList"],postprocess:p},{name:"Function",symbols:["FUNCTION","__","Identifier","_","FunctionParameters","_","Block"],postprocess:H},{name:"Function",symbols:["FUNCTION","__","Identifier","_","FunctionParameters","_","FunctionResult","_","Block"],postprocess:$e},{name:"FunctionParameters",symbols:["LB","_","RB"],postprocess:b(e.FunctionArguments)},{name:"FunctionParameters",symbols:["LB","_","ParameterList","_","RB"],postprocess:v(b(e.FunctionArguments),p,p)},{name:"ParameterList",symbols:["NameAndType"],postprocess:B},{name:"ParameterList",symbols:["NameAndType","_","COMMA","_","ParameterList"],postprocess:p},{name:"NameAndType",symbols:["Identifier","_","COLON","_","DeclType"],postprocess:b(e.Pair)},{name:"DeclType",symbols:["Type"],postprocess:v(n({Type:e.DeclType}),c(0))},{name:"FunctionResult",symbols:["COLON","_","Type"],postprocess:v(D,i)},{name:"GlobalDeclaration",symbols:["LET","_","NameAndType","_","SEPARATOR"],postprocess:pe(e.Declaration)},{name:"GlobalDeclaration",symbols:["LET","_","NameAndType","_","EQUALS","_","Atom","_","SEPARATOR"],postprocess:pe(e.Declaration)},{name:"GlobalImmutableDeclaration",symbols:["CONST","_","Identifier","_","COLON","_","GenericType","_","SEPARATOR"],postprocess:ht},{name:"GlobalImmutableDeclaration",symbols:["CONST","_","NameAndType","_","EQUALS","_","ObjectLiteral","_","SEPARATOR"],postprocess:pe(e.ImmutableDeclaration)},{name:"GlobalImmutableDeclaration",symbols:["CONST","_","NameAndType","_","EQUALS","_","Atom","_","SEPARATOR"],postprocess:pe(e.ImmutableDeclaration)},{name:"Declaration",symbols:["LET","_","NameAndType","_","EQUALS","_","Expression","_","SEPARATOR"],postprocess:pe(e.Declaration)},{name:"Declaration",symbols:["LET","_","NameAndType","_","SEPARATOR"],postprocess:pe(e.Declaration)},{name:"ImmutableDeclaration",symbols:["CONST","_","NameAndType","_","EQUALS","_","Expression","_","SEPARATOR"],postprocess:pe(e.ImmutableDeclaration)},{name:"ImmutableDeclaration",symbols:["CONST","_","NameAndType","_","EQUALS","_","ObjectLiteral","_","SEPARATOR"],postprocess:pe(e.ImmutableDeclaration)},{name:"ImmutableDeclaration",symbols:["CONST","_","Identifier","_","COLON","_","GenericType","_","SEPARATOR"],postprocess:ht},{name:"StaticNameAndType",symbols:["Identifier","_","COLON","_","ArrayType"],postprocess:b(e.Pair)},{name:"StaticDeclaration",symbols:["CONST","_","StaticNameAndType","_","EQUALS","_","LSB","_","RSB","_","SEPARATOR"],postprocess:pe(e.StaticDeclaration)},{name:"StaticDeclaration",symbols:["CONST","_","StaticNameAndType","_","EQUALS","_","LSB","_","StaticValueList","_","RSB","_","SEPARATOR"],postprocess:v(pe(e.StaticDeclaration),p)},{name:"StaticValueList",symbols:["Atom"],postprocess:B},{name:"StaticValueList",symbols:["Atom","_","COMMA","_","StaticValueList"],postprocess:p},{name:"Unreachable",symbols:["THROW","_","SEPARATOR"],postprocess:b(e.Unreachable)},{name:"Unreachable",symbols:["THROW","_","Expression","_","SEPARATOR"],postprocess:b(e.Unreachable)},{name:"Pair",symbols:["Identifier","_","COLON","_","Identifier"],postprocess:b(e.Pair)},{name:"Export",symbols:["EXPORT","__","ImmutableDeclaration"],postprocess:b(e.Export,{value:"export"})},{name:"Export",symbols:["EXPORT","__","Function"],postprocess:b(e.Export,{value:"export"})},{name:"Export",symbols:["EXPORT","__","TypeDef"],postprocess:b(e.Export,{value:"export"})},{name:"Export",symbols:["EXPORT","__","Struct"],postprocess:b(e.Export,{value:"export"})},{name:"ReturnStatement",symbols:["RETURN","__","Expression","_","SEPARATOR"],postprocess:b(e.ReturnStatement)},{name:"ReturnStatement$subexpression$1",symbols:[{literal:";"}],postprocess:l},{name:"ReturnStatement",symbols:["RETURN","ReturnStatement$subexpression$1"],postprocess:b(e.ReturnStatement)},{name:"Assignment",symbols:["_Assignment","_","SEPARATOR"],postprocess:B},{name:"_Assignment",symbols:["Subscript","_","EQUALS","_","Expression"],postprocess:ie=>ae(ie,"=")},{name:"_Assignment",symbols:["Subscript","_","PLSEQUALS","_","Expression"],postprocess:ie=>ae(ie,"+=")},{name:"_Assignment",symbols:["Subscript","_","MINEQUALS","_","Expression"],postprocess:ie=>ae(ie,"-=")},{name:"_Assignment",symbols:["Subscript","_","EQUALS","_","ObjectLiteral"],postprocess:ie=>ae(ie,"=")},{name:"ExpressionStatement",symbols:["Call","_","SEPARATOR"],postprocess:B},{name:"Expression",symbols:["AssignmentExpression"],postprocess:B},{name:"AssignmentExpression",symbols:["Identifier","_","EQUALS","_","Ternary"],postprocess:ie=>Ue(ie,"=")},{name:"AssignmentExpression",symbols:["Identifier","_","PLSEQUALS","_","Ternary"],postprocess:ie=>Ue(ie,"+=")},{name:"AssignmentExpression",symbols:["Identifier","_","MINEQUALS","_","Ternary"],postprocess:ie=>Ue(ie,"-=")},{name:"AssignmentExpression",symbols:["Ternary"],postprocess:B},{name:"Ternary",symbols:["Ternary","_","QUESTION","_","TernaryPair"],postprocess:z},{name:"Ternary",symbols:["Binary"],postprocess:B},{name:"TernaryPair",symbols:["Expression","_","COLON","_","Expression"],postprocess:b(e.Pair)},{name:"Binary",symbols:["Logical"],postprocess:B},{name:"Logical",symbols:["Logical","_",{literal:"||"},"_","Bitwise"],postprocess:g},{name:"Logical",symbols:["Logical","_",{literal:"&&"},"_","Bitwise"],postprocess:g},{name:"Logical",symbols:["Bitwise"],postprocess:B},{name:"Bitwise",symbols:["Bitwise","_",{literal:"|"},"_","Sum"],postprocess:g},{name:"Bitwise",symbols:["Bitwise","_",{literal:"^"},"_","Sum"],postprocess:g},{name:"Bitwise",symbols:["Bitwise","_",{literal:"&"},"_","Sum"],postprocess:g},{name:"Bitwise",symbols:["Equality"],postprocess:B},{name:"Equality",symbols:["Equality","_",{literal:"=="},"_","Comparison"],postprocess:g},{name:"Equality",symbols:["Equality","_",{literal:"!="},"_","Comparison"],postprocess:g},{name:"Equality",symbols:["Comparison"],postprocess:B},{name:"Comparison",symbols:["Comparison","_",{literal:"<"},"_","Shift"],postprocess:g},{name:"Comparison",symbols:["Comparison","_",{literal:">"},"_","Shift"],postprocess:g},{name:"Comparison",symbols:["Comparison","_",{literal:"<="},"_","Shift"],postprocess:g},{name:"Comparison",symbols:["Comparison","_",{literal:">="},"_","Shift"],postprocess:g},{name:"Comparison",symbols:["Shift"],postprocess:B},{name:"Shift",symbols:["Shift","_",{literal:">>"},"_","Sum"],postprocess:g},{name:"Shift",symbols:["Shift","_",{literal:"<<"},"_","Sum"],postprocess:g},{name:"Shift",symbols:["Shift","_",{literal:">>>"},"_","Sum"],postprocess:g},{name:"Shift",symbols:["Sum"],postprocess:B},{name:"Sum",symbols:["Sum","_",{literal:"+"},"_","Product"],postprocess:g},{name:"Sum",symbols:["Sum","_",{literal:"-"},"_","Product"],postprocess:g},{name:"Sum",symbols:["Product"],postprocess:B},{name:"Product",symbols:["Product","_",{literal:"*"},"_","Typecast"],postprocess:g},{name:"Product",symbols:["Product","_",{literal:"/"},"_","Typecast"],postprocess:g},{name:"Product",symbols:["Product","_",{literal:"%"},"_","Typecast"],postprocess:g},{name:"Product",symbols:["Typecast"],postprocess:B},{name:"Typecast",symbols:["Expression","_","COLON","_","DeclType"],postprocess:b(e.Pair)},{name:"Typecast",symbols:["Expression","_","AS","_","DeclType"],postprocess:b(e.Pair)},{name:"Typecast",symbols:["Unary"],postprocess:B},{name:"Unary",symbols:[{literal:"!"},"Call"],postprocess:M},{name:"Unary",symbols:[{literal:"~"},"Call"],postprocess:M},{name:"Unary",symbols:[{literal:"-"},"Call"],postprocess:M},{name:"Unary",symbols:[{literal:"+"},"Call"],postprocess:M},{name:"Unary",symbols:[{literal:"++"},"Call"],postprocess:M},{name:"Unary",symbols:[{literal:"--"},"Call"],postprocess:M},{name:"Unary",symbols:["Call"],postprocess:B},{name:"Call",symbols:["Subscript","_","LB","_","ArgumentList","_","RB"],postprocess:v(O,p)},{name:"Call",symbols:["Subscript","_","LB","_","RB"],postprocess:O},{name:"Call",symbols:["Subscript"],postprocess:B},{name:"ArgumentList",symbols:["Expression"],postprocess:B},{name:"ArgumentList",symbols:["NativeType"],postprocess:B},{name:"ArgumentList",symbols:["Expression","_","COMMA","_","ArgumentList"],postprocess:p},{name:"Subscript",symbols:["Access","LSB","_","Expression","_","RSB","Subscript"],postprocess:X},{name:"Subscript",symbols:["Access","LSB","_","Expression","_","RSB"],postprocess:X},{name:"Subscript",symbols:["Access"],postprocess:B},{name:"Access",symbols:["Access","DOT","Identifier"],postprocess:v(Q,i)},{name:"Access",symbols:["NativeType","DOT","Access"],postprocess:v(Q,i)},{name:"Access",symbols:["Grouping"],postprocess:B},{name:"Grouping",symbols:["LB","_","Expression","_","RB"],postprocess:c(2)},{name:"Grouping",symbols:["Atom"],postprocess:B},{name:"Atom",symbols:["Identifier"],postprocess:B},{name:"Atom",symbols:["StringLiteral"],postprocess:B},{name:"Atom",symbols:["CharacterLiteral"],postprocess:B},{name:"Atom",symbols:["Number"],postprocess:B},{name:"NativeType",symbols:[s.has("type")?{type:"type"}:Z],postprocess:Z},{name:"Identifier",symbols:[s.has("identifier")?{type:"identifier"}:L],postprocess:L},{name:"Number",symbols:[s.has("number")?{type:"number"}:number],postprocess:w},{name:"StringLiteral",symbols:[s.has("string")?{type:"string"}:Y],postprocess:Y},{name:"CharacterLiteral",symbols:[s.has("char")?{type:"char"}:q],postprocess:q},{name:"word",symbols:[/[a-zA-Z_]/],postprocess:B},{name:"word",symbols:["word",/[a-zA-Z0-9_]/],postprocess:y},{name:"digit",symbols:[/[0-9]/],postprocess:B},{name:"digit",symbols:["digit",/[0-9]/],postprocess:y},{name:"SEPARATOR",symbols:["_",{literal:";"}],postprocess:l},{name:"QUESTION",symbols:[{literal:"?"}],postprocess:l},{name:"COMMA",symbols:[{literal:","}],postprocess:l},{name:"AND",symbols:[{literal:"&"}],postprocess:l},{name:"DOT",symbols:[{literal:"."}],postprocess:l},{name:"LB",symbols:[{literal:"("}],postprocess:l},{name:"RB",symbols:[{literal:")"}],postprocess:l},{name:"LSB",symbols:[{literal:"["}],postprocess:l},{name:"RSB",symbols:[{literal:"]"}],postprocess:l},{name:"LCB",symbols:[{literal:"{"}],postprocess:l},{name:"RCB",symbols:[{literal:"}"}],postprocess:l},{name:"OR",symbols:[{literal:"|"}],postprocess:l},{name:"COLON",symbols:[{literal:":"}],postprocess:l},{name:"EQUALS",symbols:[{literal:"="}],postprocess:l},{name:"PLSEQUALS",symbols:[{literal:"+="}],postprocess:l},{name:"MINEQUALS",symbols:[{literal:"-="}],postprocess:l},{name:"GT",symbols:[{literal:">"}],postprocess:l},{name:"LT",symbols:[{literal:"<"}],postprocess:l},{name:"FATARROW",symbols:[{literal:"=>"}],postprocess:l},{name:"SPREAD",symbols:[{literal:"..."}],postprocess:l},{name:"FUNCTION",symbols:[{literal:"function"}],postprocess:l},{name:"LET",symbols:[{literal:"let"}],postprocess:l},{name:"CONST",symbols:[{literal:"const"}],postprocess:l},{name:"EXPORT",symbols:[{literal:"export"}],postprocess:l},{name:"IMPORT",symbols:[{literal:"import"}],postprocess:l},{name:"AS",symbols:[{literal:"as"}],postprocess:l},{name:"FROM",symbols:[{literal:"from"}],postprocess:l},{name:"RETURN",symbols:[{literal:"return"}],postprocess:l},{name:"TYPE",symbols:[{literal:"type"}],postprocess:l},{name:"IF",symbols:[{literal:"if"}],postprocess:l},{name:"ELSE",symbols:[{literal:"else"}],postprocess:l},{name:"FOR",symbols:[{literal:"for"}],postprocess:l},{name:"WHILE",symbols:[{literal:"while"}],postprocess:l},{name:"SWITCH",symbols:[{literal:"switch"}],postprocess:l},{name:"DO",symbols:[{literal:"do"}],postprocess:l},{name:"THROW",symbols:[{literal:"throw"}],postprocess:l},{name:"BREAK",symbols:[{literal:"break"}],postprocess:l}],ParserStart:"Program"}}function Wn(s){return s[0]}function Qn(){let s=this.Syntax,{flatten:e}=this.helpers,{node:n}=this.nodes(this.lexer);return{Lexer:void 0,ParserRules:[{name:"TypeList",symbols:["DefaultArgument"],postprocess:Wn},{name:"TypeList",symbols:["DefaultArgument","_","COMMA","_","TypeList"],postprocess:e},{name:"DefaultArgument",symbols:["Type","_","EQUALS","_","Atom"],postprocess:n(s.Assignment)},{name:"ParameterList",symbols:["DefaultFunctionArgument"],postprocess:Wn},{name:"ParameterList",symbols:["DefaultFunctionArgument","_","COMMA","_","ParameterList"],postprocess:e},{name:"DefaultFunctionArgument",symbols:["NameAndType","_","EQUALS","_","Atom"],postprocess:n(s.Assignment)}],ParserStart:"TypeList"}}var Hn=re(function(s){(function(e,n){s.exports?s.exports=n():e.nearley=n()})(ve,function(){function e(y,p,v){return this.id=++e.highestId,this.name=y,this.symbols=p,this.postprocess=v,this}e.highestId=0,e.prototype.toString=function(y){function p(b){return b.literal?JSON.stringify(b.literal):b.type?"%"+b.type:b.toString()}var v=typeof y>"u"?this.symbols.map(p).join(" "):this.symbols.slice(0,y).map(p).join(" ")+" \u25CF "+this.symbols.slice(y).map(p).join(" ");return this.name+" \u2192 "+v};function n(y,p,v,b){this.rule=y,this.dot=p,this.reference=v,this.data=[],this.wantedBy=b,this.isComplete=this.dot===y.symbols.length}n.prototype.toString=function(){return"{"+this.rule.toString(this.dot)+"}, from: "+(this.reference||0)},n.prototype.nextState=function(y){var p=new n(this.rule,this.dot+1,this.reference,this.wantedBy);return p.left=this,p.right=y,p.isComplete&&(p.data=p.build()),p},n.prototype.build=function(){var y=[],p=this;do y.push(p.right.data),p=p.left;while(p.left);return y.reverse(),y},n.prototype.finish=function(){this.rule.postprocess&&(this.data=this.rule.postprocess(this.data,this.reference,f.fail))};function i(y,p){this.grammar=y,this.index=p,this.states=[],this.wants={},this.scannable=[],this.completed={}}i.prototype.process=function(y){for(var p=this.states,v=this.wants,b=this.completed,g=0;g<p.length;g++){var w=p[g];if(w.isComplete){if(w.finish(),w.data!==f.fail){for(var L=w.wantedBy,R=L.length;R--;){var M=L[R];this.complete(M,w)}if(w.reference===this.index){var z=w.rule.name;(this.completed[z]=this.completed[z]||[]).push(w)}}}else{var z=w.rule.symbols[w.dot];if(typeof z!="string"){this.scannable.push(w);continue}if(v[z]){if(v[z].push(w),b.hasOwnProperty(z))for(var X=b[z],R=0;R<X.length;R++){var Q=X[R];this.complete(w,Q)}}else v[z]=[w],this.predict(z)}}},i.prototype.predict=function(y){for(var p=this.grammar.byName[y]||[],v=0;v<p.length;v++){var b=p[v],g=this.wants[y],w=new n(b,0,this.index,g);this.states.push(w)}},i.prototype.complete=function(y,p){var v=y.nextState(p);this.states.push(v)};function c(y,p){this.rules=y,this.start=p||this.rules[0].name;var v=this.byName={};this.rules.forEach(function(b){v.hasOwnProperty(b.name)||(v[b.name]=[]),v[b.name].push(b)})}c.fromCompiled=function(b,p){var v=b.Lexer;b.ParserStart&&(p=b.ParserStart,b=b.ParserRules);var b=b.map(function(w){return new e(w.name,w.symbols,w.postprocess)}),g=new c(b,p);return g.lexer=v,g};function l(){this.reset("")}l.prototype.reset=function(y,p){this.buffer=y,this.index=0,this.line=p?p.line:1,this.lastLineBreak=p?-p.col:0},l.prototype.next=function(){if(this.index<this.buffer.length){var y=this.buffer[this.index++];return y===`
`&&(this.line+=1,this.lastLineBreak=this.index),{value:y}}},l.prototype.save=function(){return{line:this.line,col:this.index-this.lastLineBreak}},l.prototype.formatError=function(y,p){var v=this.buffer;if(typeof v=="string"){var b=v.indexOf(`
`,this.index);b===-1&&(b=v.length);var g=v.substring(this.lastLineBreak,b),w=this.index-this.lastLineBreak;return p+=" at line "+this.line+" col "+w+`:

`,p+="  "+g+`
`,p+="  "+Array(w).join(" ")+"^",p}else return p+" at index "+(this.index-1)};function f(y,p,v){if(y instanceof c)var b=y,v=p;else var b=c.fromCompiled(y,p);this.grammar=b,this.options={keepHistory:!1,lexer:b.lexer||new l};for(var g in v||{})this.options[g]=v[g];this.lexer=this.options.lexer,this.lexerState=void 0;var w=new i(b,0);this.table=[w],w.wants[b.start]=[],w.predict(b.start),w.process(),this.current=0}return f.fail={},f.prototype.feed=function(y){var p=this.lexer;p.reset(y,this.lexerState);for(var v;v=p.next();){var b=this.table[this.current];this.options.keepHistory||delete this.table[this.current-1];var g=this.current+1,w=new i(this.grammar,g);this.table.push(w);for(var L=v.text!==void 0?v.text:v.value,R=p.constructor===l?v.value:v,M=b.scannable,z=M.length;z--;){var X=M[z],Q=X.rule.symbols[X.dot];if(Q.test?Q.test(R):Q.type?Q.type===v.type:Q.literal===L){var $e=X.nextState({data:R,token:v,isToken:!0,reference:g-1});w.states.push($e)}}if(w.process(),w.states.length===0){var pe=this.lexer.formatError(v,"invalid syntax")+`
`;pe+="Unexpected "+(v.type?v.type+" token: ":""),pe+=JSON.stringify(v.value!==void 0?v.value:v)+`
`;var O=new Error(pe);throw O.offset=this.current,O.token=v,O}this.options.keepHistory&&(b.lexerState=p.save()),this.current++}return b&&(this.lexerState=p.save()),this.results=this.finish(),this},f.prototype.save=function(){var y=this.table[this.current];return y.lexerState=this.lexerState,y},f.prototype.restore=function(y){var p=y.index;this.current=p,this.table[p]=y,this.table.splice(p+1),this.lexerState=y.lexerState,this.results=this.finish()},f.prototype.rewind=function(y){if(!this.options.keepHistory)throw new Error("set option `keepHistory` to enable rewinding");this.restore(this.table[y])},f.prototype.finish=function(){var y=[],p=this.grammar.start,v=this.table[this.table.length-1];return v.states.forEach(function(b){b.rule.name===p&&b.dot===b.rule.symbols.length&&b.reference===0&&b.data!==f.fail&&y.push(b)}),y.map(function(b){return b.data})},{Parser:f,Grammar:c,Rule:e}})}),Ps=Hn.Parser,Is=Hn.Grammar,Ns=(...s)=>s.reduce((e,n)=>(...i)=>e(n(...i))),P=Object.assign||function(s){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(s[i]=n[i])}return s},Rs=function(s,e){var n={};for(var i in s)e.indexOf(i)>=0||Object.prototype.hasOwnProperty.call(s,i)&&(n[i]=s[i]);return n};let W=wt((s,e)=>{let{meta:n}=s,i=Rs(s,["meta"]);return P({},e,{meta:P({},e.meta,n)},i)}),Bs=s=>e=>e[s],ks=()=>null,qe=s=>Array.isArray(s)?!!s.length:s!=null,Fs=s=>`${s[0]}${s[1]}`,Ms=s=>s.reduce((e,n)=>(Array.isArray(n),e.concat(n)),[]),de=s=>s.filter(qe);var js={nth:Bs,nuller:ks,nonEmpty:qe,add:Fs,flatten:Ms,compose:Ns,drop:de,extendNode:W};let Ds=s=>{let{col:e,line:n}=s;return s.lines.length?{col:e,line:n,sourceLine:s.lines[s.line-1]}:{col:e,line:n,sourceLine:""}};function Us(s){let e=(c,l={})=>f=>{let y=f.filter(qe),{value:p="",meta:v={}}=l,b=Ds(s),g=y[y.length-1]&&y[y.length-1].range?y[y.length-1].range[1]:P({},b,{col:b.col+p.length});return{value:p,type:null,Type:c,toString(){},meta:v,range:[b,g],params:y}},n=c=>{let[l,f,y]=c.filter(qe),p=d.BinaryExpression;return(f.value==="||"||f.value==="&&")&&(p=d.Select),e(p,{value:f.value})([l,y])},i=c=>{let[l]=de(c);return W({type:l!=null&&l.value!=="void"?l.value:null},e(d.FunctionResult)(c))};return{node:e,binary:n,constant:c=>{let l=c[0].value;return W({value:`${l}`,type:l.toString().indexOf(".")!==-1?"f32":"i32"},e(d.Constant)([]))},identifier:c=>e("Identifier",{value:c.join("")})([]),unary:([c,l])=>{let f=[l];return c.value==="-"&&(f=[P({},l,{value:"0",Type:d.Constant,params:[],meta:{}}),l]),W({value:c.value,params:f},e(d.UnaryExpression)([c,l]))},ternary:c=>W({value:"?"},e(d.TernaryExpression)(c)),subscript:c=>{let[l,f]=c.filter(qe);return W({value:l.value,params:[l,f]},e(d.ArraySubscript)([l,f]))},access(c){return W({value:c[0].value+"."+c[1].value},e(d.Access)(c))},fun:c=>{let[l,f,y,p]=c.filter(qe);return P({},l,{Type:d.FunctionDeclaration,meta:[],params:[f,y,p]})},declaration:c=>l=>{let[f,...y]=de(l),[p,v]=f.params;return W({value:p.value,type:v.value},e(c)(y))},call:c=>{let[l,...f]=de(c);return W({value:l.value},e(d.FunctionCall)([l,...f]))},struct:c=>{let[l,...f]=de(c);return W({value:l.value},e(d.Struct)(f))},result:i,string:c=>W({value:c[0].value,type:"i32"},e(d.StringLiteral)([])),char(c){return W({value:c[0].value,type:"i32"},e(d.CharacterLiteral)([]))},type(c){return W({value:c[0].value,type:c[0].value,params:[]},e(d.Type)(c))},arrayType(c){let f=de(c)[0];return W({value:f.value+"[]",type:f.type+"[]",params:[]},e(d.ArrayType)(c))},typeGeneric(c){let[l,f]=de(c);return W({value:l.value,type:l.value,params:[f]},e(d.Type)(c))},typedef:c=>{let[l,f,y]=de(c);return W({value:l.value,params:[e(d.FunctionArguments)(f),W({type:y.value},e(d.FunctionResult)([y]))],type:y.type},e(d.Typedef)([l,f,i]))},voidFun:c=>{let l=de(c),[f,y,p]=l,v=W({type:null},e(d.FunctionResult)([]));return W({value:f.value,params:[y,v,p]},e(d.FunctionDeclaration)(l))},assignment(c,l){if(["-=","+="].includes(l)){let f=l[0],[y,p]=de(c),v=n([y,{value:f},p]);return e(d.Assignment,{value:"="})([y,v])}return e(d.Assignment,{value:l})(c)},assignmentExpr(c,l){if(["-=","+="].includes(l)){let f=l[0],[y,p]=de(c),v=n([y,{value:f},p]);return e(d.AssignmentExpression,{value:"="})([y,v])}return e(d.AssignmentExpression,{value:l})(c)},forLoop(c){let[l,f,y,...p]=de(c);return e(d.Loop)([l,f,...p,y])},whileLoop(c){let l=e(d.Noop)([]);return e(d.Loop)([l,...c])},spread(c){return e(d.Spread)(c)},builtinDecl(c){let[l,f]=de(c);return W({value:l.value,type:f.value,params:[f]},e(d.ImmutableDeclaration)(c))},addressOf(c){let[l]=de(c);return W({value:l.value,params:[]},e("AddressOf")(c))}}}function zs(){let s=xs.compile(be);return{current:null,lines:[],get line(){return s.line},get col(){return s.col},save(){return s.save()},reset(e,n){return this.lines=e.split(`
`),s.reset(e,n)},next(){let e=s.next();for(;e&&e.type==="comment";)e=s.next();return this.current=e,this.current},formatError(e){return s.formatError(e)},has(e){return s.has(e)}}}var Zt=wt(function(s,e){let n=[Ls,Qn,...s],i={lexer:zs(),nodes:Us,helpers:js,Syntax:d},c=n.slice(1).reduce((f,y)=>{let p=y.call(i);return P({},f,{ParserRules:f.ParserRules.concat(p.ParserRules)})},n[0].call(i)),l=new Ps(Is.fromCompiled(c));return l.feed(e),I(l.results.length===1,`PANIC - Ambiguous Syntax! Number of productions (${l.results.length})`),l.results[0]});let Gs=s=>{let e,n=s.reduce((i,c)=>c(l=>i(l,e)),([i])=>i);return(i,c)=>(e=c,n(i,e))},Ys=s=>{let e=[],n=s.reduce((i,c)=>(Object.entries(c).forEach(([l,f])=>{if(l==="*"){e.push(f);return}i[l]==null&&(i[l]=[...e]),i[l].push(f)}),i),{});return Object.entries(n).reduce((i,[c,l])=>(i[c]=Gs(l),i),{})},Kn=Symbol("scope namespace"),Xn=Symbol("signature");function qs(s,e){return[...s,{[Kn]:e,[Xn]:{result:null,arguments:null}}]}function Vs(s){return s.slice(0,-1)}function Zn(s){return s[s.length-1]}function Js(s,e,n){let i=Zn(s);return i&&(i[e]=n),i}function Ws(s,e){let i=s.length-1;for(i;i>=0;i--){let c=s[i][e];if(c)return c}return null}function Qs(s,e){let n=Object.keys(s).indexOf(e);return n>-1?n:Object.keys(s).length}var Hs={enter:qs,exit:Vs,add:Js,find:Ws,current:Zn,index:Qs,namespace:Kn,signature:Xn};let{enter:Ks,exit:Xs,add:Zs,find:eo,current:to,namespace:no,signature:ro,index:so}=Hs;var Be={enter:Ks,exit:Xs,add:Zs,find:eo,current:to,namespace:no,index:so,signature:ro},er=Be.enter,oo=Be.exit,je=Be.current,Ve=Be.find,ao=Be.add,tr=Be.index,nr=Be.namespace,Je=Be.signature;let Ce="function/index",$t="LOCAL_INDEX",Le="global/index",Ot="type/const",pt="TYPE_INDEX",io="OBJECT_SIZE",en="type/cast",tn="AST_METADATA",nn="FUNCTION_METADATA",ke=s=>{switch(s){case"i32":case"bool":return 0;case"i64":return 1;case"f32":return 2;case"f64":return 3;default:return-1}},rn=s=>{let e=s.params.reduce((i,{type:c})=>ke(i)<ke(c)?c:i,s.type),n=s.params.map(i=>i.type!=null&&ke(i.type)!==ke(e)?i.Type===d.Constant?W({type:e},i):W({type:e,value:i.value,Type:d.TypeCast,meta:{[en]:{to:e,from:i.type}},params:[i]},i):i);return P({},s,{params:n,type:e})};function co(){return{semantics(){let s=e=>([n,i])=>{let c=je(i.scopes),l=tr(c,n.value);return c[n.value]=W({params:n.params.map(W({type:n.type})),meta:P({},n.meta,{[c[nr]]:l,[Ot]:n.Type===d.ImmutableDeclaration}),Type:d.Declaration},n),e([c[n.value],i])};return{[d.Export]:e=>([n,i])=>{let c=e([n,i]),[l]=c.params;return i.exports[l.value]=l,c},[d.Declaration]:s,[d.ImmutableDeclaration]:s,[d.Select]:e=>([n,i],c)=>rn(P({},n,{params:n.params.map(l=>c([l,i]))})),[d.BinaryExpression]:e=>([n,i],c)=>rn(P({},n,{params:n.params.map(l=>c([l,i]))})),[d.Pair]:e=>(n,i)=>{let[c,l]=n,f=c.params.map(g=>i([g,l])),[y,p]=f,{type:v}=y,{value:b}=p;return P({},c,{type:b,value:y.value,Type:d.TypeCast,meta:P({},c.meta,{[en]:{to:b,from:v}}),params:[y]})},[d.Identifier]:e=>n=>{let[i,c]=n,l=Ve(c.scopes,i.value);return l?P({},i,{meta:P({},i.meta,l.meta),type:l.type}):i.value==="null"?P({},i,{value:"0",type:"i32",Type:d.Constant}):e(n)},[d.TernaryExpression]:e=>([n,i])=>e([rn(P({},n,{params:[...n.params[1].params,n.params[0]]})),i])}}}}function lo(){return{semantics(){return{"*":s=>function([e,...n],i){return P({},e,{params:e.params.map(l=>i([l,...n]))})}}}}}function uo(){return{semantics(){return{[d.Typedef]:s=>([e])=>e,[d.Program]:s=>e=>{let[n,i]=e,{types:c}=i,l=N({[d.Export]:(f,y)=>{let[p]=f.params;return p!=null&&[d.Typedef,d.Struct].includes(p.Type)?y(P({},p,{meta:P({},p.meta,{EXPORTED:!0})})):f},[d.Typedef]:(f,y)=>{let p=0,[v]=f.params,b=[];U({Assignment(w){let L=w.params[1];b.push(L)},Type(){p+=1}})(v);let g=P({},f,{meta:P({},f.meta,{FUNCTION_METADATA:{argumentsCount:p},DEFAULT_ARGUMENTS:b})});return c[f.value]=g,g}})(n);return s([l,i])}}}}}let po={i64:63,f64:63,i32:31,f32:31},fo={i64:"0xffffffffffff",f64:"0xffffffffffff",i32:"0xffffff",f32:"0xffffff"};function mo(){return{semantics({stmt:s}){return{[d.UnaryExpression]:e=>(n,i)=>{let[c,l]=n,[f,y]=c.params.map(p=>i([p,l]));switch(c.value){case"!":let p=po[f.type];return i([s`(((${f} >> ${p}) | ((~${f} + 1) >> ${p})) + 1);`,l]);case"~":let v=fo[i([f,l]).type];return i([s`(${f} ^ ${v});`,l]);case"-":if(y.Type===d.Constant)return P({},y,{meta:P({},y.meta,{SIGN:-1})});default:return i([P({},c,{type:y.type,params:[P({},f,{type:y.type}),y],Type:d.BinaryExpression}),l])}}}}}}function yo(){return{semantics(){return{[d.FunctionDeclaration]:s=>([e,n],i)=>{n.scopes=er(n.scopes,$t);let c=je(n.scopes),[l,f,y]=e.params,[p,v]=[l,f].map(g=>i([g,n])),b=P({},e,{type:c[Je].result,meta:P({},e.meta,{[Ce]:Object.keys(n.functions).length,[nn]:{argumentsCount:c[Je].arguments.length,locals:je(n.scopes)}})});return n.functions[e.value]=b,b.params=[p,v,i([y,n])],n.scopes=oo(n.scopes),b},[d.FunctionResult]:s=>([e,n])=>{let i=je(n.scopes);return i[Je].result=e.type,e},[d.FunctionArguments]:s=>([e,n],i)=>{let c=je(n.scopes);return c[Je].arguments=[],N({[d.Pair]:(f,y)=>{let[p,v]=f.params,b=i([v,n]);return c[Je].arguments.push(f),i([P({},f,{value:p.value,type:b.value,params:[],Type:d.Declaration}),n]),P({},f,{params:[p,b]})}})(P({},e,{params:e.params.filter(Boolean)}))},[d.FunctionCall]:s=>([e,n])=>{let{functions:i}=n,c=Object.keys(i).indexOf(e.value);return s([P({},e,{type:i[e.value]!=null?i[e.value].type:null,meta:{[Ce]:c},params:e.params.slice(1)}),n])},[d.ReturnStatement]:s=>([e,n],i)=>{let c=je(n.scopes),[l]=e.params.map(p=>i([p,n])),{result:f}=c[Je];if(l!=null&&l.Type===d.Constant&&ke(l.type)!==ke(f))return P({},e,{type:f,params:[P({},l,{type:f})]});let y=l?l.type:null;return P({},e,{params:[l],type:y})}}}}}function ho(){return{semantics:()=>({[d.Import]:s=>e=>{let[n,i]=e;return N({[d.BinaryExpression]:(c,l)=>{let[f,y]=c.params;if(f.Type!==d.Pair)return c;let[p,v]=f.params;return l(P({},f,{params:[P({},y,{meta:P({},p.meta,{AS:p.value})}),v]}))},[d.Pair]:(c,l)=>{let{types:f,functions:y}=i,[p,v]=c.params;if(f[v.value]!=null){let b=Object.keys(y).length,g=Object.keys(f).indexOf(v.value),w=P({},p,{id:p.value,type:f[v.value].type,meta:P({},p.meta,{[Ce]:b,[pt]:g,FUNCTION_METADATA:f[v.value].meta.FUNCTION_METADATA,DEFAULT_ARGUMENTS:f[v.value].meta.DEFAULT_ARGUMENTS})});return y[p.value]=w,P({},c,{params:[w,f[v.value]]})}if(["Table","Memory"].includes(v.value)){let b=v.value==="Memory"?"memories":"tables";i[b].push(p)}else{let b=je(i.scopes),g=tr(b,p.value);ao(i.scopes,p.value,P({},p,{meta:{[b[nr]]:g,[Ot]:!0},type:v.type}))}return c}})(n)}})}}function bo(){return{semantics(){let s=e=>([n,i])=>n.type==="bool"?e([P({},n,{type:"i32"}),i]):e([n,i]);return{[d.Identifier]:e=>(n,i)=>{let[c,l]=n;return c.value==="true"||c.value==="false"?i([P({},c,{Type:d.Constant,value:c.value==="true"?"1":"0",type:"i32"}),l]):e(n)},[d.FunctionResult]:e=>([n,i])=>n.type==="bool"?e([P({},n,{type:"i32"}),i]):e([n,i]),[d.Declaration]:s,[d.ImmutableDeclaration]:s}}}}function rr(s,e){let n=[null,e];return function(i){return n[0]=i,s(n)}}function _o(s,e){let n={},i=0;for(i;i<s.length;i++)n[s[i]]=e[s[i]];return n}let go={i32:2,f32:2,i64:3,f64:3},vo="i32";function So({stmt:s}){let e=l=>f=>{let[y,p]=f;if(!String(y.type).endsWith("[]"))return l(f);let v=W({type:vo,meta:{TYPE_ARRAY:y.type.slice(0,-2)}},y);return l([v,p])};function n(l,f){let y=go[l.meta.TYPE_ARRAY]||2;return f.Type!==d.Constant||Number(f.value)?s`(${l} + (${f} << ${y}));`:s`(${l});`}function i(l){return!(l.type==null||l.index==null)}function c([l,f]){let y=l.meta.TYPE_ARRAY,p=n(l,f);return{type:y,index:p,TYPE_ARRAY:l.meta.TYPE_ARRAY}}return{[d.Declaration]:e,[d.ImmutableDeclaration]:e,[d.Identifier]:l=>f=>{let[y,p]=f,v=Ve(p.scopes,y.value);return v&&v.meta.TYPE_ARRAY?l([W(_o(["type","meta"],v),y),p]):l(f)},[d.Assignment]:l=>(f,y)=>{let[p,v]=f,[b,g]=p.params;if(b.Type!==d.ArraySubscript)return l(f);let w=rr(y,v),L=c(b.params.map(w)),{type:R,index:M}=L;return I(i(L),`PANIC - Cannot assign to subscript of ${b.value}`),w(s`${R}.store(${M}, ${g});`)},[d.ArraySubscript]:l=>(f,y)=>{let[p,v]=f,b=rr(y,v),g=c(p.params.map(b)),{type:w,index:L,TYPE_ARRAY:R}=g;return i(g)?W({meta:{TYPE_ARRAY:R}},b(s`${w}.load(${L});`)):l(f)},[d.FunctionResult]:e}}function To(){return{semantics:So}}let Eo=(s,e)=>{let n=s.memories[0];return n&&n.value===e.value};function xo(){return{semantics({stmt:s}){return{[d.ImmutableDeclaration]:e=>n=>{let[i,c]=n,{scopes:l,memories:f}=c;return!l.length<2&&i.type==="Memory"&&!f.length?(f.push(P({},i,{meta:P({},i.meta,{[Le]:-1})})),f[0]):e(n)},[d.FunctionCall]:e=>(n,i)=>{let[c,l]=n,[f,...y]=c.params,[p={},v={}]=f.params,g={dataSize:i([s`i32.load(0);`,l]),grow:P({},p,{value:"grow_memory",params:y.map(w=>i([w,l])),Type:d.NativeMethod}),size:P({},p,{value:"current_memory",params:[],Type:d.NativeMethod})}[v.value];return f.Type===d.Access&&Eo(l,p)&&g?g:e(n)}}}}}let sr=s=>{let e=[];for(;;){let n=s&127;s=s>>7;let i=n&64;if(s===0&&!i||s===-1&&i){e.push(n);break}else e.push(n|128)}return e},Ao=s=>{let e=[];for(;;){let n=s&127;if(s=s>>>7,s===0){e.push(n);break}e.push(n|128)}return e};let Ct=1,Lt=1<<1,Pt=1<<2,It=1<<3,Nt=1<<4,Rt=1<<5,or=1<<6,Bt=1<<7,kt=1<<8,Ft=1<<9,Mt=1<<10,jt=1<<11,sn=1<<12,Se=4,wo={[Ct]:Se,[Lt]:Se*2,[Pt]:Se,[It]:Se*2,[jt]:Se,[Mt]:Se>>1,[kt]:Se>>2,[Bt]:Se>>2,[Ft]:Se>>1,[Nt]:Se,[Rt]:Se,[or]:Se},se=!0;var Pe={i32:Ct,i64:Lt,f32:Pt,f64:It,anyfunc:Nt,func:Rt,block_type:or,i8:Bt,u8:kt,i16:Ft,u16:Mt,u32:jt,u64:sn,set:(s,e,n,i)=>{switch(s){case Ct:return n.setInt32(e,i,se);case Lt:return n.setInt64(e,i,se);case Pt:return n.setFloat32(e,i,se);case It:return n.setFloat64(e,i,se);case Nt:return n.setUint32(e,i,se);case Rt:return n.setUint32(e,i,se);case Bt:return n.setInt8(e,i,se);case kt:return n.setUint8(e,i,se);case Ft:return n.setInt16(e,i,se);case Mt:return n.setUint16(e,i,se);case jt:return n.setUint32(e,i,se);case sn:return n.setUint64(e,i,se);default:return n.setUint8(e,i,se)}},get:(s,e,n)=>{switch(s){case Ct:return n.getInt32(e,se);case Lt:return n.getInt64(e,se);case Pt:return n.getFloat32(e,se);case It:return n.getFloat64(e,se);case Nt:return n.getUint32(e,se);case Rt:return n.getUint32(e,se);case Bt:return n.getInt8(e,se);case kt:return n.getUint8(e,se);case Ft:return n.getInt16(e,se);case Mt:return n.getUint16(e,se);case jt:return n.getUint32(e,se);case sn:return n.getUint64(e,se);default:return n.getUint8(e,se)}},sizeof:wo},T=Pe.i32,C=Pe.i64,$=Pe.f32,oe=Pe.f64,ce=Pe.u8,on=Pe.u32,ar=Pe.set,an=Pe.sizeof;class le{constructor(){this.data=[],this.size=0}push(e,n,i){let c=0;switch(e){case"varuint7":case"varuint32":case"varint7":case"varint1":{n=Ao(n),c=n.length,I(c,`Cannot write a value of size ${c}`);break}case"varint32":{n=sr(n),c=n.length,I(c,`Cannot write a value of size ${c}`);break}case"varint64":{n=sr(n),c=n.length,I(c,`Cannot write a value of size ${c}`);break}default:c=an[e],I(c,`Cannot write a value of size ${c}, type ${e}`)}return this.data.push({type:e,value:n,debug:i}),this.size+=c,this}buffer(e=new ArrayBuffer(this.size)){let n=new DataView(e),i=0;return this.data.forEach(({type:c,value:l})=>{Array.isArray(l)?l.forEach(f=>ar(ce,i++,n,f)):(ar(c,i,n,l),i+=an[c])}),e}write(e){return e&&(this.data=this.data.concat(e.data),this.size+=e.size),this}}function*$o(s,e){let n=0,i=0,c=0,l=e;for(;;){let y=s.getUint8(l,!0);if(n|=(y&127)<<c,l+=1,!(y&128))break;c+=7}let f=0;for(;i<n;){for(f=0,c=0;;){let y=s.getUint8(l,!0);if(f|=(y&127)<<c,l+=1,!(y&128))break;c+=7}i+=1,yield f}}function ir(s){let e=new le,n=new le;n.push("varuint32",s.length,s);let i=0;for(i=0;i<s.length;i++)n.push("varuint32",s.codePointAt(i),s[i]);return e.write(n),e}let Oo={["\\0"]:0,["\\a"]:7,["\\b"]:8,["\\t"]:9,["\\n"]:10,["\\v"]:11,["\\f"]:12,["\\r"]:13,["\\'"]:39},Co={i64:8,f64:8,i32:4,f32:4};function Lo(s,e){let n=new le,i=Pe[e];return s.forEach(c=>{n.push(i,c,String(c))}),n}function Po(){let s=0;return{semantics:({stmt:e})=>({[d.StaticDeclaration]:n=>([i,c],l)=>{let{userTypes:f,statics:y}=c,p=String(i.type).slice(0,-2),v=Co[p],b=i.params.reduce((w,L,R)=>{let M=l([L,c]);return w.OBJECT_SIZE+=v,w.TYPE_OBJECT[R]=R*v,w.OBJECT_KEY_TYPES[R]=p,w.VALUES.push(Number(M.value)),w},{OBJECT_SIZE:0,TYPE_OBJECT:{},OBJECT_KEY_TYPES:{},VALUES:[],STATIC:p}),g=`__auto_gen_${i.value}_${s}`;return s+=1,f[g]=P({},i,{value:g,Type:d.Type,meta:b,params:[]}),y[g]=Lo(b.VALUES,p),l([P({},i,{meta:b,type:g,Type:d.ImmutableDeclaration,params:[P({},i.params[0],{value:g,Type:d.StaticValueList})]}),c])},[d.ArraySubscript]:n=>([i,c],l)=>{let[f,y]=i.params.map(v=>l([v,c]));if(!f.meta.STATIC)return n([i,c]);let p={i32:2,f32:2,i64:3,f64:3}[f.meta.STATIC];return l([e`${f.meta.STATIC}.load(${f} + (${y} << ${p}));`,c])},[d.CharacterLiteral]:n=>([i,c],l)=>{let f=Oo[i.value]||i.value.codePointAt(0);return l([P({},i,{Type:"Constant",type:"i32",value:String(f)}),c])},[d.StringLiteral]:n=>i=>{let[c,l]=i,{statics:f}=l,{value:y}=c;return y in f||(f[y]=ir(y)),c}})}}function Io(){return{semantics(){return{[d.ImmutableDeclaration]:s=>function(e){let[n,i]=e;return!i.locals&&n.type==="Table"?P({},n,{meta:P({},n.meta,{[Le]:-1})}):s(e)},[d.Identifier]:s=>function(e){let[n,i]=e,{functions:c,table:l,scopes:f}=i;return Ve(f,n.value)||!c[n.value]?s(e):(l[n.value]==null&&(l[n.value]=c[n.value]),P({},n,{type:"i32",meta:{[Ce]:c[n.value].meta[Ce]},value:Object.keys(l).indexOf(n.value),Type:d.FunctionPointer}))},[d.FunctionResult]:s=>(e,n)=>{let[i,c]=e,{types:l}=c;return l[i.type]?s([W({type:"i32",meta:{ALIAS:i.type},params:i.params.map(f=>n([f,c]))},i),c]):s(e)},[d.FunctionCall]:s=>function(e,n){let[i,c]=e,{scopes:l,types:f}=c,y=Ve(l,i.value);if(!y)return s(e);let p=f[y.type],v=Object.keys(f).indexOf(y.type),b=[...i.params.slice(1),P({},y,{Type:d.Identifier})].map(g=>n([g,c]));return P({},i,{meta:P({},i.meta,y.meta,{[pt]:v}),type:p!=null?p.type:i.type,params:b,Type:d.IndirectFunctionCall})}}}}}let Dt="i32",No={i64:8,f64:8,i32:4,f32:4,["__DIRECT_ADDRESS__"]:4},Ro=s=>{let e={},n={},i=0;return U({[d.Pair]:c=>{let[l]=c.params,f=l.value,y=c.params[1].value;I(e[f]==null,`Duplicate key ${f} not allowed in object type`),n[f]=`${l.Type==="AddressOf"?"&":""}${y}`,e[f]=i,i+=No[y]||4}})(s),[e,i,n]},Bo=s=>(e,n)=>{let i=s`throw;`,c={load:W({range:n.range},s`i32.load(${i}, ${i});`),store:M=>W({range:n.range},s`i32.store(${i}, ${M});`),offset:i,type:"void"};if(e.meta.STRUCT_TYPE==null)return c;let l=e.meta.STRUCT_TYPE,f=l.meta.TYPE_OBJECT,y=l.meta.OBJECT_KEY_TYPES,p=f[n.value];if(p==null)return c;let v=y[n.value],b=v[0]==="&",g=p?s`(${e} + ${p});`:s`(${e});`,w=null,L=null;v!=null&&typeof v=="object"&&(w=v,v=Dt),String(v).endsWith("[]")&&(L=v.slice(0,-2).replace("&",""),v="i32");let R=W({range:e.range,meta:{STRUCT_TYPE:w,TYPE_ARRAY:L}});return{offset:g,type:v,store:M=>R(s`${v}.store(${g}, ${M});`),load:R(b?g:s`${v}.load(${g});`)}};function ko(){return{semantics({stmt:s}){let e=Bo(s);function n(c,l){let[f,y]=c,[p,v]=f.params,[b,g]=p.params,w=e(l([b,y]),g);return l([w.store(v),y])}function i(c,l){let[f,y]=c,[p,v]=f.params,b=l([p,y]),g=[];U({[d.Identifier]:(L,R)=>{let M=e(b,L);g.push({field:M,value:L})},[d.Pair]:(L,R)=>{let[M,z]=L.params,X=e(b,M);g.push({field:X,value:z})},[d.Spread]:(L,R)=>{let M=l([L.params[0],y]);Object.keys(M.meta.TYPE_OBJECT).forEach(z=>{let X=e(b,{value:z,type:null,range:M.range}),Q=e(M,{value:z,type:null,range:M.range});g.push({field:X,value:Q.load})})}})(v);let w=g.filter(({field:L})=>L!=null).map(L=>l([L.field.store(L.value),y]));return P({},p,{Type:d.Block,params:w})}return{[d.Struct]:c=>([l,f],y)=>{let{userTypes:p,aliases:v}=f,[b]=l.params,g=P({},l,{meta:P({},l.meta,{TYPE_OBJECT:{},OBJECT_SIZE:0,OBJECT_KEY_TYPES:{}})}),w=()=>{v[l.value]=b.value},L=(M,z)=>{let[X,Q,$e]=Ro(M);g.meta.TYPE_OBJECT=P({},g.meta.TYPE_OBJECT,X),g.meta.OBJECT_SIZE+=Q,g.meta.OBJECT_KEY_TYPES=P({},g.meta.OBJECT_KEY_TYPES,$e)};return{[d.Type]:w,[d.Identifier]:w,[d.ObjectLiteral]:()=>{L(l),p[g.value]=g},[d.UnionType]:()=>{U({[d.ObjectLiteral]:L,[d.ArrayType]:M=>{g.meta.TYPE_ARRAY=M.type.slice(0,-2)},[d.Identifier]:M=>{let z=p[y([M,f]).value];g.meta.TYPE_OBJECT=P({},g.meta.TYPE_OBJECT,z.meta.TYPE_OBJECT),g.meta.OBJECT_SIZE=Math.max(g.meta.OBJECT_SIZE,z.meta.OBJECT_SIZE),g.meta.OBJECT_KEY_TYPES=P({},g.meta.OBJECT_KEY_TYPES,z.meta.OBJECT_KEY_TYPES)}})(b),p[g.value]=g}}[b.Type](),g.meta.OBJECT_KEY_TYPES=Object.entries(g.meta.OBJECT_KEY_TYPES).reduce((M,[z,X])=>(M[z]=p[X]||X,M),{}),g},[d.DeclType]:c=>(l,f)=>{let[y,p]=l,{aliases:v}=p;return v[y.value]?f([W({value:v[y.value],type:v[y.value]},y),p]):c(l)},[d.FunctionResult]:c=>(l,f)=>{let[y,p]=l,{userTypes:v,aliases:b}=p;return b[y.type]?f([W({type:b[y.type]},y),p]):v[String(y.type)]?c([W({type:Dt,meta:{STRUCT_TYPE:v[y.type]},params:y.params.map(g=>f([g,p]))},y),p]):c(l)},[d.Identifier]:c=>l=>{let[f,y]=l,{userTypes:p,scopes:v}=y,b=Ve(v,f.value);return b&&p[b.type]?P({},f,{meta:P({},f.meta,b.meta,p[b.type].meta,{STRUCT_TYPE:p[b.type]}),type:Dt}):c(l)},[d.Access]:function(c){return(l,f)=>{let[y,p]=l,[v,b]=y.params,g=e(f([v,p]),b);return f([g.load,p])}},[d.Assignment]:c=>(l,f)=>{let[y]=l,[p,v]=y.params;return p.Type===d.Access?n(l,f):v.Type===d.ObjectLiteral?i(l,f):c(l)},[d.ArraySubscript]:c=>(l,f)=>{let[y,p]=l,v=c(l);if(p.userTypes[v.meta.TYPE_ARRAY]==null)return v;let[b,g]=y.params.map(w=>f([w,p]));return f([W({type:Dt,meta:{STRUCT_TYPE:p.userTypes[v.meta.TYPE_ARRAY]}},s`(${b} + (${g} * sizeof(${v.meta.TYPE_ARRAY})));`),p])}}}}}function Fo(){return{semantics(){return{[d.FunctionCall]:s=>(e,n)=>{let[i,c]=e,[l,...f]=i.params;if(l.Type===d.Access&&l.params[0]&&l.params[0].Type===d.Type){let[y,p]=l.params;return W({value:`${y.value}.${p.value}`,type:y.value,params:f.map(v=>n([v,c])),Type:d.NativeMethod},i)}return s(e)},[d.Unreachable]:s=>([e])=>W({value:"unreachable",params:[],Type:d.NativeMethod},e)}}}}function Mo(){return{grammar:Qn,semantics(){return{[d.FunctionDeclaration]:s=>e=>{let[n,i]=e,[c]=n.params,l=[];return U({Assignment:f=>{let[,y]=f.params;l.push(y)}})(c),s([P({},n,{meta:P({},n.meta,{DEFAULT_ARGUMENTS:l})}),i])},[d.FunctionCall]:s=>e=>{let[n,i]=e,{functions:c}=i,[l,...f]=n.params,y=c[l.value];if(!y)return s(e);let p=y.meta.FUNCTION_METADATA.argumentsCount,v=f.length,b=p-v;return b>0?s([P({},n,{params:[...n.params,...y.meta.DEFAULT_ARGUMENTS.slice(b-1)]}),i]):s(e)}}}}}let jo={i64:8,f64:8,i32:4,f32:4};function Do(){return{semantics(){return{[d.FunctionCall]:s=>e=>{let[n,i]=e;if(n.value!=="sizeof")return s(e);let{scopes:c,userTypes:l,functions:f}=i,[,y]=n.params,p=Ve(c,y.value),{type:v=""}=p||{},b=l[y.value]||l[v],g=f[y.value];if(b!=null){let L=b.meta[io];return I(L,"Object size information is missing"),P({},n,{value:L,params:[],type:"i32",Type:d.Constant})}let w=p||g;return P({},n,{value:jo[String(w?w.type:y.value)],type:"i32",params:[],Type:d.Constant})}}}}}let Uo=()=>[lo().semantics,co().semantics,ho().semantics,uo().semantics,mo().semantics,yo().semantics,bo().semantics,To().semantics,xo().semantics,Po().semantics,Io().semantics,ko().semantics,Fo().semantics,Do().semantics,Mo().semantics];function cn(s,e,n){let i=[...Uo(),...e],c=Ys(i.map(R=>R(n))),l={functions:{},types:{},userTypes:{},table:{},hoist:[],statics:{},path:[],scopes:er([],Le),memories:[],tables:[],aliases:{},exports:{}},f=A(c)([s,l]),{functions:y,scopes:p,types:v,userTypes:b,statics:g,hoist:w,exports:L}=l;return P({},f,{meta:P({},f.meta,{[tn]:{functions:y,globals:p[0],types:v,userTypes:b,statics:g,exports:L}}),params:[...f.params,...w]})}function we(s,e,n,i,c){let l=n.start.line,f=n.start.col,y=n.end.col,p=n.end.sourceLine,v=new Array(y-f+1).join("^").padStart(n.start.col-1," ");return`
`+p+`
`+v+` ${e}
`+s+`
  at ${c} (${i}:${l}:${f})`}let k={},zo=[],ln={},x=null,S=(s,e,n,i,c,l,f)=>{let y={result:s,first:e,second:n,size:i,code:c,name:l,text:f};return k[l]=y,zo[c]=y,ln[f]=y,y};S(x,x,x,0,0,"Unreachable","unreachable"),S(x,x,x,0,1,"Nop","nop"),S(x,x,x,0,2,"Block","block"),S(x,x,x,0,3,"Loop","loop"),S(x,x,x,0,4,"If","if"),S(x,x,x,0,5,"Else","else"),S(x,x,x,0,6,"Try","try"),S(x,x,x,0,7,"Catch","catch"),S(x,x,x,0,8,"Throw","throw"),S(x,x,x,0,9,"Rethrow","rethrow"),S(x,x,x,0,10,"CatchAll","catch_all"),S(x,x,x,0,11,"End","end"),S(x,x,x,0,12,"Br","br"),S(x,x,x,0,13,"BrIf","br_if"),S(x,x,x,0,14,"BrTable","br_table"),S(x,x,x,0,15,"Return","return"),S(x,x,x,0,16,"Call","call"),S(x,x,x,0,17,"CallIndirect","call_indirect"),S(x,x,x,0,26,"Drop","drop"),S(x,x,x,0,27,"Select","select"),S(x,x,x,0,32,"GetLocal","get_local"),S(x,x,x,0,33,"SetLocal","set_local"),S(x,x,x,0,34,"TeeLocal","tee_local"),S(x,x,x,0,35,"GetGlobal","get_global"),S(x,x,x,0,36,"SetGlobal","set_global"),S(T,T,x,4,40,"i32Load","i32.load"),S(C,T,x,8,41,"i64Load","i64.load"),S($,T,x,4,42,"f32Load","f32.load"),S(oe,T,x,8,43,"f64Load","f64.load"),S(T,T,x,1,44,"i32Load8S","i32.load8_s"),S(T,T,x,1,45,"i32Load8U","i32.load8_u"),S(T,T,x,2,46,"i32Load16S","i32.load16_s"),S(T,T,x,2,47,"i32Load16U","i32.load16_u"),S(C,T,x,1,48,"i64Load8S","i64.load8_s"),S(C,T,x,1,49,"i64Load8U","i64.load8_u"),S(C,T,x,2,50,"i64Load16S","i64.load16_s"),S(C,T,x,2,51,"i64Load16U","i64.load16_u"),S(C,T,x,4,52,"i64Load32S","i64.load32_s"),S(C,T,x,4,53,"i64Load32U","i64.load32_u"),S(x,T,T,4,54,"i32Store","i32.store"),S(x,T,C,8,55,"i64Store","i64.store"),S(x,T,$,4,56,"f32Store","f32.store"),S(x,T,$,8,57,"f64Store","f64.store"),S(x,T,T,1,58,"i32Store8","i32.store8"),S(x,T,T,2,59,"i32Store16","i32.store16"),S(x,T,C,1,60,"i64Store8","i64.store8"),S(x,T,C,2,61,"i64Store16","i64.store16"),S(x,T,C,4,62,"i64Store32","i64.store32"),S(T,x,x,0,63,"CurrentMemory","current_memory"),S(T,T,x,0,64,"GrowMemory","grow_memory"),S(T,x,x,0,65,"i32Const","i32.const"),S(C,x,x,0,66,"i64Const","i64.const"),S($,x,x,0,67,"f32Const","f32.const"),S(oe,x,x,0,68,"f64Const","f64.const"),S(T,T,x,0,69,"i32Eqz","i32.eqz"),S(T,T,T,0,70,"i32Eq","i32.eq"),S(T,T,T,0,71,"i32Ne","i32.ne"),S(T,T,T,0,72,"i32LtS","i32.lt_s"),S(T,T,T,0,73,"i32LtU","i32.lt_u"),S(T,T,T,0,74,"i32GtS","i32.gt_s"),S(T,T,T,0,75,"i32GtU","i32.gt_u"),S(T,T,T,0,76,"i32LeS","i32.le_s"),S(T,T,T,0,77,"i32LeU","i32.le_u"),S(T,T,T,0,78,"i32GeS","i32.ge_s"),S(T,T,T,0,79,"i32GeU","i32.ge_u"),S(T,C,x,0,80,"i64Eqz","i64.eqz"),S(T,C,C,0,81,"i64Eq","i64.eq"),S(T,C,C,0,82,"i64Ne","i64.ne"),S(T,C,C,0,83,"i64LtS","i64.lt_s"),S(T,C,C,0,84,"i64LtU","i64.lt_u"),S(T,C,C,0,85,"i64GtS","i64.gt_s"),S(T,C,C,0,86,"i64GtU","i64.gt_u"),S(T,C,C,0,87,"i64LeS","i64.le_s"),S(T,C,C,0,88,"i64LeU","i64.le_u"),S(T,C,C,0,89,"i64GeS","i64.ge_s"),S(T,C,C,0,90,"i64GeU","i64.ge_u"),S(T,$,$,0,91,"f32Eq","f32.eq"),S(T,$,$,0,92,"f32Ne","f32.ne"),S(T,$,$,0,93,"f32Lt","f32.lt"),S(T,$,$,0,94,"f32Gt","f32.gt"),S(T,$,$,0,95,"f32Le","f32.le"),S(T,$,$,0,96,"f32Ge","f32.ge"),S(T,$,$,0,97,"f64Eq","f64.eq"),S(T,$,$,0,98,"f64Ne","f64.ne"),S(T,$,$,0,99,"f64Lt","f64.lt"),S(T,$,$,0,100,"f64Gt","f64.gt"),S(T,$,$,0,101,"f64Le","f64.le"),S(T,$,$,0,102,"f64Ge","f64.ge"),S(T,T,x,0,103,"i32Clz","i32.clz"),S(T,T,x,0,104,"i32Ctz","i32.ctz"),S(T,T,x,0,105,"i32Popcnt","i32.popcnt"),S(T,T,T,0,106,"i32Add","i32.add"),S(T,T,T,0,107,"i32Sub","i32.sub"),S(T,T,T,0,108,"i32Mul","i32.mul"),S(T,T,T,0,109,"i32DivS","i32.div_s"),S(T,T,T,0,110,"i32DivU","i32.div_u"),S(T,T,T,0,111,"i32RemS","i32.rem_s"),S(T,T,T,0,112,"i32RemU","i32.rem_u"),S(T,T,T,0,113,"i32And","i32.and"),S(T,T,T,0,114,"i32Or","i32.or"),S(T,T,T,0,115,"i32Xor","i32.xor"),S(T,T,T,0,116,"i32Shl","i32.shl"),S(T,T,T,0,117,"i32ShrS","i32.shr_s"),S(T,T,T,0,118,"i32ShrU","i32.shr_u"),S(T,T,T,0,119,"i32Rotl","i32.rotl"),S(T,T,T,0,120,"i32Rotr","i32.rotr"),S(C,C,x,0,121,"i64Clz","i64.clz"),S(C,C,x,0,122,"i64Ctz","i64.ctz"),S(C,C,x,0,123,"i64Popcnt","i64.popcnt"),S(C,C,C,0,124,"i64Add","i64.add"),S(C,C,C,0,125,"i64Sub","i64.sub"),S(C,C,C,0,126,"i64Mul","i64.mul"),S(C,C,C,0,127,"i64DivS","i64.div_s"),S(C,C,C,0,128,"i64DivU","i64.div_u"),S(C,C,C,0,129,"i64RemS","i64.rem_s"),S(C,C,C,0,130,"i64RemU","i64.rem_u"),S(C,C,C,0,131,"i64And","i64.and"),S(C,C,C,0,132,"i64Or","i64.or"),S(C,C,C,0,133,"i64Xor","i64.xor"),S(C,C,C,0,134,"i64Shl","i64.shl"),S(C,C,C,0,135,"i64ShrS","i64.shr_s"),S(C,C,C,0,136,"i64ShrU","i64.shr_u"),S(C,C,C,0,137,"i64Rotl","i64.rotl"),S(C,C,C,0,138,"i64Rotr","i64.rotr"),S($,$,$,0,139,"f32Abs","f32.abs"),S($,$,$,0,140,"f32Neg","f32.neg"),S($,$,$,0,141,"f32Ceil","f32.ceil"),S($,$,$,0,142,"f32Floor","f32.floor"),S($,$,$,0,143,"f32Trunc","f32.trunc"),S($,$,$,0,144,"f32Nearest","f32.nearest"),S($,$,$,0,145,"f32Sqrt","f32.sqrt"),S($,$,$,0,146,"f32Add","f32.add"),S($,$,$,0,147,"f32Sub","f32.sub"),S($,$,$,0,148,"f32Mul","f32.mul"),S($,$,$,0,149,"f32Div","f32.div"),S($,$,$,0,150,"f32Min","f32.min"),S($,$,$,0,151,"f32Max","f32.max"),S($,$,$,0,152,"f32Copysign","f32.copysign"),S($,$,$,0,153,"f32Abs","f64.abs"),S($,$,$,0,154,"f32Neg","f64.neg"),S($,$,$,0,155,"f32Ceil","f64.ceil"),S($,$,$,0,156,"f32Floor","f64.floor"),S($,$,$,0,157,"f32Trunc","f64.trunc"),S($,$,$,0,158,"f32Nearest","f64.nearest"),S($,$,$,0,159,"f32Sqrt","f64.sqrt"),S(oe,oe,oe,0,160,"f64Add","f64.add"),S(oe,oe,oe,0,161,"f64Sub","f64.sub"),S(oe,oe,oe,0,162,"f64Mul","f64.mul"),S(oe,oe,oe,0,163,"f64Div","f64.div"),S(oe,oe,oe,0,164,"f64Min","f64.min"),S(oe,oe,oe,0,165,"f64Max","f64.max"),S(oe,oe,oe,0,166,"f64Copysign","f64.copysign"),S(T,C,x,0,167,"i32Wrapi64","i32.wrap/i64"),S(T,$,x,0,168,"i32TruncSf32","i32.trunc_s/f32"),S(T,$,x,0,169,"i32TruncUf32","i32.trunc_u/f32"),S(T,$,x,0,170,"i32TruncSf64","i32.trunc_s/f64"),S(T,$,x,0,171,"i32TruncUf64","i32.trunc_u/f64"),S(C,T,x,0,172,"i64ExtendSi32","i64.extend_s/i32"),S(C,T,x,0,173,"i64ExtendUi32","i64.extend_u/i32"),S(C,$,x,0,174,"i64TruncSf32","i64.trunc_s/f32"),S(C,$,x,0,175,"i64TruncUf32","i64.trunc_u/f32"),S(C,$,x,0,176,"i64TruncSf64","i64.trunc_s/f64"),S(C,$,x,0,177,"i64TruncUf64","i64.trunc_u/f64"),S($,T,x,0,178,"f32ConvertSi32","f32.convert_s/i32"),S($,T,x,0,179,"f32ConvertUi32","f32.convert_u/i32"),S($,C,x,0,180,"f32ConvertSi64","f32.convert_s/i64"),S($,C,x,0,181,"f32ConvertUi64","f32.convert_u/i64"),S($,$,x,0,182,"f32Demotef64","f32.demote/f64"),S($,T,x,0,183,"f64ConvertSi32","f64.convert_s/i32"),S($,T,x,0,184,"f64ConvertUi32","f64.convert_u/i32"),S($,C,x,0,185,"f64ConvertSi64","f64.convert_s/i64"),S($,C,x,0,186,"f64ConvertUi64","f64.convert_u/i64"),S($,$,x,0,187,"f64Promotef32","f64.promote/f32"),S(T,$,x,0,188,"i32Reinterpretf32","i32.reinterpret/f32"),S(C,$,x,0,189,"i64Reinterpretf64","i64.reinterpret/f64"),S($,T,x,0,190,"f32Reinterpreti32","f32.reinterpret/i32"),S($,C,x,0,191,"f32Reinterpreti64","f64.reinterpret/i64");let cr=(s,e)=>{let n=s[0];return["i32","bool"].includes(s)&&e==="i64"?k.i32Wrapi64:s==="i64"&&["i32","bool"].includes(e)?k.i64ExtendSi32:s==="f32"&&e==="f64"?k.f32Demotef64:s==="f64"&&e==="f32"?k.f64Promotef32:k[s+(n==="f"?"ConvertS":"TruncS")+e]},lr=({type:s,value:e})=>({"+":k[String(s)+"Add"],"-":k[String(s)+"Sub"],"*":k[String(s)+"Mul"],"/":k[String(s)+"DivS"]||k[String(s)+"Div"],"%":k[String(s)+"RemS"]||k[String(s)+"RemU"],"==":k[String(s)+"Eq"],"!=":k[String(s)+"Ne"],">":k[String(s)+"Gt"]||k[String(s)+"GtS"],"<":k[String(s)+"Lt"]||k[String(s)+"LtS"],"<=":k[String(s)+"Le"]||k[String(s)+"LeS"],">=":k[String(s)+"Ge"]||k[String(s)+"GeS"],"?":k.If,":":k.Else,"&":k[String(s)+"And"],"|":k[String(s)+"Or"],"^":k[String(s)+"Xor"],">>":k[String(s)+"ShrS"],">>>":k[String(s)+"ShrU"],"<<":k[String(s)+"Shl"]})[e],We=127,Qe=126,He=125,Ke=124,ur=112,pr=96,Go={i32:We,i64:Qe,f32:He,f64:Ke},Ut=s=>{switch(s){case Qe:return"i64";case He:return"f32";case Ke:return"f64";case pr:return"func";case ur:return"anyfunc";case We:default:return"i32"}},un=s=>{let e={};return U({[d.Pair]:({params:n})=>{let[{value:i},{value:c}]=n;e[i]=parseInt(c)}})(s),e},Yo=s=>{let e=s.value||"??",n=s.type,i=lr({value:e,type:n||"i32"});return n?i.text:i.text.replace("i32","??")},fr=s=>{let e=[];return U({[d.Pair]:(n,i)=>{e.push(`${n.params[0].value} ${n.params[1].value}`)},[d.Type]:n=>{e.push(n.value)}})(s),e.length?" param("+e.join(" ")+")":""},mr=s=>s==null?"":" (result "+(s.type||"??")+")",yr=s=>{let[e,n]=s.params;return"(type "+s.value+` (func${fr(e)}${mr(n)}))`},Fe=(s,e,{value:n,params:i})=>{i.filter(Boolean).length?(s(`(${n}`,2),i.forEach(e),s(")",0,-2)):s(`(${n})`,0,0)},qo=s=>({[d.Import]:(e,n)=>{let[i,c]=e.params;U({[d.Pair]:({params:l},f)=>{let{value:y}=l[0],p=l[1];if(p.value==="Memory"){let v=un(p);s(`(import "${c.value}" "${y}" (memory ${v.initial}${v.max?v.max:""}))`)}else s(`(import "${c.value}" "${y}" ${yr(p)})`)},[d.Identifier]:(l,f)=>{let{value:y}=l;s(`(import "${c.value}" "${y}" (type ??))`)}})(i)},[d.Export]:(e,n)=>{s("(export",2),e.params.forEach(n),s(")",0,-2)},[d.GenericType]:(e,n)=>{s(";; Pseudo type",0,0),s("(type-generic "+e.value+")",0,0)},[d.FunctionCall]:({value:e,params:n},i)=>{Fe(s,i,{value:`call ${e}`,params:n})},[d.Block]:({params:e},n)=>{Fe(s,n,{value:"block",params:e})},[d.NativeMethod]:(e,n)=>{Fe(s,n,e)},[d.BinaryExpression]:(e,n)=>{let i=Yo(e);Fe(s,n,{value:i,params:e.params})},[d.ArraySubscript]:({params:e},n)=>{s(";; unparsed",0,0),Fe(s,n,{value:"subscript",params:e})},[d.Typedef]:(e,n)=>{s(yr(e))},[d.Struct]:(e,n)=>{s(";; Pseudo struct type",0,0),Fe(s,n,{value:"type-struct "+e.value,params:e.params})},[d.Identifier]:e=>{let n=e.meta[Le]!=null?"global":"local";s(`(get_${n} ${e.value})`)},[d.Constant]:e=>{s(`(${String(e.type)}.const ${e.value})`)},[d.FunctionPointer]:e=>{s(`(${String(e.type)}.table_pointer ${e.value})`)},[d.FunctionDeclaration]:(e,n)=>{let[i,c,...l]=e.params;s(`(func ${e.value}${fr(i)}${mr(c)}`,2),l.forEach(n),s(")",0,-2)},[d.ReturnStatement]:({params:e},n)=>{Fe(s,n,{value:"return",params:e})},[d.Declaration]:(e,n)=>{s("(local "+e.value+" "+String(e.type),2,0),e.params.forEach(n),s(")",0,-2)},[d.ImmutableDeclaration]:(e,n)=>{let i=e.meta[Le]!=null?"global":"local";if(e.type==="Memory"){let c=un(e);s(`(memory ${c.initial}${c.max?` ${c.max}`:""})`)}else s(`(${i} `+e.value+" "+String(e.type),2,0),e.params.forEach(n),s(")",0,-2)},[d.StringLiteral]:e=>{s(`; string "${e.value}"`,0,0),s("(i32.const ??)",0,0)},[d.Type]:e=>{s(e.value)},[d.TypeCast]:(e,n)=>{let i=e.params[0],c=cr(String(e.type),i.type);s("("+c.text,2),e.params.forEach(n),s(")",0,-2)},[d.Access]:({params:e},n)=>{s(";; unparsed",0,0),Fe(s,n,{value:"access",params:e})},[d.MemoryAssignment]:(e,n)=>{s("("+String(e.type)+".store",2,0),e.params.forEach(n),s(")",0,-2)},[d.Assignment]:(e,n)=>{let[i,...c]=e.params,l=i.meta[Le]!=null?"global":"local";s(`(set_${l} ${i.value}`,2),[d.ArraySubscript,d.Access].includes(i.Type)&&n(i),c.forEach(n),s(")",0,-2)},[d.TernaryExpression]:(e,n)=>{let[i,c,l]=e.params;s("(select",2),n(i),n(c),n(l),s(")",0,-2)},[d.IfThenElse]:(e,n)=>{let[i,c,...l]=e.params;s("(if",2),n(i),s("(then",2),n(c),s(")",0,-2),l.length>0&&(s("(else",2),l.forEach(n),s(")",0,-2)),s(")",0,-2)},[d.ObjectLiteral]:(e,n)=>{}}),hr=s=>{if(s==null)return"";let e=0,n=[],i=[];return U(qo((f,y=0,p=0)=>{e+=p,i.push(f),n.push(e+f.length),e+=y}))(s),i.reduce((f,y,p)=>(f+=y.padStart(n[p]," ")+`
`,f),"")},dr=wt((s,e)=>{let n=e.meta[$t],i=e.meta[Le],c=n!=null?n:i;I(c!=null,`Undefined index for scope Operation. Possibly missing metadata. op: ${JSON.stringify(s)} node: ${hr(e)}`);let l=n!=null?s+"Local":s+"Global",f=[Number(c)];return{kind:k[l],params:f,debug:`${e.value}<${e.meta.ALIAS||e.type}>`}}),Vo=s=>{switch(s){case ye.f32:return He;case ye.f64:return Ke;case ye.i64:return Qe;case ye.i32:default:return We}},ft=s=>typeof s=="string"&&ye[s]!=null,br=s=>({mutable:s.meta[Ot]?0:1,type:Vo(s.type)}),Jo=dr("Set"),_r=dr("Get"),zt="global";function pn(s,{filename:e}){let n=s.meta[tn];if(n==null)throw new Error("Missing AST metadata!");let{types:i,functions:c,userTypes:l}=n,f=[];U({[d.Import]:(p,v)=>{U({[d.BinaryExpression]:(b,g)=>{let[w,L]=b.range;f.push(we("Using an 'as' import without a type.","A type for original import "+b.params[0].value+" is not defined nor could it be inferred.",{start:w,end:L},e,zt))},[d.Identifier]:(b,g)=>{let[w,L]=b.range;f.push(we("Infered type not supplied.","Looks like you'd like to infer a type, but it was never provided by a linker. Non-concrete types cannot be compiled.",{start:w,end:L},e,zt))},[d.Pair]:(b,g)=>{let w=b.params[1];if(!ft(w.value)&&i[w.value]==null){let[L,R]=w.range;f.push(we(`Undefined Type ${w.value}`,`Invalid Import. ${w.value} type does not exist`,{start:L,end:R},e,zt))}}})(p)},[d.Struct]:(p,v)=>{},[d.ImmutableDeclaration]:(p,v)=>{},[d.Declaration]:(p,v)=>{let[b,g]=p.range;!ft(p.type)&&!i[p.type]&&!l[p.type]&&f.push(we(`Unknown type used in a declaration, "${String(p.type)}"`,"Variables must be assigned with a known type.",{start:b,end:g},e,zt))},[d.FunctionDeclaration]:(p,v)=>{let b=`${p.value}()`;U({[d.Declaration]:(g,w)=>{let[L,R]=g.range;!ft(g.type)&&!i[g.type]&&!l[g.type]&&f.push(we(`Unknown type used in a declartion, "${String(g.type)}"`,"Variables must be assigned with a known type.",{start:L,end:R},e,b))},[d.Assignment]:g=>{let[w]=g.params,[L,R]=g.range;w.meta[Ot]&&f.push(we(`Cannot reassign a const variable ${w.value}`,"const variables cannot be reassigned, use let instead.",{start:L,end:R},e,b))},[d.ArraySubscript]:g=>{let[w]=g.params,[L,R]=g.range;f.push(we("Invalid subscript target",`Expected array type for ${w.value}, received ${w.type}`,{start:L,end:R},e,b))},[d.NativeMethod]:(g,w)=>{let{value:L}=g,[R={},M]=g.params,[z,X]=g.range;R.value==="unreachable"&&(L.includes("store")||L.includes("load"))&&f.push(we("Cannot generate property access",`Cannot assign "${M.value}". Key is "${R.value}"`,{start:z,end:X},e,b))},[d.ReturnStatement]:(g,w)=>{if(g.params.map(w),p.type==null)return;let[L]=g.params,[R]=g.range,M=L!=null?L.range[1]:g.range[1],z=g.type;ke(z)!==ke(p.type)&&f.push(we("Missing return value","Inconsistent return value. Expected "+p.type+" received "+String(z),{start:R,end:M},e,b))},[d.FunctionCall]:(g,w)=>{if(c[g.value]==null){let[L,R]=g.range;f.push(we("Undefined function reference",`${g.value} is not defined.`,{start:L,end:R},e,b))}},[d.IndirectFunctionCall]:(g,w)=>{let L=g.params[g.params.length-1],R=i[L.type];if(!ft(L.type)&&R==null){let[M,z]=g.range;f.push(we("Cannot make an indirect call without a valid function type",`${L.value} has type ${String(L.type)} which is not defined. Indirect calls must have pre-defined types.`,{start:M,end:z},e,b))}}})(p)}})(s);let y=f.length;if(y>0){let p=f.reduce((v,b)=>v+`
${b}
`,`Cannot generate WebAssembly for ${e}. ${y} problems.
`);throw new Error(p)}}let ue=(s,e)=>(Array.isArray(e)?s=[...s,...e]:s.push(e),s),Wo=(s,e)=>{let n=s.params.map(fe(e)).reduce(ue,[]),i=s.meta[Ce];return n.push({kind:k.Call,params:[i],debug:`${s.value}<${s.type?s.type:"void"}>`}),n},Qo=(s,e)=>{let n=s.params.map(fe(e)).reduce(ue,[]),i=s.meta[$t],c=s.meta[pt];return I(i!=null,"Undefined local index, not a valid function pointer"),I(c!=null,"Variable is not of a valid function pointer type"),[...n,{kind:k.CallIndirect,params:[c,0]}]},Ho=(s,e)=>{let n=s.params.map(fe(e)).reduce(ue,[]);return n.push({kind:lr(P({},s,{type:s.type})),params:[]}),n},Ko=(s,e)=>{let n=s.params.map(fe(e)).reduce(ue,[]);return n.push({kind:k.Select,params:[]}),n},Xo=(s,e)=>{let n=fe(e),[i,c,...l]=s.params;return[...[i].map(n).reduce(ue,[]),{kind:k.If,params:[64]},...[c].map(n).reduce(ue,[]),...l.map(n).reduce(ue,[]),{kind:k.End,params:[]}]},Zo=s=>[{kind:k.i32Const,params:[Number(s.value)]}],ea=s=>{let e=s.params.filter(Boolean).map(fe(null)).reduce(ue,[]);return e.push({kind:k.Return,params:[]}),e},ta=(s,e)=>[s].map(fe(e)).reduce(ue,[]),na=(s,e)=>{let n=s.params[0];if(n){let i=s.meta[$t],c=ft(s.type)?s.type:ut;return[...ta(P({},n,{type:c}),e),{kind:k.SetLocal,params:[i],debug:`${s.value}<${String(s.type)}>`}]}return[]},ra=s=>{let[e,n]=s.params,i=[n].map(fe(null)).reduce(ue,[]);return i.push(Jo(e)),i},sa=s=>{let[e,n]=s.params,i=[n].map(fe(null)).reduce(ue,[]);return i.push({kind:k.TeeLocal,params:[Number(e.meta.LOCAL_INDEX)],debug:`${e.value}<${String(e.meta.ALIAS||e.type)}>`}),i},oa=(s,e)=>{let n=[],i=fe(e),[c,l,...f]=s.params;return n.push.apply(n,[c].map(i).reduce(ue,[])),n.push({kind:k.Block,params:[64]}),n.push({kind:k.Loop,params:[64]}),n.push.apply(n,[l].map(i).reduce(ue,[])),n.push({kind:k.i32Eqz,params:[]}),n.push({kind:k.BrIf,params:[1]}),n.push.apply(n,f.map(i).reduce(ue,[])),n.push({kind:k.Br,params:[0]}),n.push({kind:k.End,params:[]}),n.push({kind:k.End,params:[]}),n},aa=(s,e)=>{let n=s.meta[en];I(n,`Cannot generate typecast for node: ${JSON.stringify(s)}`);let{to:i,from:c}=n;return[...s.params.map(fe(e)).reduce(ue,[]),{kind:cr(i,c),params:[]}]},ia=()=>[{kind:k.Br,params:[2]}];function ca(){return[]}let la=(s,e)=>s.params.map(fe(e)).reduce(ue,[]),ua=(s,e)=>[{kind:k.Else,params:[]},...s.params.map(fe(e)).reduce(ue,[])],pa=(s,e)=>{let[n,i]=s.params,c={kind:k.Select,params:[]},l=[n].map(fe(e)).reduce(ue,[]);return s.value==="&&"?[...[i].map(fe(e)).reduce(ue,[]),{kind:k.i32Const,params:[0]},...l,c]:[...l,...[i].map(fe(e)).reduce(ue,[]),...l,c]},gr={load8_s:0,load8_u:0,store8:0,load16_s:1,load16_u:1,store16:1,store32:2,load32_s:2,load32_u:2,store:2,load:2},fa={grow_memory:0,current_memory:0},ma=(s,e)=>{let n=s.params.map(fe(e)).reduce(ue,[]),i=s.value.split(".").pop();if(gr[i]==null)n.push({kind:ln[s.value],params:[fa[s.value]]});else{let c=gr[i];n.push({kind:ln[s.value],params:[c,0]})}return n},ya=s=>{let e=k[String(s.type)+"Const"],n=(s.meta.SIGN||1)*Number(s.value);return[{kind:e,params:[n]}]},ha={[d.FunctionCall]:Wo,[d.IndirectFunctionCall]:Qo,[d.Constant]:ya,[d.BinaryExpression]:Ho,[d.TernaryExpression]:Ko,[d.IfThenElse]:Xo,[d.Else]:ua,[d.Select]:pa,[d.Block]:la,[d.Identifier]:_r,[d.FunctionIdentifier]:_r,[d.FunctionPointer]:Zo,[d.ReturnStatement]:ea,[d.Declaration]:na,[d.Assignment]:ra,[d.AssignmentExpression]:sa,[d.Loop]:oa,[d.Break]:ia,[d.TypeCast]:aa,[d.Noop]:ca,[d.NativeMethod]:ma},fe=wt((s,e)=>{let n=ha[e.Type];return I(n,`Unsupported Syntax Token. ${e.Type} "${e.value}"`),n(e,s)}),da=s=>({functionIndex:s}),fn=0,Gt=1,Yt=2,mt=3,ba={Memory:Yt,Table:Gt};function _a(s){let e=s.meta[Ce],n=s.meta[Le];if(n!=null){let i=ba[String(s.type)]||mt;return{index:[Yt,Gt].includes(i)?0:n,kind:i,field:s.value}}return{index:e,kind:fn,field:s.value}}let ga=s=>{let e={max:0,initial:0};return U({[d.Pair]:({params:n})=>{let[{value:i},{value:c}]=n;e[i]=parseInt(c)}})(s),e};function va(s){let e={max:0,initial:0,type:"element"};return U({[d.Pair]:({params:n})=>{let[{value:i},{value:c}]=n;switch(i){case"initial":e.initial=parseInt(c);break;case"element":e.type=c;break;case"max":e.max=parseInt(c);break}}})(s),e}let Sa=s=>{let e=br(s),[n]=s.params;if(n!=null){let{value:i}=n;switch(e.type){case He:case Ke:e.init=parseFloat(i);break;case We:case Qe:default:e.init=parseInt(i)}}return e},Ta=s=>{switch(s){case"Memory":return Yt;case"Table":return Gt;case"i32":case"f32":case"i64":case"f64":return mt;default:return fn}},Ea=s=>{let e=s.value;return s.meta.AS!=null?s.meta.AS:e};function xa(s){let[e,n]=s.params,{value:i}=n,c=[];return U({[d.Pair]:(l,f)=>{let[y,p]=l.params,v=Ea(y),{value:b}=p,g=Ta(b),w=(()=>{let R=p.meta[pt];return R||null})(),L=b==="Memory"?un(p):{};c.push(P({module:i,field:v,global:g===mt,kind:g,type:Go[b],typeIndex:w},L))}})(e),c}let Xe=s=>{switch(s){case"f32":return He;case"f64":return Ke;case"i64":return Qe;case"i32":case"Function":default:return We}},vr=s=>{let[e]=s.params,n=s.type?Xe(s.type):null,i=[];return U({[d.Pair]:c=>{let l=c.params[1];I(l,"Undefined type in a argument expression"),i.push(Xe(l.value))}})(e),{params:i,result:n,id:s.value}};function Aa(s){let e=s.value;I(typeof e=="string",`Generator: A type must have a valid string identifier, node: ${JSON.stringify(s)}`);let[n,i]=s.params,c=[];return U({[d.DeclType]:(l,f)=>{c.push(Xe(l.value))},[d.Type]:(l,f)=>{c.push(Xe(l.value))},[d.Identifier]:(l,f)=>{c.push(Xe(l.value))}})(n),{id:e,params:c,result:i.type&&i.type!=="void"?Xe(i.type):null}}function wa(s,e){let n=e,i={},c=Object.entries(s).reduce((f,[y,p])=>(f.push({offset:Number(n),data:p}),i[y]=n,n+=p.size,f),[]),l=new le;return l.push(on,n,String(n)),{data:[{offset:0,data:l},...c],map:i}}let $a=4,Oa=s=>{let[e,n,...i]=s.params,c=s.meta[nn];I(i,"Cannot generate code for function without body"),I(c,"Cannot generate code for function without metadata");let{locals:l,argumentsCount:f}=c,y={code:[],locals:Object.keys(l).slice(f).map(p=>br(l[p])),debug:`Function ${s.value}`};return y.code=i.map(fe(y)).reduce(ue,[]),y};function mn(s,e){let n={Version:e.version,Types:[],Start:[],Element:[],Code:[],Exports:[],Imports:[],Globals:[],Functions:[],Memory:[],Table:[],Artifacts:[],Data:[],Name:{module:e.filename,functions:[],locals:[]}},{statics:i}=s.meta[tn];e.linker!=null&&(i=P({},e.linker.statics,i));let{map:c,data:l}=wa(i,$a);Object.keys(i).length>0&&(n.Data=l);let f=g=>{let w=vr(g);return n.Types.findIndex(L=>{let R=L.params.length===w.params.length&&L.params.reduce((z,X,Q)=>z&&X===w.params[Q],!0),M=L.result===w.result;return R&&M})},y=g=>n.Element.findIndex(w=>w.functionIndex===g),p={},v=N({[d.Typedef]:(g,w)=>{let L=n.Types.findIndex(({id:M})=>M===g.value),R=n.Types[L];return R==null&&(L=n.Types.length,n.Types.push(Aa(g))),R=P({},g,{meta:P({},g.meta,{[pt]:L})}),p[g.value]={typeIndex:L,typeNode:R},R}})(N({[d.Import]:(g,w)=>g,[d.StringLiteral]:(g,w)=>{let{value:L}=g;return c[L]==null?g:P({},g,{value:String(c[L]),Type:d.Constant})},[d.StaticValueList]:g=>{let{value:w}=g;return P({},g,{value:String(c[w]),Type:d.Constant})}})(s)),b={[d.Typedef]:(g,w)=>g,[d.Export]:g=>{let[w]=g.params;n.Exports.push(_a(w))},[d.ImmutableDeclaration]:g=>{switch(g.type){case"Memory":n.Memory.push(ga(g));break;case"Table":n.Table.push(va(g));break}},[d.Declaration]:g=>{g.meta[Le]!=null&&n.Globals.push(Sa(g))},[d.Import]:g=>{n.Imports.push(...xa(g))},[d.FunctionDeclaration]:g=>{let w=(()=>{let M=f(g);return M===-1?(n.Types.push(vr(g)),n.Types.length-1):M})(),L=N({FunctionPointer(M){let X=M.meta[Ce],Q=y(X);return Q<0&&(Q=n.Element.length,n.Element.push(da(X))),M}})(g),R=g.meta[Ce];if(I(R!=null,"Function index must be set"),n.Functions[R]=w,n.Code[R]=Oa(L),L.value==="start"&&n.Start.push(R),e.encodeNames){n.Name.functions.push({index:R,name:g.value});let M=g.meta[nn];M!=null&&Object.keys(M.locals).length&&(n.Name.locals[R]={index:R,locals:Object.entries(M.locals).map(([z,X])=>({name:z,index:Number(X.meta["local/index"])}))})}}};return U(b)(v),n.Code=n.Code.filter(Boolean),n}let Sr=1,Ca=1836278016;function La(s){return new le().push(on,Ca,"\\0asm").push(on,s,`version ${s}`)}let yn="varuint7",G="varuint32",yt="varint7",Ze="varint1",hn="varint32",Tr="varint64";function De(s,e,n){s.push(G,e.length,n);for(let i=0;i<e.length;i++)s.push(ce,e.charCodeAt(i),e[i]);return s}let Pa=s=>{let e=new le().push(G,s.length,"entry count");return s.forEach(n=>{switch(De(e,n.module,"module"),De(e,n.field,"field"),n.kind){case mt:{e.push(ce,mt,"Global"),e.push(ce,n.type,Ut(n.type)),e.push(ce,0,"immutable");break}case fn:{e.push(ce,n.kind,"Function"),e.push(G,n.typeIndex,"type index");break}case Gt:{e.push(ce,n.kind,"Table"),e.push(ce,ur,"function table types"),e.push(Ze,0,"has max value"),e.push(G,0,"iniital table size");break}case Yt:{e.push(ce,n.kind,"Memory"),e.push(Ze,!!n.max,"has no max"),e.push(G,n.initial,"initial memory size(PAGES)"),n.max&&e.push(G,n.max,"max memory size(PAGES)");break}}}),e},Ia=s=>{let e=new le;return e.push(G,s.length,"count"),s.forEach(({field:n,kind:i,index:c})=>{De(e,n,"field"),e.push(ce,i,"Global"),e.push(G,c,"index")}),e},Na=(s,{type:e,init:n,mutable:i})=>{switch(s.push(ce,e,Ut(e)),s.push(ce,i,"mutable"),e){case We:s.push(ce,k.i32Const.code,k.i32Const.text),s.push(hn,n,`value (${n})`);break;case He:s.push(ce,k.f32Const.code,k.f32Const.text),s.push($,n,`value (${n})`);break;case Ke:s.push(ce,k.f64Const.code,k.f64Const.text),s.push(oe,n,`value (${n})`);break;case Qe:s.push(ce,k.i64Const.code,k.i64Const.text),s.push(Tr,n,`value (${n})`)}s.push(ce,k.End.code,"end")},Ra=s=>{let e=new le;return e.push(G,s.length,"count"),s.forEach(n=>Na(e,n)),e},Ba=s=>{s=s.filter(n=>n!==null);let e=new le;return e.push(G,s.length,"count"),s.forEach(n=>e.push(G,n,"type index")),e};function ka(s){let e=new le;return e.push(G,s[0],"start function"),e}let Fa=s=>({functionIndex:e},n)=>{s.push(G,0,"table index"),s.push(ce,k.i32Const.code,"offset"),s.push(G,n,n.toString()),s.push(ce,k.End.code,"end"),s.push(G,1,"number of elements"),s.push(G,e,"function index")},Ma=s=>{let e=new le;return e.push(G,s.length,"count"),s.forEach(Fa(e)),e},ja=(s,{params:e,result:n},i)=>{s.push(yt,pr,`func type (${i})`),s.push(G,e.length,"parameter count"),e.forEach(c=>s.push(yt,c,"param")),n?(s.push(Ze,1,"result count"),s.push(yt,n,`result type ${Ut(n)}`)):s.push(Ze,0,"result count")},Da=s=>{let e=new le;return e.push(G,s.length,"count"),s.forEach((n,i)=>ja(e,n,i)),e},Ua=(s,e)=>{s.push(G,1,"number of locals of following type"),s.push(yt,e.type,`${Ut(e.type)}`)},za=(s,{locals:e,code:n,debug:i})=>{let c=new le;n.forEach(({kind:f,params:y,debug:p})=>{I(typeof f<"u",`Fatal error! Generated undefined opcode. debug code: ${JSON.stringify(p)}`),c.push(ce,f.code,`${f.text}  ${p||""}`),y.filter(v=>typeof v<"u").forEach(v=>{let b=G,g="i32.literal";if(f.code>=40&&f.code<=64)b=G,g="memory_immediate";else switch(f.result){case oe:b=oe,g="f64.literal";break;case $:b=$,g="f32.literal";break;case T:b=hn,g="i32.literal";break;case C:b=Tr,g="i64.literal";break;default:b=G}c.push(b,v,`${g}`)})});let l=new le;e.forEach(f=>Ua(l,f)),s.push(G,c.size+l.size+2,i),s.push(G,e.length,"locals count"),s.write(l),s.write(c),s.push(ce,k.End.code,"end")},Ga=s=>{let e=new le;return e.push(G,s.length,"function count"),s.forEach(n=>za(e,n)),e},Ya=(s,e)=>{s.push(Ze,e.max?1:0,"has no max"),s.push(G,e.initial,"initial memory size(PAGES)"),e.max&&s.push(G,e.max,"max memory size(PAGES)")},qa=s=>{let e=new le;return e.push(G,s.length,"count"),s.forEach(n=>Ya(e,n)),e},Va={anyfunc:112},Ja=(s,e)=>{s.push(yt,Va[e.type],e.type),s.push(Ze,e.max?1:0,"has max"),s.push(G,e.initial,"initial table size"),e.max&&s.push(G,e.max,"max table size")};function Wa(s){let e=new le;return e.push(G,s.length,"count"),s.forEach(n=>Ja(e,n)),e}let Qa=(s,e)=>{s.push(G,0,"memory index");let{offset:n,data:i}=e;s.push(ce,k.i32Const.code,k.i32Const.text),s.push(hn,n,`segment offset (${n})`),s.push(ce,k.End.code,"end"),s.push(G,i.size,"segment size"),s.write(i)};function Ha(s){let e=new le;e.push(G,s.length,"entries");for(let n=0,i=s.length;n<i;n++){let c=s[n];Qa(e,c)}return e}let Ka=s=>{let e=new le;return De(e,s,`name_len: ${s}`),e},Xa=s=>{let e=new le;return e.push(G,s.length,`count: ${String(s.length)}`),s.forEach(({index:n,name:i})=>{e.push(G,n,`index: ${String(n)}`),De(e,i,`name_len: ${i}`)}),e},Za=s=>{let e=new le;return e.push(G,s.length,`count: ${String(s.length)}`),s.forEach(({index:n,locals:i})=>{e.push(G,n,`function index: ${String(n)}`),e.push(G,i.length,`number of params and locals ${i.length}`),i.forEach(({index:c,name:l})=>{e.push(G,c,`index: ${String(c)}`),De(e,l,`name_len: ${l}`)})}),e},ei=s=>{let e=new le;De(e,"name","name_len: name");let n=Ka(s.module);e.push(yn,0,"name_type: Module"),e.push(G,n.size,"name_payload_len"),e.write(n);let i=Xa(s.functions);e.push(yn,1,"name_type: Function"),e.push(G,i.size,"name_payload_len"),e.write(i);let c=Za(s.locals);return e.push(yn,2,"name_type: Locals"),e.push(G,c.size,"name_payload_len"),e.write(c),e},ti=1,ni=2,ri=3,si=4,oi=5,ai=6,ii=7,ci=8,li=9,ui=10,pi=11,fi=0,Te=({type:s,label:e,emitter:n})=>i=>{let c=i[e];if(!c||Array.isArray(c)&&!c.length)return null;let l=new le().push(ce,s,e+" section"),f=n(c);return l.push(G,f.size,"size"),l.write(f),l};var Ee={type:Te({type:ti,label:"Types",emitter:Da}),imports:Te({type:ni,label:"Imports",emitter:Pa}),function:Te({type:ri,label:"Functions",emitter:Ba}),table:Te({type:si,label:"Table",emitter:Wa}),memory:Te({type:oi,label:"Memory",emitter:qa}),exports:Te({type:ii,label:"Exports",emitter:Ia}),globals:Te({type:ai,label:"Globals",emitter:Ra}),start:Te({type:ci,label:"Start",emitter:ka}),element:Te({type:li,label:"Element",emitter:Ma}),code:Te({type:ui,label:"Code",emitter:Ga}),data:Te({type:pi,label:"Data",emitter:Ha}),name:Te({type:fi,label:"Name",emitter:ei})};function dn(s,e){let i=new le().write(La(s.Version)).write(Ee.type(s)).write(Ee.imports(s)).write(Ee.function(s)).write(Ee.table(s)).write(Ee.memory(s)).write(Ee.globals(s)).write(Ee.exports(s)).write(Ee.start(s)).write(Ee.element(s)).write(Ee.code(s)).write(Ee.data(s));return e.encodeNames?i.write(Ee.name(s)):i}let mi=(s,e=0,n)=>{let i=0;return s.data.slice(e,n).map(({type:c,value:l,debug:f})=>{let y=`${i.toString()} 0x${i.toString(16)}`.padStart(6," ").padEnd(s.data.length.toString().length+1),p;Array.isArray(l)?p=l.map(b=>b.toString(16)).join().padStart(16):p=l.toString(16).padStart(16);let v=`${y}: ${p} ; ${f}`;return i+=an[c]||l.length,v}).join(`
`)+`
 ============ fin =============`},bn=s=>{let e=n=>{try{return s(`function fragment() {
        ${n}
      }`).params[0].params[2].params[0]}catch(i){throw new Error(`PANIC - Invalid fragment input:

${n}

Parse Error: ${i.stack}`)}};return(n,...i)=>{let c=!1,l=n.reduce((y,p,v)=>{let b=i[v];return b!=null&&typeof b!="object"?y+=p+String(b):b!=null?(c=!0,y+=p+`$$rep_${v}`):y+=p},""),f=e(l);return c?N({Identifier(y){let{value:p}=y;return p.indexOf("$$rep_")?y:i[Number(p.replace("$$rep_",""))]}})(f):f}},yi="0.21.0",hi=(s,e)=>{let{version:n=Sr,encodeNames:i=!1,lines:c=s.split(`
`),filename:l="unknown",extensions:f=[]}=e||{},y=Zt([]),p=bn(y),v={version:n,encodeNames:i,lines:c,filename:l,extensions:f},b=y(s),g=cn(b,[],P({},v,{parser:y,stmt:p}));pn(g,{lines:c,filename:l});let w=mn(g,v);return dn(w,{version:n,encodeNames:i,filename:l,lines:c})},di=(s,e)=>{let{filename:n="unknown.walt",extensions:i=[],linker:c,encodeNames:l=!1}=e||{},f={filename:n,lines:s.split(`
`),version:Sr,encodeNames:l},y=i.reduce((R,M)=>{let z=P({semantics:X=>({}),grammar:()=>({ParserRules:[]})},M(f));return R.grammar.push(z.grammar),R.semantics.push(z.semantics),R},{grammar:[],semantics:[]}),p=Zt(y.grammar),v=bn(p),b=p(s),g=cn(b,y.semantics,{parser:p,stmt:v});pn(g,f);let w=mn(g,P({},f,{linker:c})),L=dn(w,f);return{wasm:L,buffer(){return L.buffer()},ast:b,semanticAST:g}};return r.makeParser=Zt,r.makeFragment=bn,r.semantics=cn,r.validate=pn,r.generator=mn,r.emitter=dn,r.prettyPrintNode=hr,r.debug=mi,r.stringEncoder=ir,r.stringDecoder=$o,r.walkNode=U,r.mapNode=N,r.VERSION=yi,r.getIR=hi,r.compile=di,r}({}),ps=Wi;var Qi=r=>r.trim().length?JSON.stringify([...new Uint8Array(ps.compile(r).buffer())]):"[]",Hi=r=>{let t={};return Object.getOwnPropertyNames(Object.getPrototypeOf(r)).filter(o=>!["constructor","initial_state","initial_component","__walt","css","init"].includes(o)).map(o=>t[o]=r[o].bind(r)),t},Ki=(r,t)=>{if(r.length){let o=new WebAssembly.Table({initial:10,element:"anyfunc"}),a=new WebAssembly.Instance(new WebAssembly.Module(new Uint8Array(r).buffer),{tag:Hi(t),console,javascript:{table:o,setTimeout:(m,h)=>window.setTimeout(o.get(m),h),setInterval}}).exports,u={};return Object.keys(a).map(m=>u[m]=a[m]),u}return{}},fs={name:"Walt",uniqueBlock:"walt",compileWalt:Qi,initWalt:Ki};function Xi(r){function t(m,h,_){var E;return _<0?_+=1:_>1&&(_-=1),6*_<1?E=m+(h-m)*_*6:2*_<1?E=h:3*_<2?E=m+(h-m)*(2/3-_)*6:E=m,255*E}function o(m,h,_){var E,A,N,F,U,te,I=Math;return h/=100,_/=100,h?(_<=.5?A=_*(h+1):A=_+h-_*h,E=_*2-A,N=m/360,F=I.ceil(t(E,A,N+1/3)),U=I.ceil(t(E,A,N)),te=I.ceil(t(E,A,N-1/3))):F=U=te=_*255,{r:F,g:U,b:te}}function a(m,h,_){return"#"+((1<<24)+(1*m<<16)+(1*h<<8)+1*_).toString(16).slice(1)}var u="|_|";return String(r).replace(/(:not\(.*?\))\s+(?!{)/g,"$1"+u).replace(/\/\*[\s\S]*?\*\//g," ").replace(/\s+/g," ").replace(/^\s+/g,"").replace(/ \{/g,"{").replace(/\;\}/g,"}").replace(/ ([+~>]) /g,"$1").replace(/([\: ,\(\)\\/])(\-*0+)(%|px|pt|pc|rem|em|ex|cm|mm|in)([, ;\(\)}\/]*?)/g,"$10$4").replace(/([: ,=\-\(\{\}])0+\.(\d)/g,"$1.$2").replace(/([^\}]*\{\s*?\})/g,"").replace(/(\*)([.:\[])/g,"$2").replace(/(\[)([^"' \]]+)(["'])([^"' \]]+)(\3)(\])/g,"$1$2$4$6").replace(/(?:{)([^{}]+?)(?:})/g,function(m,h){var _=[],E=[];h=h.replace(/(url\s*\([^)]*\))/g,function(N){return _.push(N),"$"+(_.length-1)+"$"}),h=h.match(/([a-z\-]+)\:(.+?)(;|$)/gi);for(var A=0;A<h.length;A++)h[A]=/([a-z\-]+)\:(.+?)(;|$)/i.exec(h[A]),h[A]&&(h[A][2]=h[A][2].replace(/\$([0-9]+)\$/g,function(N,F){return _[F]||""}));m={};for(var A=0;A<h.length;A++)if(h[A]){if(h[A][1]=="background"||h[A][1]=="background-image"){E.push(h[A][1]+":"+h[A][2]);continue}m[h[A][1]]=h[A][2]}for(var A in m)E.push(A+":"+m[A]);return"{"+E.join(";")+"}"}).replace(/ (\!important)/g,"$1").replace(/\:(\:before|\:after)/g,"$1").replace(/(rgb|rgba|hsl|hsla)\s*\(\s*(\d+)[, %]+(\d+)[, %]+(\d+)[, %]+?([0-1]?)\s*\)/g,function(m,h,_,E,A,N){if(N==="0")return" transparent ";if(h=h.toLowerCase(),!h.indexOf("hsl")){var F=o(_,E,A);_=F.r,E=F.g,A=F.b}return a(_,E,A)}).replace(/([,: \(]#)([0-9a-f])\2([0-9a-f])\3([0-9a-f])\4/gi,"$1$2$3$4").replace(/ ?([\(\)\{\}\:\;\,]) /g,"$1").replace(/(margin|padding|border-width|border-color|border-style)\:([^;}]+)/gi,function(m,h,_){function E(){for(var F=arguments,U=F.length>1?F:F.length==1?F[0]:[],te=0;te<U.length;te++)if(te!=0&&U[te]!=U[te-1])return!1;return!0}var A=_.toLowerCase().split(" "),N=_;return E(A)?N=A[0]:A.length==4&&E(A[0],A[2])&&E(A[1],A[3])||A.length==3&&E(A[0],A[2])?N=A[0]+" "+A[1]:A.length==4&&E(A[1],A[3])&&(N=A[0]+" "+A[1]+" "+A[2]),N=h+":"+N,N}).replace(/\:\s*calc\(([^;}]+)/g,function(m){return m.replace(/\s+/g,"").replace(/([-+*/]+)/g," $1 ").replace(/(--)\s/g,"$1")}).replace(/\|_\|/g," ")}var ms=Xi;var ys={name:"min.css",processStyle:ms};var Zi={walt:fs,mincss:ys},Tt=Zi;var Et;if(typeof window<"u"){class r extends HTMLElement{constructor(){super(),this.ShadowDOM="open",this.state=this.initial_state,this.__walt&&(this.walt=Tt.walt.initWalt(this.__walt,this,this.state)),this.init&&this.init(),this.document=["open","closed"].includes(this.ShadowDOM)?this.attachShadow({mode:this.ShadowDOM}):this,this.initialize()}attributeChangedCallback(o,a,u){this.setAttribute(o,u)}}Kt(r,at),Et=r}var xt=class{constructor(){if(this.state=this.initial_state,this.init&&this.init(),this.document=document.querySelector(this.container),!this.document)throw`i.js: target container "${this.container}" not found`;this.initialize(),this.connectedCallback()}destroy(){this.disconnectedCallback()}};Kt(xt,at);var hs=(r,t=0)=>{for(var o=3735928559^t,a=1103547991^t,u=0,m;u<r.length;u++)m=r.charCodeAt(u),o=Math.imul(o^m,2654435761),a=Math.imul(a^m,1597334677);return o=Math.imul(o^o>>>16,2246822507)^Math.imul(a^a>>>13,3266489909),a=Math.imul(a^a>>>16,2246822507)^Math.imul(o^o>>>13,3266489909),4294967296*(2097151&a)+(o>>>0)};function At(r,t){return"i-"+String(hs(t||r.trim())).replaceAll("-","i")}var ec={},it=ec;var zn={},tc=r=>r.split("-").map(t=>t.slice(0,1).toUpperCase()+t.slice(1)).join(""),nc=r=>((t,o)=>JSON.stringify(r,(a,u)=>typeof u=="function"?o.push(u)&&t:u).replace(new RegExp('"'+t+'"',"g"),a=>o.shift()))("____"+Yr(50)+"____",[]),rc=(r,t)=>{if(zn[r])return zn[r];let o=URL.createObjectURL(new Blob([String.raw({raw:t})],{type:"text/javascript"}));return zn[r]=o,o},sc=(r,t)=>r.reduce((o,a)=>{let u=t?"i.js:"+t+a.path:rc(a.path,a.src);return a.type==="*"?o+"const "+a.import+" = {...(await import(`"+u+"`))};\n":a.type==="object"?o+"const "+a.import+" =  (await import(`"+u+"`));\n":o+"const "+a.import+" =  (await import(`"+u+"`)).default;\n"},"");function ds(r,t,{inFunc:o=!1}){let a=Object.values(Tt).filter(U=>U.processStyle).reduce((U,te)=>te.processStyle(U),r.style||""),u=r.walt?Tt.walt.compileWalt(r.walt):"undefined",m=`{${(r.state||"").trim()}}`,h=t!=="customElement"?"":new Function(`return 'static get observedAttributes() { return '+JSON.stringify(Object.keys(${m}))+' }'`)(),_=tc(r.name),E=nc(ls(r.template,r.tag||[])),A=r.container?`get container()         { return "${r.container}" }`:"",N=`
        ${r.import?sc(r.import,r.nodePath):""}
        ${r.static||""};
        class ${_} extends ${t} {
            ${h}
            get initial_state()     { return ${m} }
            get initial_component() { return ${E} }
            get css()               { return \`${a}\`; }
            get __walt()            { return ${u} }
            ${A}
            ${r.class||""}
        };
    `,F=t==="customElement"?`
        if(!customElements.get('${r.name}')) {
            ${N}
            customElements.define('${r.name}', ${_});
            window['iJS'].tags['${r.name}'] = true;
        }
    `:`${N} return new ${_}()`;return o?`;(async () => {${F}})();`:F}async function _s(r,t){let o=At(r.innerText);await ct(r.innerText,{name:o,path:t}),r.replaceWith(document.createElement(o))}async function Yn(r,t,o){await ct(r,{name:t,path:o})}async function qn(r,t,o=""){if(it[r])return!0;let a=t.substr(-4)===".tag"?t:t+".tag",u=t[0]!=="/"?Gn(o+a):a,m=await fetch(u).catch(_=>!1);if(m===!1)throw"i.js  \u2764\uFE0F error loading "+a;let h=u.substring(0,u.lastIndexOf("/"))+"/";await Yn(await m.text(),r,h)}async function gs(r,t,o){await ct(r.innerText,{name:At(r.innerText),path:o,container:t})}function Gn(r){return typeof window>"u"?r:new URL(r,document.baseURI).pathname}async function Vn({source:r,path:t,keepName:o,nodeFetch:a,nodePath:u}){let m=o?t.split("/").pop().split(".")[0]:At(t);return{name:m,compiled:await ct(r,{name:m,path:t.substring(0,t.lastIndexOf("/"))+"/",bundle:!0,nodeFetch:a,nodePath:u})}}async function bs(r,t){if(t)return await t(r);let o=await fetch(r).catch(a=>!1);if(o===!1)throw"i.js  \u2764\uFE0F error loading "+r;return(await o.text()).trim()}async function ct(r,t={}){let o=await us(r);if(!t.name)throw"name is undefined !!!";o.name=t.name||"i-component",o.path=t.path,o.container=t.container||"",o.nodePath=t.nodePath?t.nodePath+t.path:void 0;let a=t.nodeFetch||void 0;var u="";if(o.style&&(o.style=o.style.trim(),o.style.length&&(u=o.style)),o.css)for(let m of o.css){let h=m[0]!=="/"?Gn(o.path+m):m,_=await bs(h,a);_.length&&(u+=`
`+_)}if(o.style=u.replaceAll("`","`").trim(),o.tag)for(let m of o.tag){let h=m.path,_=At(h.substr(-4)===".tag"?h:h+".tag");m.name=_,a?m.src=await a(h.substr(-4)===".tag"?h:h+".tag"):await qn(_,h,o.path)}if(o.import&&!a)for(let m of o.import){let h=m.path[0]!=="/"?Gn(o.path+m.path):m.path,_=await bs(h,a);m.src=_}if(it[o.name]=!0,o.container){let m=ds(o,"iElement",{inFunc:!1});return await new jn("iElement",m)(xt)}else{let m=ds(o,"customElement",{inFunc:!0});if(t.bundle){if(o.tag){let h="";for(let _ of o.tag)if(it[_.name])console.log(`              <${_.name}> skipped`);else{let{name:E,compiled:A}=await Vn({source:_.src,path:_.path.substr(-4)===".tag"?_.path:_.path+".tag",name:_.name,nodePath:o.nodePath,nodeFetch:a});h+=A}return h+m}return m}await new jn("customElement",m)(Et)}}function oc(r,t){r.innerText.trim().length&&console.warn(`i.js \u2764\uFE0F  warning: contents of "<script type=i ${t.map(o=>o.name).join(" ")}> will be ignored"`)}function vs(r,t){r.innerText.trim().length||console.warn(`i.js \u2764\uFE0F  warning: empty "<script type=i ${t.map(o=>o.name).join(" ")}>"`)}async function Ss(){let r=Array.from(document.querySelectorAll('script[type="i"]'));try{for(let t of r){let o=window.location.pathname,a=o.substring(0,o.lastIndexOf("/"))+"/",u=Array.prototype.slice.call(t.attributes).map(_=>({name:_.name,value:t.getAttribute(_.name).trim()})),m=u.find(_=>_.name==="target"&&_.value.length);if(m){u.length>2&&console.warn(`i.js \u2764\uFE0F  warning: all other attributes for "<script type=i target="${m.value}"> will be ignored"`),await gs(t,m.value,a),t.remove();continue}let h=u.filter(_=>_.name.includes("-"));if(h.length>1)throw`i.js \u2764\uFE0F  ERROR: more then one attribute with hyphens "<script ${h.map(_=>_.name).join(" ")}>"`;h.length===1?(h[0].value?(oc(t,u),await qn(h[0].name,h[0].value,a)):(vs(t,u),await Yn(t.innerText,h[0].name,a)),t.remove()):(vs(t,u),await _s(t,a))}}catch(t){throw new qt(t)}}var Ts="0.5.62";console.log(`i.js \u2764\uFE0F  ${Ts} alpha experiment. Make DOM great again!`);var Es={VERSION:Ts,tags:it,customElement:Et,createTag:ct,compile:Vn},Lu=Es;typeof window<"u"&&(window.iJS=Es,document.addEventListener("DOMContentLoaded",Ss));export{Ts as VERSION,Vn as compile,ct as createTag,Et as customElement,Lu as default,it as tags};
/**
 * WASM types
 *
 * https://github.com/WebAssembly/spec/tree/master/interpreter#s-expression-syntax
 *
 * Plus some extra C type mappings
 *
 * @author arthrubuldauskas@gmail.com
 * @license MIT
 */
/**
 * min.css
 *
 * min.css is a tiny, fast and efficient JavaScript library for minifying CSS
 * files that really makes your website faster
 *
 * Site: https://github.com/w3core/min.css/
 * Online: https://w3core.github.io/min.css/
 *
 * @version 1.3.1
 *
 * @license BSD License
 * @author Max Chuhryaev
 */
