var is=Object.freeze,Ht=Object.defineProperty;var Ja=Object.getOwnPropertyDescriptor;var Ha=Object.getOwnPropertyNames;var Qa=Object.prototype.hasOwnProperty;var Ka=(e,t)=>{for(var s in t)Ht(e,s,{get:t[s],enumerable:!0})},Xa=(e,t,s,i)=>{if(t&&typeof t=="object"||typeof t=="function")for(let c of Ha(t))!Qa.call(e,c)&&c!==s&&Ht(e,c,{get:()=>t[c],enumerable:!(i=Ja(t,c))||i.enumerable});return e};var Za=e=>Xa(Ht({},"__esModule",{value:!0}),e);var de=(e,t)=>is(Ht(e,"raw",{value:is(t||e.slice())}));var Vc={};Ka(Vc,{VERSION:()=>pn,compile:()=>ln,createTag:()=>Qe,customElement:()=>yt,default:()=>Wc,plugins:()=>ar,tags:()=>Le});module.exports=Za(Vc);var ec="useandom-26T198340PX75pxJACKVERYMINDBUSHWOLF_GQZbfghjklqvwyzrict";var tc=(e=21)=>{let t="",s=e;for(;s--;)t+=ec[Math.random()*64|0];return t},as=tc;var Je=class extends Error{constructor(t){super(t),this.name="ui.js \u2764\uFE0F  brackets parse ERROR"}};function nc({open:e,close:t,pos:s,nodes:i},c,p){return{nodeType:"bracket",open:e,close:t,nodes:i,pos:Object.assign({},s,{end:c}),content:p.substring(s.start,c+1),innerContent:p.substring(s.start+1,c)}}function rc(e){let t=new Map;return e.forEach(([s,i=s])=>t.set(s,i)),{quotes:t}}function sc(e){let t={},s={};return e.forEach(([i,c])=>{s[i]=c,t[c]=i}),{opens:t,closes:s}}function qn(e){let{text:t,parent:s,start:i,end:c,opt:p}=e;if(i===c&&!p.includeEmpty)return;let m=p.pairs.reduce((x,$)=>x.concat($.split("")),[]).map(x=>"".concat(p.escape).concat(x)),g=x=>m.reduce(($,R)=>$.split(R).join(R[1]),x),_=s.pos.depth+1;s.nodes.push({nodeType:"text",pos:{start:i,end:c,depth:_},content:g(t.substring(i,c))})}var Wn=e=>{let t=e.pop();if(t===void 0)throw new Je("LogicError :)");return t};function lt(e,t){let i=Object.assign({pairs:["()","{}","[]"],nestMax:100,escape:"\\",skip:!1,includeEmpty:!1,quotes:['"',"'","`"]},t||{}),{pairs:c,nestMax:p,escape:m,skip:g}=i,{opens:_,closes:x}=sc(c),{quotes:$}=rc(i.quotes),R=[{nodeType:"root",nodes:[],pos:{start:0,end:0,depth:-1},content:e}],D=0,J=null,L=0;for(let te=0;te<e.length;te++){let ee=Wn(R),G=e[te],y=te>0&&e[te-1]===m;if(g&&["{","}","(",")","[","]"].includes(G)&&ee.nodeType==="root")R.push(ee);else if(g&&["{","(","["].includes(ee.open)&&(G==="<"||G===">"))R.push(ee);else if(y)R.push(ee);else if(J!==null)J===G&&(J=null),R.push(ee);else if($.has(G))J=$.get(G),L=te,R.push(ee);else if(x[G]!==void 0){if(R.length>=p)throw new Je("over nest max limit. options: { nestMax: '".concat(i.nestMax,"' }"));qn({text:e,parent:ee,start:D,end:te,opt:i}),R.push(ee),R.push({nodeType:"bracket-open",pos:{start:te,depth:ee.pos.depth+1},open:G,close:x[G],nodes:[]}),D=te+1}else if(_[G]!==void 0){if(ee.nodeType==="root"||_[G]!==ee.open)throw new Je("404 pair '".concat(_[G],"' :").concat(te));let _e=Wn(R);qn({text:e,parent:ee,start:D,end:te,opt:i});let Pe=nc(ee,te,e);_e.nodes.push(Pe),R.push(_e),D=te+1}else R.push(ee)}if(J!==null)throw new Je("unclosed quote ".concat(J,' near "...').concat(e.substring(D-20,D+30),'..."'));let fe=Wn(R);if(fe.nodeType!=="root")throw new Je("404 pair '".concat(fe.open,"' :").concat(fe.pos.start));return qn({text:e,parent:fe,start:D,end:e.length,opt:i}),fe.nodes}function cs(e){return[...e].reduce((t,s)=>(t.quote?(s===t.quote&&(t.quote=void 0),t.a[t.a.length-1]+=s):s==="="?t.a[t.a.length-1].length?t.a.push("="):t.a[t.a.length-1]="=":s===" "?t.a[t.a.length-1]!=="="&&t.a[t.a.length-1].length&&t.a.push(""):(['"',"'","`"].includes(s)&&(t.quote=s),t.a[t.a.length-1]+=s),t),{a:[""]}).a}function ut(e,t="|",s=!1){let i=[...e].reduce((c,p)=>(c.quote?(p===c.quote&&(c.quote=void 0),c.a[c.a.length-1]+=p):p===t?c.a.push(""):(['"',"'","`"].includes(p)&&(c.quote=p),c.a[c.a.length-1]+=p),c),{a:[""]}).a;return s?i.filter(c=>c):i}function ls(e,t="|"){var s=e.lastIndexOf(t);return[e.substr(0,s),e.substr(s+1)]}function us(e){if(['"',"'"].includes(e[0])&&e[0]===e[e.length-1]){for(var t=1;t<e.length-1;){if(e[t]===e[0]&&e[t-1]!=="\\")return!1;t++}return!0}return!1}function oc(e){return e.filter(t=>t.opts&&t.opts.length).forEach(t=>{t.opts2={};let s=t.opts.find(_=>_.type==="loop");if(s){let _=s.key;t.opts2.key=new Function("return ".concat(_))();let x=s.value.split(" as ");if(!x[1])throw"Alias for the loop not defined";let $=x[1].split(",");t.opts2.loop_fn=x[0].trim(),t.opts2.loop_alias=$[0].trim(),$[1]&&(t.opts2.loop_key_alias=$[1].trim())}let i=t.opts.find(_=>_.type==="text");i&&(us(i.value)?t.opts2.text=i.value.substring(1,i.value.length-1):t.opts2.textFn=i.value);let c=t.opts.find(_=>_.type==="html");c&&(us(c.value)?t.opts2.html=c.value.substring(1,c.value.length-1):t.opts2.htmlFn=c.value),["if","style","attrs","enterStyles","updateStyles","exitStyles","enterAttrs","updateAttrs","exitAttrs"].forEach(_=>{let x=t.opts.find($=>$.type===_);x&&(t.opts2[_]=x.value)}),t.opts.filter(_=>_.type==="eventCallback").forEach(_=>{t.opts2.events||(t.opts2.events={});let x=_.key.substr(1);if(t.opts2.events[x])throw'ui.js compile error: Duplicate event name "'.concat(x,'"');_.value[0]==="("&&console.warn('"'.concat(_.key,'(" is deprecated. Use "').concat(_.key,'{" inside "').concat(t.content.length>40?t.content.substring(0,40)+"...":t.content,'" declaration')),_.value=_.value[0]==="("?_.value.substring(1,_.value.length-1).trim():_.value.trim(),_.value[0]==="{"?_.value=_.value.substring(0,_.value.length-1)+";this.render()}":_.value="("+_.value+")==this.render()",t.opts2.events[x]=_.value}),t.opts.filter(_=>_.type==="eventBind"||_.type==="eventBindSelfNamed").forEach(_=>{t.opts2.events||(t.opts2.events={});let x=_.key.substr(1);if(t.opts2.events[x])throw'ui.js compile error: Duplicate event name "'.concat(x,'"');t.opts2.events[x]=new Function("return (...args) => this.".concat(_.value,"(...args)"))()}),t.opts.filter(_=>_.type==="eventCallFunction").forEach(_=>{t.opts2.events||(t.opts2.events={});let x=_.key.substr(1);if(t.opts2.events[x])throw'ui.js compile error: Duplicate event name "'.concat(x,'"');t.opts2.events[x]="".concat(_.value).concat(_.args)})}),e.filter(t=>t.opts&&t.opts.length).forEach(t=>{t.opts2||(t.opts2={}),t.opts2.attrs2||(t.opts2.attrs2={},t.opts2.attrsB={},t.opts2.attrsR={}),t.opts.filter(p=>p.type==="booleanAttribute").forEach(p=>{t.opts2.attrs2[p.key]&&console.warn('ui.js compile warning: direct attibute "'.concat(p.key,'" override attrs({...').concat(p.key,'...}) declaration in tag ""!')),t.opts2.attrs2[p.key]=p.key,t.opts2.attrsB[p.key]=!0}),t.opts.filter(p=>p.type==="stringAttribute").forEach(p=>{t.opts2.attrs2[p.key]&&console.warn('ui.js compile warning: direct attibute "'.concat(p.key,'" override attrs({...').concat(p.key,'...}) declaration in tag ""!')),t.opts2.attrs2[p.key]=p.value}),t.opts.filter(p=>p.type==="jsAttribute").forEach(p=>{if(p.key[0]==="%"){var m=p.key.substr(1);t.opts2.attrsR[m]=p.value}else var m=p.key;t.opts2.attrs2[m]&&console.warn('ui.js compile warning: direct attibute "'.concat(m,'" override attrs({...').concat(m,'...}) declaration in tag ""!')),t.opts2.attrs2[m]=p.value.endsWith("%")?p.value:p})}),e.forEach(t=>{t.opts2&&t.opts2.attrs2&&!Object.keys(t.opts2.attrs2).length&&(delete t.opts2.attrs2,delete t.opts2.attrsB),t.opts2&&t.opts2.events&&!Object.keys(t.opts2.events).length&&delete t.opts2.events}),e}function Fe({AAA:e,item:t,tag:s,a:i},c="enter",p="enterStyles"){if(i===c&&e.length){let m=e.shift().content;if(m[0]==="("){if(t.opts.find(g=>g.type===c))throw"ui.js template parse error: duplicate ".concat(c,'() inside "<').concat(s,'>" declaration');t.opts.push({type:p,value:m.slice(1,-1)})}else if(m[0]==="{"){if(c==="if")throw'ui.js template parse error: expected "if(..." but "if'.concat(m[0],'..." found inside "<').concat(s,'>"');if(t.opts.find(g=>g.type===c))throw"ui.js template parse error: duplicate ".concat(c,'() inside "<').concat(s,'>" declaration');t.opts.push({type:p,value:m.slice(1,-1)})}else throw'ui.js template parse error: expected "'.concat(c,'{..." but "').concat(c).concat(m[0],'..." found inside "<').concat(s,'>"');return!0}return!1}function ps(e){return e.filter(t=>t.nodeType==="bracket"&&t.innerContent[0]!=="/").forEach(t=>{t.opts=[];let s=lt(t.innerContent).map(c=>({nodeType:c.nodeType,content:c.content.trim()}));var i="";do{let c=s.shift();if(c.nodeType==="bracket")if(t.opts.length){let p=t.opts[t.opts.length-1];if(p.type==="jsAttribute")p.value+=c.content;else throw'ui.js template parse error: unxpected brackets "'.concat(c.content,'" at the end of <').concat(i,"> attributes")}else throw'ui.js template parse error: unxpected brackets "'.concat(c.content,'" at the end of <').concat(i,"> attributes");else if(c.nodeType==="text"){let p=cs(c.content);i||(i=p.shift());do{let m=p.shift();if(p[0]&&p[0][0]==="="){let g=p.shift().substr(1);if(m[0]==="@"){if(['"',"'","`"].includes(g[0]))throw"ui.js template parse error: quotes around ".concat(g," is prohibited");if(s.length&&s[0].nodeType==="bracket"&&!p.length){let _=s.shift();t.opts.push({type:"eventCallFunction",key:m,value:g,args:_.content})}else t.opts.push({type:"eventBind",key:m,value:g.endsWith("/")?g.substring(0,g.length-1):g})}else if(g.startsWith('"')&&g.endsWith('"')||g.startsWith("`")&&g.endsWith("`")||g.startsWith("'")&&g.endsWith("'"))t.opts.push({type:"stringAttribute",key:m,value:g.slice(1,-1)});else if(g.length){let _=g.endsWith("/")?g.substring(0,g.length-1):g;_.startsWith('"')&&_.endsWith('"')||_.startsWith("`")&&_.endsWith("`")||_.startsWith("'")&&_.endsWith("'")?t.opts.push({type:"stringAttribute",key:m,value:_.slice(1,-1)}):t.opts.push({type:"jsAttribute",key:m,value:_})}else{if(!s.length)throw'ui.js template parse error: unxpected end of attribute "...'.concat(m,'=" inside "<').concat(i,'>" declaration');let _=s.shift().content;_[0]==="{"?t.opts.push({type:"eueAttribute",key:m,value:_}):_[0]==="["?t.opts.push({type:"transitionAttribute",key:m,value:_}):t.opts.push({type:"jsAttribute",key:m,value:_.substring(1,_.length-1)})}}else if(m==="loop"&&s.length){let g=s.shift().content;if(g[0]==="("){if(t.opts.find($=>$.type==="loop"))throw"ui.js template parse error: duplicate loop".concat(g,' inside "<').concat(i,'>" declaration');let[_,x]=ls(g.slice(1,-1));if(x)t.opts.push({type:"loop",key:x,value:_});else throw'ui.js template parse error: non-keyed loop not supported yet. "loop'.concat(g,'" inside "<').concat(i,'>"')}else throw'ui.js template parse error: expected "loop(..." but "loop'.concat(g[0],'..." found inside "<').concat(i,'>" ')}else if(!Fe({AAA:s,item:t,tag:i,a:m},"if","if")){if(!Fe({AAA:s,item:t,tag:i,a:m},"style","style")){if(!Fe({AAA:s,item:t,tag:i,a:m},"attrs","attrs")){if(!Fe({AAA:s,item:t,tag:i,a:m},"enter","enterStyles")){if(!Fe({AAA:s,item:t,tag:i,a:m},"update","updateStyles")){if(!Fe({AAA:s,item:t,tag:i,a:m},"exit","exitStyles")){if(!Fe({AAA:s,item:t,tag:i,a:m},"#enter","enterAttrs")){if(!Fe({AAA:s,item:t,tag:i,a:m},"#update","updateAttrs")){if(!Fe({AAA:s,item:t,tag:i,a:m},"#exit","exitAttrs")){if(m==="text"&&s.length){let g=s.shift().content;if(g[0]==="("){if(t.opts.find(_=>_.type==="text"))throw'ui.js template parse error: duplicate text{c} inside "<'.concat(i,'>" declaration');t.opts.push({type:"text",value:g.slice(1,-1)})}else throw'ui.js template parse error: expected "text(..." but "text{c[0]}..." found inside "<'.concat(i,'>"')}else if(m==="html"&&s.length){let g=s.shift().content;if(g[0]==="("){if(t.opts.find(_=>_.type==="html"))throw'ui.js template parse error: duplicate html{c} inside "<'.concat(i,'>" declaration');t.opts.push({type:"html",value:g.slice(1,-1)})}else throw'ui.js template parse error: expected "html(..." but "html{c[0]}..." found inside "<'.concat(i,'>"')}else if(m)if(m[0]==="@")if(!p.length&&s[0]&&s[0].nodeType==="bracket"){let g=s.shift();t.opts.push({type:"eventCallback",key:m,value:g.content})}else m.endsWith("/")?t.opts.push({type:"eventBindSelfNamed",key:m.trim().slice(0,-1),value:m.trim().slice(1,-1)}):t.opts.push({type:"eventBindSelfNamed",key:m.trim(),value:m.trim().slice(1)});else{if(m==="=")throw'ui.js template parse error: unxpected end of attribute "'.concat(m,'" inside "<').concat(i,'>" declaration');m!=="/"&&t.opts.push({type:"booleanAttribute",key:m.endsWith("/")?m.slice(0,-1):m})}}}}}}}}}}}while(p.length)}}while(s.length)}),oc(e)}var Vn={"!DOCTYPE":!0,"!doctype":!0,area:!0,base:!0,br:!0,col:!0,command:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,menuitem:!0,param:!0,source:!0,track:!0,wbr:!0,circle:!0,ellipse:!0,line:!0,path:!0,polygon:!0,polyline:!0,rect:!0,stop:!0,use:!0};function Jn(e,t=[]){if(!t.length)return e;if(e[0]=="@"){if(e.length===1)throw"empty alias tag <@>";let s=t.find(i=>i.alias===e);if(s)e=s.name;else throw"alias <".concat(e,"> not defined")}return e}function Hn(e,t){let s=t.find(i=>i.name===e);return s?s.alias:e}function ic(e,t,s=!1){let i=[{children:[]}];if(i.last=()=>i[i.length-1],e.forEach(c=>{if(c.nodeType==="text"){var p=i[i.length-1];if(p.text)throw"children and text() attribute at the same time";p.children.push({tag:"#text",content:c.content})}else{var m=c.content.match(new RegExp("^<(@?[a-z][-a-z0-9]*)(\\s.*)?\\/>$","s"));if(m){var p=i[i.length-1];if(p.text)throw"children and text() attribute at the same time";p.children.push(Object.assign({tag:Jn(m[1],t)},c.opts2))}else{var g=c.content.match(new RegExp("^<(@?[a-z][-a-z0-9]*)(\\s.*)?>$","s"));if(g)if(!s&&Vn[g[1]]){let x=i[i.length-1];if(x.text)throw"children and text() attribute at the same time";x.children.push(Object.assign({tag:Jn(g[1],t)},c.opts2))}else i.push(Object.assign({tag:Jn(g[1],t),children:[]},c.opts2));else{var _=c.content.match(new RegExp("^<\\/(@?[a-z][-a-z0-9]*)(\\s.*)?>$","s"));if(_){if(!s&&Vn[_[1]])throw"can't close self-closing tag \"</".concat(_[1],'>"');let x=i[i.length-2],$=i.pop();if($.children.length===1&&$.children[0].tag==="#text"?($.text=$.children[0].content,delete $.children):$.children.length||delete $.children,x){if(x.text)throw"children and text() attribute at the same time";let R=Hn($.tag,t),D=Hn(_[1],t);if(R!==D)throw"the opening and closing tags are not the same <".concat(R,">...</").concat(D,">");x.children.push($)}else throw!$.children||$.children[0].tag!==_[1]?"missing the opening tag for </".concat(_[1],">"):"closed twice tag <".concat($.children[0].tag,">")}}}}}),i.length>1){let c=i.find(p=>p.tag);throw"Unclosed tag <".concat(Hn(c.tag,t),">")}return i[0].children}var fs=ic;var pt={};pt.animate=function(e,t,s,i,c,p,m){if(typeof e!="number"||typeof t!="number"||typeof s!="number"||typeof i!="function")return;typeof c=="string"&&H[c]&&(c=H[c]),typeof c!="function"&&(c=H.linear),typeof p!="function"&&(p=function(){});var g=window.requestAnimationFrame||function(D){window.setTimeout(D,1e3/60)},_=!1,x=t-e;function $(D){if(!_){var J=(D||+new Date)-R;J>=0&&i(c(J,e,x,s)),J>=0&&J>=s?(i(t),p(m,t)):g($)}}if(i(e),x){var R=window.performance&&window.performance.now?window.performance.now():+new Date;g($)}return{update:function(D,J,L){R=window.performance&&window.performance.now?window.performance.now():+new Date,e=D,t=J,x=t-e,typeof L=="string"&&H[L]&&(c=H[L])},cancel:function(){_=!0},last:t}};pt.animateCSS=function(e,t,s,i,c,p,m,g){var _=function(x){e.style[t]=x+s};return pt.animate(i,c,p,_,m,g)};pt.cancel=function(e){e&&e.cancel()};var H=pt.easings={};H.linear=function(e,t,s,i){return s*e/i+t};H.easeInQuad=function(e,t,s,i){return s*(e/=i)*e+t};H.easeOutQuad=function(e,t,s,i){return-s*(e/=i)*(e-2)+t};H.easeInOutQuad=function(e,t,s,i){return(e/=i/2)<1?s/2*e*e+t:-s/2*(--e*(e-2)-1)+t};H.easeInCubic=function(e,t,s,i){return s*(e/=i)*e*e+t};H.easeOutCubic=function(e,t,s,i){return s*((e=e/i-1)*e*e+1)+t};H.easeInOutCubic=function(e,t,s,i){return(e/=i/2)<1?s/2*e*e*e+t:s/2*((e-=2)*e*e+2)+t};H.easeInQuart=function(e,t,s,i){return s*(e/=i)*e*e*e+t};H.easeOutQuart=function(e,t,s,i){return-s*((e=e/i-1)*e*e*e-1)+t};H.easeInOutQuart=function(e,t,s,i){return(e/=i/2)<1?s/2*e*e*e*e+t:-s/2*((e-=2)*e*e*e-2)+t};H.easeInQuint=function(e,t,s,i){return s*(e/=i)*e*e*e*e+t};H.easeOutQuint=function(e,t,s,i){return s*((e=e/i-1)*e*e*e*e+1)+t};H.easeInOutQuint=function(e,t,s,i){return(e/=i/2)<1?s/2*e*e*e*e*e+t:s/2*((e-=2)*e*e*e*e+2)+t};H.easeInSine=function(e,t,s,i){return-s*Math.cos(e/i*(Math.PI/2))+s+t};H.easeOutSine=function(e,t,s,i){return s*Math.sin(e/i*(Math.PI/2))+t};H.easeInOutSine=function(e,t,s,i){return-s/2*(Math.cos(Math.PI*e/i)-1)+t};H.easeInExpo=function(e,t,s,i){return e==0?t:s*Math.pow(2,10*(e/i-1))+t};H.easeOutExpo=function(e,t,s,i){return e==i?t+s:s*(-Math.pow(2,-10*e/i)+1)+t};H.easeInOutExpo=function(e,t,s,i){return e==0?t:e==i?t+s:(e/=i/2)<1?s/2*Math.pow(2,10*(e-1))+t:s/2*(-Math.pow(2,-10*--e)+2)+t};H.easeInCirc=function(e,t,s,i){return-s*(Math.sqrt(1-(e/=i)*e)-1)+t};H.easeOutCirc=function(e,t,s,i){return s*Math.sqrt(1-(e=e/i-1)*e)+t};H.easeInOutCirc=function(e,t,s,i){return(e/=i/2)<1?-s/2*(Math.sqrt(1-e*e)-1)+t:s/2*(Math.sqrt(1-(e-=2)*e)+1)+t};H.easeInElastic=function(e,t,s,i){var c=0,p=s;if(e==0)return t;if((e/=i)==1)return t+s;if(c||(c=i*.3),p<Math.abs(s)){p=s;var m=c/4}else var m=c/(2*Math.PI)*Math.asin(s/p);return-(p*Math.pow(2,10*(e-=1))*Math.sin((e*i-m)*(2*Math.PI)/c))+t};H.easeOutElastic=function(e,t,s,i){var c=0,p=s;if(e==0)return t;if((e/=i)==1)return t+s;if(c||(c=i*.3),p<Math.abs(s)){p=s;var m=c/4}else var m=c/(2*Math.PI)*Math.asin(s/p);return p*Math.pow(2,-10*e)*Math.sin((e*i-m)*(2*Math.PI)/c)+s+t};H.easeInOutElastic=function(e,t,s,i){var c=0,p=s;if(e==0)return t;if((e/=i/2)==2)return t+s;if(c||(c=i*(.3*1.5)),p<Math.abs(s)){p=s;var m=c/4}else var m=c/(2*Math.PI)*Math.asin(s/p);return e<1?-.5*(p*Math.pow(2,10*(e-=1))*Math.sin((e*i-m)*(2*Math.PI)/c))+t:p*Math.pow(2,-10*(e-=1))*Math.sin((e*i-m)*(2*Math.PI)/c)*.5+s+t};H.easeInBack=function(e,t,s,i,c){return c==null&&(c=1.70158),s*(e/=i)*e*((c+1)*e-c)+t};H.easeOutBack=function(e,t,s,i,c){return c==null&&(c=1.70158),s*((e=e/i-1)*e*((c+1)*e+c)+1)+t};H.easeInOutBack=function(e,t,s,i,c){return c==null&&(c=1.70158),(e/=i/2)<1?s/2*(e*e*(((c*=1.525)+1)*e-c))+t:s/2*((e-=2)*e*(((c*=1.525)+1)*e+c)+2)+t};H.easeInBounce=function(e,t,s,i){return s-H.easeOutBounce(i-e,0,s,i)+t};H.easeOutBounce=function(e,t,s,i){return(e/=i)<1/2.75?s*(7.5625*e*e)+t:e<2/2.75?s*(7.5625*(e-=1.5/2.75)*e+.75)+t:e<2.5/2.75?s*(7.5625*(e-=2.25/2.75)*e+.9375)+t:s*(7.5625*(e-=2.625/2.75)*e+.984375)+t};H.easeInOutBounce=function(e,t,s,i){return e<i/2?H.easeInBounce(e*2,0,s,i)*.5+t:H.easeOutBounce(e*2-i,0,s,i)*.5+s*.5+t};var Se=pt;var ac={},Le=ac;var Ne={duration:500};function Qn(e,t,s){var i=e[t];if(t<s)for(;t<s;t++)e[t]=e[t+1];else for(;t>s;t--)e[t]=e[t-1];e[s]=i}function ft(e,t){if(typeof Le[e.tag]=="function")var s=new Le[e.tag](t,e);else if(e.svg)var s=document.createElementNS("http://www.w3.org/2000/svg",e.tag);else var s=document.createElement(e.tag);return Object.assign(s,{_attrs:{},_styles:{},_attrsV:{},_styleV:{},_colors:{},_events:{}}),s}function ms(e,t,s){t._BASE_ELEMENT?s?e._childNodes.splice(e._childNodes.findIndex(i=>i===s)+1,0,t):e._childNodes.unshift(t):s?s.after(t):e.prepend(t)}function mt(e,t){t._BASE_ELEMENT?e._childNodes.unshift(t):e.prepend(t)}function ht(e,t,s){var R;var i=void 0,c="linear",p=void 0,m=void 0,g=void 0;if(typeof s=="object"){var _=s.duration||Ne.duration,x=s.to;s.ease&&(c=s.ease),s.fn&&(p=s.fn),s.done&&(m=s.done),s.from!==void 0&&(i=s.from),s.default!==void 0&&(g=s.default)}else var _=Ne.duration,x=s;if(i===void 0){var $=e.__rendererName?e.state[t]:e.getAttribute(t);i=$==null?g||0:Number($)}Se.cancel(e._attrs[t]),p?(i=((R=e._attrs[t])==null?void 0:R.last)||0,e._attrs[t]=Se.animate(i,x,_,D=>{e.setAttribute(t,p(D))},c,m,e)):e._attrs[t]=Se.animate(i,x,_,D=>{e.setAttribute(t,D)},c,m,e)}function cc(e,t,s){var i="linear",c=0;if(typeof s=="object"){var p=s.duration||Ne.duration,m=s.to;s.ease&&(i=s.ease),s.delay&&(c=s.delay)}else var p=Ne.duration,m=s;e._colors[t]=t+" "+p+"ms "+i+" "+c+"ms",clearTimeout(e._styles[t]),e._styles[t]=setTimeout(()=>{delete e._colors[t];var _=Object.values(e._colors).join(",");e._transition!=_&&(e._transition=_,e._transition?e.style.setProperty("transition",e._transition):e.style.removeProperty("transition"))},p+c);var g=Object.values(e._colors).join(",");e._transition!=g&&(e._transition=g,e._transition?e.style.setProperty("transition",e._transition):e.style.removeProperty("transition")),e.style.getPropertyValue(t)||e.style.setProperty(t,"#000000"),e.style.setProperty(t,getComputedStyle(e)[t]),setTimeout(()=>{e.style.setProperty(t,m)},0)}function Qt(e,t,s){if(["color","background","fill","stroke","background-color","border-color"].includes(t)){cc(e,t,s);return}var i="linear",c=void 0,p=void 0,m=0,g="",_=void 0,x=void 0;if(typeof s=="object"){if(typeof s.duration=="function"&&(s.duration=s.duration()),s.duration===0&&s.to){Se.cancel(e._styles[t]),e.style.setProperty(t,s.to);return}var $=s.duration||Ne.duration,R=s.to;s.from!==void 0&&(p=s.from),s.default!==void 0&&(x=s.default),s.ease&&(i=s.ease),s.done&&(c=s.done),s.threshold!==void 0&&(m=s.threshold),s.fn&&(_=s.fn)}else var $=Ne.duration,R=s;var D=t.startsWith("--"),J=D?e.style.getPropertyValue(t):e.style[t];if(!J&&x&&(J=x),typeof R=="string"?["px","%","deg","vw","vh","em"].some(L=>{if(R.endsWith(L))return p!==void 0?p.endsWith(L)&&(p=Number(p.substring(0,p.length-L.length))):p=Number(J.substring(0,J.length-L.length)),R=Number(R.substring(0,R.length-L.length)),g=L,!0})||(R=Number(R)):p===void 0&&(p=Number(J)),m&&Math.abs(p-R)<m){Se.cancel(e._styles[t]),e.style.setProperty(t,s.to);return}Se.cancel(e._styles[t]),_?e._styles[t]=Se.animate(p,R,$,L=>{e.style.setProperty(t,_(L+g))},i,c,e):e._styles[t]=Se.animate(p,R,$,L=>{e.style.setProperty(t,L+g)},i,c,e)}function hs(e,t,s,i,c){return typeof c!="object"?(e.setAttribute(i,c),Ne.duration):(ht(e,i,c),c.duration?c.duration:Ne.duration)}function ds(e,t,s,i,c){return Qt(e,i,c),c.duration?c.duration:Ne.duration}function ys(e,t,s,i,c,p){var m=0,g=0;if(t.exitAttrs){var _=t.exitAttrs(s);typeof _=="object"&&(g=Object.entries(_).reduce(($,R)=>Math.max(hs(e,t,s,R[0],R[1]),$),0))}if(t.exitStyles){var x=t.exitStyles(s);typeof x=="object"&&(m=Object.entries(x).reduce(($,R)=>Math.max(ds(e,t,s,R[0],R[1]),$),0))}if(e.isExit=!0,m>0||g>0){let $=setTimeout(()=>p.Done.then(()=>{xt(e),c.exit.delete(i)}),m>g?m:g);c.exit.set(i,{element:e,timeout:$});return}clearTimeout(c.exit[i]),xt(e)}function _s(e,t,s,i,c){var p=0,m=0;if(t.exitAttrs){var g=t.exitAttrs(s);typeof g=="object"&&(m=Object.entries(g).reduce((x,$)=>Math.max(hs(e,t,s,$[0],$[1]),x),0))}if(t.exitStyles){var _=t.exitStyles(s);typeof _=="object"&&(p=Object.entries(_).reduce((x,$)=>Math.max(ds(e,t,s,$[0],$[1]),x),0))}if(e.isExit=!0,p>0||m>0){let x=setTimeout(()=>i.Done.then(()=>{i.__i__[c]=!1,xt(e)}),p>m?p:m);return i.__i__[c]={exit:x},!1}return clearTimeout(i.__i__[c]),i.__i__[c]=!1,xt(e),!0}async function xt(e){if(e.nodeName==="#text"){console.log("TEXT");return}if(e.__i__)for(let s of Object.values(e.__i__))clearTimeout(s.exit);for(let s of Object.values(e._attrs))s!=null&&s.cancel&&s.cancel();for(let s of Object.values(e._styles))s!=null&&s.cancel&&s.cancel();let t=e.__rendererName?e.document._childNodes:e.children;for(;t.length;){let s=t[t.length-1];await xt(s)}await e.remove()}function At(e,t,s,i,c,p,m){var g=c.keys,_=c.elements,x=c.exit,$=_.length,R=m.length,D=$>R?$:R,J=0,L=0,fe=0;do{if(L<R){var te=e.key(m[L],L);if(L>=$){$++,D=$>R?$:R;var ee=x.get(te);if(ee){clearTimeout(ee.timeout);var G=ee.element;delete G.isExit,e.svg||(G.className=""),x.delete(te)}else var G=ft(e,t);if(i[e.loop_alias]=m[L],e.loop_key_alias&&(i[e.loop_key_alias]=L),wt(G,e,i,ye,ee),L===0)if(x.size)for(let De of x){De[1].element.before(G);break}else s?s.after(G):mt(t,G);else _[L-1].after(G);_.splice(L,0,G),G.key=te,g[te]=!0,L++;continue}else{var y=_[L].key;if(te===y){i[e.loop_alias]=m[L],e.loop_key_alias&&(i[e.loop_key_alias]=L),e.Update_Tag(_[L],e,i,ye),L++;continue}else if(g[te]){var _e=void 0,Pe=void 0;let De;for(var Ke=void 0,be=L+1;be<D;be++)if(!_e&&be<$&&_[be].key===te&&(_e=be+1),!Pe&&be<R&&e.key(m[be],be)===y&&(Pe=be+1),_e&&Pe){var Ie=_[L];if(_e>=Pe)De=_[_e-1],t.insertBefore(De,Ie),i[e.loop_alias]=m[L],e.loop_key_alias&&(i[e.loop_key_alias]=L),e.Update_Tag(De,e,i,ye),_e===Pe?(be-L>1&&(_e>=_.length?_[be-1].after(Ie):t.insertBefore(Ie,_[_e])),_[L]=_[be],_[be]=Ie):(Qn(_,_e-1,L),J++),L++;else{De=!0;var Xe=Pe-1+J;if(Xe>=_.length)_[_.length-2].after(Ie);else{if(!_[Xe])throw 9999999999;t.insertBefore(Ie,_[Xe])}Qn(_,L,(Xe>$?$:Xe)-1),i[e.loop_alias]=m[L],e.loop_key_alias&&(i[e.loop_key_alias]=L),e.Update_Tag(Ie,e,i,ye)}break}if(De)continue}else{$++,D=$>R?$:R;var ee=x.get(te);if(ee)clearTimeout(ee.timeout),G=ee.element,delete G.isExit,e.svg||(G.className=""),x.delete(te);else var G=ft(e,t);i[e.loop_alias]=m[L],e.loop_key_alias&&(i[e.loop_key_alias]=L),wt(G,e,i,ye,ee),L===0?s?s.after(G):mt(t,G):_[L-1].after(G),_.splice(L,0,G),G.key=te,g[te]=!0,L++;continue}}}delete g[_[L].key],e.loop_key_alias&&(i[e.loop_key_alias]=L+fe,fe++),ys(_[L],e,i,_[L].key,c,t),_.splice(L,1),$--,D=$>R?$:R}while(L<D);return c.length=_.length,x.size+c.length}function lc(){return{ret_element:function(e,t,s,i){return e},children:function(e,t,s,i){i.UPDATE_Chidldren(e,t.children,s)},fn_text:function(e,t,s,i){var c=t.text(s);if(!e){console.log("NOT element.__lastText",e),console.trace();return}e.__lastText!==c&&(e.textContent=e.__lastText=c)},fn_html:function(e,t,s,i){var c=t.html(s);e.__lastHTML!==c&&(e.innerHTML=e.__lastHTML=c)},updateProps:function(e,t,s,i){t.updateProps(e,t,s,i)}}}function Kt(e){var t=[],s=lc();return e.tag==="#text"?(t.push(s.ret_element),t):(e.children?t.push(s.children):e.html?typeof e.html=="function"&&t.push(s.fn_html):e.text&&typeof e.text=="function"&&t.push(s.fn_text),e.updateProps&&(t=[...t,...e.updateProps]),t.push(s.ret_element),t)}function uc(e,t,s,i,c,p){return t.Update_Tag(e.__rendererName?e._childNodes[c]:e.childNodes[c],t,s,ye),c+1}function pc(e,t,s,i,c,p){let m=t.loop(s);if(!p||p.length===0){if(!p||p.exit.size===0)return m.length?i===0?(t.enter(t,e,void 0,s,i,m,ye),c+e.__i__[i].length):(t.enter(t,e,c===0?void 0:e.__rendererName?e._childNodes[c-1]:e.childNodes[c-1],s,i,m,ye),c+e.__i__[i].length):c;if(m.length){let g=At(t,e,i===0||c===0?void 0:e.__rendererName?e._childNodes[c]:e.childNodes[c],s,p,i,m);return c+g}else return c+p.exit.size}else if(m.length){let g=At(t,e,i===0||c===0?void 0:e.__rendererName?e._childNodes[c-1]:e.childNodes[c-1],s,p,i,m);return c+g}else{let g=At(t,e,i===0||c===0?void 0:e.__rendererName?e._childNodes[c]:e.childNodes[c],s,p,i,m);return c+g}}function fc(e,t,s,i,c,p){if(p===!1)if(t.if(s)){let _=ft(t,e);if(t.children)Ue(_,t.children,s);else if(t.text){var m=typeof t.text=="function"?t.text(s):t.text;_.__lastText!==m&&(_.textContent=_.__lastText=m)}else if(t.html){var g=typeof t.html=="function"?t.html(s):t.html;_.__lastHTML!==g&&(_.innerHTML=_.__lastHTML=g)}return t.enterProps&&t.enterProps(_,t,s,ye),c===0?mt(e,_):e.__rendererName?e._childNodes[c-1].after(_):e.childNodes[c-1].after(_),e.__i__[i]={exit:!1},c+1}else return c;else{if(t.if(s))return p.exit?(clearTimeout(p.exit),t.enterProps&&t.enterProps(e.__rendererName?e._childNodes[c]:e.childNodes[c],t,s,ye),e.__i__[i]={exit:!1},c+1):(t.Update_Tag(e.__rendererName?e._childNodes[c]:e.childNodes[c],t,s,ye),c+1);if(p.exit)return c+1;{let _=e.__rendererName?e._childNodes:e.childNodes;return _s(_[c],t,s,e,i)?c:c+1}}}function mc(e,t,s,i,c,p){if(p===!1||p.length===0)if(t.if(s)){let m=t.loop(s);return m.length?i===0?(t.enter(t,e,void 0,s,i,m,ye),c+e.__i__[i].length):(t.enter(t,e,c===0?void 0:e.__rendererName?e._childNodes[c-1]:e.childNodes[c-1],s,i,m,ye),c+e.__i__[i].length):c}else return c;else if(t.if(s)){let m=t.loop(s),g=At(t,e,i===0&&c===0?void 0:e.__rendererName||e.__rendererName?e._childNodes[c]:e.childNodes[c],s,p,i,m);return c+g}else{if(p.length===0)return c+p.exit.size;{let m=At(t,e,i===0&&c===0?void 0:e.__rendererName?e._childNodes[c]:e.childNodes[c],s,p,i,[]);return c+m}}}function Xt(e,t,s){if(!e.isExit){var i=void 0;e.Done=new Promise(p=>i=p);var c=0;t.every((p,m)=>{if(!e.__i__)return console.groupCollapsed("Not initialized element!!! "+p.tag),console.dir(e),console.log("component",t),console.log("tag",p),console.trace(),console.groupEnd(),!1;let g=e.__i__[m];return p.tag==="#text"?(c++,!0):(p.hasOwnProperty("if")?p.loop?c=mc(e,p,s,m,c,g):c=fc(e,p,s,m,c,g):p.loop?c=pc(e,p,s,m,c,g):c=uc(e,p,s,m,c,g),!0)}),i()}}function Ct(e,t){if(e==="input"){if(["checked","autofocus","readonly","required","disabled","multiple"].includes(t))return!0}else if(e==="option"){if(["selected"].includes(t))return!0}else if(e==="button"){if(["disabled","multiple"].includes(t))return!0}else if(e==="select"&&["disabled"].includes(t))return!0;return!1}function bs(e,t,s,i){var p,m;if(e.tag==="input"&&s==="value")t._attrsV[s]!==i&&(t._attrsV[s]=i,t.value!=i&&(t.value=i));else if(s==="class"){if(typeof i=="object"&&i!==null)throw"Cannot do transition on class attribute";var c=i||void 0;t._attrsV[s]!==c&&(t._attrsV[s]=c,c?e.svg?t.setAttribute(s,c):t.className=c:t.removeAttribute(s))}else if(s==="style"){if(typeof i=="object"&&i!==null)throw"Cannot do transition on style attribute";var c=i||void 0;t._attrsV[s]!==c&&(t._attrsV[s]=c,c?t.setAttribute(s,c):t.removeAttribute(s))}else(typeof i=="object"||t._attrsV[s]!==i||Array.isArray(i))&&(Ct(e.tag,s)?(t._attrsV[s]=i,e.tag==="input"&&e.attrs2.type==="radio"&&s==="checked"&&!e.attrsB[s]?e.attrs2.value?e.attrs2.value==i?(t.setAttribute(s,""),t[s]=s):(t.removeAttribute(s),t[s]=""):i?(t.setAttribute(s,""),t[s]=s):(t.removeAttribute(s),t[s]=""):i?t.setAttribute(s,"")||(t[s]=s):t.removeAttribute(s)||(t[s]="")):e.tag==="textarea"&&s==="value"?t.value=i:(!e.attrs3||!e.attrs3[s])&&typeof i=="object"?i!=null&&i.skip||t._attrsV[s]!==i.to&&(t._attrsV[s]=i.to,i!=null&&i.disabled?((p=t._attrs[s])!=null&&p.cancel&&t._attrs[s].cancel(),t.setAttribute(s,i.to)):ht(t,s,i)):t._attrsV[s]!==i&&(t._attrsV[s]=i,(m=t._attrs[s])!=null&&m.cancel&&t._attrs[s].cancel(),t.setAttribute(s,i)))}function hc(){return{updateAttrs:function(e,t,s,i){Object.entries(t.updateAttrs(s)).forEach(([c,p])=>{i.updateAttribute(t,e,c,p)})},attrs3:function(e,t,s,i){Object.entries(t.attrs3).forEach(([c,p])=>{i.updateAttribute(t,e,c,typeof p=="function"?p(s):p)})},updateStyles:function(e,t,s,i){Object.entries(t.updateStyles(s)).forEach(([c,p])=>{var m;typeof p=="object"?e._styleV[c]!==p.to&&(p!=null&&p.skip||(e._styleV[c]=p.to,p!=null&&p.disabled?((m=e._styles[c])!=null&&m.cancel&&e._styles[c].cancel(),e.style.setProperty(c,p.to)):i.animateCSS(e,c,p))):e._styleV[c]!==p&&(e._styleV[c]=p,e.style.setProperty(c,p))})},style:function(e,t,s,i){Object.entries(t.style(s)).forEach(([c,p])=>{e._styleV[c]!==p&&(e._styleV[c]=p,e.style.setProperty(c,p))})},events:function(e,t,s,i){e.__datum={...s}}}}function Zt(e){let t=[],s=hc();return e.updateAttrs&&t.push(s.updateAttrs),e.attrs3&&t.push(s.attrs3),e.style&&t.push(s.style),e.updateStyles&&t.push(s.updateStyles),e.events&&t.push(s.events),t}function gs(e,t,s,i){var p;if(s==="class"){var c=i||void 0;t._attrsV[s]=c,c&&(e.svg?t.setAttribute(s,c):t.className=c)}else if(s==="style"){var c=i||void 0;t._attrsV[s]=c,c&&t.setAttribute(s,c)}else s==="id"?(t._attrsV[s]=i,t.id=i,t.setAttribute(s,i)):Ct(e.tag,s)?e.tag==="input"&&e.attrs2.type==="radio"&&s==="checked"&&!e.attrsB[s]?e.attrs2.value?e.attrs2.value==i&&(t.setAttribute(s,""),t._attrsV[s]=i&&!0):i&&(t.setAttribute(s,""),t._attrsV[s]=i&&!0):(t._attrsV[s]=i&&!0,i&&t.setAttribute(s,"")):e.tag==="textarea"&&s==="value"?(t._attrsV[s]=i,t.innerHTML=i):((p=t._attrs[s])!=null&&p.cancel&&t._attrs[s].cancel(),t._attrsV[s]=i,t.setAttribute(s,i))}function dc(){return{enterAttrs:function(e,t,s,i){Object.entries(t.enterAttrs(s)).forEach(([c,p])=>{var m;if(Array.isArray(p))throw"not implemented";typeof p=="object"?(e._attrsV[c]=p,i.animateAttr(e,c,p)):((m=e._attrs[c])!=null&&m.cancel&&e._attrs[c].cancel(),i.enterAttribute(t,e,c,p))})},attrs:function(e,t,s,i){var c=t.attrs?t.attrs(s):{};t.attrs2&&Object.entries(t.attrs2).forEach(([p,m])=>{c[p]=typeof m=="function"?m(s):m}),Object.entries(c).forEach(([p,m])=>{i.enterAttribute(t,e,p,m)})},enterStyles:function(e,t,s,i){Object.entries(t.enterStyles(s)).forEach(([c,p])=>{var m;if(Array.isArray(p))throw"not implemented";typeof p=="object"?(e._styleV[c]=p.to,i.animateCSS(e,c,p)):(e._styleV[c]=p,(m=e._styles[c])!=null&&m.cancel&&e._styles[c].cancel(),e.style.setProperty(c,p))})},style:function(e,t,s,i){Object.entries(t.style(s)).forEach(([c,p])=>{e._styleV[c]=p,e.style.setProperty(c,p)})},events:function(e,t,s,i){e.__datum={...s},Object.entries(t.events).forEach(([c,p])=>{e._events[c]=m=>p(m,e.__datum,e),e.addEventListener(c,e._events[c])})}}}function en(e){let t=[],s=dc();return e.enterAttrs&&t.push(s.enterAttrs),(e.attrs||e.attrs2)&&t.push(s.attrs),e.style&&t.push(s.style),e.enterStyles&&t.push(s.enterStyles),e.events&&t.push(s.events),t}var yc={createElement:ft,insertElement:ms,prependElement:mt,Enter_Children:Ue,UPDATE_Chidldren:Xt,Update_Tag:Kt,animateAttr:ht,animateCSS:Qt,enterProps:en,enterAttribute:gs,updateProps:Zt,updateAttribute:bs},ye=yc;function vs(e){return(t,s,i,c,p,m,g)=>{var _={},x=new Map,$=[],R=i;return m.forEach((D,J)=>{var L=g.createElement(t,s);L.key=t.key(D,J),_[L.key]=!0,$.push(L),c[t.loop_alias]=D,t.loop_key_alias&&(c[t.loop_key_alias]=J),t.enterProps&&t.enterProps(L,t,c,g),t.children?g.Enter_Children(L,t.children,c):(t.text&&(typeof t.text=="function"?L.textContent=L.__lastText=t.text(c):L.textContent=L.__lastText=t.text),t.html&&(typeof t.html=="function"?L.innerHTML=L.__lastHTML=t.html(c):L.innerHTML=L.__lastHTML=t.html)),J===0&&!R?g.prependElement(s,L):R.after(L),R=L}),s.__i__[p]={length:m.length,exit:x,elements:$,keys:_},R}}function _c(e,t,s,i){e.__i__={},t.forEach((c,p)=>{if(c.if&&!c.if(s)){e.__i__[p]=!1;return}if(c.loop){if(c.loop(s).length)throw 123;e.__i__[p]=!1;return}else{let m=e.__rendererName?e._childNodes:e.children;wt(m[p],c,s,i,!0);return}})}function wt(e,t,s,i,c){return t.enterProps&&t.enterProps(e,t,s,i),t.children?c?_c(e,t.children,s,i):Ue(e,t.children,s):(t.text&&(typeof t.text=="function"?e.textContent=e.__lastText=t.text(s):e.textContent=e.__lastText=t.text),t.html&&(typeof t.html=="function"?e.innerHTML=e.__lastHTML=t.html(s):e.innerHTML=e.__lastHTML=t.html)),e}function Ts(e,t,s,i,c){return e.element=document.createTextNode(e.content),s?s.after(e.element):t.prepend(e.element),t.__i__[c]={exit:!1},e.element}function Ss(e){return(t,s,i,c,p,m,g)=>{var _=g.createElement(t,s);return t.enterProps&&t.enterProps(_,t,c,g),t.text&&(typeof t.text=="function"?_.textContent=_.__lastText=t.text(c):_.textContent=_.__lastText=t.text),t.html&&(typeof t.html=="function"?_.innerHTML=_.__lastHTML=t.html(c):_.innerHTML=_.__lastHTML=t.html),g.insertElement(s,_,i),s.__i__[p]={exit:!1},_}}function Es(e){return(t,s,i,c,p,m,g)=>{var _=g.createElement(t,s);return t.enterProps&&t.enterProps(_,t,c,g),g.insertElement(s,_,i),g.Enter_Children(_,t.children,c),s.__i__[p]={exit:!1},_}}function Ue(e,t,s){e.__i__={};var i;t.forEach((c,p)=>{if(c.if&&!c.if(s)){e.__i__[p]=!1;return}if(c.loop){let m=c.loop(s);if(m.length){i=c.enter(c,e,i,s,p,m,ye);return}else{e.__i__[p]=!1;return}}else{i=c.enter(c,e,i,s,p,void 0,ye);return}})}function xs(e){if(e.tag==="#text"){e.enter=Ts;return}e.enterProps=en(e),e.updateProps=Zt(e),e.Update_Tag=Kt(e),e.loop?e.enter=vs(e):e.enter=e.children?Es(e):Ss(e)}var bc=["svg","g","path","polygon","rect","circle","line","clipPath","cursor","defs","desc","ellipse","filter","font","glyph","image","text","textPath","animate","animateMotion","animateTransform"],tn=(e,t)=>new Function("return ({ ".concat(e.context.join(",")," }) => ").concat(e[t]))(),gc=(e,t)=>new Function("return ({ ".concat(e.context.join(",")," }) => ({").concat(e[t],"})"))(),nn=(e,t,s)=>new Function("return (event, { ".concat(e.context.join(",")," }, element) => {setTimeout(()=>this.render(),0);").concat(t," = event.target.").concat(s,"} "))(),vc=(e,t)=>new Function("return async (event, { ".concat(e.context.join(",")," }, element) => ").concat(t))(),Tc=(e,t)=>new Function("return ({ ".concat(e.context.join(",")," }) => ").concat(t.value+(t.args||"")))();function Kn(e,t,s){return e.forEach((i,c)=>{bc.includes(i.tag)&&(i.svg=!0),i.context=[...t],i.loop_alias&&(i.loop=tn(i,"loop_fn"),i.context.push(i.loop_alias),i.loop_key_alias&&i.context.push(i.loop_key_alias)),i.textFn&&(i.text=tn(i,"textFn"),delete i.textFn),i.htmlFn&&(i.html=tn(i,"htmlFn"),delete i.htmlFn),i.if&&(i.if=tn(i,"if")),["style","attrs","enterStyles","updateStyles","exitStyles","enterAttrs","updateAttrs","exitAttrs"].forEach(p=>{i[p]&&(i[p]=gc(i,p))}),i.events&&Object.entries(i.events).forEach(([p,m])=>{typeof m=="string"&&(i.events[p]=vc(i,m))}),i.attrsR&&Object.keys(i.attrsR).length&&Object.entries(i.attrsR).forEach(([p,m])=>{if(i.events||(i.events={}),i.events.input)throw"@input and reactive attr at the same time";i.tag==="input"?p==="value"?i.events.input=nn(i,m,"value"):p==="checked"&&(i.attrs2.type==="checkbox"?i.events.input=nn(i,m,"checked"):i.attrs2.type==="radio"&&(i.events.input=nn(i,m,"value"))):i.tag==="textarea"&&p==="value"&&(i.events.input=nn(i,m,"value"))}),i.attrs2&&(Object.keys(i.attrs2).length&&(i.attrs3={}),Object.entries(i.attrs2).forEach(([p,m])=>{typeof m=="object"&&m.type==="jsAttribute"&&(i.attrs3[p]=i.attrs2[p]=Tc(i,m))}),Object.keys(i.attrs3).length||delete i.attrs3),xs(i),i.children&&Kn(i.children,i.context,s)}),e}function Sc(e){return e.filter(t=>{if(t.nodeType==="bracket"){let s=t.innerContent.split(" ").join("");if(["","/","@","@/","/@"].includes(s))throw"Empty tag <".concat(s,">")}return!(t.nodeType==="text"&&!t.content.trim().length)})}function Ec(e=""){return Sc(lt(e,{skip:!0,pairs:["<>","{}","()","[]"]}))}function As(e,t=[],s=!1,i=!1){return Kn(fs(ps(Ec(e)),t,i),["state"],s)}var xc="static|template|state|class|style|walt";function Ac(e){return e.split(/\r\n|\n|\r/)}function wc(e,t){let s=e.match(new RegExp("^\\s*<!(".concat(t,")>\\s*$"),"i"));return s?s[1]:null}function Cc(e,t){let s=e.match(new RegExp("^\\s*<!".concat(t,"\\s+([^>]*)>\\s*$"),"i"));return s?s[1]:null}async function $c(e){let t=Ac(e),s={};var i=void 0,c=0;for(let p=0;p<t.length;p++){let m=t[p];if(!m.trim().length)continue;let g=wc(m,xc);if(!(!g&&["css","import","tag","renderer"].some(_=>{let x=Cc(m,_);if(x)return i=_,s[i]||(s[i]=[]),s[_].push(i==="tag"?{value:x,line:p}:x),!0}))){if(!i&&!g){i="template",c=p,s.template="",s.template+="\n"+m;continue}if(g){if(i=g,!s[g])s[g]="";else throw"duplicate <!".concat(g,"> block at line ").concat(p);continue}else{if(["css","import","tag","renderer"].includes(i))if(!s.template)i="template",c=p,s.template="";else{if(m.trim().startsWith("//"))continue;throw'unexpected "'.concat(m.trim(),'" at line ').concat(p,". Template started at line ").concat(c)}s[i]+="\n"+m;continue}}}return s}function He(e){return['"',"'","`"].includes(e[0])&&e[0]==e[e.length-1]?e.substring(1,e.length-1).trim():e.trim()}function Oc(e){let t={},s=ut(e.value," ",!0).map(He);if(s.length>2)throw"excess arguments <!tag ".concat(e.value,"> at line ").concat(e.line);if(s.some(i=>!i))throw"empty argument <!tag ".concat(e.value,"> at line ").concat(e.line);if(s.length===1){if(s[0][0]==="@")throw"alias is present but path is not <!tag ".concat(e.value,"> at line ").concat(e.line);t.alias="@"+s[0].split("\\").pop().split("/").pop(),t.path=s[0]}else{if(s[0][0]!=="@")throw'missing alias identifier "@" <!tag '.concat(e.value,"> at line ").concat(e.line);t.alias=s[0],t.path=s[1]}return t}function Lc(e){if(ut(e," ",!0).length>1)throw"excess parameters <!import ".concat(e,">");return He(e)}function Nc(e){let t=ut(e," ",!0);if(t.length>2)throw"excess parameters <!renderer ".concat(e,">");if(t.length==2&&t[1]!=="html")throw"unknown second parameter <!renderer ".concat(e,">");return He(e)}function rn(e){try{Function("var "+e)}catch(t){return!1}return!0}function Pc(e){let t=ut(e," ",!0);if(t.length<3)throw"not enough parameters <!import ".concat(e,">");if(t.length===3){if(t[1].toLowerCase()!=="from")throw"wrong parameters <!import ".concat(e,">");if(t[0].startsWith("{")&&t[0].endsWith("}")){let i=t[0].substring(1,t[0].length-1);if(!i.length)throw"wrong parameters <!import ".concat(e,">");if(!i.split(",").map(p=>p.trim()).every(rn))throw"invalid variable name <!import ".concat(e,">");return{type:"object",import:t[0],path:He(t[2])}}else{if(!rn(t[0]))throw"invalid variable name <!import ".concat(e,">");return{type:"var",import:t[0],path:He(t[2])}}}else{try{var s=lt(e,{pairs:["{}"]})}catch(i){throw"invalid variable name <!import ".concat(e,">")}if(s.length>2)throw"wrong parameters <!import ".concat(e,">");if(s.length===1){if(s[0].nodeType==="bracket")throw"wrong parameters <!import ".concat(e,">");if(t[0]==="*"&&t[1].toLowerCase()==="as"&&t[3].toLowerCase()==="from"&&t.length===5){if(!rn(t[2]))throw"invalid variable name <!import ".concat(e,">");return{type:"*",import:t[2],path:He(t[4])}}else throw"wrong parameters <!import ".concat(e,">")}else{let i=ut(s[1].content," ",!0);if(i.length!==2||i[0].toLowerCase()!=="from"||!s[0].innerContent.trim().length)throw"wrong parameters <!import ".concat(e,">");let c=s[0].innerContent.split(",").map(p=>p.trim());if(!c.every(rn))throw"invalid variable name <!import ".concat(e,">");return{type:"object",import:"{"+c.join(",")+"}",path:He(i[1])}}}}async function ws(e){let t=await $c(e);return t.tag&&(t.tag=t.tag.map(Oc)),t.css&&(t.css=t.css.map(Lc)),t.import&&(t.import=t.import.map(Pc)),t.renderer&&(t.renderer=t.renderer.map(Nc)),t}var Cs=(...e)=>e.filter(t=>typeof t=="function").reduce((t,s)=>t===null?s:function(...c){t.apply(this,c),s.apply(this,c)},null);function Ic(e){return["Update_Tag","enterProps","updateProps"].forEach(t=>{Array.isArray(e[t])&&(e[t].length?e[t]=Cs(...e[t]):delete e[t])}),e}function Xn(e){e.forEach((t,s)=>{e[s]=Ic(t),t.children&&Xn(t.children)})}var $t=class{constructor({stiffness:t=300,damping:s=70,mass:i=10,delta:c=.01,target:p,current:m,callback:g,done:_}={}){this.stiffness=t,this.damping=s,this.delta=c,this.mass=i,this.callback=g,this.done=_,this.target=p||0,this.current=m||0,this.running=!1,this.velocity=0,this.acceleration=0,this.step()}set(t,s=!1){this.target=t,s?this.current=t:this.running||this.step()}stop(){cancelAnimationFrame(this.rafId),this.done&&this.done(this.current)}start(){this.step()}step(){if(this.isAtTarget())this.current=this.target,this.running=!1,this.done&&this.done(this.current);else{let t=this.lastFrameTime?Math.min(Math.max((Date.now()-this.lastFrameTime)/1e3,.008333333333333333),.03333333333333333):.016666666666666666;this.running=!0,this.advance(t),this.lastFrameTime=Date.now(),this.rafId=requestAnimationFrame(()=>this.step())}this.callback&&this.callback(this.current)}advance(t){let s=-this.stiffness*(this.current-this.target),i=-this.damping*this.velocity;this.acceleration=(s+i)/this.mass,this.velocity+=this.acceleration*t,this.current+=this.velocity*t}isAtTarget(){return Math.abs(this.target-this.current)<this.delta&&Math.abs(this.velocity)<=this.delta}};var dt=e=>class extends e{baseInit(){this.component=this.initial_component,Xn(this.component),this.animate=Se.animate,this.Spring=$t,this.window_events={},this.checkStateObjectChanges={},this.state=this.initial_state,delete this.__proto__.baseInit}async connectedCallback(){if(this.renderer&&!this.__rendererHTML&&this.__rendererName!==this.parent.__rendererName)throw"ui.js diffferent renderers ".concat(this.__rendererName," and ").concat(this.parent.__rendererName);Ue(this.document,this.component,{state:this.state}),this.is_connected=!0,this.connected&&this.connected()}async disconnectedCallback(){this.disconnected&&await this.disconnected(),Object.keys(this.window_events).forEach(s=>this.window_events[s].forEach(i=>window.removeEventListener(s,i.cb)))}render(){this.is_connected&&Xt(this.document,this.component,{state:this.state})}attributeChangedCallback(s,i,c){if(typeof c=="object"){if(Array.isArray(this.state[s])&&Array.isArray(c)&&this.state[s].length==0&&c.length==0||this.checkStateObjectChanges[s]&&JSON.stringify(this.state[s])===JSON.stringify(c))return}else if(this.state[s]===c)return;this.state[s]=c,this.changed&&this.changed({[s]:c}),this.render()}hasEventHandler(s){return this._events?!!this._events[s]:!!this.getAttribute("on"+s)}get cookies(){return typeof document<"u"?Object.assign({},...document.cookie.split(";").filter(s=>s).map(s=>s.split("=")).map(([s,i])=>({[s.trim()]:(i+"").trim()}))):{}}get hash(){return typeof window<"u"?window.location.hash.substr(1).split("/"):[]}on(s,i,c){this.window_events[s]||(this.window_events[s]=[]);let p=this.window_events[s].find(g=>g.callback===i),m=(...g)=>i.call(this,...g);p||(this.window_events[s].push({callback:i,cb:m}),window.addEventListener(s,m,c))}off(s,i){if(!this.window_events[s])return;let c=this.window_events[s].findIndex(p=>p.callback===i);c!==-1&&(window.removeEventListener(s,this.window_events[s][c].cb),this.window_events[s].splice(c,1))}};var sn=e=>class extends e{htmlInit(){if(this.animateCSS=(s,{element:i,unit:c,from:p,to:m,duration:g,easing:_,done:x})=>{i._styles[s]=Se.animateCSS(i||this,s,c===void 0?"":c,p||0,m,g||1e3,_,()=>{i._styleV[s]=m+c,x&&x()})},this.css.length){let s=document.createElement("style");s.textContent=this.css,this.ShadowDOM?this.document.append(s):setTimeout(()=>{this.document.append(s)},0)}delete this.__proto__.htmlInit}setAttribute(s,i){this.attributeChangedCallback(s,void 0,i),this.AddAttributes&&typeof i!="object"&&super.setAttribute(s,i)}$(s){return this.document.querySelector(s)}$$(s){return this.document.querySelectorAll(s)}emitNative(s,i){console.warn('this.emitNative() is deprecated. Use this.emit(). "'.concat(this.__src,'"')),this.emit(s,i)}emit(s,i){this.dispatchEvent(new CustomEvent(s,{cancelable:!1,bubbles:!1,detail:i}))}};var yt;if(typeof window<"u"){class e extends HTMLElement{constructor(){super(),this.AddAttributes=!1,this.ShadowDOM="open",this.MutationObserverOptions={childList:!0},this.baseInit(),this.init&&this.init(),this.document=["open","closed"].includes(this.ShadowDOM)?this.attachShadow({mode:this.ShadowDOM}):this,this.htmlInit(),this.slotChange&&(this._slot_observer=new MutationObserver(s=>this.slotChange(s)),this._slot_observer.observe(this,this.MutationObserverOptions))}get slotted(){let s=this.document.querySelector("slot");return s?s.assignedElements():[]}get element(){return this.ShadowDOM?this.document.host:this.document}}yt=class extends sn(dt(e)){}}var Zn=class{constructor(){if(this.document=document.querySelector(this.container),!this.document)throw'ui.js: target container "'.concat(this.container,'" not found');this.baseInit(),this.htmlInit(),this.init&&this.init(),this.connectedCallback()}get element(){return this.document}},on=class extends sn(dt(Zn)){};var er=class{constructor(t,s){if(this._BASE_ELEMENT=!0,this.document={_childNodes:[],__rendererName:this.__rendererName},this._childNodes=[],this._eventListeners={},this.parent=t,this.baseInit(),this.renderer&&!this.__rendererHTML&&this.__rendererName!==this.parent.__rendererName)throw"ui.js diffferent renderers ".concat(this.__rendererName," and ").concat(this.parent.__rendererName);this.onReady=new Promise(async i=>{var c,p,m;(c=this.renderer)!=null&&c.onReady&&await this.renderer.onReady,(p=this.parent)!=null&&p.onReady&&await this.parent.onReady,(m=this.renderer)!=null&&m.onConnect&&await this.renderer.onConnect(this),this.document.renderer=this.renderer,this.document.parent=this.document,this.init&&await this.init(),Ue(this.document,this.component,{state:this.state}),i(),this.is_connected=!0,this.connected&&await this.connected()})}setAttribute(t,s){this.attributeChangedCallback(t,void 0,s)}emit(t,s){this._eventListeners[t]&&this._eventListeners[t].forEach(i=>i.cb(new CustomEvent(t,{cancelable:!1,bubbles:!1,detail:s})))}addEventListener(t,s,i){this._eventListeners[t]||(this._eventListeners[t]=[]);let c=this._eventListeners[t].find(m=>m.callback===s),p=(...m)=>s.call(this,...m);c||this._eventListeners[t].push({callback:s,cb:p})}removeEventListener(t,s){if(!this._eventListeners[t])return;let i=this._eventListeners[t].findIndex(c=>c.callback===s);i!==-1&&this._eventListeners[t].splice(i,1)}async remove(){for(await this.disconnectedCallback();this.document._childNodes.length;)await this.document._childNodes[this.document._childNodes.length-1].remove();this.renderer.onDisconnect&&await this.renderer.onDisconnect(this);let t=this.parent._childNodes.findIndex(s=>s==this);if(t!==-1)this.parent._childNodes.splice(t,1);else throw"Element not found"}after(t){this.renderer.insertAfter(this,t)}before(t){this.renderer.insertBefore(this,t)}},an=class extends dt(er){};var $s=(e,t=0)=>{for(var s=3735928559^t,i=1103547991^t,c=0,p;c<e.length;c++)p=e.charCodeAt(c),s=Math.imul(s^p,2654435761),i=Math.imul(i^p,1597334677);return s=Math.imul(s^s>>>16,2246822507)^Math.imul(i^i>>>13,3266489909),i=Math.imul(i^i>>>16,2246822507)^Math.imul(s^s>>>13,3266489909),4294967296*(2097151&i)+(s>>>0)};function Ot(e,t,s=""){return"ui-"+s+String($s(t||e.trim())).replaceAll("-","i")}var Rc=Object.getPrototypeOf(async function(){}).constructor,cn=Rc;var tr={},Bc=e=>e.split("-").map(t=>t.slice(0,1).toUpperCase()+t.slice(1)).join(""),Mc=e=>((t,s)=>JSON.stringify(e,(i,c)=>typeof c=="function"?s.push(c)&&t:c).replace(new RegExp('"'+t+'"',"g"),i=>s.shift()))("____"+as(50)+"____",[]),Fc=(e,t)=>{if(tr[e])return tr[e];let s=URL.createObjectURL(new Blob([String.raw({raw:t})],{type:"text/javascript"}));return tr[e]=s,s},nr=(e,t,s,i)=>e.reduce((c,p)=>{let m=t?p.path[0]==="@"?p.path:"ui.js-bundled-tags:"+(p.path[0]==="/"?s:s+i)+"/"+p.path:Fc(p.path,p.src);return p.type==="*"?c+"const "+p.import+" = {...(await import(`"+m+"`))};\n":p.type==="object"?c+"const "+p.import+" =  (await import(`"+m+"`));\n":c+"const "+p.import+" =  (await import(`"+m+"`)).default;\n"},"");function rr(e,t,{inFunc:s=!1,parent:i}){var c="",p="",m="";c=e.style,m="";let g="{".concat((e.state||"").trim(),"}"),_=t!=="customElement"?"":new Function("return 'static get observedAttributes() { return '+JSON.stringify(Object.keys(".concat(g,"))+' }'"))(),x=Bc(e.name),$=Mc(As(e.template,e.tag||[])),R=e.container?'get container()         { return "'.concat(e.container,'" }'):"";var D="";if(e.renderer){let fe=e.renderer[0].split(" ");if(D='get __rendererName(){ return "'+fe[0]+'" }',fe.length==2){var J=!0;D+="\nget __rendererHTML(){ return true }"}else D+="\nget renderer(){ return this.parent?.renderer }"}let L="\n\n        ".concat(e.static||"",";\n        class ").concat(x," extends ").concat(t," {\n            ").concat(_,"\n            get nanoapp()           { return ").concat(JSON.stringify(e.nanoapp)," }\n            get initial_state()     { return ").concat(g," }\n            get initial_component() { return ").concat($," }\n            get css()               { return `").concat(c,"`; }\n            ").concat(m,'\n            get __src()             { return "').concat(e.src,'" }\n            ').concat(D,"\n            ").concat(R,"\n            ").concat(e.class||"","\n        };\n    ");switch(t){case"customElement":let fe=e.microfrontend?"microfrontend_app_name":"'".concat(e.name,"'"),te="\n                ".concat(e.import?nr(e.import,e.nodePath,e.BASE_URL,e.path):"","\n                if(!customElements.get(").concat(fe,")) {\n                    ").concat(L,"\n                    customElements.define(").concat(fe,", ").concat(x,");\n                    window['UIjs'].tags[").concat(fe,"] = true;\n                };");return s?";(async () => {".concat(te,"})();"):te;case"uiElement":let ee="\n                ".concat(e.import?nr(e.import,e.nodePath,e.BASE_URL,e.path):"","\n                ").concat(L," return new ").concat(x,'("').concat("parentparentparent:"+i,'");');return s?";(async () => {".concat(ee,"})();"):ee;case"baseElement":let G="\n                ".concat(e.import?nr(e.import,e.nodePath,e.BASE_URL,e.path):"","\n                ").concat(L," ;window['UIjs'].tags['").concat(e.name,"'] = ").concat(x,";");return s?";(async () => {".concat(G,"})();"):G}}async function Ns(e,t,s){let i=Ot(e.innerText);await Qe(e.innerText,{name:i,path:t,nanoapp:s}),e.replaceWith(document.createElement(i))}async function sr(e,t,s,i,c,p){await Qe(e,{name:t,path:s,nanoapp:i,src:p})}function Os(e,t){return e.startsWith("/https://")&&(e=e.replace("/https://","https://")),typeof window<"u"&&window.nanoapp_base_path&&!e.startsWith(window.nanoapp_base_path)?window.nanoapp_base_path+"/app"+e:e}async function Ps(e,t){if(window.document.location.protocol=="file:"){console.error("WARNING!!! ui.js cannot fetch external resources from a 'local' filesystem: \"file://".concat(e,'"'));var s=await fetch(Os(e,t),{mode:"no-cors"}).catch(i=>!1)}else var s=await fetch(Os(e,t)).catch(c=>!1);return s}async function Ls(e,t,s){if(t)return await t(e);let i=await Ps(e,s);if(i===!1)throw"ui.js  \u2764\uFE0F error loading "+e;return(await i.text()).trim()}async function or(e,t,s="",i){if(Le[e])return!0;let c=t.substr(-4)===".tag"?t:t+".tag",p=t[0]!=="/"?_t(s+c):c,m=await Ps(p,i);if(m===!1)throw"ui.js  \u2764\uFE0F error loading "+c;let g=p.substring(0,p.lastIndexOf("/"))+"/";await sr(await m.text(),e,g,i,g,t)}async function Is(e,t,s){await Qe(e.innerText,{name:Ot(e.innerText),path:s,container:t})}function _t(e){return typeof window>"u"?e:new URL(e,document.baseURI).pathname}async function ln({source:e,path:t,keepName:s,nodeFetch:i,nodePath:c,BASE_URL:p,nameSuffix:m,microfrontend:g},_=[]){let x=s?t.split("/").pop().split(".")[0]:Ot(t,void 0,m);return{name:x,compiled:await Qe(e,{name:x,path:t.substring(0,t.lastIndexOf("/"))+"/",bundle:!0,nodeFetch:i,nodePath:c,BASE_URL:p,nameSuffix:m,microfrontend:g},_)}}async function Qe(e,t={},s=[]){let i=await ws(e);if(!t.name)throw"name is undefined !!!";i.name=t.name||"ui-component",i.microfrontend=!!t.microfrontend,i.path=t.path,i.src=t.src,i.container=t.container||"",i.nodePath=t.nodePath?t.nodePath:void 0,i.BASE_URL=t.BASE_URL,i.nanoapp=t.nanoapp||[];let c=t.nodeFetch||void 0;var p="";if(i.style&&(i.style=i.style.trim(),i.style.length&&(p=i.style)),i.css)for(let m of i.css){let g=m[0]!=="/"?_t(i.path+m):m,_=await Ls(g,c,i.nanoapp);_.length&&(p+="\n"+_)}if(i.style=p.replaceAll("`","`").trim(),i.tag)for(let m of i.tag){let g=m.path;g=g.substr(-4)===".tag"?g:g+".tag",c?g=_t(g[0]==="/"?g:i.path+g):g=_t(m.path[0]==="/"?g:i.path+g);let _=Ot(g,void 0,t.nameSuffix);if(m.name=_,c)m.src=await c(g);else{let x=i.nanoapp&&i.nanoapp.children&&i.nanoapp.children.find($=>"@"+$.alias===m.alias);x&&(g.startsWith("/!"+x.alias+".tag")&&g.split("/").length==2?g=window.nanoapp_base_path+g.replace("/!"+x.alias+".tag","/imports/"+x.child_release+"/index.tag"):g.startsWith("/!"+x.alias+"/")&&(g=window.nanoapp_base_path+g.replace("/!"+x.alias+"/","/imports/"+x.child_release+"/"))),await or(_,g,i.path,x||i.nanoapp)}}if(i.import&&!c)for(let m of i.import){let g=m.path[0]!=="/"?_t(i.path+m.path):m.path;m.path=g;let _=await Ls(g,c,i.nanoapp);m.src=_}if(Le[i.name]=!0,i.renderer&&i.renderer[0].split(" ").length==1){let m=rr(i,"baseElement",{inFunc:!1});return await new cn("baseElement",m)(an)}else if(i.container){let m=rr(i,"uiElement",{inFunc:!1});return await new cn("uiElement",m)(on)}else{let m=rr(i,"customElement",{inFunc:!1});if(t.bundle){if(i.tag){let g=[];for(let _ of i.tag)if(!Le[_.name]){let x=_.path.substr(-4)===".tag"?_.path:_.path+".tag";x[0]!=="/"&&(x=i.path+x);let{name:$,compiled:R}=await ln({source:_.src,path:x,name:_.name,nodePath:_t(i.nodePath+i.path),BASE_URL:i.BASE_URL,nodeFetch:c,nameSuffix:t.nameSuffix||""},s);s.includes($)||(s.push($),g.push(R))}return g.join("")+m}return m}await new cn("customElement",m)(yt)}}var un=class extends Error{constructor(t){super(t),this.name="ui.js \u2764\uFE0F  syntax ERROR"}};function Uc(e,t){e.innerText.trim().length&&console.warn('ui.js warning: contents of "<script type=ui '.concat(t.map(s=>s.name).join(" "),'> will be ignored"'))}function Rs(e,t){e.innerText.trim().length||console.warn('ui.js warning: empty "<script type=ui '.concat(t.map(s=>s.name).join(" "),'>"'))}async function Bs(){let e=Array.from(document.querySelectorAll('script[type="ui"],script[type="i"]'));try{for(let t of e){let s=window.location.pathname,i=s.substring(0,s.lastIndexOf("/"))+"/",c=Array.prototype.slice.call(t.attributes).map(g=>({name:g.name,value:t.getAttribute(g.name).trim()})),p=c.find(g=>g.name==="target"&&g.value.length);if(p){c.length>2&&console.warn('ui.js warning: all other attributes for "<script type=ui target="'.concat(p.value,'"> will be ignored"')),await Is(t,p.value,i),t.remove();continue}let m=c.filter(g=>g.name.includes("-"));if(m.length>1)throw'ui.js ERROR: more then one attribute with hyphens "<script '.concat(m.map(g=>g.name).join(" "),'>"');m.length===1?(m[0].value?(Uc(t,c),await or(m[0].name,m[0].value,i,typeof window<"u"&&window.nanoapp_dependencies)):(Rs(t,c),await sr(t.innerText,m[0].name,i,typeof window<"u"&&window.nanoapp_dependencies)),t.remove()):(Rs(t,c),await Ns(t,i))}}catch(t){throw new un(t)}}var Ms,Fs,Us,Ds,js,ks,zs,Gs,Ys,qs,Ws,Vs,Js,Hs,Qs,Ks,Dc=function(e){"use strict";var t=i,s=Object.prototype.hasOwnProperty;function i(){for(var o={},n=0;n<arguments.length;n++){var r=arguments[n];for(var a in r)s.call(r,a)&&(o[a]=r[a])}return o}let c=o=>o;function p(o){function n(r){if(!Array.isArray(r))throw new Error("Transform must be used on an Array. Received "+JSON.stringify(r));let a=(()=>{let[d]=r;return d.Type in o&&typeof o[d.Type]=="function"?o[d.Type]:c})();if(a.length===2)return a(r,n);let[l,...u]=a(r),h=l.params.filter(Boolean).map(d=>n([d,...u]));return t(l,{params:h})}return n}function m(o){let n=r=>{if(r==null)return r;let a="*"in o&&typeof o["*"]=="function"?o["*"]:r.Type in o&&typeof o[r.Type]=="function"?o[r.Type]:c;if(a.length===2)return a(r,n);let l=a(r),u=l.params.map(n);return t(l,{params:u})};return n}var g={map:p,mapNode:m},_=g,x=_.map,$=_.mapNode,R=function(o){let n=r=>{if(r==null)return r;let{params:a}=r,l="*"in o&&typeof o["*"]=="function"?o["*"]:r.Type in o&&typeof o[r.Type]=="function"?o[r.Type]:()=>r;return l.length===2?(l(r,n),r):(l(r),a.forEach(n),r)};return n},D=R,J=function(o,n,r,a,l,u,h,d){if(n===void 0)throw new Error("invariant requires an error message argument");if(!o){var f;if(n===void 0)f=new Error("Minified exception occurred; use the non-minified dev environment for the full error message and additional helpful warnings.");else{var T=[r,a,l,u,h,d],b=0;f=new Error(n.replace(/%s/g,function(){return T[b++]})),f.name="Invariant Violation"}throw f.framesToPop=1,f}},L=J,fe=typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function te(o){return o&&o.__esModule?o.default:o}function ee(o,n){return n={exports:{}},o(n,n.exports),n.exports}var G=ee(function(o,n){(function(r,a){a(n)})(fe,function(r){let a={whitespace:/[ \t]+/,comment:[{match:/\/\/.*?$/},{match:/\/\*[^]*?\*\//,lineBreaks:!0}],number:[{match:/0[xX][0-9a-fA-F]+/},{match:/0[oO][0-9]+/},{match:/0[bB][01]+/},{match:/(?:[0-9]+(?:\.[0-9]+)?e-?[0-9]+)/},{match:/[0-9]+\.[0-9]+|[0-9]+/}],char:[{match:/'(?:\\['\\bfnrtv0]|[^'\\\n])'/,value:Ve=>Ve.slice(1,-1)}],string:[{match:/"(?:\\["\\rn]|[^"\\\n])*?"/,value:Ve=>Ve.slice(1,-1)},{match:/'(?:\\['\\bfnrtv0]|[^'\\\n])*?'/,value:Ve=>Ve.slice(1,-1)},{match:/`(?:\\['\\bfnrtv0]|[^'\\])*?`/,value:Ve=>Ve.slice(1,-1)}],identifier:{match:/[A-Za-z_$][A-Za-z0-9_$]*/,keywords:{keyword:["break","if","else","import","as","from","export","return","switch","case","default","const","let","for","continue","do","while","throw","function","global","module","type","lambda"],type:["i32","i64","f32","f64","bool"]}},punctuator:["+","++","-","--",">>",">>>","<<","=","==","+=","-=","=>","<=",">=","!=","%","*","/","^","&","~","|","!","**",":","(",")",".","{","}",",","[","]",";",">","<","?","||","&&","{","}","..."],newline:{match:/(?:\r\n|\r|\n)/,lineBreaks:!0}},l="Program",u="Keyword",h="Export",d="Import",f="Statement",T="IfThenElse",b="Select",v="Else",w="UnaryExpression",P="BinaryExpression",B="TernaryExpression",U="NumberLiteral",z="StringLiteral",Z="CharacterLiteral",K="Punctuator",Oe="Identifier",pe="ArraySubscript",O="Constant",j="Type",k="ArrayType",q="DeclType",W="GenericType",V="UserType",X="FunctionType",ne="Declaration",re="StaticDeclaration",ie="StaticValueList",ve="ImmutableDeclaration",Te="FunctionDeclaration",he="ArrayDeclaration",ct="IndirectFunctionCall",St="FunctionCall",We="Loop",Et="MemoryAssignment",ae="Assignment",Dr="AssignmentExpression",jr="Param",Nn="Typedef",Pn="Struct",In="UnionType",Rn="ReturnStatement",Bn="Sequence",Mn="ObjectLiteral",Fn="Pair",kr="TypeCast",Un="Break",Dn="Comment",jn="Sizeof",kn="Spread",zr="Closure",zn="Noop",Gr="ClosureType",Gn="Block",Yr="ObjectField",qr="FunctionIndex",Wr="FunctionIdentifier",Vr="FunctionPointer",Jr="FunctionArguments",Hr="FunctionResult",Qr="FunctionLocals",Kr="NativeMethod",Yn="Unreachable",Xr="Access",Zr="i32",es="f32",ts="i64",ns="f64",rs="Memory",ss="Table",os="bool";r.Program=l,r.Keyword=u,r.Export=h,r.Import=d,r.Statement=f,r.IfThenElse=T,r.Select=b,r.Else=v,r.UnaryExpression=w,r.BinaryExpression=P,r.TernaryExpression=B,r.NumberLiteral=U,r.StringLiteral=z,r.CharacterLiteral=Z,r.Punctuator=K,r.Identifier=Oe,r.ArraySubscript=pe,r.Constant=O,r.Type=j,r.ArrayType=k,r.DeclType=q,r.GenericType=W,r.UserType=V,r.FunctionType=X,r.Declaration=ne,r.StaticDeclaration=re,r.StaticValueList=ie,r.ImmutableDeclaration=ve,r.FunctionDeclaration=Te,r.ArrayDeclaration=he,r.IndirectFunctionCall=ct,r.FunctionCall=St,r.Loop=We,r.MemoryAssignment=Et,r.Assignment=ae,r.AssignmentExpression=Dr,r.Param=jr,r.Typedef=Nn,r.Struct=Pn,r.UnionType=In,r.ReturnStatement=Rn,r.Sequence=Bn,r.ObjectLiteral=Mn,r.Pair=Fn,r.TypeCast=kr,r.Break=Un,r.Comment=Dn,r.Sizeof=jn,r.Spread=kn,r.Closure=zr,r.Noop=zn,r.ClosureType=Gr,r.Block=Gn,r.ObjectField=Yr,r.FunctionIndex=qr,r.FunctionIdentifier=Wr,r.FunctionPointer=Vr,r.FunctionArguments=Jr,r.FunctionResult=Hr,r.FunctionLocals=Qr,r.NativeMethod=Kr,r.Unreachable=Yn,r.Access=Xr,r.i32=Zr,r.f32=es,r.i64=ts,r.f64=ns,r.Memory=rs,r.Table=ss,r.bool=os,r.builtinTypes={i32:Zr,f32:es,i64:ts,f64:ns,Memory:rs,Table:ss,bool:os},r.statements={Program:l,Export:h,Import:d,IfThenElse:T,Else:v,Declaration:ne,ImmutableDeclaration:ve,FunctionDeclaration:Te,ArrayDeclaration:he,Loop:We,MemoryAssignment:Et,Assignment:ae,Typedef:Nn,Struct:Pn,UnionType:In,ReturnStatement:Rn,Sequence:Bn,ObjectLiteral:Mn,Pair:Fn,Break:Un,Comment:Dn,Sizeof:jn,Spread:kn,Noop:zn,Block:Gn,Unreachable:Yn},r.default={Program:l,Keyword:u,Export:h,Import:d,Statement:f,IfThenElse:T,Select:b,Else:v,UnaryExpression:w,BinaryExpression:P,TernaryExpression:B,NumberLiteral:U,StringLiteral:z,CharacterLiteral:Z,Punctuator:K,Identifier:Oe,ArraySubscript:pe,Constant:O,Type:j,ArrayType:k,DeclType:q,GenericType:W,UserType:V,FunctionType:X,Declaration:ne,ImmutableDeclaration:ve,FunctionDeclaration:Te,ArrayDeclaration:he,StaticDeclaration:re,StaticValueList:ie,IndirectFunctionCall:ct,FunctionCall:St,Loop:We,MemoryAssignment:Et,Assignment:ae,AssignmentExpression:Dr,Param:jr,Typedef:Nn,Struct:Pn,UnionType:In,ReturnStatement:Rn,Sequence:Bn,ObjectLiteral:Mn,Pair:Fn,TypeCast:kr,Break:Un,Comment:Dn,Sizeof:jn,Spread:kn,Closure:zr,Access:Xr,Noop:zn,ClosureType:Gr,Block:Gn,ObjectField:Yr,FunctionIndex:qr,FunctionIdentifier:Wr,FunctionPointer:Vr,FunctionArguments:Jr,FunctionResult:Hr,FunctionLocals:Qr,NativeMethod:Kr,Unreachable:Yn},r.tokens=a,Object.defineProperty(r,"__esModule",{value:!0})})}),y=te(G),_e=G.tokens,Pe=G.semantics,Ke=G.builtinTypes,be=G.statements,Ie=G.i32,Xe=G.f32,De=G.i64,Jc=G.f64,to=ee(function(o){(function(n,r){o.exports?o.exports=r():n.moo=r()})(fe,function(){var n=Object.prototype.hasOwnProperty,r=typeof Object.assign=="function"?Object.assign:function(O,j){if(O==null)throw new TypeError("Target cannot be null or undefined");O=Object(O);for(var k=1;k<arguments.length;k++){var q=arguments[k];if(q!=null)for(var W in q)n.call(q,W)&&(O[W]=q[W])}return O},a=typeof new RegExp().sticky=="boolean";function l(O){return O&&O.constructor===RegExp}function u(O){return O&&typeof O=="object"&&O.constructor!==RegExp&&!Array.isArray(O)}function h(O){return O.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}function d(O){var j=new RegExp("|"+O);return j.exec("").length-1}function f(O){return"("+O+")"}function T(O){var j=O.map(function(k){return"(?:"+k+")"}).join("|");return"(?:"+j+")"}function b(O){if(typeof O=="string")return"(?:"+h(O)+")";if(l(O)){if(O.ignoreCase)throw new Error("RegExp /i flag not allowed");if(O.global)throw new Error("RegExp /g flag is implied");if(O.sticky)throw new Error("RegExp /y flag is implied");if(O.multiline)throw new Error("RegExp /m flag is implied");return O.source}else throw new Error("not a pattern: "+O)}function v(O){for(var j=Object.getOwnPropertyNames(O),k=[],q=0;q<j.length;q++){var W=j[q],V=O[W],X=Array.isArray(V)?V:[V],ne=[];X.forEach(function(re){u(re)?(ne.length&&k.push(P(W,ne)),k.push(P(W,re)),ne=[]):ne.push(re)}),ne.length&&k.push(P(W,ne))}return k}function w(O){for(var j=[],k=0;k<O.length;k++){var q=O[k];if(!q.name)throw new Error("Rule has no name: "+JSON.stringify(q));j.push(P(q.name,q))}return j}function P(O,j){(typeof j!="object"||Array.isArray(j)||l(j))&&(j={match:j});var k=r({tokenType:O,lineBreaks:!!j.error,pop:!1,next:null,push:null,error:!1,value:null,getType:null},j),q=k.match;return k.match=Array.isArray(q)?q:q?[q]:[],k.match.sort(function(W,V){return l(W)&&l(V)?0:l(V)?-1:l(W)?1:V.length-W.length}),k.keywords&&(k.getType=Z(k.keywords)),k}function B(O,j){O=Array.isArray(O)?w(O):v(O);for(var k=null,q=[],W=[],V=0;V<O.length;V++){var X=O[V];if(X.error){if(k)throw new Error("Multiple error rules not allowed: (for token '"+X.tokenType+"')");k=X}if(X.match.length!==0){q.push(X);var ne=T(X.match.map(b)),re=new RegExp(ne);if(re.test(""))throw new Error("RegExp matches empty string: "+re);var ie=d(ne);if(ie>0)throw new Error("RegExp has capture groups: "+re+"\nUse (?: \u2026 ) instead");if(!j&&(X.pop||X.push||X.next))throw new Error("State-switching options are not allowed in stateless lexers (for token '"+X.tokenType+"')");if(!X.lineBreaks&&re.test("\n"))throw new Error("Rule should declare lineBreaks: "+re);W.push(f(ne))}}var ve=a?"":"|(?:)",Te=a?"ym":"gm",he=new RegExp(T(W)+ve,Te);return{regexp:he,groups:q,error:k}}function U(O){var j=B(O);return new K({start:j},"start")}function z(O,j){var k=Object.getOwnPropertyNames(O);j||(j=k[0]);for(var q=Object.create(null),W=0;W<k.length;W++){var V=k[W];q[V]=B(O[V],!0)}for(var W=0;W<k.length;W++)for(var X=q[k[W]].groups,ne=0;ne<X.length;ne++){var re=X[ne],ie=re&&(re.push||re.next);if(ie&&!q[ie])throw new Error("Missing state '"+ie+"' (in token '"+re.tokenType+"' of state '"+k[W]+"')");if(re&&re.pop&&+re.pop!=1)throw new Error("pop must be 1 (in token '"+re.tokenType+"' of state '"+k[W]+"')")}return new K(q,j)}function Z(O){for(var j=Object.create(null),k=Object.create(null),q=Object.getOwnPropertyNames(O),W=0;W<q.length;W++){var V=q[W],X=O[V],ne=Array.isArray(X)?X:[X];ne.forEach(function(he){if((k[he.length]=k[he.length]||[]).push(he),typeof he!="string")throw new Error("keyword must be string (in keyword '"+V+"')");j[he]=V})}function re(he){return JSON.stringify(he)}var ie="";ie+="(function(value) {\n",ie+="switch (value.length) {\n";for(var ve in k){var Te=k[ve];ie+="case "+ve+":\n",ie+="switch (value) {\n",Te.forEach(function(he){var ct=j[he];ie+="case "+re(he)+": return "+re(ct)+"\n"}),ie+="}\n"}return ie+="}\n",ie+="})",(0,eval)(ie)}var K=function(O,j){this.startState=j,this.states=O,this.buffer="",this.stack=[],this.reset()};K.prototype.reset=function(O,j){return this.buffer=O||"",this.index=0,this.line=j?j.line:1,this.col=j?j.col:1,this.setState(j?j.state:this.startState),this},K.prototype.save=function(){return{line:this.line,col:this.col,state:this.state}},K.prototype.setState=function(O){if(!(!O||this.state===O)){this.state=O;var j=this.states[O];this.groups=j.groups,this.error=j.error||{lineBreaks:!0,shouldThrow:!0},this.re=j.regexp}},K.prototype.popState=function(){this.setState(this.stack.pop())},K.prototype.pushState=function(O){this.stack.push(this.state),this.setState(O)},K.prototype._eat=a?function(O){return O.exec(this.buffer)}:function(O){var j=O.exec(this.buffer);return j[0].length===0?null:j},K.prototype._getGroup=function(O){if(O===null)return-1;for(var j=this.groups.length,k=0;k<j;k++)if(O[k+1]!==void 0)return k;throw new Error("oops")};function Oe(){return this.value}if(K.prototype.next=function(){var O=this.re,j=this.buffer,k=O.lastIndex=this.index;if(k!==j.length){var q=this._eat(O),W=this._getGroup(q),V,X;W===-1?(V=this.error,X=j.slice(k)):(X=q[0],V=this.groups[W]);var ne=0;if(V.lineBreaks){var re=/\n/g,ie=1;if(X==="\n")ne=1;else for(;re.exec(X);)ne++,ie=re.lastIndex}var ve={type:V.getType&&V.getType(X)||V.tokenType,value:V.value?V.value(X):X,text:X,toString:Oe,offset:k,lineBreaks:ne,line:this.line,col:this.col},Te=X.length;if(this.index+=Te,this.line+=ne,ne!==0?this.col=Te-ie+1:this.col+=Te,V.shouldThrow)throw new Error(this.formatError(ve,"invalid syntax"));return V.pop?this.popState():V.push?this.pushState(V.push):V.next&&this.setState(V.next),ve}},typeof Symbol<"u"&&Symbol.iterator){var pe=function(O){this.lexer=O};pe.prototype.next=function(){var O=this.lexer.next();return{value:O,done:!O}},pe.prototype[Symbol.iterator]=function(){return this},K.prototype[Symbol.iterator]=function(){return new pe(this)}}return K.prototype.formatError=function(O,j){var k=O.value,q=O.offset,W=O.lineBreaks?k.indexOf("\n"):k.length,V=Math.max(0,q-O.col+1),X=this.buffer.substring(V,q+W);return j+=" at line "+O.line+" col "+O.col+":\n\n",j+="  "+X+"\n",j+="  "+Array(O.col).join(" ")+"^",j},K.prototype.clone=function(){return new K(this.states,this.state)},K.prototype.has=function(O){for(var j in this.states)for(var k=this.states[j].groups,q=0;q<k.length;q++){var W=k[q];if(W.tokenType===O||W.keywords&&n.call(W.keywords,O))return!0}return!1},{compile:U,states:z,error:Object.freeze({error:!0})}})}),lr=Array.prototype.slice,no=function(o){return lr.call(o)},ro=function(o){return lr.call(o,1)},fn=function(o,n,r){var a=r-n.length;switch(a){case 0:return function(){return Ce(o,we(n,arguments),r)};case 1:return function(l){return Ce(o,we(n,arguments),r)};case 2:return function(l,u){return Ce(o,we(n,arguments),r)};case 3:return function(l,u,h){return Ce(o,we(n,arguments),r)};case 4:return function(l,u,h,d){return Ce(o,we(n,arguments),r)};case 5:return function(l,u,h,d,f){return Ce(o,we(n,arguments),r)};case 6:return function(l,u,h,d,f,T){return Ce(o,we(n,arguments),r)};case 7:return function(l,u,h,d,f,T,b){return Ce(o,we(n,arguments),r)};case 8:return function(l,u,h,d,f,T,b,v){return Ce(o,we(n,arguments),r)};case 9:return function(l,u,h,d,f,T,b,v,w){return Ce(o,we(n,arguments),r)};case 10:return function(l,u,h,d,f,T,b,v,w,P){return Ce(o,we(n,arguments),r)};default:return so(o,n,a)}},we=function(o,n){return o.concat(no(n))},so=function(o,n,r){var a=oo(r),l="false||function("+a+"){ return processInvocation(fn, concatArgs(args, arguments)); }";return(0,eval)(l)},oo=function(o){for(var n=[],r=0;r<o;r+=1)n.push("a"+r.toString());return n.join(",")},io=function(o,n){return o.length>n?o.slice(0,n):o},Ce=function(o,n,r){return n=io(n,r),n.length===r?o.apply(null,n):fn(o,n,r)},je=function(o){return fn(o,[],o.length)};je.to=je(function(o,n){return fn(n,[],o)}),je.adaptTo=je(function(o,n){return je.to(o,function(r){var a=ro(arguments).concat(r);return n.apply(this,a)})}),je.adapt=function(o){return je.adaptTo(o.length,o)};var Lt=je;function M(o){return o[0]}function ao(){let o=this.lexer,n=this.Syntax,{extendNode:r,drop:a,nth:l,nuller:u,nonEmpty:h,add:d,flatten:f,compose:T}=this.helpers,{node:b,binary:v,constant:w,identifier:P,statement:B,unary:U,ternary:z,subscript:Z,access:K,fun:Oe,declaration:pe,call:O,struct:j,result:k,string:q,char:W,typedef:V,voidFun:X,type:ne,arrayType:re,assignment:ie,forLoop:ve,whileLoop:Te,typeGeneric:he,spread:ct,builtinDecl:St,assignmentExpr:We,addressOf:Et}=this.nodes(o);return{Lexer:o,ParserRules:[{name:"_$ebnf$1",symbols:[]},{name:"_$ebnf$1",symbols:["_$ebnf$1","wschar"],postprocess:function(ae){return ae[0].concat([ae[1]])}},{name:"_",symbols:["_$ebnf$1"],postprocess:function(ae){return null}},{name:"__$ebnf$1",symbols:["wschar"]},{name:"__$ebnf$1",symbols:["__$ebnf$1","wschar"],postprocess:function(ae){return ae[0].concat([ae[1]])}},{name:"__",symbols:["__$ebnf$1"],postprocess:function(ae){return null}},{name:"wschar",symbols:[/[ \t\n\v\f]/],postprocess:M},{name:"Struct",symbols:["TYPE","__","Identifier","_","EQUALS","_","Union","SEPARATOR"],postprocess:j},{name:"Struct",symbols:["TYPE","__","Identifier","_","EQUALS","_","NativeType","SEPARATOR"],postprocess:j},{name:"Union",symbols:["StructDefinition"],postprocess:M},{name:"Union",symbols:["StructDefinition","_","OR","_","Union"],postprocess:b(n.UnionType)},{name:"StructDefinition",symbols:["ArrayType"],postprocess:M},{name:"StructDefinition",symbols:["Identifier"],postprocess:M},{name:"StructDefinition",symbols:["LCB","_","StructBody","_","RCB"],postprocess:T(b(n.ObjectLiteral),f)},{name:"StructBody",symbols:["StructNameAndType"],postprocess:M},{name:"StructBody",symbols:["StructNameAndType","_","COMMA","_","StructBody"],postprocess:f},{name:"StructNameAndType",symbols:["Identifier","_","COLON","_","Type"],postprocess:b(n.Pair)},{name:"StructNameAndType",symbols:["AddressOf","_","COLON","_","Type"],postprocess:b(n.Pair)},{name:"AddressOf",symbols:["AND","Identifier"],postprocess:Et},{name:"TypeDef",symbols:["TYPE","__","Identifier","_","EQUALS","_","TypeDefinition","_","FATARROW","_","Type","_","SEPARATOR"],postprocess:T(V)},{name:"TypeDefinition",symbols:["LB","_","TypeList","_","RB"],postprocess:f},{name:"TypeDefinition",symbols:["LB","_","RB"],postprocess:f},{name:"TypeList",symbols:["Type"],postprocess:M},{name:"TypeList",symbols:["Type","_","COMMA","_","TypeList"],postprocess:f},{name:"_Type",symbols:["NativeType"],postprocess:M},{name:"_Type",symbols:["GenericType"],postprocess:M},{name:"_Type",symbols:["Identifier"],postprocess:M},{name:"ArrayType",symbols:["_Type","_","LSB","_","RSB"],postprocess:re},{name:"Type",symbols:["_Type"],postprocess:M},{name:"Type",symbols:["ArrayType"],postprocess:M},{name:"GenericType",symbols:["Identifier","LT","_","StaticObjectLiteral","_","GT"],postprocess:he},{name:"StaticObjectLiteral",symbols:["LCB","_","RCB"],postprocess:T(b(n.ObjectLiteral))},{name:"StaticObjectLiteral",symbols:["LCB","_","StaticPropertyList","_","RCB"],postprocess:T(b(n.ObjectLiteral),f)},{name:"StaticPropertyValue",symbols:["Number"],postprocess:M},{name:"StaticPropertyValue",symbols:["Boolean"],postprocess:M},{name:"StaticPropertyValue",symbols:["StringLiteral"],postprocess:M},{name:"StaticProperty",symbols:["Identifier","_","COLON","_","StaticPropertyValue"],postprocess:b(n.Pair)},{name:"StaticPropertyList",symbols:["StaticProperty"],postprocess:M},{name:"StaticPropertyList",symbols:["StaticProperty","_","COMMA","_","StaticPropertyList"],postprocess:f},{name:"ObjectLiteral",symbols:["LCB","_","RCB"],postprocess:b(n.ObjectLiteral)},{name:"ObjectLiteral",symbols:["LCB","_","PropertyList","_","RCB"],postprocess:T(b(n.ObjectLiteral),f)},{name:"PropertyList",symbols:["Property"],postprocess:M},{name:"PropertyList",symbols:["Property","_","COMMA","_","PropertyList"],postprocess:f},{name:"Property",symbols:["Identifier","_","COLON","_","Ternary"],postprocess:b(n.Pair)},{name:"Property",symbols:["SPREAD","Identifier"],postprocess:ct},{name:"Property",symbols:["Identifier"],postprocess:M},{name:"Import",symbols:["IMPORT","_","ImportDefinition","__","FROM","__","StringLiteral","_","SEPARATOR"],postprocess:b(n.Import)},{name:"ImportDefinition",symbols:["LCB","_","ImportAndTypeList","_","RCB"],postprocess:T(b(n.ObjectLiteral),f)},{name:"ImportAndTypeList",symbols:["ImportName"],postprocess:M},{name:"ImportAndTypeList",symbols:["ImportAndType"],postprocess:M},{name:"ImportAndTypeList",symbols:["ImportName","_","COMMA","_","ImportAndTypeList"],postprocess:f},{name:"ImportAndTypeList",symbols:["ImportAndType","_","COMMA","_","ImportAndTypeList"],postprocess:f},{name:"ImportAndType",symbols:["ImportName","_","COLON","_","Type"],postprocess:b(n.Pair)},{name:"ImportAndType",symbols:["ImportName","_","AS","_","Identifier"],postprocess:b(n.BinaryExpression,{value:"as"})},{name:"ImportAndType",symbols:["ImportAndType","_","AS","_","Identifier"],postprocess:b(n.BinaryExpression,{value:"as"})},{name:"ImportName",symbols:["Identifier"],postprocess:M},{name:"If",symbols:["IF","_","LB","_","Expression","_","RB","_","BranchBody"],postprocess:b(n.IfThenElse)},{name:"If",symbols:["IF","_","LB","_","Expression","_","RB","_","BranchBody","_","Else"],postprocess:b(n.IfThenElse)},{name:"Else",symbols:["ELSE","_","BranchBody"],postprocess:b(n.Else)},{name:"BranchBody",symbols:["Statement"],postprocess:M},{name:"BranchBody",symbols:["Block"],postprocess:M},{name:"For",symbols:["FOR","_","LB","_","ForArg","_","SEPARATOR","_","Expression","_","SEPARATOR","_","ForArg","_","RB","_","BranchBody"],postprocess:ve},{name:"ForArg",symbols:["_Assignment"],postprocess:M},{name:"ForArg",symbols:["Ternary"],postprocess:M},{name:"While",symbols:["WHILE","_","LB","_","Expression","_","RB","_","BranchBody"],postprocess:Te},{name:"Break",symbols:["BREAK","_","SEPARATOR"],postprocess:b(n.Break)},{name:"Program",symbols:["_"],postprocess:T(b("Program",{value:"ROOT_NODE"}),f)},{name:"Program",symbols:["_","SourceElementList","_"],postprocess:T(b("Program",{value:"ROOT_NODE"}),f)},{name:"SourceElementList",symbols:["SourceElement"],postprocess:f},{name:"SourceElementList",symbols:["SourceElement","_","SourceElementList"],postprocess:T(a,f,f)},{name:"SourceElement",symbols:["Function"],postprocess:M},{name:"SourceElement",symbols:["GlobalDeclaration"],postprocess:M},{name:"SourceElement",symbols:["GlobalImmutableDeclaration"],postprocess:M},{name:"SourceElement",symbols:["StaticDeclaration"],postprocess:M},{name:"SourceElement",symbols:["Struct"],postprocess:M},{name:"SourceElement",symbols:["TypeDef"],postprocess:M},{name:"SourceElement",symbols:["Export"],postprocess:M},{name:"SourceElement",symbols:["Import"],postprocess:M},{name:"Statement",symbols:["ExpressionStatement"],postprocess:M},{name:"Statement",symbols:["Declaration"],postprocess:M},{name:"Statement",symbols:["ImmutableDeclaration"],postprocess:M},{name:"Statement",symbols:["Assignment"],postprocess:M},{name:"Statement",symbols:["If"],postprocess:M},{name:"Statement",symbols:["For"],postprocess:M},{name:"Statement",symbols:["While"],postprocess:M},{name:"Statement",symbols:["Break"],postprocess:M},{name:"Statement",symbols:["Unreachable"],postprocess:M},{name:"Statement",symbols:["ReturnStatement"],postprocess:M},{name:"Block",symbols:["LCB","_","RCB"],postprocess:b(n.Block)},{name:"Block",symbols:["LCB","_","StatementList","_","RCB"],postprocess:T(b(n.Block),f)},{name:"StatementList",symbols:["Statement"],postprocess:a},{name:"StatementList",symbols:["Statement","_","StatementList"],postprocess:f},{name:"Function",symbols:["FUNCTION","__","Identifier","_","FunctionParameters","_","Block"],postprocess:X},{name:"Function",symbols:["FUNCTION","__","Identifier","_","FunctionParameters","_","FunctionResult","_","Block"],postprocess:Oe},{name:"FunctionParameters",symbols:["LB","_","RB"],postprocess:b(n.FunctionArguments)},{name:"FunctionParameters",symbols:["LB","_","ParameterList","_","RB"],postprocess:T(b(n.FunctionArguments),f,f)},{name:"ParameterList",symbols:["NameAndType"],postprocess:M},{name:"ParameterList",symbols:["NameAndType","_","COMMA","_","ParameterList"],postprocess:f},{name:"NameAndType",symbols:["Identifier","_","COLON","_","DeclType"],postprocess:b(n.Pair)},{name:"DeclType",symbols:["Type"],postprocess:T(r({Type:n.DeclType}),l(0))},{name:"FunctionResult",symbols:["COLON","_","Type"],postprocess:T(k,a)},{name:"GlobalDeclaration",symbols:["LET","_","NameAndType","_","SEPARATOR"],postprocess:pe(n.Declaration)},{name:"GlobalDeclaration",symbols:["LET","_","NameAndType","_","EQUALS","_","Atom","_","SEPARATOR"],postprocess:pe(n.Declaration)},{name:"GlobalImmutableDeclaration",symbols:["CONST","_","Identifier","_","COLON","_","GenericType","_","SEPARATOR"],postprocess:St},{name:"GlobalImmutableDeclaration",symbols:["CONST","_","NameAndType","_","EQUALS","_","ObjectLiteral","_","SEPARATOR"],postprocess:pe(n.ImmutableDeclaration)},{name:"GlobalImmutableDeclaration",symbols:["CONST","_","NameAndType","_","EQUALS","_","Atom","_","SEPARATOR"],postprocess:pe(n.ImmutableDeclaration)},{name:"Declaration",symbols:["LET","_","NameAndType","_","EQUALS","_","Expression","_","SEPARATOR"],postprocess:pe(n.Declaration)},{name:"Declaration",symbols:["LET","_","NameAndType","_","SEPARATOR"],postprocess:pe(n.Declaration)},{name:"ImmutableDeclaration",symbols:["CONST","_","NameAndType","_","EQUALS","_","Expression","_","SEPARATOR"],postprocess:pe(n.ImmutableDeclaration)},{name:"ImmutableDeclaration",symbols:["CONST","_","NameAndType","_","EQUALS","_","ObjectLiteral","_","SEPARATOR"],postprocess:pe(n.ImmutableDeclaration)},{name:"ImmutableDeclaration",symbols:["CONST","_","Identifier","_","COLON","_","GenericType","_","SEPARATOR"],postprocess:St},{name:"StaticNameAndType",symbols:["Identifier","_","COLON","_","ArrayType"],postprocess:b(n.Pair)},{name:"StaticDeclaration",symbols:["CONST","_","StaticNameAndType","_","EQUALS","_","LSB","_","RSB","_","SEPARATOR"],postprocess:pe(n.StaticDeclaration)},{name:"StaticDeclaration",symbols:["CONST","_","StaticNameAndType","_","EQUALS","_","LSB","_","StaticValueList","_","RSB","_","SEPARATOR"],postprocess:T(pe(n.StaticDeclaration),f)},{name:"StaticValueList",symbols:["Atom"],postprocess:M},{name:"StaticValueList",symbols:["Atom","_","COMMA","_","StaticValueList"],postprocess:f},{name:"Unreachable",symbols:["THROW","_","SEPARATOR"],postprocess:b(n.Unreachable)},{name:"Unreachable",symbols:["THROW","_","Expression","_","SEPARATOR"],postprocess:b(n.Unreachable)},{name:"Pair",symbols:["Identifier","_","COLON","_","Identifier"],postprocess:b(n.Pair)},{name:"Export",symbols:["EXPORT","__","ImmutableDeclaration"],postprocess:b(n.Export,{value:"export"})},{name:"Export",symbols:["EXPORT","__","Function"],postprocess:b(n.Export,{value:"export"})},{name:"Export",symbols:["EXPORT","__","TypeDef"],postprocess:b(n.Export,{value:"export"})},{name:"Export",symbols:["EXPORT","__","Struct"],postprocess:b(n.Export,{value:"export"})},{name:"ReturnStatement",symbols:["RETURN","__","Expression","_","SEPARATOR"],postprocess:b(n.ReturnStatement)},{name:"ReturnStatement$subexpression$1",symbols:[{literal:";"}],postprocess:u},{name:"ReturnStatement",symbols:["RETURN","ReturnStatement$subexpression$1"],postprocess:b(n.ReturnStatement)},{name:"Assignment",symbols:["_Assignment","_","SEPARATOR"],postprocess:M},{name:"_Assignment",symbols:["Subscript","_","EQUALS","_","Expression"],postprocess:ae=>ie(ae,"=")},{name:"_Assignment",symbols:["Subscript","_","PLSEQUALS","_","Expression"],postprocess:ae=>ie(ae,"+=")},{name:"_Assignment",symbols:["Subscript","_","MINEQUALS","_","Expression"],postprocess:ae=>ie(ae,"-=")},{name:"_Assignment",symbols:["Subscript","_","EQUALS","_","ObjectLiteral"],postprocess:ae=>ie(ae,"=")},{name:"ExpressionStatement",symbols:["Call","_","SEPARATOR"],postprocess:M},{name:"Expression",symbols:["AssignmentExpression"],postprocess:M},{name:"AssignmentExpression",symbols:["Identifier","_","EQUALS","_","Ternary"],postprocess:ae=>We(ae,"=")},{name:"AssignmentExpression",symbols:["Identifier","_","PLSEQUALS","_","Ternary"],postprocess:ae=>We(ae,"+=")},{name:"AssignmentExpression",symbols:["Identifier","_","MINEQUALS","_","Ternary"],postprocess:ae=>We(ae,"-=")},{name:"AssignmentExpression",symbols:["Ternary"],postprocess:M},{name:"Ternary",symbols:["Ternary","_","QUESTION","_","TernaryPair"],postprocess:z},{name:"Ternary",symbols:["Binary"],postprocess:M},{name:"TernaryPair",symbols:["Expression","_","COLON","_","Expression"],postprocess:b(n.Pair)},{name:"Binary",symbols:["Logical"],postprocess:M},{name:"Logical",symbols:["Logical","_",{literal:"||"},"_","Bitwise"],postprocess:v},{name:"Logical",symbols:["Logical","_",{literal:"&&"},"_","Bitwise"],postprocess:v},{name:"Logical",symbols:["Bitwise"],postprocess:M},{name:"Bitwise",symbols:["Bitwise","_",{literal:"|"},"_","Sum"],postprocess:v},{name:"Bitwise",symbols:["Bitwise","_",{literal:"^"},"_","Sum"],postprocess:v},{name:"Bitwise",symbols:["Bitwise","_",{literal:"&"},"_","Sum"],postprocess:v},{name:"Bitwise",symbols:["Equality"],postprocess:M},{name:"Equality",symbols:["Equality","_",{literal:"=="},"_","Comparison"],postprocess:v},{name:"Equality",symbols:["Equality","_",{literal:"!="},"_","Comparison"],postprocess:v},{name:"Equality",symbols:["Comparison"],postprocess:M},{name:"Comparison",symbols:["Comparison","_",{literal:"<"},"_","Shift"],postprocess:v},{name:"Comparison",symbols:["Comparison","_",{literal:">"},"_","Shift"],postprocess:v},{name:"Comparison",symbols:["Comparison","_",{literal:"<="},"_","Shift"],postprocess:v},{name:"Comparison",symbols:["Comparison","_",{literal:">="},"_","Shift"],postprocess:v},{name:"Comparison",symbols:["Shift"],postprocess:M},{name:"Shift",symbols:["Shift","_",{literal:">>"},"_","Sum"],postprocess:v},{name:"Shift",symbols:["Shift","_",{literal:"<<"},"_","Sum"],postprocess:v},{name:"Shift",symbols:["Shift","_",{literal:">>>"},"_","Sum"],postprocess:v},{name:"Shift",symbols:["Sum"],postprocess:M},{name:"Sum",symbols:["Sum","_",{literal:"+"},"_","Product"],postprocess:v},{name:"Sum",symbols:["Sum","_",{literal:"-"},"_","Product"],postprocess:v},{name:"Sum",symbols:["Product"],postprocess:M},{name:"Product",symbols:["Product","_",{literal:"*"},"_","Typecast"],postprocess:v},{name:"Product",symbols:["Product","_",{literal:"/"},"_","Typecast"],postprocess:v},{name:"Product",symbols:["Product","_",{literal:"%"},"_","Typecast"],postprocess:v},{name:"Product",symbols:["Typecast"],postprocess:M},{name:"Typecast",symbols:["Expression","_","COLON","_","DeclType"],postprocess:b(n.Pair)},{name:"Typecast",symbols:["Expression","_","AS","_","DeclType"],postprocess:b(n.Pair)},{name:"Typecast",symbols:["Unary"],postprocess:M},{name:"Unary",symbols:[{literal:"!"},"Call"],postprocess:U},{name:"Unary",symbols:[{literal:"~"},"Call"],postprocess:U},{name:"Unary",symbols:[{literal:"-"},"Call"],postprocess:U},{name:"Unary",symbols:[{literal:"+"},"Call"],postprocess:U},{name:"Unary",symbols:[{literal:"++"},"Call"],postprocess:U},{name:"Unary",symbols:[{literal:"--"},"Call"],postprocess:U},{name:"Unary",symbols:["Call"],postprocess:M},{name:"Call",symbols:["Subscript","_","LB","_","ArgumentList","_","RB"],postprocess:T(O,f)},{name:"Call",symbols:["Subscript","_","LB","_","RB"],postprocess:O},{name:"Call",symbols:["Subscript"],postprocess:M},{name:"ArgumentList",symbols:["Expression"],postprocess:M},{name:"ArgumentList",symbols:["NativeType"],postprocess:M},{name:"ArgumentList",symbols:["Expression","_","COMMA","_","ArgumentList"],postprocess:f},{name:"Subscript",symbols:["Access","LSB","_","Expression","_","RSB","Subscript"],postprocess:Z},{name:"Subscript",symbols:["Access","LSB","_","Expression","_","RSB"],postprocess:Z},{name:"Subscript",symbols:["Access"],postprocess:M},{name:"Access",symbols:["Access","DOT","Identifier"],postprocess:T(K,a)},{name:"Access",symbols:["NativeType","DOT","Access"],postprocess:T(K,a)},{name:"Access",symbols:["Grouping"],postprocess:M},{name:"Grouping",symbols:["LB","_","Expression","_","RB"],postprocess:l(2)},{name:"Grouping",symbols:["Atom"],postprocess:M},{name:"Atom",symbols:["Identifier"],postprocess:M},{name:"Atom",symbols:["StringLiteral"],postprocess:M},{name:"Atom",symbols:["CharacterLiteral"],postprocess:M},{name:"Atom",symbols:["Number"],postprocess:M},{name:"NativeType",symbols:[o.has("type")?{type:"type"}:ne],postprocess:ne},{name:"Identifier",symbols:[o.has("identifier")?{type:"identifier"}:P],postprocess:P},{name:"Number",symbols:[o.has("number")?{type:"number"}:number],postprocess:w},{name:"StringLiteral",symbols:[o.has("string")?{type:"string"}:q],postprocess:q},{name:"CharacterLiteral",symbols:[o.has("char")?{type:"char"}:W],postprocess:W},{name:"word",symbols:[/[a-zA-Z_]/],postprocess:M},{name:"word",symbols:["word",/[a-zA-Z0-9_]/],postprocess:d},{name:"digit",symbols:[/[0-9]/],postprocess:M},{name:"digit",symbols:["digit",/[0-9]/],postprocess:d},{name:"SEPARATOR",symbols:["_",{literal:";"}],postprocess:u},{name:"QUESTION",symbols:[{literal:"?"}],postprocess:u},{name:"COMMA",symbols:[{literal:","}],postprocess:u},{name:"AND",symbols:[{literal:"&"}],postprocess:u},{name:"DOT",symbols:[{literal:"."}],postprocess:u},{name:"LB",symbols:[{literal:"("}],postprocess:u},{name:"RB",symbols:[{literal:")"}],postprocess:u},{name:"LSB",symbols:[{literal:"["}],postprocess:u},{name:"RSB",symbols:[{literal:"]"}],postprocess:u},{name:"LCB",symbols:[{literal:"{"}],postprocess:u},{name:"RCB",symbols:[{literal:"}"}],postprocess:u},{name:"OR",symbols:[{literal:"|"}],postprocess:u},{name:"COLON",symbols:[{literal:":"}],postprocess:u},{name:"EQUALS",symbols:[{literal:"="}],postprocess:u},{name:"PLSEQUALS",symbols:[{literal:"+="}],postprocess:u},{name:"MINEQUALS",symbols:[{literal:"-="}],postprocess:u},{name:"GT",symbols:[{literal:">"}],postprocess:u},{name:"LT",symbols:[{literal:"<"}],postprocess:u},{name:"FATARROW",symbols:[{literal:"=>"}],postprocess:u},{name:"SPREAD",symbols:[{literal:"..."}],postprocess:u},{name:"FUNCTION",symbols:[{literal:"function"}],postprocess:u},{name:"LET",symbols:[{literal:"let"}],postprocess:u},{name:"CONST",symbols:[{literal:"const"}],postprocess:u},{name:"EXPORT",symbols:[{literal:"export"}],postprocess:u},{name:"IMPORT",symbols:[{literal:"import"}],postprocess:u},{name:"AS",symbols:[{literal:"as"}],postprocess:u},{name:"FROM",symbols:[{literal:"from"}],postprocess:u},{name:"RETURN",symbols:[{literal:"return"}],postprocess:u},{name:"TYPE",symbols:[{literal:"type"}],postprocess:u},{name:"IF",symbols:[{literal:"if"}],postprocess:u},{name:"ELSE",symbols:[{literal:"else"}],postprocess:u},{name:"FOR",symbols:[{literal:"for"}],postprocess:u},{name:"WHILE",symbols:[{literal:"while"}],postprocess:u},{name:"SWITCH",symbols:[{literal:"switch"}],postprocess:u},{name:"DO",symbols:[{literal:"do"}],postprocess:u},{name:"THROW",symbols:[{literal:"throw"}],postprocess:u},{name:"BREAK",symbols:[{literal:"break"}],postprocess:u}],ParserStart:"Program"}}function ur(o){return o[0]}function pr(){let o=this.Syntax,{flatten:n}=this.helpers,{node:r}=this.nodes(this.lexer);return{Lexer:void 0,ParserRules:[{name:"TypeList",symbols:["DefaultArgument"],postprocess:ur},{name:"TypeList",symbols:["DefaultArgument","_","COMMA","_","TypeList"],postprocess:n},{name:"DefaultArgument",symbols:["Type","_","EQUALS","_","Atom"],postprocess:r(o.Assignment)},{name:"ParameterList",symbols:["DefaultFunctionArgument"],postprocess:ur},{name:"ParameterList",symbols:["DefaultFunctionArgument","_","COMMA","_","ParameterList"],postprocess:n},{name:"DefaultFunctionArgument",symbols:["NameAndType","_","EQUALS","_","Atom"],postprocess:r(o.Assignment)}],ParserStart:"TypeList"}}var fr=ee(function(o){(function(n,r){o.exports?o.exports=r():n.nearley=r()})(fe,function(){function n(d,f,T){return this.id=++n.highestId,this.name=d,this.symbols=f,this.postprocess=T,this}n.highestId=0,n.prototype.toString=function(d){function f(b){return b.literal?JSON.stringify(b.literal):b.type?"%"+b.type:b.toString()}var T=typeof d>"u"?this.symbols.map(f).join(" "):this.symbols.slice(0,d).map(f).join(" ")+" \u25CF "+this.symbols.slice(d).map(f).join(" ");return this.name+" \u2192 "+T};function r(d,f,T,b){this.rule=d,this.dot=f,this.reference=T,this.data=[],this.wantedBy=b,this.isComplete=this.dot===d.symbols.length}r.prototype.toString=function(){return"{"+this.rule.toString(this.dot)+"}, from: "+(this.reference||0)},r.prototype.nextState=function(d){var f=new r(this.rule,this.dot+1,this.reference,this.wantedBy);return f.left=this,f.right=d,f.isComplete&&(f.data=f.build()),f},r.prototype.build=function(){var d=[],f=this;do d.push(f.right.data),f=f.left;while(f.left);return d.reverse(),d},r.prototype.finish=function(){this.rule.postprocess&&(this.data=this.rule.postprocess(this.data,this.reference,h.fail))};function a(d,f){this.grammar=d,this.index=f,this.states=[],this.wants={},this.scannable=[],this.completed={}}a.prototype.process=function(d){for(var f=this.states,T=this.wants,b=this.completed,v=0;v<f.length;v++){var w=f[v];if(w.isComplete){if(w.finish(),w.data!==h.fail){for(var P=w.wantedBy,B=P.length;B--;){var U=P[B];this.complete(U,w)}if(w.reference===this.index){var z=w.rule.name;(this.completed[z]=this.completed[z]||[]).push(w)}}}else{var z=w.rule.symbols[w.dot];if(typeof z!="string"){this.scannable.push(w);continue}if(T[z]){if(T[z].push(w),b.hasOwnProperty(z))for(var Z=b[z],B=0;B<Z.length;B++){var K=Z[B];this.complete(w,K)}}else T[z]=[w],this.predict(z)}}},a.prototype.predict=function(d){for(var f=this.grammar.byName[d]||[],T=0;T<f.length;T++){var b=f[T],v=this.wants[d],w=new r(b,0,this.index,v);this.states.push(w)}},a.prototype.complete=function(d,f){var T=d.nextState(f);this.states.push(T)};function l(d,f){this.rules=d,this.start=f||this.rules[0].name;var T=this.byName={};this.rules.forEach(function(b){T.hasOwnProperty(b.name)||(T[b.name]=[]),T[b.name].push(b)})}l.fromCompiled=function(b,f){var T=b.Lexer;b.ParserStart&&(f=b.ParserStart,b=b.ParserRules);var b=b.map(function(w){return new n(w.name,w.symbols,w.postprocess)}),v=new l(b,f);return v.lexer=T,v};function u(){this.reset("")}u.prototype.reset=function(d,f){this.buffer=d,this.index=0,this.line=f?f.line:1,this.lastLineBreak=f?-f.col:0},u.prototype.next=function(){if(this.index<this.buffer.length){var d=this.buffer[this.index++];return d==="\n"&&(this.line+=1,this.lastLineBreak=this.index),{value:d}}},u.prototype.save=function(){return{line:this.line,col:this.index-this.lastLineBreak}},u.prototype.formatError=function(d,f){var T=this.buffer;if(typeof T=="string"){var b=T.indexOf("\n",this.index);b===-1&&(b=T.length);var v=T.substring(this.lastLineBreak,b),w=this.index-this.lastLineBreak;return f+=" at line "+this.line+" col "+w+":\n\n",f+="  "+v+"\n",f+="  "+Array(w).join(" ")+"^",f}else return f+" at index "+(this.index-1)};function h(d,f,T){if(d instanceof l)var b=d,T=f;else var b=l.fromCompiled(d,f);this.grammar=b,this.options={keepHistory:!1,lexer:b.lexer||new u};for(var v in T||{})this.options[v]=T[v];this.lexer=this.options.lexer,this.lexerState=void 0;var w=new a(b,0);this.table=[w],w.wants[b.start]=[],w.predict(b.start),w.process(),this.current=0}return h.fail={},h.prototype.feed=function(d){var f=this.lexer;f.reset(d,this.lexerState);for(var T;T=f.next();){var b=this.table[this.current];this.options.keepHistory||delete this.table[this.current-1];var v=this.current+1,w=new a(this.grammar,v);this.table.push(w);for(var P=T.text!==void 0?T.text:T.value,B=f.constructor===u?T.value:T,U=b.scannable,z=U.length;z--;){var Z=U[z],K=Z.rule.symbols[Z.dot];if(K.test?K.test(B):K.type?K.type===T.type:K.literal===P){var Oe=Z.nextState({data:B,token:T,isToken:!0,reference:v-1});w.states.push(Oe)}}if(w.process(),w.states.length===0){var pe=this.lexer.formatError(T,"invalid syntax")+"\n";pe+="Unexpected "+(T.type?T.type+" token: ":""),pe+=JSON.stringify(T.value!==void 0?T.value:T)+"\n";var O=new Error(pe);throw O.offset=this.current,O.token=T,O}this.options.keepHistory&&(b.lexerState=f.save()),this.current++}return b&&(this.lexerState=f.save()),this.results=this.finish(),this},h.prototype.save=function(){var d=this.table[this.current];return d.lexerState=this.lexerState,d},h.prototype.restore=function(d){var f=d.index;this.current=f,this.table[f]=d,this.table.splice(f+1),this.lexerState=d.lexerState,this.results=this.finish()},h.prototype.rewind=function(d){if(!this.options.keepHistory)throw new Error("set option `keepHistory` to enable rewinding");this.restore(this.table[d])},h.prototype.finish=function(){var d=[],f=this.grammar.start,T=this.table[this.table.length-1];return T.states.forEach(function(b){b.rule.name===f&&b.dot===b.rule.symbols.length&&b.reference===0&&b.data!==h.fail&&d.push(b)}),d.map(function(b){return b.data})},{Parser:h,Grammar:l,Rule:n}})}),co=fr.Parser,lo=fr.Grammar,uo=(...o)=>o.reduce((n,r)=>(...a)=>n(r(...a))),I=Object.assign||function(o){for(var n=1;n<arguments.length;n++){var r=arguments[n];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(o[a]=r[a])}return o},po=function(o,n){var r={};for(var a in o)n.indexOf(a)>=0||Object.prototype.hasOwnProperty.call(o,a)&&(r[a]=o[a]);return r};let Q=Lt((o,n)=>{let{meta:r}=o,a=po(o,["meta"]);return I({},n,{meta:I({},n.meta,r)},a)}),fo=o=>n=>n[o],mo=()=>null,Ze=o=>Array.isArray(o)?!!o.length:o!=null,ho=o=>"".concat(o[0]).concat(o[1]),yo=o=>o.reduce((n,r)=>(Array.isArray(r),n.concat(r)),[]),ge=o=>o.filter(Ze);var _o={nth:fo,nuller:mo,nonEmpty:Ze,add:ho,flatten:yo,compose:uo,drop:ge,extendNode:Q};let bo=o=>{let{col:n,line:r}=o;return o.lines.length?{col:n,line:r,sourceLine:o.lines[o.line-1]}:{col:n,line:r,sourceLine:""}};function go(o){let n=(l,u={})=>h=>{let d=h.filter(Ze),{value:f="",meta:T={}}=u,b=bo(o),v=d[d.length-1]&&d[d.length-1].range?d[d.length-1].range[1]:I({},b,{col:b.col+f.length});return{value:f,type:null,Type:l,toString(){},meta:T,range:[b,v],params:d}},r=l=>{let[u,h,d]=l.filter(Ze),f=y.BinaryExpression;return(h.value==="||"||h.value==="&&")&&(f=y.Select),n(f,{value:h.value})([u,d])},a=l=>{let[u]=ge(l);return Q({type:u!=null&&u.value!=="void"?u.value:null},n(y.FunctionResult)(l))};return{node:n,binary:r,constant:l=>{let u=l[0].value;return Q({value:"".concat(u),type:u.toString().indexOf(".")!==-1?"f32":"i32"},n(y.Constant)([]))},identifier:l=>n("Identifier",{value:l.join("")})([]),unary:([l,u])=>{let h=[u];return l.value==="-"&&(h=[I({},u,{value:"0",Type:y.Constant,params:[],meta:{}}),u]),Q({value:l.value,params:h},n(y.UnaryExpression)([l,u]))},ternary:l=>Q({value:"?"},n(y.TernaryExpression)(l)),subscript:l=>{let[u,h]=l.filter(Ze);return Q({value:u.value,params:[u,h]},n(y.ArraySubscript)([u,h]))},access(l){return Q({value:l[0].value+"."+l[1].value},n(y.Access)(l))},fun:l=>{let[u,h,d,f]=l.filter(Ze);return I({},u,{Type:y.FunctionDeclaration,meta:[],params:[h,d,f]})},declaration:l=>u=>{let[h,...d]=ge(u),[f,T]=h.params;return Q({value:f.value,type:T.value},n(l)(d))},call:l=>{let[u,...h]=ge(l);return Q({value:u.value},n(y.FunctionCall)([u,...h]))},struct:l=>{let[u,...h]=ge(l);return Q({value:u.value},n(y.Struct)(h))},result:a,string:l=>Q({value:l[0].value,type:"i32"},n(y.StringLiteral)([])),char(l){return Q({value:l[0].value,type:"i32"},n(y.CharacterLiteral)([]))},type(l){return Q({value:l[0].value,type:l[0].value,params:[]},n(y.Type)(l))},arrayType(l){let h=ge(l)[0];return Q({value:h.value+"[]",type:h.type+"[]",params:[]},n(y.ArrayType)(l))},typeGeneric(l){let[u,h]=ge(l);return Q({value:u.value,type:u.value,params:[h]},n(y.Type)(l))},typedef:l=>{let[u,h,d]=ge(l);return Q({value:u.value,params:[n(y.FunctionArguments)(h),Q({type:d.value},n(y.FunctionResult)([d]))],type:d.type},n(y.Typedef)([u,h,a]))},voidFun:l=>{let u=ge(l),[h,d,f]=u,T=Q({type:null},n(y.FunctionResult)([]));return Q({value:h.value,params:[d,T,f]},n(y.FunctionDeclaration)(u))},assignment(l,u){if(["-=","+="].includes(u)){let h=u[0],[d,f]=ge(l),T=r([d,{value:h},f]);return n(y.Assignment,{value:"="})([d,T])}return n(y.Assignment,{value:u})(l)},assignmentExpr(l,u){if(["-=","+="].includes(u)){let h=u[0],[d,f]=ge(l),T=r([d,{value:h},f]);return n(y.AssignmentExpression,{value:"="})([d,T])}return n(y.AssignmentExpression,{value:u})(l)},forLoop(l){let[u,h,d,...f]=ge(l);return n(y.Loop)([u,h,...f,d])},whileLoop(l){let u=n(y.Noop)([]);return n(y.Loop)([u,...l])},spread(l){return n(y.Spread)(l)},builtinDecl(l){let[u,h]=ge(l);return Q({value:u.value,type:h.value,params:[h]},n(y.ImmutableDeclaration)(l))},addressOf(l){let[u]=ge(l);return Q({value:u.value,params:[]},n("AddressOf")(l))}}}function vo(){let o=to.compile(_e);return{current:null,lines:[],get line(){return o.line},get col(){return o.col},save(){return o.save()},reset(n,r){return this.lines=n.split("\n"),o.reset(n,r)},next(){let n=o.next();for(;n&&n.type==="comment";)n=o.next();return this.current=n,this.current},formatError(n){return o.formatError(n)},has(n){return o.has(n)}}}var mn=Lt(function(o,n){let r=[ao,pr,...o],a={lexer:vo(),nodes:go,helpers:_o,Syntax:y},l=r.slice(1).reduce((h,d)=>{let f=d.call(a);return I({},h,{ParserRules:h.ParserRules.concat(f.ParserRules)})},r[0].call(a)),u=new co(lo.fromCompiled(l));return u.feed(n),L(u.results.length===1,"PANIC - Ambiguous Syntax! Number of productions (".concat(u.results.length,")")),u.results[0]});let To=o=>{let n,r=o.reduce((a,l)=>l(u=>a(u,n)),([a])=>a);return(a,l)=>(n=l,r(a,n))},So=o=>{let n=[],r=o.reduce((a,l)=>(Object.entries(l).forEach(([u,h])=>{if(u==="*"){n.push(h);return}a[u]==null&&(a[u]=[...n]),a[u].push(h)}),a),{});return Object.entries(r).reduce((a,[l,u])=>(a[l]=To(u),a),{})},mr=Symbol("scope namespace"),hr=Symbol("signature");function Eo(o,n){return[...o,{[mr]:n,[hr]:{result:null,arguments:null}}]}function xo(o){return o.slice(0,-1)}function dr(o){return o[o.length-1]}function Ao(o,n,r){let a=dr(o);return a&&(a[n]=r),a}function wo(o,n){let a=o.length-1;for(a;a>=0;a--){let l=o[a][n];if(l)return l}return null}function Co(o,n){let r=Object.keys(o).indexOf(n);return r>-1?r:Object.keys(o).length}var $o={enter:Eo,exit:xo,add:Ao,find:wo,current:dr,index:Co,namespace:mr,signature:hr};let{enter:Oo,exit:Lo,add:No,find:Po,current:Io,namespace:Ro,signature:Bo,index:Mo}=$o;var ke={enter:Oo,exit:Lo,add:No,find:Po,current:Io,namespace:Ro,index:Mo,signature:Bo},yr=ke.enter,Fo=ke.exit,Ye=ke.current,et=ke.find,Uo=ke.add,_r=ke.index,br=ke.namespace,tt=ke.signature;let Re="function/index",Nt="LOCAL_INDEX",Be="global/index",Pt="type/const",bt="TYPE_INDEX",Do="OBJECT_SIZE",hn="type/cast",dn="AST_METADATA",yn="FUNCTION_METADATA",ze=o=>{switch(o){case"i32":case"bool":return 0;case"i64":return 1;case"f32":return 2;case"f64":return 3;default:return-1}},_n=o=>{let n=o.params.reduce((a,{type:l})=>ze(a)<ze(l)?l:a,o.type),r=o.params.map(a=>a.type!=null&&ze(a.type)!==ze(n)?a.Type===y.Constant?Q({type:n},a):Q({type:n,value:a.value,Type:y.TypeCast,meta:{[hn]:{to:n,from:a.type}},params:[a]},a):a);return I({},o,{params:r,type:n})};function jo(){return{semantics(){let o=n=>([r,a])=>{let l=Ye(a.scopes),u=_r(l,r.value);return l[r.value]=Q({params:r.params.map(Q({type:r.type})),meta:I({},r.meta,{[l[br]]:u,[Pt]:r.Type===y.ImmutableDeclaration}),Type:y.Declaration},r),n([l[r.value],a])};return{[y.Export]:n=>([r,a])=>{let l=n([r,a]),[u]=l.params;return a.exports[u.value]=u,l},[y.Declaration]:o,[y.ImmutableDeclaration]:o,[y.Select]:n=>([r,a],l)=>_n(I({},r,{params:r.params.map(u=>l([u,a]))})),[y.BinaryExpression]:n=>([r,a],l)=>_n(I({},r,{params:r.params.map(u=>l([u,a]))})),[y.Pair]:n=>(r,a)=>{let[l,u]=r,h=l.params.map(v=>a([v,u])),[d,f]=h,{type:T}=d,{value:b}=f;return I({},l,{type:b,value:d.value,Type:y.TypeCast,meta:I({},l.meta,{[hn]:{to:b,from:T}}),params:[d]})},[y.Identifier]:n=>r=>{let[a,l]=r,u=et(l.scopes,a.value);return u?I({},a,{meta:I({},a.meta,u.meta),type:u.type}):a.value==="null"?I({},a,{value:"0",type:"i32",Type:y.Constant}):n(r)},[y.TernaryExpression]:n=>([r,a])=>n([_n(I({},r,{params:[...r.params[1].params,r.params[0]]})),a])}}}}function ko(){return{semantics(){return{"*":o=>function([n,...r],a){return I({},n,{params:n.params.map(u=>a([u,...r]))})}}}}}function zo(){return{semantics(){return{[y.Typedef]:o=>([n])=>n,[y.Program]:o=>n=>{let[r,a]=n,{types:l}=a,u=$({[y.Export]:(h,d)=>{let[f]=h.params;return f!=null&&[y.Typedef,y.Struct].includes(f.Type)?d(I({},f,{meta:I({},f.meta,{EXPORTED:!0})})):h},[y.Typedef]:(h,d)=>{let f=0,[T]=h.params,b=[];D({Assignment(w){let P=w.params[1];b.push(P)},Type(){f+=1}})(T);let v=I({},h,{meta:I({},h.meta,{FUNCTION_METADATA:{argumentsCount:f},DEFAULT_ARGUMENTS:b})});return l[h.value]=v,v}})(r);return o([u,a])}}}}}let Go={i64:63,f64:63,i32:31,f32:31},Yo={i64:"0xffffffffffff",f64:"0xffffffffffff",i32:"0xffffff",f32:"0xffffff"};function qo(){return{semantics({stmt:o}){return{[y.UnaryExpression]:n=>(r,a)=>{let[l,u]=r,[h,d]=l.params.map(f=>a([f,u]));switch(l.value){case"!":let f=Go[h.type];return a([o(Ms||(Ms=de(["((("," >> ",") | ((~"," + 1) >> ",")) + 1);"])),h,f,h,f),u]);case"~":let T=Yo[a([h,u]).type];return a([o(Fs||(Fs=de(["("," ^ ",");"])),h,T),u]);case"-":if(d.Type===y.Constant)return I({},d,{meta:I({},d.meta,{SIGN:-1})});default:return a([I({},l,{type:d.type,params:[I({},h,{type:d.type}),d],Type:y.BinaryExpression}),u])}}}}}}function Wo(){return{semantics(){return{[y.FunctionDeclaration]:o=>([n,r],a)=>{r.scopes=yr(r.scopes,Nt);let l=Ye(r.scopes),[u,h,d]=n.params,[f,T]=[u,h].map(v=>a([v,r])),b=I({},n,{type:l[tt].result,meta:I({},n.meta,{[Re]:Object.keys(r.functions).length,[yn]:{argumentsCount:l[tt].arguments.length,locals:Ye(r.scopes)}})});return r.functions[n.value]=b,b.params=[f,T,a([d,r])],r.scopes=Fo(r.scopes),b},[y.FunctionResult]:o=>([n,r])=>{let a=Ye(r.scopes);return a[tt].result=n.type,n},[y.FunctionArguments]:o=>([n,r],a)=>{let l=Ye(r.scopes);return l[tt].arguments=[],$({[y.Pair]:(h,d)=>{let[f,T]=h.params,b=a([T,r]);return l[tt].arguments.push(h),a([I({},h,{value:f.value,type:b.value,params:[],Type:y.Declaration}),r]),I({},h,{params:[f,b]})}})(I({},n,{params:n.params.filter(Boolean)}))},[y.FunctionCall]:o=>([n,r])=>{let{functions:a}=r,l=Object.keys(a).indexOf(n.value);return o([I({},n,{type:a[n.value]!=null?a[n.value].type:null,meta:{[Re]:l},params:n.params.slice(1)}),r])},[y.ReturnStatement]:o=>([n,r],a)=>{let l=Ye(r.scopes),[u]=n.params.map(f=>a([f,r])),{result:h}=l[tt];if(u!=null&&u.Type===y.Constant&&ze(u.type)!==ze(h))return I({},n,{type:h,params:[I({},u,{type:h})]});let d=u?u.type:null;return I({},n,{params:[u],type:d})}}}}}function Vo(){return{semantics:()=>({[y.Import]:o=>n=>{let[r,a]=n;return $({[y.BinaryExpression]:(l,u)=>{let[h,d]=l.params;if(h.Type!==y.Pair)return l;let[f,T]=h.params;return u(I({},h,{params:[I({},d,{meta:I({},f.meta,{AS:f.value})}),T]}))},[y.Pair]:(l,u)=>{let{types:h,functions:d}=a,[f,T]=l.params;if(h[T.value]!=null){let b=Object.keys(d).length,v=Object.keys(h).indexOf(T.value),w=I({},f,{id:f.value,type:h[T.value].type,meta:I({},f.meta,{[Re]:b,[bt]:v,FUNCTION_METADATA:h[T.value].meta.FUNCTION_METADATA,DEFAULT_ARGUMENTS:h[T.value].meta.DEFAULT_ARGUMENTS})});return d[f.value]=w,I({},l,{params:[w,h[T.value]]})}if(["Table","Memory"].includes(T.value)){let b=T.value==="Memory"?"memories":"tables";a[b].push(f)}else{let b=Ye(a.scopes),v=_r(b,f.value);Uo(a.scopes,f.value,I({},f,{meta:{[b[br]]:v,[Pt]:!0},type:T.type}))}return l}})(r)}})}}function Jo(){return{semantics(){let o=n=>([r,a])=>r.type==="bool"?n([I({},r,{type:"i32"}),a]):n([r,a]);return{[y.Identifier]:n=>(r,a)=>{let[l,u]=r;return l.value==="true"||l.value==="false"?a([I({},l,{Type:y.Constant,value:l.value==="true"?"1":"0",type:"i32"}),u]):n(r)},[y.FunctionResult]:n=>([r,a])=>r.type==="bool"?n([I({},r,{type:"i32"}),a]):n([r,a]),[y.Declaration]:o,[y.ImmutableDeclaration]:o}}}}function gr(o,n){let r=[null,n];return function(a){return r[0]=a,o(r)}}function Ho(o,n){let r={},a=0;for(a;a<o.length;a++)r[o[a]]=n[o[a]];return r}let Qo={i32:2,f32:2,i64:3,f64:3},Ko="i32";function Xo({stmt:o}){let n=u=>h=>{let[d,f]=h;if(!String(d.type).endsWith("[]"))return u(h);let T=Q({type:Ko,meta:{TYPE_ARRAY:d.type.slice(0,-2)}},d);return u([T,f])};function r(u,h){let d=Qo[u.meta.TYPE_ARRAY]||2;return h.Type!==y.Constant||Number(h.value)?o(Us||(Us=de(["("," + ("," << ","));"])),u,h,d):o(Ds||(Ds=de(["(",");"])),u)}function a(u){return!(u.type==null||u.index==null)}function l([u,h]){let d=u.meta.TYPE_ARRAY,f=r(u,h);return{type:d,index:f,TYPE_ARRAY:u.meta.TYPE_ARRAY}}return{[y.Declaration]:n,[y.ImmutableDeclaration]:n,[y.Identifier]:u=>h=>{let[d,f]=h,T=et(f.scopes,d.value);return T&&T.meta.TYPE_ARRAY?u([Q(Ho(["type","meta"],T),d),f]):u(h)},[y.Assignment]:u=>(h,d)=>{let[f,T]=h,[b,v]=f.params;if(b.Type!==y.ArraySubscript)return u(h);let w=gr(d,T),P=l(b.params.map(w)),{type:B,index:U}=P;return L(a(P),"PANIC - Cannot assign to subscript of ".concat(b.value)),w(o(js||(js=de(["",".store(",", ",");"])),B,U,v))},[y.ArraySubscript]:u=>(h,d)=>{let[f,T]=h,b=gr(d,T),v=l(f.params.map(b)),{type:w,index:P,TYPE_ARRAY:B}=v;return a(v)?Q({meta:{TYPE_ARRAY:B}},b(o(ks||(ks=de(["",".load(",");"])),w,P))):u(h)},[y.FunctionResult]:n}}function Zo(){return{semantics:Xo}}let ei=(o,n)=>{let r=o.memories[0];return r&&r.value===n.value};function ti(){return{semantics({stmt:o}){return{[y.ImmutableDeclaration]:n=>r=>{let[a,l]=r,{scopes:u,memories:h}=l;return!u.length<2&&a.type==="Memory"&&!h.length?(h.push(I({},a,{meta:I({},a.meta,{[Be]:-1})})),h[0]):n(r)},[y.FunctionCall]:n=>(r,a)=>{let[l,u]=r,[h,...d]=l.params,[f={},T={}]=h.params,v={dataSize:a([o(zs||(zs=de(["i32.load(0);"]))),u]),grow:I({},f,{value:"grow_memory",params:d.map(w=>a([w,u])),Type:y.NativeMethod}),size:I({},f,{value:"current_memory",params:[],Type:y.NativeMethod})}[T.value];return h.Type===y.Access&&ei(u,f)&&v?v:n(r)}}}}}let vr=o=>{let n=[];for(;;){let r=o&127;o=o>>7;let a=r&64;if(o===0&&!a||o===-1&&a){n.push(r);break}else n.push(r|128)}return n},ni=o=>{let n=[];for(;;){let r=o&127;if(o=o>>>7,o===0){n.push(r);break}n.push(r|128)}return n};let It=1,Rt=2,Bt=4,Mt=8,Ft=16,Ut=32,Tr=64,Dt=128,jt=256,kt=512,zt=1024,Gt=2048,bn=4096,Ee=4,ri={[It]:Ee,[Rt]:Ee*2,[Bt]:Ee,[Mt]:Ee*2,[Gt]:Ee,[zt]:Ee>>1,[jt]:Ee>>2,[Dt]:Ee>>2,[kt]:Ee>>1,[Ft]:Ee,[Ut]:Ee,[Tr]:Ee},se=!0;var Me={i32:It,i64:Rt,f32:Bt,f64:Mt,anyfunc:Ft,func:Ut,block_type:Tr,i8:Dt,u8:jt,i16:kt,u16:zt,u32:Gt,u64:bn,set:(o,n,r,a)=>{switch(o){case It:return r.setInt32(n,a,se);case Rt:return r.setInt64(n,a,se);case Bt:return r.setFloat32(n,a,se);case Mt:return r.setFloat64(n,a,se);case Ft:return r.setUint32(n,a,se);case Ut:return r.setUint32(n,a,se);case Dt:return r.setInt8(n,a,se);case jt:return r.setUint8(n,a,se);case kt:return r.setInt16(n,a,se);case zt:return r.setUint16(n,a,se);case Gt:return r.setUint32(n,a,se);case bn:return r.setUint64(n,a,se);default:return r.setUint8(n,a,se)}},get:(o,n,r)=>{switch(o){case It:return r.getInt32(n,se);case Rt:return r.getInt64(n,se);case Bt:return r.getFloat32(n,se);case Mt:return r.getFloat64(n,se);case Ft:return r.getUint32(n,se);case Ut:return r.getUint32(n,se);case Dt:return r.getInt8(n,se);case jt:return r.getUint8(n,se);case kt:return r.getInt16(n,se);case zt:return r.getUint16(n,se);case Gt:return r.getUint32(n,se);case bn:return r.getUint64(n,se);default:return r.getUint8(n,se)}},sizeof:ri},E=Me.i32,N=Me.i64,C=Me.f32,oe=Me.f64,ce=Me.u8,gn=Me.u32,Sr=Me.set,vn=Me.sizeof;class le{constructor(){this.data=[],this.size=0}push(n,r,a){let l=0;switch(n){case"varuint7":case"varuint32":case"varint7":case"varint1":{r=ni(r),l=r.length,L(l,"Cannot write a value of size ".concat(l));break}case"varint32":{r=vr(r),l=r.length,L(l,"Cannot write a value of size ".concat(l));break}case"varint64":{r=vr(r),l=r.length,L(l,"Cannot write a value of size ".concat(l));break}default:l=vn[n],L(l,"Cannot write a value of size ".concat(l,", type ").concat(n))}return this.data.push({type:n,value:r,debug:a}),this.size+=l,this}buffer(n=new ArrayBuffer(this.size)){let r=new DataView(n),a=0;return this.data.forEach(({type:l,value:u})=>{Array.isArray(u)?u.forEach(h=>Sr(ce,a++,r,h)):(Sr(l,a,r,u),a+=vn[l])}),n}write(n){return n&&(this.data=this.data.concat(n.data),this.size+=n.size),this}}function*si(o,n){let r=0,a=0,l=0,u=n;for(;;){let d=o.getUint8(u,!0);if(r|=(d&127)<<l,u+=1,!(d&128))break;l+=7}let h=0;for(;a<r;){for(h=0,l=0;;){let d=o.getUint8(u,!0);if(h|=(d&127)<<l,u+=1,!(d&128))break;l+=7}a+=1,yield h}}function Er(o){let n=new le,r=new le;r.push("varuint32",o.length,o);let a=0;for(a=0;a<o.length;a++)r.push("varuint32",o.codePointAt(a),o[a]);return n.write(r),n}let oi={"\\0":0,"\\a":7,"\\b":8,"\\t":9,"\\n":10,"\\v":11,"\\f":12,"\\r":13,"\\'":39},ii={i64:8,f64:8,i32:4,f32:4};function ai(o,n){let r=new le,a=Me[n];return o.forEach(l=>{r.push(a,l,String(l))}),r}function ci(){let o=0;return{semantics:({stmt:n})=>({[y.StaticDeclaration]:r=>([a,l],u)=>{let{userTypes:h,statics:d}=l,f=String(a.type).slice(0,-2),T=ii[f],b=a.params.reduce((w,P,B)=>{let U=u([P,l]);return w.OBJECT_SIZE+=T,w.TYPE_OBJECT[B]=B*T,w.OBJECT_KEY_TYPES[B]=f,w.VALUES.push(Number(U.value)),w},{OBJECT_SIZE:0,TYPE_OBJECT:{},OBJECT_KEY_TYPES:{},VALUES:[],STATIC:f}),v="__auto_gen_".concat(a.value,"_").concat(o);return o+=1,h[v]=I({},a,{value:v,Type:y.Type,meta:b,params:[]}),d[v]=ai(b.VALUES,f),u([I({},a,{meta:b,type:v,Type:y.ImmutableDeclaration,params:[I({},a.params[0],{value:v,Type:y.StaticValueList})]}),l])},[y.ArraySubscript]:r=>([a,l],u)=>{let[h,d]=a.params.map(T=>u([T,l]));if(!h.meta.STATIC)return r([a,l]);let f={i32:2,f32:2,i64:3,f64:3}[h.meta.STATIC];return u([n(Gs||(Gs=de(["",".load("," + ("," << ","));"])),h.meta.STATIC,h,d,f),l])},[y.CharacterLiteral]:r=>([a,l],u)=>{let h=oi[a.value]||a.value.codePointAt(0);return u([I({},a,{Type:"Constant",type:"i32",value:String(h)}),l])},[y.StringLiteral]:r=>a=>{let[l,u]=a,{statics:h}=u,{value:d}=l;return d in h||(h[d]=Er(d)),l}})}}function li(){return{semantics(){return{[y.ImmutableDeclaration]:o=>function(n){let[r,a]=n;return!a.locals&&r.type==="Table"?I({},r,{meta:I({},r.meta,{[Be]:-1})}):o(n)},[y.Identifier]:o=>function(n){let[r,a]=n,{functions:l,table:u,scopes:h}=a;return et(h,r.value)||!l[r.value]?o(n):(u[r.value]==null&&(u[r.value]=l[r.value]),I({},r,{type:"i32",meta:{[Re]:l[r.value].meta[Re]},value:Object.keys(u).indexOf(r.value),Type:y.FunctionPointer}))},[y.FunctionResult]:o=>(n,r)=>{let[a,l]=n,{types:u}=l;return u[a.type]?o([Q({type:"i32",meta:{ALIAS:a.type},params:a.params.map(h=>r([h,l]))},a),l]):o(n)},[y.FunctionCall]:o=>function(n,r){let[a,l]=n,{scopes:u,types:h}=l,d=et(u,a.value);if(!d)return o(n);let f=h[d.type],T=Object.keys(h).indexOf(d.type),b=[...a.params.slice(1),I({},d,{Type:y.Identifier})].map(v=>r([v,l]));return I({},a,{meta:I({},a.meta,d.meta,{[bt]:T}),type:f!=null?f.type:a.type,params:b,Type:y.IndirectFunctionCall})}}}}}let Yt="i32",ui={i64:8,f64:8,i32:4,f32:4,["__DIRECT_ADDRESS__"]:4},pi=o=>{let n={},r={},a=0;return D({[y.Pair]:l=>{let[u]=l.params,h=u.value,d=l.params[1].value;L(n[h]==null,"Duplicate key ".concat(h," not allowed in object type")),r[h]="".concat(u.Type==="AddressOf"?"&":"").concat(d),n[h]=a,a+=ui[d]||4}})(o),[n,a,r]},fi=o=>(n,r)=>{let a=o(Ys||(Ys=de(["throw;"]))),l={load:Q({range:r.range},o(qs||(qs=de(["i32.load(",", ",");"])),a,a)),store:U=>Q({range:r.range},o(Ws||(Ws=de(["i32.store(",", ",");"])),a,U)),offset:a,type:"void"};if(n.meta.STRUCT_TYPE==null)return l;let u=n.meta.STRUCT_TYPE,h=u.meta.TYPE_OBJECT,d=u.meta.OBJECT_KEY_TYPES,f=h[r.value];if(f==null)return l;let T=d[r.value],b=T[0]==="&",v=f?o(Vs||(Vs=de(["("," + ",");"])),n,f):o(Js||(Js=de(["(",");"])),n),w=null,P=null;T!=null&&typeof T=="object"&&(w=T,T=Yt),String(T).endsWith("[]")&&(P=T.slice(0,-2).replace("&",""),T="i32");let B=Q({range:n.range,meta:{STRUCT_TYPE:w,TYPE_ARRAY:P}});return{offset:v,type:T,store:U=>B(o(Hs||(Hs=de(["",".store(",", ",");"])),T,v,U)),load:B(b?v:o(Qs||(Qs=de(["",".load(",");"])),T,v))}};function mi(){return{semantics({stmt:o}){let n=fi(o);function r(l,u){let[h,d]=l,[f,T]=h.params,[b,v]=f.params,w=n(u([b,d]),v);return u([w.store(T),d])}function a(l,u){let[h,d]=l,[f,T]=h.params,b=u([f,d]),v=[];D({[y.Identifier]:(P,B)=>{let U=n(b,P);v.push({field:U,value:P})},[y.Pair]:(P,B)=>{let[U,z]=P.params,Z=n(b,U);v.push({field:Z,value:z})},[y.Spread]:(P,B)=>{let U=u([P.params[0],d]);Object.keys(U.meta.TYPE_OBJECT).forEach(z=>{let Z=n(b,{value:z,type:null,range:U.range}),K=n(U,{value:z,type:null,range:U.range});v.push({field:Z,value:K.load})})}})(T);let w=v.filter(({field:P})=>P!=null).map(P=>u([P.field.store(P.value),d]));return I({},f,{Type:y.Block,params:w})}return{[y.Struct]:l=>([u,h],d)=>{let{userTypes:f,aliases:T}=h,[b]=u.params,v=I({},u,{meta:I({},u.meta,{TYPE_OBJECT:{},OBJECT_SIZE:0,OBJECT_KEY_TYPES:{}})}),w=()=>{T[u.value]=b.value},P=(U,z)=>{let[Z,K,Oe]=pi(U);v.meta.TYPE_OBJECT=I({},v.meta.TYPE_OBJECT,Z),v.meta.OBJECT_SIZE+=K,v.meta.OBJECT_KEY_TYPES=I({},v.meta.OBJECT_KEY_TYPES,Oe)};return{[y.Type]:w,[y.Identifier]:w,[y.ObjectLiteral]:()=>{P(u),f[v.value]=v},[y.UnionType]:()=>{D({[y.ObjectLiteral]:P,[y.ArrayType]:U=>{v.meta.TYPE_ARRAY=U.type.slice(0,-2)},[y.Identifier]:U=>{let z=f[d([U,h]).value];v.meta.TYPE_OBJECT=I({},v.meta.TYPE_OBJECT,z.meta.TYPE_OBJECT),v.meta.OBJECT_SIZE=Math.max(v.meta.OBJECT_SIZE,z.meta.OBJECT_SIZE),v.meta.OBJECT_KEY_TYPES=I({},v.meta.OBJECT_KEY_TYPES,z.meta.OBJECT_KEY_TYPES)}})(b),f[v.value]=v}}[b.Type](),v.meta.OBJECT_KEY_TYPES=Object.entries(v.meta.OBJECT_KEY_TYPES).reduce((U,[z,Z])=>(U[z]=f[Z]||Z,U),{}),v},[y.DeclType]:l=>(u,h)=>{let[d,f]=u,{aliases:T}=f;return T[d.value]?h([Q({value:T[d.value],type:T[d.value]},d),f]):l(u)},[y.FunctionResult]:l=>(u,h)=>{let[d,f]=u,{userTypes:T,aliases:b}=f;return b[d.type]?h([Q({type:b[d.type]},d),f]):T[String(d.type)]?l([Q({type:Yt,meta:{STRUCT_TYPE:T[d.type]},params:d.params.map(v=>h([v,f]))},d),f]):l(u)},[y.Identifier]:l=>u=>{let[h,d]=u,{userTypes:f,scopes:T}=d,b=et(T,h.value);return b&&f[b.type]?I({},h,{meta:I({},h.meta,b.meta,f[b.type].meta,{STRUCT_TYPE:f[b.type]}),type:Yt}):l(u)},[y.Access]:function(l){return(u,h)=>{let[d,f]=u,[T,b]=d.params,v=n(h([T,f]),b);return h([v.load,f])}},[y.Assignment]:l=>(u,h)=>{let[d]=u,[f,T]=d.params;return f.Type===y.Access?r(u,h):T.Type===y.ObjectLiteral?a(u,h):l(u)},[y.ArraySubscript]:l=>(u,h)=>{let[d,f]=u,T=l(u);if(f.userTypes[T.meta.TYPE_ARRAY]==null)return T;let[b,v]=d.params.map(w=>h([w,f]));return h([Q({type:Yt,meta:{STRUCT_TYPE:f.userTypes[T.meta.TYPE_ARRAY]}},o(Ks||(Ks=de(["("," + ("," * sizeof(",")));"])),b,v,T.meta.TYPE_ARRAY)),f])}}}}}function hi(){return{semantics(){return{[y.FunctionCall]:o=>(n,r)=>{let[a,l]=n,[u,...h]=a.params;if(u.Type===y.Access&&u.params[0]&&u.params[0].Type===y.Type){let[d,f]=u.params;return Q({value:"".concat(d.value,".").concat(f.value),type:d.value,params:h.map(T=>r([T,l])),Type:y.NativeMethod},a)}return o(n)},[y.Unreachable]:o=>([n])=>Q({value:"unreachable",params:[],Type:y.NativeMethod},n)}}}}function di(){return{grammar:pr,semantics(){return{[y.FunctionDeclaration]:o=>n=>{let[r,a]=n,[l]=r.params,u=[];return D({Assignment:h=>{let[,d]=h.params;u.push(d)}})(l),o([I({},r,{meta:I({},r.meta,{DEFAULT_ARGUMENTS:u})}),a])},[y.FunctionCall]:o=>n=>{let[r,a]=n,{functions:l}=a,[u,...h]=r.params,d=l[u.value];if(!d)return o(n);let f=d.meta.FUNCTION_METADATA.argumentsCount,T=h.length,b=f-T;return b>0?o([I({},r,{params:[...r.params,...d.meta.DEFAULT_ARGUMENTS.slice(b-1)]}),a]):o(n)}}}}}let yi={i64:8,f64:8,i32:4,f32:4};function _i(){return{semantics(){return{[y.FunctionCall]:o=>n=>{let[r,a]=n;if(r.value!=="sizeof")return o(n);let{scopes:l,userTypes:u,functions:h}=a,[,d]=r.params,f=et(l,d.value),{type:T=""}=f||{},b=u[d.value]||u[T],v=h[d.value];if(b!=null){let P=b.meta[Do];return L(P,"Object size information is missing"),I({},r,{value:P,params:[],type:"i32",Type:y.Constant})}let w=f||v;return I({},r,{value:yi[String(w?w.type:d.value)],type:"i32",params:[],Type:y.Constant})}}}}}let bi=()=>[ko().semantics,jo().semantics,Vo().semantics,zo().semantics,qo().semantics,Wo().semantics,Jo().semantics,Zo().semantics,ti().semantics,ci().semantics,li().semantics,mi().semantics,hi().semantics,_i().semantics,di().semantics];function Tn(o,n,r){let a=[...bi(),...n],l=So(a.map(B=>B(r))),u={functions:{},types:{},userTypes:{},table:{},hoist:[],statics:{},path:[],scopes:yr([],Be),memories:[],tables:[],aliases:{},exports:{}},h=x(l)([o,u]),{functions:d,scopes:f,types:T,userTypes:b,statics:v,hoist:w,exports:P}=u;return I({},h,{meta:I({},h.meta,{[dn]:{functions:d,globals:f[0],types:T,userTypes:b,statics:v,exports:P}}),params:[...h.params,...w]})}function $e(o,n,r,a,l){let u=r.start.line,h=r.start.col,d=r.end.col,f=r.end.sourceLine,T=new Array(d-h+1).join("^").padStart(r.start.col-1," ");return"\n"+f+"\n"+T+" ".concat(n)+"\n"+o+"\n"+"  at ".concat(l," (").concat(a,":").concat(u,":").concat(h,")")}let F={},gi=[],Sn={},A=null,S=(o,n,r,a,l,u,h)=>{let d={result:o,first:n,second:r,size:a,code:l,name:u,text:h};return F[u]=d,gi[l]=d,Sn[h]=d,d};S(A,A,A,0,0,"Unreachable","unreachable"),S(A,A,A,0,1,"Nop","nop"),S(A,A,A,0,2,"Block","block"),S(A,A,A,0,3,"Loop","loop"),S(A,A,A,0,4,"If","if"),S(A,A,A,0,5,"Else","else"),S(A,A,A,0,6,"Try","try"),S(A,A,A,0,7,"Catch","catch"),S(A,A,A,0,8,"Throw","throw"),S(A,A,A,0,9,"Rethrow","rethrow"),S(A,A,A,0,10,"CatchAll","catch_all"),S(A,A,A,0,11,"End","end"),S(A,A,A,0,12,"Br","br"),S(A,A,A,0,13,"BrIf","br_if"),S(A,A,A,0,14,"BrTable","br_table"),S(A,A,A,0,15,"Return","return"),S(A,A,A,0,16,"Call","call"),S(A,A,A,0,17,"CallIndirect","call_indirect"),S(A,A,A,0,26,"Drop","drop"),S(A,A,A,0,27,"Select","select"),S(A,A,A,0,32,"GetLocal","get_local"),S(A,A,A,0,33,"SetLocal","set_local"),S(A,A,A,0,34,"TeeLocal","tee_local"),S(A,A,A,0,35,"GetGlobal","get_global"),S(A,A,A,0,36,"SetGlobal","set_global"),S(E,E,A,4,40,"i32Load","i32.load"),S(N,E,A,8,41,"i64Load","i64.load"),S(C,E,A,4,42,"f32Load","f32.load"),S(oe,E,A,8,43,"f64Load","f64.load"),S(E,E,A,1,44,"i32Load8S","i32.load8_s"),S(E,E,A,1,45,"i32Load8U","i32.load8_u"),S(E,E,A,2,46,"i32Load16S","i32.load16_s"),S(E,E,A,2,47,"i32Load16U","i32.load16_u"),S(N,E,A,1,48,"i64Load8S","i64.load8_s"),S(N,E,A,1,49,"i64Load8U","i64.load8_u"),S(N,E,A,2,50,"i64Load16S","i64.load16_s"),S(N,E,A,2,51,"i64Load16U","i64.load16_u"),S(N,E,A,4,52,"i64Load32S","i64.load32_s"),S(N,E,A,4,53,"i64Load32U","i64.load32_u"),S(A,E,E,4,54,"i32Store","i32.store"),S(A,E,N,8,55,"i64Store","i64.store"),S(A,E,C,4,56,"f32Store","f32.store"),S(A,E,C,8,57,"f64Store","f64.store"),S(A,E,E,1,58,"i32Store8","i32.store8"),S(A,E,E,2,59,"i32Store16","i32.store16"),S(A,E,N,1,60,"i64Store8","i64.store8"),S(A,E,N,2,61,"i64Store16","i64.store16"),S(A,E,N,4,62,"i64Store32","i64.store32"),S(E,A,A,0,63,"CurrentMemory","current_memory"),S(E,E,A,0,64,"GrowMemory","grow_memory"),S(E,A,A,0,65,"i32Const","i32.const"),S(N,A,A,0,66,"i64Const","i64.const"),S(C,A,A,0,67,"f32Const","f32.const"),S(oe,A,A,0,68,"f64Const","f64.const"),S(E,E,A,0,69,"i32Eqz","i32.eqz"),S(E,E,E,0,70,"i32Eq","i32.eq"),S(E,E,E,0,71,"i32Ne","i32.ne"),S(E,E,E,0,72,"i32LtS","i32.lt_s"),S(E,E,E,0,73,"i32LtU","i32.lt_u"),S(E,E,E,0,74,"i32GtS","i32.gt_s"),S(E,E,E,0,75,"i32GtU","i32.gt_u"),S(E,E,E,0,76,"i32LeS","i32.le_s"),S(E,E,E,0,77,"i32LeU","i32.le_u"),S(E,E,E,0,78,"i32GeS","i32.ge_s"),S(E,E,E,0,79,"i32GeU","i32.ge_u"),S(E,N,A,0,80,"i64Eqz","i64.eqz"),S(E,N,N,0,81,"i64Eq","i64.eq"),S(E,N,N,0,82,"i64Ne","i64.ne"),S(E,N,N,0,83,"i64LtS","i64.lt_s"),S(E,N,N,0,84,"i64LtU","i64.lt_u"),S(E,N,N,0,85,"i64GtS","i64.gt_s"),S(E,N,N,0,86,"i64GtU","i64.gt_u"),S(E,N,N,0,87,"i64LeS","i64.le_s"),S(E,N,N,0,88,"i64LeU","i64.le_u"),S(E,N,N,0,89,"i64GeS","i64.ge_s"),S(E,N,N,0,90,"i64GeU","i64.ge_u"),S(E,C,C,0,91,"f32Eq","f32.eq"),S(E,C,C,0,92,"f32Ne","f32.ne"),S(E,C,C,0,93,"f32Lt","f32.lt"),S(E,C,C,0,94,"f32Gt","f32.gt"),S(E,C,C,0,95,"f32Le","f32.le"),S(E,C,C,0,96,"f32Ge","f32.ge"),S(E,C,C,0,97,"f64Eq","f64.eq"),S(E,C,C,0,98,"f64Ne","f64.ne"),S(E,C,C,0,99,"f64Lt","f64.lt"),S(E,C,C,0,100,"f64Gt","f64.gt"),S(E,C,C,0,101,"f64Le","f64.le"),S(E,C,C,0,102,"f64Ge","f64.ge"),S(E,E,A,0,103,"i32Clz","i32.clz"),S(E,E,A,0,104,"i32Ctz","i32.ctz"),S(E,E,A,0,105,"i32Popcnt","i32.popcnt"),S(E,E,E,0,106,"i32Add","i32.add"),S(E,E,E,0,107,"i32Sub","i32.sub"),S(E,E,E,0,108,"i32Mul","i32.mul"),S(E,E,E,0,109,"i32DivS","i32.div_s"),S(E,E,E,0,110,"i32DivU","i32.div_u"),S(E,E,E,0,111,"i32RemS","i32.rem_s"),S(E,E,E,0,112,"i32RemU","i32.rem_u"),S(E,E,E,0,113,"i32And","i32.and"),S(E,E,E,0,114,"i32Or","i32.or"),S(E,E,E,0,115,"i32Xor","i32.xor"),S(E,E,E,0,116,"i32Shl","i32.shl"),S(E,E,E,0,117,"i32ShrS","i32.shr_s"),S(E,E,E,0,118,"i32ShrU","i32.shr_u"),S(E,E,E,0,119,"i32Rotl","i32.rotl"),S(E,E,E,0,120,"i32Rotr","i32.rotr"),S(N,N,A,0,121,"i64Clz","i64.clz"),S(N,N,A,0,122,"i64Ctz","i64.ctz"),S(N,N,A,0,123,"i64Popcnt","i64.popcnt"),S(N,N,N,0,124,"i64Add","i64.add"),S(N,N,N,0,125,"i64Sub","i64.sub"),S(N,N,N,0,126,"i64Mul","i64.mul"),S(N,N,N,0,127,"i64DivS","i64.div_s"),S(N,N,N,0,128,"i64DivU","i64.div_u"),S(N,N,N,0,129,"i64RemS","i64.rem_s"),S(N,N,N,0,130,"i64RemU","i64.rem_u"),S(N,N,N,0,131,"i64And","i64.and"),S(N,N,N,0,132,"i64Or","i64.or"),S(N,N,N,0,133,"i64Xor","i64.xor"),S(N,N,N,0,134,"i64Shl","i64.shl"),S(N,N,N,0,135,"i64ShrS","i64.shr_s"),S(N,N,N,0,136,"i64ShrU","i64.shr_u"),S(N,N,N,0,137,"i64Rotl","i64.rotl"),S(N,N,N,0,138,"i64Rotr","i64.rotr"),S(C,C,C,0,139,"f32Abs","f32.abs"),S(C,C,C,0,140,"f32Neg","f32.neg"),S(C,C,C,0,141,"f32Ceil","f32.ceil"),S(C,C,C,0,142,"f32Floor","f32.floor"),S(C,C,C,0,143,"f32Trunc","f32.trunc"),S(C,C,C,0,144,"f32Nearest","f32.nearest"),S(C,C,C,0,145,"f32Sqrt","f32.sqrt"),S(C,C,C,0,146,"f32Add","f32.add"),S(C,C,C,0,147,"f32Sub","f32.sub"),S(C,C,C,0,148,"f32Mul","f32.mul"),S(C,C,C,0,149,"f32Div","f32.div"),S(C,C,C,0,150,"f32Min","f32.min"),S(C,C,C,0,151,"f32Max","f32.max"),S(C,C,C,0,152,"f32Copysign","f32.copysign"),S(C,C,C,0,153,"f32Abs","f64.abs"),S(C,C,C,0,154,"f32Neg","f64.neg"),S(C,C,C,0,155,"f32Ceil","f64.ceil"),S(C,C,C,0,156,"f32Floor","f64.floor"),S(C,C,C,0,157,"f32Trunc","f64.trunc"),S(C,C,C,0,158,"f32Nearest","f64.nearest"),S(C,C,C,0,159,"f32Sqrt","f64.sqrt"),S(oe,oe,oe,0,160,"f64Add","f64.add"),S(oe,oe,oe,0,161,"f64Sub","f64.sub"),S(oe,oe,oe,0,162,"f64Mul","f64.mul"),S(oe,oe,oe,0,163,"f64Div","f64.div"),S(oe,oe,oe,0,164,"f64Min","f64.min"),S(oe,oe,oe,0,165,"f64Max","f64.max"),S(oe,oe,oe,0,166,"f64Copysign","f64.copysign"),S(E,N,A,0,167,"i32Wrapi64","i32.wrap/i64"),S(E,C,A,0,168,"i32TruncSf32","i32.trunc_s/f32"),S(E,C,A,0,169,"i32TruncUf32","i32.trunc_u/f32"),S(E,C,A,0,170,"i32TruncSf64","i32.trunc_s/f64"),S(E,C,A,0,171,"i32TruncUf64","i32.trunc_u/f64"),S(N,E,A,0,172,"i64ExtendSi32","i64.extend_s/i32"),S(N,E,A,0,173,"i64ExtendUi32","i64.extend_u/i32"),S(N,C,A,0,174,"i64TruncSf32","i64.trunc_s/f32"),S(N,C,A,0,175,"i64TruncUf32","i64.trunc_u/f32"),S(N,C,A,0,176,"i64TruncSf64","i64.trunc_s/f64"),S(N,C,A,0,177,"i64TruncUf64","i64.trunc_u/f64"),S(C,E,A,0,178,"f32ConvertSi32","f32.convert_s/i32"),S(C,E,A,0,179,"f32ConvertUi32","f32.convert_u/i32"),S(C,N,A,0,180,"f32ConvertSi64","f32.convert_s/i64"),S(C,N,A,0,181,"f32ConvertUi64","f32.convert_u/i64"),S(C,C,A,0,182,"f32Demotef64","f32.demote/f64"),S(C,E,A,0,183,"f64ConvertSi32","f64.convert_s/i32"),S(C,E,A,0,184,"f64ConvertUi32","f64.convert_u/i32"),S(C,N,A,0,185,"f64ConvertSi64","f64.convert_s/i64"),S(C,N,A,0,186,"f64ConvertUi64","f64.convert_u/i64"),S(C,C,A,0,187,"f64Promotef32","f64.promote/f32"),S(E,C,A,0,188,"i32Reinterpretf32","i32.reinterpret/f32"),S(N,C,A,0,189,"i64Reinterpretf64","i64.reinterpret/f64"),S(C,E,A,0,190,"f32Reinterpreti32","f32.reinterpret/i32"),S(C,N,A,0,191,"f32Reinterpreti64","f64.reinterpret/i64");let xr=(o,n)=>{let r=o[0];return["i32","bool"].includes(o)&&n==="i64"?F.i32Wrapi64:o==="i64"&&["i32","bool"].includes(n)?F.i64ExtendSi32:o==="f32"&&n==="f64"?F.f32Demotef64:o==="f64"&&n==="f32"?F.f64Promotef32:F[o+(r==="f"?"ConvertS":"TruncS")+n]},Ar=({type:o,value:n})=>({"+":F[String(o)+"Add"],"-":F[String(o)+"Sub"],"*":F[String(o)+"Mul"],"/":F[String(o)+"DivS"]||F[String(o)+"Div"],"%":F[String(o)+"RemS"]||F[String(o)+"RemU"],"==":F[String(o)+"Eq"],"!=":F[String(o)+"Ne"],">":F[String(o)+"Gt"]||F[String(o)+"GtS"],"<":F[String(o)+"Lt"]||F[String(o)+"LtS"],"<=":F[String(o)+"Le"]||F[String(o)+"LeS"],">=":F[String(o)+"Ge"]||F[String(o)+"GeS"],"?":F.If,":":F.Else,"&":F[String(o)+"And"],"|":F[String(o)+"Or"],"^":F[String(o)+"Xor"],">>":F[String(o)+"ShrS"],">>>":F[String(o)+"ShrU"],"<<":F[String(o)+"Shl"]})[n],nt=127,rt=126,st=125,ot=124,wr=112,Cr=96,vi={i32:nt,i64:rt,f32:st,f64:ot},qt=o=>{switch(o){case rt:return"i64";case st:return"f32";case ot:return"f64";case Cr:return"func";case wr:return"anyfunc";case nt:default:return"i32"}},En=o=>{let n={};return D({[y.Pair]:({params:r})=>{let[{value:a},{value:l}]=r;n[a]=parseInt(l)}})(o),n},Ti=o=>{let n=o.value||"??",r=o.type,a=Ar({value:n,type:r||"i32"});return r?a.text:a.text.replace("i32","??")},$r=o=>{let n=[];return D({[y.Pair]:(r,a)=>{n.push("".concat(r.params[0].value," ").concat(r.params[1].value))},[y.Type]:r=>{n.push(r.value)}})(o),n.length?" param("+n.join(" ")+")":""},Or=o=>o==null?"":" (result "+(o.type||"??")+")",Lr=o=>{let[n,r]=o.params;return"(type "+o.value+" (func".concat($r(n)).concat(Or(r),"))")},Ge=(o,n,{value:r,params:a})=>{a.filter(Boolean).length?(o("(".concat(r),2),a.forEach(n),o(")",0,-2)):o("(".concat(r,")"),0,0)},Si=o=>({[y.Import]:(n,r)=>{let[a,l]=n.params;D({[y.Pair]:({params:u},h)=>{let{value:d}=u[0],f=u[1];if(f.value==="Memory"){let T=En(f);o('(import "'.concat(l.value,'" "').concat(d,'" (memory ').concat(T.initial).concat(T.max?T.max:"","))"))}else o('(import "'.concat(l.value,'" "').concat(d,'" ').concat(Lr(f),")"))},[y.Identifier]:(u,h)=>{let{value:d}=u;o('(import "'.concat(l.value,'" "').concat(d,'" (type ??))'))}})(a)},[y.Export]:(n,r)=>{o("(export",2),n.params.forEach(r),o(")",0,-2)},[y.GenericType]:(n,r)=>{o(";; Pseudo type",0,0),o("(type-generic "+n.value+")",0,0)},[y.FunctionCall]:({value:n,params:r},a)=>{Ge(o,a,{value:"call ".concat(n),params:r})},[y.Block]:({params:n},r)=>{Ge(o,r,{value:"block",params:n})},[y.NativeMethod]:(n,r)=>{Ge(o,r,n)},[y.BinaryExpression]:(n,r)=>{let a=Ti(n);Ge(o,r,{value:a,params:n.params})},[y.ArraySubscript]:({params:n},r)=>{o(";; unparsed",0,0),Ge(o,r,{value:"subscript",params:n})},[y.Typedef]:(n,r)=>{o(Lr(n))},[y.Struct]:(n,r)=>{o(";; Pseudo struct type",0,0),Ge(o,r,{value:"type-struct "+n.value,params:n.params})},[y.Identifier]:n=>{let r=n.meta[Be]!=null?"global":"local";o("(get_".concat(r," ").concat(n.value,")"))},[y.Constant]:n=>{o("(".concat(String(n.type),".const ").concat(n.value,")"))},[y.FunctionPointer]:n=>{o("(".concat(String(n.type),".table_pointer ").concat(n.value,")"))},[y.FunctionDeclaration]:(n,r)=>{let[a,l,...u]=n.params;o("(func ".concat(n.value).concat($r(a)).concat(Or(l)),2),u.forEach(r),o(")",0,-2)},[y.ReturnStatement]:({params:n},r)=>{Ge(o,r,{value:"return",params:n})},[y.Declaration]:(n,r)=>{o("(local "+n.value+" "+String(n.type),2,0),n.params.forEach(r),o(")",0,-2)},[y.ImmutableDeclaration]:(n,r)=>{let a=n.meta[Be]!=null?"global":"local";if(n.type==="Memory"){let l=En(n);o("(memory ".concat(l.initial).concat(l.max?" ".concat(l.max):"",")"))}else o("(".concat(a," ")+n.value+" "+String(n.type),2,0),n.params.forEach(r),o(")",0,-2)},[y.StringLiteral]:n=>{o('; string "'.concat(n.value,'"'),0,0),o("(i32.const ??)",0,0)},[y.Type]:n=>{o(n.value)},[y.TypeCast]:(n,r)=>{let a=n.params[0],l=xr(String(n.type),a.type);o("("+l.text,2),n.params.forEach(r),o(")",0,-2)},[y.Access]:({params:n},r)=>{o(";; unparsed",0,0),Ge(o,r,{value:"access",params:n})},[y.MemoryAssignment]:(n,r)=>{o("("+String(n.type)+".store",2,0),n.params.forEach(r),o(")",0,-2)},[y.Assignment]:(n,r)=>{let[a,...l]=n.params,u=a.meta[Be]!=null?"global":"local";o("(set_".concat(u," ").concat(a.value),2),[y.ArraySubscript,y.Access].includes(a.Type)&&r(a),l.forEach(r),o(")",0,-2)},[y.TernaryExpression]:(n,r)=>{let[a,l,u]=n.params;o("(select",2),r(a),r(l),r(u),o(")",0,-2)},[y.IfThenElse]:(n,r)=>{let[a,l,...u]=n.params;o("(if",2),r(a),o("(then",2),r(l),o(")",0,-2),u.length>0&&(o("(else",2),u.forEach(r),o(")",0,-2)),o(")",0,-2)},[y.ObjectLiteral]:(n,r)=>{}}),Nr=o=>{if(o==null)return"";let n=0,r=[],a=[];return D(Si((h,d=0,f=0)=>{n+=f,a.push(h),r.push(n+h.length),n+=d}))(o),a.reduce((h,d,f)=>(h+=d.padStart(r[f]," ")+"\n",h),"")},Pr=Lt((o,n)=>{let r=n.meta[Nt],a=n.meta[Be],l=r!=null?r:a;L(l!=null,"Undefined index for scope Operation. Possibly missing metadata. op: ".concat(JSON.stringify(o)," node: ").concat(Nr(n)));let u=r!=null?o+"Local":o+"Global",h=[Number(l)];return{kind:F[u],params:h,debug:"".concat(n.value,"<").concat(n.meta.ALIAS||n.type,">")}}),Ei=o=>{switch(o){case Ke.f32:return st;case Ke.f64:return ot;case Ke.i64:return rt;case Ke.i32:default:return nt}},gt=o=>typeof o=="string"&&Ke[o]!=null,Ir=o=>({mutable:o.meta[Pt]?0:1,type:Ei(o.type)}),xi=Pr("Set"),Rr=Pr("Get"),Wt="global";function xn(o,{filename:n}){let r=o.meta[dn];if(r==null)throw new Error("Missing AST metadata!");let{types:a,functions:l,userTypes:u}=r,h=[];D({[y.Import]:(f,T)=>{D({[y.BinaryExpression]:(b,v)=>{let[w,P]=b.range;h.push($e("Using an 'as' import without a type.","A type for original import "+b.params[0].value+" is not defined nor could it be inferred.",{start:w,end:P},n,Wt))},[y.Identifier]:(b,v)=>{let[w,P]=b.range;h.push($e("Infered type not supplied.","Looks like you'd like to infer a type, but it was never provided by a linker. Non-concrete types cannot be compiled.",{start:w,end:P},n,Wt))},[y.Pair]:(b,v)=>{let w=b.params[1];if(!gt(w.value)&&a[w.value]==null){let[P,B]=w.range;h.push($e("Undefined Type ".concat(w.value),"Invalid Import. ".concat(w.value," type does not exist"),{start:P,end:B},n,Wt))}}})(f)},[y.Struct]:(f,T)=>{},[y.ImmutableDeclaration]:(f,T)=>{},[y.Declaration]:(f,T)=>{let[b,v]=f.range;!gt(f.type)&&!a[f.type]&&!u[f.type]&&h.push($e("Unknown type used in a declaration, "+'"'.concat(String(f.type),'"'),"Variables must be assigned with a known type.",{start:b,end:v},n,Wt))},[y.FunctionDeclaration]:(f,T)=>{let b="".concat(f.value,"()");D({[y.Declaration]:(v,w)=>{let[P,B]=v.range;!gt(v.type)&&!a[v.type]&&!u[v.type]&&h.push($e("Unknown type used in a declartion, "+'"'.concat(String(v.type),'"'),"Variables must be assigned with a known type.",{start:P,end:B},n,b))},[y.Assignment]:v=>{let[w]=v.params,[P,B]=v.range;w.meta[Pt]&&h.push($e("Cannot reassign a const variable ".concat(w.value),"const variables cannot be reassigned, use let instead.",{start:P,end:B},n,b))},[y.ArraySubscript]:v=>{let[w]=v.params,[P,B]=v.range;h.push($e("Invalid subscript target","Expected array type for ".concat(w.value,", received ").concat(w.type),{start:P,end:B},n,b))},[y.NativeMethod]:(v,w)=>{let{value:P}=v,[B={},U]=v.params,[z,Z]=v.range;B.value==="unreachable"&&(P.includes("store")||P.includes("load"))&&h.push($e("Cannot generate property access",'Cannot assign "'.concat(U.value,'". Key is "').concat(B.value,'"'),{start:z,end:Z},n,b))},[y.ReturnStatement]:(v,w)=>{if(v.params.map(w),f.type==null)return;let[P]=v.params,[B]=v.range,U=P!=null?P.range[1]:v.range[1],z=v.type;ze(z)!==ze(f.type)&&h.push($e("Missing return value","Inconsistent return value. Expected "+f.type+" received "+String(z),{start:B,end:U},n,b))},[y.FunctionCall]:(v,w)=>{if(l[v.value]==null){let[P,B]=v.range;h.push($e("Undefined function reference","".concat(v.value," is not defined."),{start:P,end:B},n,b))}},[y.IndirectFunctionCall]:(v,w)=>{let P=v.params[v.params.length-1],B=a[P.type];if(!gt(P.type)&&B==null){let[U,z]=v.range;h.push($e("Cannot make an indirect call without a valid function type","".concat(P.value," has type ").concat(String(P.type)," which is not defined. Indirect calls must have pre-defined types."),{start:U,end:z},n,b))}}})(f)}})(o);let d=h.length;if(d>0){let f=h.reduce((T,b)=>T+"\n"+"".concat(b,"\n"),"Cannot generate WebAssembly for ".concat(n,". ").concat(d," problems.\n"));throw new Error(f)}}let ue=(o,n)=>(Array.isArray(n)?o=[...o,...n]:o.push(n),o),Ai=(o,n)=>{let r=o.params.map(me(n)).reduce(ue,[]),a=o.meta[Re];return r.push({kind:F.Call,params:[a],debug:"".concat(o.value,"<").concat(o.type?o.type:"void",">")}),r},wi=(o,n)=>{let r=o.params.map(me(n)).reduce(ue,[]),a=o.meta[Nt],l=o.meta[bt];return L(a!=null,"Undefined local index, not a valid function pointer"),L(l!=null,"Variable is not of a valid function pointer type"),[...r,{kind:F.CallIndirect,params:[l,0]}]},Ci=(o,n)=>{let r=o.params.map(me(n)).reduce(ue,[]);return r.push({kind:Ar(I({},o,{type:o.type})),params:[]}),r},$i=(o,n)=>{let r=o.params.map(me(n)).reduce(ue,[]);return r.push({kind:F.Select,params:[]}),r},Oi=(o,n)=>{let r=me(n),[a,l,...u]=o.params;return[...[a].map(r).reduce(ue,[]),{kind:F.If,params:[64]},...[l].map(r).reduce(ue,[]),...u.map(r).reduce(ue,[]),{kind:F.End,params:[]}]},Li=o=>[{kind:F.i32Const,params:[Number(o.value)]}],Ni=o=>{let n=o.params.filter(Boolean).map(me(null)).reduce(ue,[]);return n.push({kind:F.Return,params:[]}),n},Pi=(o,n)=>[o].map(me(n)).reduce(ue,[]),Ii=(o,n)=>{let r=o.params[0];if(r){let a=o.meta[Nt],l=gt(o.type)?o.type:Ie;return[...Pi(I({},r,{type:l}),n),{kind:F.SetLocal,params:[a],debug:"".concat(o.value,"<").concat(String(o.type),">")}]}return[]},Ri=o=>{let[n,r]=o.params,a=[r].map(me(null)).reduce(ue,[]);return a.push(xi(n)),a},Bi=o=>{let[n,r]=o.params,a=[r].map(me(null)).reduce(ue,[]);return a.push({kind:F.TeeLocal,params:[Number(n.meta.LOCAL_INDEX)],debug:"".concat(n.value,"<").concat(String(n.meta.ALIAS||n.type),">")}),a},Mi=(o,n)=>{let r=[],a=me(n),[l,u,...h]=o.params;return r.push.apply(r,[l].map(a).reduce(ue,[])),r.push({kind:F.Block,params:[64]}),r.push({kind:F.Loop,params:[64]}),r.push.apply(r,[u].map(a).reduce(ue,[])),r.push({kind:F.i32Eqz,params:[]}),r.push({kind:F.BrIf,params:[1]}),r.push.apply(r,h.map(a).reduce(ue,[])),r.push({kind:F.Br,params:[0]}),r.push({kind:F.End,params:[]}),r.push({kind:F.End,params:[]}),r},Fi=(o,n)=>{let r=o.meta[hn];L(r,"Cannot generate typecast for node: ".concat(JSON.stringify(o)));let{to:a,from:l}=r;return[...o.params.map(me(n)).reduce(ue,[]),{kind:xr(a,l),params:[]}]},Ui=()=>[{kind:F.Br,params:[2]}];function Di(){return[]}let ji=(o,n)=>o.params.map(me(n)).reduce(ue,[]),ki=(o,n)=>[{kind:F.Else,params:[]},...o.params.map(me(n)).reduce(ue,[])],zi=(o,n)=>{let[r,a]=o.params,l={kind:F.Select,params:[]},u=[r].map(me(n)).reduce(ue,[]);return o.value==="&&"?[...[a].map(me(n)).reduce(ue,[]),{kind:F.i32Const,params:[0]},...u,l]:[...u,...[a].map(me(n)).reduce(ue,[]),...u,l]},Br={load8_s:0,load8_u:0,store8:0,load16_s:1,load16_u:1,store16:1,store32:2,load32_s:2,load32_u:2,store:2,load:2},Gi={grow_memory:0,current_memory:0},Yi=(o,n)=>{let r=o.params.map(me(n)).reduce(ue,[]),a=o.value.split(".").pop();if(Br[a]==null)r.push({kind:Sn[o.value],params:[Gi[o.value]]});else{let l=Br[a];r.push({kind:Sn[o.value],params:[l,0]})}return r},qi=o=>{let n=F[String(o.type)+"Const"],r=(o.meta.SIGN||1)*Number(o.value);return[{kind:n,params:[r]}]},Wi={[y.FunctionCall]:Ai,[y.IndirectFunctionCall]:wi,[y.Constant]:qi,[y.BinaryExpression]:Ci,[y.TernaryExpression]:$i,[y.IfThenElse]:Oi,[y.Else]:ki,[y.Select]:zi,[y.Block]:ji,[y.Identifier]:Rr,[y.FunctionIdentifier]:Rr,[y.FunctionPointer]:Li,[y.ReturnStatement]:Ni,[y.Declaration]:Ii,[y.Assignment]:Ri,[y.AssignmentExpression]:Bi,[y.Loop]:Mi,[y.Break]:Ui,[y.TypeCast]:Fi,[y.Noop]:Di,[y.NativeMethod]:Yi},me=Lt((o,n)=>{let r=Wi[n.Type];return L(r,"Unsupported Syntax Token. ".concat(n.Type,' "').concat(n.value,'"')),r(n,o)}),Vi=o=>({functionIndex:o}),An=0,Vt=1,Jt=2,vt=3,Ji={Memory:Jt,Table:Vt};function Hi(o){let n=o.meta[Re],r=o.meta[Be];if(r!=null){let a=Ji[String(o.type)]||vt;return{index:[Jt,Vt].includes(a)?0:r,kind:a,field:o.value}}return{index:n,kind:An,field:o.value}}let Qi=o=>{let n={max:0,initial:0};return D({[y.Pair]:({params:r})=>{let[{value:a},{value:l}]=r;n[a]=parseInt(l)}})(o),n};function Ki(o){let n={max:0,initial:0,type:"element"};return D({[y.Pair]:({params:r})=>{let[{value:a},{value:l}]=r;switch(a){case"initial":n.initial=parseInt(l);break;case"element":n.type=l;break;case"max":n.max=parseInt(l);break}}})(o),n}let Xi=o=>{let n=Ir(o),[r]=o.params;if(r!=null){let{value:a}=r;switch(n.type){case st:case ot:n.init=parseFloat(a);break;case nt:case rt:default:n.init=parseInt(a)}}return n},Zi=o=>{switch(o){case"Memory":return Jt;case"Table":return Vt;case"i32":case"f32":case"i64":case"f64":return vt;default:return An}},ea=o=>{let n=o.value;return o.meta.AS!=null?o.meta.AS:n};function ta(o){let[n,r]=o.params,{value:a}=r,l=[];return D({[y.Pair]:(u,h)=>{let[d,f]=u.params,T=ea(d),{value:b}=f,v=Zi(b),w=(()=>{let B=f.meta[bt];return B||null})(),P=b==="Memory"?En(f):{};l.push(I({module:a,field:T,global:v===vt,kind:v,type:vi[b],typeIndex:w},P))}})(n),l}let it=o=>{switch(o){case"f32":return st;case"f64":return ot;case"i64":return rt;case"i32":case"Function":default:return nt}},Mr=o=>{let[n]=o.params,r=o.type?it(o.type):null,a=[];return D({[y.Pair]:l=>{let u=l.params[1];L(u,"Undefined type in a argument expression"),a.push(it(u.value))}})(n),{params:a,result:r,id:o.value}};function na(o){let n=o.value;L(typeof n=="string","Generator: A type must have a valid string identifier, node: ".concat(JSON.stringify(o)));let[r,a]=o.params,l=[];return D({[y.DeclType]:(u,h)=>{l.push(it(u.value))},[y.Type]:(u,h)=>{l.push(it(u.value))},[y.Identifier]:(u,h)=>{l.push(it(u.value))}})(r),{id:n,params:l,result:a.type&&a.type!=="void"?it(a.type):null}}function ra(o,n){let r=n,a={},l=Object.entries(o).reduce((h,[d,f])=>(h.push({offset:Number(r),data:f}),a[d]=r,r+=f.size,h),[]),u=new le;return u.push(gn,r,String(r)),{data:[{offset:0,data:u},...l],map:a}}let sa=4,oa=o=>{let[n,r,...a]=o.params,l=o.meta[yn];L(a,"Cannot generate code for function without body"),L(l,"Cannot generate code for function without metadata");let{locals:u,argumentsCount:h}=l,d={code:[],locals:Object.keys(u).slice(h).map(f=>Ir(u[f])),debug:"Function ".concat(o.value)};return d.code=a.map(me(d)).reduce(ue,[]),d};function wn(o,n){let r={Version:n.version,Types:[],Start:[],Element:[],Code:[],Exports:[],Imports:[],Globals:[],Functions:[],Memory:[],Table:[],Artifacts:[],Data:[],Name:{module:n.filename,functions:[],locals:[]}},{statics:a}=o.meta[dn];n.linker!=null&&(a=I({},n.linker.statics,a));let{map:l,data:u}=ra(a,sa);Object.keys(a).length>0&&(r.Data=u);let h=v=>{let w=Mr(v);return r.Types.findIndex(P=>{let B=P.params.length===w.params.length&&P.params.reduce((z,Z,K)=>z&&Z===w.params[K],!0),U=P.result===w.result;return B&&U})},d=v=>r.Element.findIndex(w=>w.functionIndex===v),f={},T=$({[y.Typedef]:(v,w)=>{let P=r.Types.findIndex(({id:U})=>U===v.value),B=r.Types[P];return B==null&&(P=r.Types.length,r.Types.push(na(v))),B=I({},v,{meta:I({},v.meta,{[bt]:P})}),f[v.value]={typeIndex:P,typeNode:B},B}})($({[y.Import]:(v,w)=>v,[y.StringLiteral]:(v,w)=>{let{value:P}=v;return l[P]==null?v:I({},v,{value:String(l[P]),Type:y.Constant})},[y.StaticValueList]:v=>{let{value:w}=v;return I({},v,{value:String(l[w]),Type:y.Constant})}})(o)),b={[y.Typedef]:(v,w)=>v,[y.Export]:v=>{let[w]=v.params;r.Exports.push(Hi(w))},[y.ImmutableDeclaration]:v=>{switch(v.type){case"Memory":r.Memory.push(Qi(v));break;case"Table":r.Table.push(Ki(v));break}},[y.Declaration]:v=>{v.meta[Be]!=null&&r.Globals.push(Xi(v))},[y.Import]:v=>{r.Imports.push(...ta(v))},[y.FunctionDeclaration]:v=>{let w=(()=>{let U=h(v);return U===-1?(r.Types.push(Mr(v)),r.Types.length-1):U})(),P=$({FunctionPointer(U){let Z=U.meta[Re],K=d(Z);return K<0&&(K=r.Element.length,r.Element.push(Vi(Z))),U}})(v),B=v.meta[Re];if(L(B!=null,"Function index must be set"),r.Functions[B]=w,r.Code[B]=oa(P),P.value==="start"&&r.Start.push(B),n.encodeNames){r.Name.functions.push({index:B,name:v.value});let U=v.meta[yn];U!=null&&Object.keys(U.locals).length&&(r.Name.locals[B]={index:B,locals:Object.entries(U.locals).map(([z,Z])=>({name:z,index:Number(Z.meta["local/index"])}))})}}};return D(b)(T),r.Code=r.Code.filter(Boolean),r}let Fr=1,ia=1836278016;function aa(o){return new le().push(gn,ia,"\\0asm").push(gn,o,"version ".concat(o))}let Cn="varuint7",Y="varuint32",Tt="varint7",at="varint1",$n="varint32",Ur="varint64";function qe(o,n,r){o.push(Y,n.length,r);for(let a=0;a<n.length;a++)o.push(ce,n.charCodeAt(a),n[a]);return o}let ca=o=>{let n=new le().push(Y,o.length,"entry count");return o.forEach(r=>{switch(qe(n,r.module,"module"),qe(n,r.field,"field"),r.kind){case vt:{n.push(ce,vt,"Global"),n.push(ce,r.type,qt(r.type)),n.push(ce,0,"immutable");break}case An:{n.push(ce,r.kind,"Function"),n.push(Y,r.typeIndex,"type index");break}case Vt:{n.push(ce,r.kind,"Table"),n.push(ce,wr,"function table types"),n.push(at,0,"has max value"),n.push(Y,0,"iniital table size");break}case Jt:{n.push(ce,r.kind,"Memory"),n.push(at,!!r.max,"has no max"),n.push(Y,r.initial,"initial memory size(PAGES)"),r.max&&n.push(Y,r.max,"max memory size(PAGES)");break}}}),n},la=o=>{let n=new le;return n.push(Y,o.length,"count"),o.forEach(({field:r,kind:a,index:l})=>{qe(n,r,"field"),n.push(ce,a,"Global"),n.push(Y,l,"index")}),n},ua=(o,{type:n,init:r,mutable:a})=>{switch(o.push(ce,n,qt(n)),o.push(ce,a,"mutable"),n){case nt:o.push(ce,F.i32Const.code,F.i32Const.text),o.push($n,r,"value (".concat(r,")"));break;case st:o.push(ce,F.f32Const.code,F.f32Const.text),o.push(C,r,"value (".concat(r,")"));break;case ot:o.push(ce,F.f64Const.code,F.f64Const.text),o.push(oe,r,"value (".concat(r,")"));break;case rt:o.push(ce,F.i64Const.code,F.i64Const.text),o.push(Ur,r,"value (".concat(r,")"))}o.push(ce,F.End.code,"end")},pa=o=>{let n=new le;return n.push(Y,o.length,"count"),o.forEach(r=>ua(n,r)),n},fa=o=>{o=o.filter(r=>r!==null);let n=new le;return n.push(Y,o.length,"count"),o.forEach(r=>n.push(Y,r,"type index")),n};function ma(o){let n=new le;return n.push(Y,o[0],"start function"),n}let ha=o=>({functionIndex:n},r)=>{o.push(Y,0,"table index"),o.push(ce,F.i32Const.code,"offset"),o.push(Y,r,r.toString()),o.push(ce,F.End.code,"end"),o.push(Y,1,"number of elements"),o.push(Y,n,"function index")},da=o=>{let n=new le;return n.push(Y,o.length,"count"),o.forEach(ha(n)),n},ya=(o,{params:n,result:r},a)=>{o.push(Tt,Cr,"func type (".concat(a,")")),o.push(Y,n.length,"parameter count"),n.forEach(l=>o.push(Tt,l,"param")),r?(o.push(at,1,"result count"),o.push(Tt,r,"result type ".concat(qt(r)))):o.push(at,0,"result count")},_a=o=>{let n=new le;return n.push(Y,o.length,"count"),o.forEach((r,a)=>ya(n,r,a)),n},ba=(o,n)=>{o.push(Y,1,"number of locals of following type"),o.push(Tt,n.type,"".concat(qt(n.type)))},ga=(o,{locals:n,code:r,debug:a})=>{let l=new le;r.forEach(({kind:h,params:d,debug:f})=>{L(typeof h<"u","Fatal error! Generated undefined opcode. debug code: ".concat(JSON.stringify(f))),l.push(ce,h.code,"".concat(h.text,"  ").concat(f||"")),d.filter(T=>typeof T<"u").forEach(T=>{let b=Y,v="i32.literal";if(h.code>=40&&h.code<=64)b=Y,v="memory_immediate";else switch(h.result){case oe:b=oe,v="f64.literal";break;case C:b=C,v="f32.literal";break;case E:b=$n,v="i32.literal";break;case N:b=Ur,v="i64.literal";break;default:b=Y}l.push(b,T,"".concat(v))})});let u=new le;n.forEach(h=>ba(u,h)),o.push(Y,l.size+u.size+2,a),o.push(Y,n.length,"locals count"),o.write(u),o.write(l),o.push(ce,F.End.code,"end")},va=o=>{let n=new le;return n.push(Y,o.length,"function count"),o.forEach(r=>ga(n,r)),n},Ta=(o,n)=>{o.push(at,n.max?1:0,"has no max"),o.push(Y,n.initial,"initial memory size(PAGES)"),n.max&&o.push(Y,n.max,"max memory size(PAGES)")},Sa=o=>{let n=new le;return n.push(Y,o.length,"count"),o.forEach(r=>Ta(n,r)),n},Ea={anyfunc:112},xa=(o,n)=>{o.push(Tt,Ea[n.type],n.type),o.push(at,n.max?1:0,"has max"),o.push(Y,n.initial,"initial table size"),n.max&&o.push(Y,n.max,"max table size")};function Aa(o){let n=new le;return n.push(Y,o.length,"count"),o.forEach(r=>xa(n,r)),n}let wa=(o,n)=>{o.push(Y,0,"memory index");let{offset:r,data:a}=n;o.push(ce,F.i32Const.code,F.i32Const.text),o.push($n,r,"segment offset (".concat(r,")")),o.push(ce,F.End.code,"end"),o.push(Y,a.size,"segment size"),o.write(a)};function Ca(o){let n=new le;n.push(Y,o.length,"entries");for(let r=0,a=o.length;r<a;r++){let l=o[r];wa(n,l)}return n}let $a=o=>{let n=new le;return qe(n,o,"name_len: ".concat(o)),n},Oa=o=>{let n=new le;return n.push(Y,o.length,"count: ".concat(String(o.length))),o.forEach(({index:r,name:a})=>{n.push(Y,r,"index: ".concat(String(r))),qe(n,a,"name_len: ".concat(a))}),n},La=o=>{let n=new le;return n.push(Y,o.length,"count: ".concat(String(o.length))),o.forEach(({index:r,locals:a})=>{n.push(Y,r,"function index: ".concat(String(r))),n.push(Y,a.length,"number of params and locals ".concat(a.length)),a.forEach(({index:l,name:u})=>{n.push(Y,l,"index: ".concat(String(l))),qe(n,u,"name_len: ".concat(u))})}),n},Na=o=>{let n=new le;qe(n,"name","name_len: name");let r=$a(o.module);n.push(Cn,0,"name_type: Module"),n.push(Y,r.size,"name_payload_len"),n.write(r);let a=Oa(o.functions);n.push(Cn,1,"name_type: Function"),n.push(Y,a.size,"name_payload_len"),n.write(a);let l=La(o.locals);return n.push(Cn,2,"name_type: Locals"),n.push(Y,l.size,"name_payload_len"),n.write(l),n},Pa=1,Ia=2,Ra=3,Ba=4,Ma=5,Fa=6,Ua=7,Da=8,ja=9,ka=10,za=11,Ga=0,xe=({type:o,label:n,emitter:r})=>a=>{let l=a[n];if(!l||Array.isArray(l)&&!l.length)return null;let u=new le().push(ce,o,n+" section"),h=r(l);return u.push(Y,h.size,"size"),u.write(h),u};var Ae={type:xe({type:Pa,label:"Types",emitter:_a}),imports:xe({type:Ia,label:"Imports",emitter:ca}),function:xe({type:Ra,label:"Functions",emitter:fa}),table:xe({type:Ba,label:"Table",emitter:Aa}),memory:xe({type:Ma,label:"Memory",emitter:Sa}),exports:xe({type:Ua,label:"Exports",emitter:la}),globals:xe({type:Fa,label:"Globals",emitter:pa}),start:xe({type:Da,label:"Start",emitter:ma}),element:xe({type:ja,label:"Element",emitter:da}),code:xe({type:ka,label:"Code",emitter:va}),data:xe({type:za,label:"Data",emitter:Ca}),name:xe({type:Ga,label:"Name",emitter:Na})};function On(o,n){let a=new le().write(aa(o.Version)).write(Ae.type(o)).write(Ae.imports(o)).write(Ae.function(o)).write(Ae.table(o)).write(Ae.memory(o)).write(Ae.globals(o)).write(Ae.exports(o)).write(Ae.start(o)).write(Ae.element(o)).write(Ae.code(o)).write(Ae.data(o));return n.encodeNames?a.write(Ae.name(o)):a}let Ya=(o,n=0,r)=>{let a=0;return o.data.slice(n,r).map(({type:l,value:u,debug:h})=>{let d="".concat(a.toString()," 0x").concat(a.toString(16)).padStart(6," ").padEnd(o.data.length.toString().length+1),f;Array.isArray(u)?f=u.map(b=>b.toString(16)).join().padStart(16):f=u.toString(16).padStart(16);let T="".concat(d,": ").concat(f," ; ").concat(h);return a+=vn[l]||u.length,T}).join("\n")+"\n ============ fin ============="},Ln=o=>{let n=r=>{try{return o("function fragment() {\n        ".concat(r,"\n      }")).params[0].params[2].params[0]}catch(a){throw new Error("PANIC - Invalid fragment input:\n\n".concat(r,"\n\nParse Error: ").concat(a.stack))}};return(r,...a)=>{let l=!1,u=r.reduce((d,f,T)=>{let b=a[T];return b!=null&&typeof b!="object"?d+=f+String(b):b!=null?(l=!0,d+=f+"$$rep_".concat(T)):d+=f},""),h=n(u);return l?$({Identifier(d){let{value:f}=d;return f.indexOf("$$rep_")?d:a[Number(f.replace("$$rep_",""))]}})(h):h}},qa="0.21.0",Wa=(o,n)=>{let{version:r=Fr,encodeNames:a=!1,lines:l=o.split("\n"),filename:u="unknown",extensions:h=[]}=n||{},d=mn([]),f=Ln(d),T={version:r,encodeNames:a,lines:l,filename:u,extensions:h},b=d(o),v=Tn(b,[],I({},T,{parser:d,stmt:f}));xn(v,{lines:l,filename:u});let w=wn(v,T);return On(w,{version:r,encodeNames:a,filename:u,lines:l})},Va=(o,n)=>{let{filename:r="unknown.walt",extensions:a=[],linker:l,encodeNames:u=!1}=n||{},h={filename:r,lines:o.split("\n"),version:Fr,encodeNames:u},d=a.reduce((B,U)=>{let z=I({semantics:Z=>({}),grammar:()=>({ParserRules:[]})},U(h));return B.grammar.push(z.grammar),B.semantics.push(z.semantics),B},{grammar:[],semantics:[]}),f=mn(d.grammar),T=Ln(f),b=f(o),v=Tn(b,d.semantics,{parser:f,stmt:T});xn(v,h);let w=wn(v,I({},h,{linker:l})),P=On(w,h);return{wasm:P,buffer(){return P.buffer()},ast:b,semanticAST:v}};return e.makeParser=mn,e.makeFragment=Ln,e.semantics=Tn,e.validate=xn,e.generator=wn,e.emitter=On,e.prettyPrintNode=Nr,e.debug=Ya,e.stringEncoder=Er,e.stringDecoder=si,e.walkNode=D,e.mapNode=$,e.VERSION=qa,e.getIR=Wa,e.compile=Va,e}({}),ir=Dc;var jc=e=>ir.compile(e).buffer(),kc=e=>e.trim().length?JSON.stringify([...new Uint8Array(ir.compile(e).buffer())]):"[]",zc=e=>{let t={};return Object.getOwnPropertyNames(Object.getPrototypeOf(e)).filter(s=>!["constructor","nanoapp","initial_state","initial_component","css","__walt","__src","init"].includes(s)).map(s=>t[s]=e[s].bind(e)),t},Gc=(e,t)=>{if(e.length){let s=new WebAssembly.Table({initial:10,element:"anyfunc"}),i=new WebAssembly.Instance(new WebAssembly.Module(new Uint8Array(e).buffer),{tag:zc(t),console,javascript:{table:s,setTimeout:(p,m)=>window.setTimeout(s.get(p),m),setInterval}}).exports,c={};return Object.keys(i).map(p=>c[p]=i[p]),c}return{}},Xs={name:"Walt",uniqueBlock:"walt",compileWalt:kc,compile:jc,initWalt:Gc};function Yc(e){return e;function t(p,m,g){var _;return g<0?g+=1:g>1&&(g-=1),6*g<1?_=p+(m-p)*g*6:2*g<1?_=m:3*g<2?_=p+(m-p)*(2/3-g)*6:_=p,255*_}function s(p,m,g){var _,x,$,R,D,J,L=Math;return m/=100,g/=100,m?(g<=.5?x=g*(m+1):x=g+m-g*m,_=g*2-x,$=p/360,R=L.ceil(t(_,x,$+1/3)),D=L.ceil(t(_,x,$)),J=L.ceil(t(_,x,$-1/3))):R=D=J=g*255,{r:R,g:D,b:J}}function i(p,m,g){return"#"+((1<<24)+(1*p<<16)+(1*m<<8)+1*g).toString(16).slice(1)}var c}var Zs=Yc;var eo={name:"min.css",processStyle:Zs};var qc={walt:Xs,mincss:eo},ar=qc;var pn="0.7.15-dev";!pn.endsWith("-dev")&&console.log("ui.js \u2764\uFE0F ".concat(pn," alpha experiment. Make user interfaces great again!"));var cr={VERSION:pn,tags:Le,customElement:yt,createTag:Qe,compile:ln};cr.plugins=ar;var Wc=cr;typeof window<"u"&&(window.UIjs=cr,document.addEventListener("DOMContentLoaded",Bs));
/**
 * WASM types
 *
 * https://github.com/WebAssembly/spec/tree/master/interpreter#s-expression-syntax
 *
 * Plus some extra C type mappings
 *
 * @author arthrubuldauskas@gmail.com
 * @license MIT
 */
/**
 * min.css
 *
 * min.css is a tiny, fast and efficient JavaScript library for minifying CSS
 * files that really makes your website faster
 *
 * Site: https://github.com/w3core/min.css/
 * Online: https://w3core.github.io/min.css/
 *
 * @version 1.3.1
 *
 * @license BSD License
 * @author Max Chuhryaev
 */
